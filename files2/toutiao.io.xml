<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>c5116aae50c0c8e406b2d654d289d128</guid>
<title>M*N个策略造成类爆炸怎样重构？</title>
<link>https://toutiao.io/k/ddkgqz5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;背景&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;收到朋友针对他们遇到的具体问题写一篇文章的邀请，问题是这样的&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;朋友:&lt;/p&gt;&lt;p&gt;我们公司对接了M个三方服务  然后还有N种业务  实现用策略的话感觉有点类爆炸  也想不到什么好方法了  这也是早上刚接到一个重构支付的需求想到的   根据业务和供应商搞了太多策略实现了[晕]&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;我:&lt;/p&gt;&lt;p&gt;初步感觉应该用打造接入平台的方式解决&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;朋友:&lt;/p&gt;&lt;p&gt;开始的时候没有考虑到  代码一言难尽了 [捂脸]  谢谢谢老师&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;我从对话中分解出下面几个问题&lt;/p&gt;&lt;p&gt;1、理解重构、重写和重新架构&lt;/p&gt;&lt;p&gt;2、怎样做重构？&lt;/p&gt;&lt;p&gt;3、重构过程与业务支撑之间怎样平衡？&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;下面我针对这三个问题展开论述。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;理解重构、重写和重新架构&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;重构是对代码和功能进行&lt;span&gt;渐进式改进&lt;/span&gt;；重写是&lt;span&gt;要摧毁它，重新构建；重新架构在大框架上做修改和再设计，具体每个实现模块可能是用原来的。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;举个例子，搭积木。重构就是我用积木搭建了一个小马，发现小马某些部分不好看，我就把几块积木调整调整，让小马更好看；重写就是我用积木搭建了一个小马，发现自己搭建好了完全不喜欢，把积木推到了重新搭，既然是重新搭，搭好的东西和原来差距有多大就不好说了；重新架构就是我用积木搭建了一个小马，发现自己其实想要个小桥，没有必要全部推到重做，而是可以先画好设计图，然后直接把小马的四条腿拆下来做桥墩，脊背部分做一部分桥面，实在不能用的再拆下来重安装。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;重构是小步跑的过程，如果对外提供的功能没有变化，这是稳妥的方法；重写往往伴随着功能上的升级，不然对于“我不知道这段代码是干什么用的但我不敢删”这种事情很难保证对外提供的功能没有变化。&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;重构和重写与修改量没有直接关系。有个哲学问题叫做“特修斯之船”，是说一艘船持续的在海上航行，船不断有部分老化或者坏掉进行替换，最终整艘船的所有部分都换过一遍，这时候船还是原来那艘船吗？&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6666666666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/2tk5ianItRl9csr5bLvWohaeCrKicQzMduZG2RWUTWG8tqmcjOXAicRBZRG1cyy4SpaDsb4ibBBKCPKsr2iaGkSQgrw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;450&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;所以咱们不再纠结概念，统一用重构这个词，聚焦于怎么解决问题。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;怎样做重构&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;首先需要对系统进行一个生命周期预估，包括：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;朋友说：“开始的时候没有考虑到  代码一言难尽了&lt;span&gt;”&lt;/span&gt;，其实大可不必这样想。架构和代码&lt;/span&gt;不是设计出来的，是演进出来的。如果一开始要我做，一段时间之后，也很可能会遇到相同觉得非重构不可的情况。虽然我一定会做未来需求预判，但是现实往往会出现很多例外情况，让程序充满了妥协。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;那针对朋友遇到的问题，怎么设计更合理呢？&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;支付重构&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;如果只是重构支付部分，我个人觉得相对容易。因为支付需要的要素比较好抽象，主要是下游支付渠道需要什么。自从有了网联，现在对接方也比较固定了。直接接网联或者微信支付、支付宝支付、拉卡拉…… 他们所需要的要素都差不多。因为它们都要接入网联完成国家监管的需求，所以要素主要看网联需要哪些要素。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;当然，它们的签名方式可能会不同；调用的支付渠道地址不同；给支付渠道传递的时候入参组装方式也不同。甚至有的支付渠道还需要有特殊的步骤。这时候怎么抽象呢？&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;推荐“工作流”+策略模式。这是一种实现积木化的方式。定义一个统一接口，比如&lt;/p&gt;&lt;p&gt;class Executor {&lt;/p&gt;&lt;p&gt;      void execute(Task task);&lt;/p&gt;&lt;p&gt;}&lt;/p&gt;&lt;p&gt;task里放置所有的入参，以及每次执行时产生的，下游需要的中间数据。签名等流程各自实现此接口。这样就实现了自由组装的重用。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;举个例子，下面&lt;span&gt;“&lt;/span&gt;积木块”各自实现了自己的execute：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;微信支付签名、微信支付入参组装、微信支付结果解析、支付宝&lt;span&gt;支付&lt;/span&gt;&lt;span&gt;签&lt;/span&gt;&lt;span&gt;名、支付宝&lt;/span&gt;&lt;span&gt;支付&lt;/span&gt;&lt;span&gt;入参组装&lt;/span&gt;&lt;span&gt;、支付宝&lt;/span&gt;&lt;span&gt;支付结果解析、&lt;/span&gt;支付宝特殊处理、下游http调用(这里假设微信和支付宝都是http的post请求来调用的，这样发起调用来说两者只是请求地址和入参不同）&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;这时候可以组装微信支付流程：&lt;/p&gt;&lt;p&gt;List list = new List();&lt;/p&gt;&lt;p&gt;list.put(微信支付签名);&lt;/p&gt;&lt;p&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;微&lt;/span&gt;&lt;span&gt;信支付入参组装&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(下游http调用&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;微&lt;/span&gt;&lt;span&gt;信支付结果解析&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;for(Executor e ：list) {&lt;/p&gt;&lt;p&gt;    e.execute(task);&lt;/p&gt;&lt;p&gt;}&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;同样可以组装支付宝支付流程：&lt;/p&gt;&lt;p&gt;List list = new List();&lt;/p&gt;&lt;p&gt;list.put(&lt;span&gt;支&lt;/span&gt;&lt;span&gt;付宝&lt;/span&gt;支付签名);&lt;/p&gt;&lt;p&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span/&gt;&lt;span&gt;支&lt;/span&gt;&lt;span&gt;付宝&lt;/span&gt;&lt;span&gt;支付入参组装&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(下游http调用&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span/&gt;&lt;span&gt;支&lt;/span&gt;&lt;span&gt;付宝&lt;/span&gt;&lt;span&gt;支付结果解析&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;lis&lt;/span&gt;&lt;span&gt;t.&lt;/span&gt;&lt;span&gt;put&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span/&gt;&lt;span&gt;支&lt;/span&gt;&lt;span&gt;付宝&lt;/span&gt;&lt;span/&gt;&lt;span&gt;支付特殊处理&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;for(Executor e ：list) {&lt;/p&gt;&lt;p&gt;    e.execute(task);&lt;/p&gt;&lt;p&gt;}&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;不同的流程只是list不同，这个list是可以时间配置化的，可以配置在配置文件中、甚至可以从数据库中读取。微信支付流程和支付宝支付流程是两种不同的策略，可以使用策略模式。入参选择哪种策略就用哪种策略执行。这样，各个流程之间没有干扰，积木块变更影响小还可以随意组合灵活性高。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;整体重构&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;朋友的业务复杂性还不在于支付，而在于收单。解决方法就是文章开头提到的接入平台的方式。打造平台的关键不是技术，而是规范。&lt;span&gt;自己制定规范。&lt;/span&gt;&lt;span&gt;别人接入&lt;/span&gt;&lt;span&gt;都要按照规范来&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;这里有前提：公司自身的影响力。平台是底层自己需要有决策权，比如微信开放平台，想接入就要理解并使用他们的API。而因为微信基础在，必须按照人家说的来，这就是平台影响力。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在实际工作中，一般有两种情况。接入方自身也没有什么规范，本身就要求功能可用，这时候咱们自身有规范，对方比较容易接受。另外一种，对方是实力背景的大公司，也有自己的规范。这时候咱们处于弱势，要按照别人的规范来，可以使用上面支付重构的积木化方法进行进行组合。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;重构过程与业务支撑之间怎样平衡？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在重构过程中一般会遇到两顶思考帽问题：一顶是需求的帽子，一顶是重构的帽子。有限的时间怎么分配呢？建议一开始就定好目标：什么阶段要重构到什么程度，然后分解工作。最后分摊到每天比如需要2小时时间。那么在需求开发时间评估的时候就要把这个时间扣掉。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;重构做完，老逻辑迁移到新逻辑有风险。这时候我的建议是：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;首先，把新功能当成重构结果的验金石。有新功能，先在新功能上验证新逻辑的正确性。因为新功能上线到上量有一个过程，初期出了问题影响也不会很大。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;然后，老逻辑迁移需要灰度。可以一个业务一个业务的灰度迁移，也可以按照流量百分比进行迁移。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;总结&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;最后总结一下对重构的几点建议：&lt;/p&gt;&lt;p&gt;1、小步快跑，稳步迭代&lt;/p&gt;&lt;p&gt;2、设计与代码的重构结伴而行&lt;/p&gt;&lt;p&gt;3、如果模块或者函数不能想到一个好名字，很可能是设计出了问题&lt;/p&gt;&lt;p&gt;4、每步要保证足够简单，想象随时可能会停止&lt;br/&gt;&lt;/p&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>901f0c34278a17a014d847da8fe4a663</guid>
<title>直击RocketMQ面试现场</title>
<link>https://toutiao.io/k/pg4axb3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzk0OTI0NzIzMQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/Eb8TPxx4xwyavDTedzsA7hicJ3r55tiaOxjDhO01LRxYCmqCRowLFRFjN9ZrEiafbBSYUATl9QBlJSY1UWwB25k4w/0?wx_fmt=png&quot; data-nickname=&quot;35岁程序员那些事&quot; data-alias=&quot;&quot; data-signature=&quot;畅销书-Spring Cloud Alibaba微服务架构实战派（上下册）的作者&quot; data-from=&quot;1&quot;/&gt;&lt;span/&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;RocketMQ是一个高性能、高可用和高吞吐量的“分布式消息中间件”，如果面试官要问你它的相关原理，那太多了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;理解RocketMQ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你只是去背了一些八股文，然后去应付RocketMQ相关面试题，那大概率是不能通过的。比如面试官突然问你。RocketMQ是用什么语言编写的？我想很多八股文都不会提到吧，因为人家默认觉得你知道，但是万一你真的不知道呢，那这个也太好玩了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;首先，我们要理解RocketMQ，先必须知道怎么搭建环境，笔者曾经面试过很多候选人，问他们RocketMQ是如何搭建环境的，需要哪些配套的中间件环境，步骤是哪些，很多候选人都不知道。反而呢，对那些“所谓的核心技术原理，非常了解”，但是我又去问，实际的项目中，又是如何去使用RocketMQ的呢，他们又不知道。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;其次，学会搭建环境之后，那就是要自己写代码去用RocketMQ，反复的用，反复的想，反复的踩坑，这样才能更深层次的理解它的功能，从而达到理解RocketMQ的目的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;最后，我们要结合使用过程中碰到的问题，去分析原理并解决问题，做到出现了问题，我们能从日志就能快速的找到出现问题的那行代码，并能够现学现用的去解决问题，这个才能我们技术人要达到的目标。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;直接RocketMQ面试现场&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;说来说去还是要我们自己在平常多积累一些RocketMQ的使用经验，并学习到它的优秀的架构设计思想，从而总结出自己的方法论。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;直接面试现场，那我们还是要上一些比较尖锐的面试题，如下：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;说说RocketMQ的生产者组的功能，主要能做什么，注意这个是要挖坑的，因为它与分布式事务消息有关系。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;说说分布是事务消息的原理，它的应用场景有哪些？&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;平常我们是怎么使用&lt;/span&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;来生产和消费消息的，这个考察我们是否关注中间件的细节？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;的集群消费和广播消费消息的区别？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;支持顺序消息吗？怎么实现的呢？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;的副本机制是什么？它解决了哪些问题？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;的主从同步机制是什么？它又解决了哪些问题？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;中消息支持重试吗？如果支持，怎么实现的？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;RocketMQ&lt;/span&gt;&lt;span&gt;是如何完&lt;/span&gt;&lt;span&gt;成消息路由的？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span/&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;RocketMQ的负载均衡机制是什么？它主要解决什么问题？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;以上只是关于RocketMQ八股文的一部分，这里还是暂时不提供解读的答案，咱们可以先自己默默的思考一下，答案解读会在下几期的文章中。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;总结&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;要想真正的做到直击面试现场，需要我们自己平常使用RocketMQ的过程中，去认真的思考RocketMQ的思想，只有真正理解了，才能做到“以不变应万变”，不惧怕现场面试。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;粉丝福利时间&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为了回馈广大技术人和书友，本公众号和电子工业出版社合作，一起给大家赠送一些技术类书籍。&lt;/span&gt;&lt;strong&gt;&lt;span&gt; &lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;              &lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.2&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ibl6u6nJ01g9icia42icDbWWvO2ObicnIUHjwQKVp30YzLS8xSInYupoEXAKjYeYDibY50CgKLz6ViaDjTjuRqUqaae0w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;20&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;参与方式&lt;/p&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.2&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/K8beZoNWDcUm9I6ia4UU97K1XHrQx2PavruEm3xAL2W3Vd7JxrB8PLXtmT5JkwqpC9Dg9hEmtVZkY2hibnlkib0Qg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;20&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;关注公众号：35岁程序员那些事，后台回复关键词“参与抽奖”，获取抽奖链接，点击抽奖。 中奖之后，可以联系笔者的微信号或者公众号后台回复关键词“联系笔者”，获取联系方式。&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果没有中奖的技术人，还可以参与本次文章的点赞和留言，笔者会按照留言的时间顺序和点赞的时间顺序，随机的再抽取一名技术人，再赠送一本技术书籍&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;笔者会在抽奖结果出来之后，进行留言和点赞技术人的抽奖，抽奖结果会同步公布。&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;部分书单列表&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;第一本 &lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__78&quot;&gt;《&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__79&quot;&gt;Spring Cloud Alibaba 微服务架构实战派（上下册）&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__80&quot;&gt;》&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;li&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;技术新。采用目前的新版本（2.2. 5.RELEASE）来编写，相关技术也采用的是目前新的稳定版本&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;精心设计的主线：零基础入门，循序渐进，直至项目实战&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;不只介绍框架本身，而是微服务架构全栈技术（比如Seata、Skywalking、Redis、RocketMQ等），本书是“一站到底”的解决方案：读者只需从这里上车，中途无需转乘，读者需要什么，本书就提供什么，直达终点&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;绘制了大量的图，便于理解原理、架构、流程&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;本书的目标是：①让读者在动手中学习，而不是“看书时好像全明白了，一动手却发现什么都不会”；②读者可以掌握微服务全栈技术，而不仅仅是框架，对于相关的技术（Seata、RocketMQ），基本都是从零讲起，这样避免了读者为了学会微服务技术，得找Spring Cloud 框架的书、Seata的书、RocketMQ的书……本书是一站式解决方案。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(175, 165, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__78&quot;&gt;《&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__79&quot;&gt;Spring Cloud Alibaba 微服务架构实战派（上下册）&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__80&quot;&gt;》&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;是笔者自己出版的书籍，肯定是要放在第一位的，资源多多。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;第二本 &lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__54&quot;&gt;《&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt;Spring Boot实战派》&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;本书花费大量的力气对比讲解多种同类技术的知识、使用和区别，读者可以根据自己的喜欢进行技术选型；还讲解了时下流行的接口架构风格RESTFUL、用来实现高并发的Redis、用来实现系统间通信的中间件RabbitMQ。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;最后两章融合了本书所讲知识点，讲解了两个常用又实用的实战项目。本书适合所有对Spring Boot感兴趣的读者阅读。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt;第三本 &lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__148&quot;&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__147&quot;&gt;《&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__148&quot;&gt;剑指Offer（专项突破版）：数据结构与算法名企面试题精讲&lt;/strong&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__149&quot;&gt;》&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;本书全面、系统地总结了在准备程序员面试过程中必备的数据结构与算法。本书首先详细讨论整数、数组、链表、字符串、哈希表、栈、队列、二叉树、堆和前缀树等常用的数据结构，然后深入讨论二分查找、排序、回溯法、动态规划和图搜索等算法。除了介绍相应的基础知识，每章还通过大量的高频面试题系统地总结了各种数据结构与算法的应用场景及解题技巧。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;本书适合所有正在准备面试的程序员阅读。无论是计算机相关专业的应届毕业生还是初入职场的程序员，本书总结的数据结构和算法的基础知识及解题经验都不仅可以帮助他们提高准备面试的效率，还可以增加他们通过面试的成功率。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__148&quot;&gt;第四本 《微服务项目实战派:从Spring Boot到Spring Cloud》&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本书以项目实战的形式来介绍Spring Cloud微服务体系。书中所有实例都来自作者多年工作实践，内容覆盖构建Spring Cloud微服务所需的绝大部分内容——包括微服务工程搭建、微服务网关、熔断限流、分布式任务调度、自动化CI/CD构建、Kubernetes容器化部署、微服务监控系统、分布式链路追踪等。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本书适合希望快速提升项目经验的Java初学者、正在转型微服务架构的传统项目研发人员、希望提升Spring Cloud微服务全栈技术经验的高级开发人员、对特定系统设计感兴趣的产品经理及研发人员。无论读者是否接触过微服务开发，只要具备一定的Java开发基础，都能通过本书的学习快速掌握实际场景中的微服务开发技巧，并快速提升项目实战经验。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt;第五本&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt; 《正本清源分布式事务之Seata》&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16460189857240=&quot;rgb(31, 31, 31)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)|rgb(253, 250, 246)&quot; data-darkmode-color-16460189857240=&quot;rgb(102, 102, 102)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(65, 58, 56)|rgb(102, 102, 102)&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;strong data-darkmode-bgcolor-16460189857240=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16460189857240=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16460189857240=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16460189857240=&quot;#fff|rgb(59, 59, 59)|rgb(0, 0, 0)&quot; data-style=&quot;max-width: 100%; max-inline-size: 100%; cursor: text; color: rgb(0, 0, 0); font-size: 16px; letter-spacing: 1.5px; caret-color: rgb(255, 0, 0); font-family: 微软雅黑, sans-serif; outline: none 0px !important; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__55&quot;&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在微服务架构下，分布式事务一直是痛点和难点。Seata是阿里巴巴开源的分布式事务中间件，致力于以高效且对业务无侵入的方式，解决在微服务场景下面临的分布式事务问题。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本书作者是阿里巴巴GTS创始人和Seata作者，结合其多年在分布式事务领域设计、研发和应用的经验，深入浅出地阐述了分布式事务技术基础、Seata AT模式、TCC模式、RPC设计、事务协调器技术的原理，并给出了两个开发实例（AT模式和TCC模式）。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本书可以为微服务系统架构师、研发人员解决核心业务实际问题提供思路，也适合分布式技术相关专业的学生阅读，帮助他们建立分布式事务的知识框架。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;如上书籍只是笔者列举的一些资源，如果中奖的技术人的书架上已经入驻了上述书籍，可以通过“微信”和笔者联系。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;公众号初衷&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;知识输出是笔者的初衷，借助知识输出，能够认识更多的牛人,能够和牛人沟通，也是自己技术提升的一个机会。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;     本人微信ID，如有需要惠请联系&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.2982954545454546&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Eb8TPxx4xwwHsTjeO8OsSJoG3Rg657x1BmzoeKGBExTk6yk6ibDyZwIX7zFMvX1HmDaKvaribkjWNqZPJpOeHYrw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1056&quot;/&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzk0OTI0NzIzMQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/Eb8TPxx4xwwRBMXF2V1EnW3pB79Rk1CZicwibngNE3omwCwhO0A41EaR8uBx7tfSh3e30IPqVmEauR1nTTzxvlAw/0?wx_fmt=png&quot; data-nickname=&quot;35岁程序员那些事&quot; data-alias=&quot;cxynxs_35&quot; data-signature=&quot;畅销书-Spring Cloud Alibaba微服务架构实战派（上下册）的作者&quot; data-from=&quot;1&quot;/&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;一路向北&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9482758620689655&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/IaMeK4iaQqbia5GiaVShU9NPibJ3wwSxZ2QVukfO2r651QwQoHwcA5hiapibrrkRh9AFJpvGZVRMFiaHzhPPKLs8RmdibQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;174&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;人间灯火无不休，爱与山水与春&lt;br/&gt;&lt;/p&gt;&lt;p data-mid=&quot;&quot;&gt;                                                                            ----无题&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Eb8TPxx4xwzofM1ESK3E9bErfo0AfKL8x9F7cremVGV5D6uAn1XoFMUVAp9tpK3QrunygNEJlSXUuFrMAqBm1w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;span/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3a4808b24d62635aa3e76a2d68ae7dd3</guid>
<title>虚拟数字人，哪家最强？</title>
<link>https://toutiao.io/k/3c65cde</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;section data-brushtype=&quot;text&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;img class=&quot;__bg_gif rich_pages wxw-img&quot; data-backh=&quot;100&quot; data-backw=&quot;578&quot; data-before-oversubscription-url=&quot;https://mmbiz.qpic.cn/mmbiz_gif/YwAQbY9GAwDQpeWCDOAy8oX1N4D2XceiaEjyCrAy5VBj25H2tTbHtC168vmibHiclcTOic0yUbrb7ictuURX2A7aicDQ/?wx_fmt=gif&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.17331288343558282&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/YwAQbY9GAwDQpeWCDOAy8oX1N4D2XceiaEjyCrAy5VBj25H2tTbHtC168vmibHiclcTOic0yUbrb7ictuURX2A7aicDQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;652&quot;/&gt;&lt;/section&gt;&lt;section data-id=&quot;97324&quot; data-tools=&quot;135编辑器&quot;&gt;&lt;section&gt;&lt;section data-autoskip=&quot;1&quot;&gt;&lt;p&gt;&lt;span&gt;❑ &lt;/span&gt;&lt;span&gt;导 读&lt;/span&gt;&lt;/p&gt;&lt;hr/&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;中国传媒大学媒体融合与传播国家重点实验室（以下简称“国重实验室”）媒体大数据中心联合头号偶像（北京）数字科技有限公司共同发布《中国虚拟数字人影响力指数报告》，国内首个“虚拟数字人影响力指数”亮相。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;654&quot; data-backw=&quot;562&quot; data-ratio=&quot;1.1644398766700925&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ue3ibzkUJGWFDKicveP42LfDvWVrtaE2H7bwyGaibycd0Hw8mjwEIicwUOicskd8uhb4J0LO33fQn8DJr9QKCwDFUug/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;973&quot;/&gt;&lt;em&gt;2021中国虚拟数字人影响力展示图&lt;/em&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;全文共计3277字，预计阅读时间9分钟&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;来源&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;| 头号偶像（转载请注明来源）&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;编辑&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;| 蒲蒲&lt;/span&gt;&lt;/section&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;89101&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;2021年，元宇宙概念下的虚拟数字人崛起。演唱会、综艺、代言、走秀、脱口秀、短剧、直播……“十八般武艺”的虚拟数字人吸引了数以亿计流量关注、企业聚焦、资本追逐。叠加疫情下国人对数字生活需求的快速增加，以及智能手机和消费级VR硬件的应用，虚拟数字人发展开始进入快车道。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;随着计算机图形学、深度学习、语音合成、类脑科学等聚合科技的进步，虚拟数字人正逐步演进成为新物种、新媒介，越来越多的虚拟数字人正在被设计、制作和运营，应用场景得到了极大的扩展，应用价值正逐步被发掘，激活了元宇宙生态，将成为未来人类进入元宇宙的重要载体。&lt;strong&gt;（后台回复“虚拟人”获取相关报告）&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;788&quot; data-backw=&quot;578&quot; data-croporisrc=&quot;https://mmbiz.qlogo.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s2caekzv7jYAsfZ1icZSH5bCUZ4lMwic9fqxhOicS2bOVBCicHLdicOgXQug/0?wx_fmt=jpeg&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;1080&quot; data-cropy1=&quot;22.422145328719722&quot; data-cropy2=&quot;1472.3875432525952&quot; data-ratio=&quot;1.3435185185185186&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sh7mh6TsTibLEoN27eiaXyVmW3cPfdy5ywCtJhuevcc8yaFol33We2Ufw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;783&quot; data-backw=&quot;578&quot; data-ratio=&quot;1.3546296296296296&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sc1qcx7ibfjzI5ye9I7VCWNcPXGElXwy60UyI3IS2HkAficMJKkVTn34w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/CdNqPPxia4lNkh0wJPdW382nvgcjkLxFjyx70dx4euZUH1Oq1WEfwrAic4yAUnhVLrT9FxDuFibqZUQtZx52JkJ6Q/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;700&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;Ø 三类数字虚拟人&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.17666666666666667&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibH8EwWdXQT9kibTYibXxNDuSRefiaUqsyrwYFglVvCpicr8ia0xjUVxraBIQA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;300&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;定义：&lt;/strong&gt;以歌手、演员、模特、网红、游戏高手等“艺人“身份出现，拥有鲜明的个性、才艺设定，活跃于各大&lt;span&gt;社交平台、视频平台、综艺节目等，通过积累流量、人气去获得更多的“工作”的虛拟数字人。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;运营方式：&lt;/strong&gt;与真人艺人类似，通过歌曲、硬照、短剧等“作品”进行人设运营。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;主要代表：&lt;/strong&gt;洛天依、柳夜熙、翎Ling、梅涩甜等。&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;471&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.8148148148148148&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibHNu4G2YtZ6ZibicsAy1ypNGJgefIicto8xiabuoQuPhgCSdDN1kaFHYDuNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;仅用一条抖音视频便火出了圈的柳夜熙，已然成为现在虚拟偶像流量的天花板。作为一个兼具“赛博朋克和中式奇幻”风格的网红IP，柳夜熙成为虚拟偶像赛道的一个标杆。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;461&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7981481481481482&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibH3ib3x1kjYddCcnPnthaMOboEItaPtHwJh8qF1XMM19kfJakkZVxQ1Vg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;虚拟歌姬洛天依拥有清晰的定位、系统的运营思路、庞大的粉丝群体，是国内为数不多的可盈利的虚拟偶像。2021年，洛天依出道九年，登上了多家卫视舞台，并登上了牛年春晚，已然是“虚拟偶像的偶像”，但面对越来越多“才艺丰富”的超写实虚拟数字人的挑战，仍需持续创新运营。&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.1806020066889632&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibH26XFwva6qVjjCmaWgzG20jH3skiapaMAhfbxWL2jqcJBCvicJrgichiaIQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;299&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;定义：&lt;/strong&gt;虚拟世界的“主持人”在专业赛道上包括各大媒体的虚拟主持人、虚拟记者;而在视频平台上活&lt;span&gt;跃的虚拟UP主们则由个人或企业运营，数量庞大。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;运营方式：&lt;/strong&gt;智能驱动与真人驱动交替出现，专业赛道以新闻播报为主，视频平台以直播带货为主。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;主要代表：&lt;/strong&gt;央视网小C、新华社小诤、人民日报果果、湖南卫视小漾等。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;459&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7944444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibHqbEicg98z2UtTCofWtQrnicy9f5ibDtUuMPHtIV10PNFvJMIaGNjHnyaQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;甜美亲切的虚拟数字人“小C”是央视网人工智能编辑部的“新成员”，小C成为央视网特别策划“两会C+真探”系列直播节目的当家主持，是媒体行业内首个直播连线采访人大代表的“3D超写实数字人” 。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;459&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7935185185185185&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibHeLWvfN8HCH6icQKgyWHPwziaq29GCL1wric9vVLvS5ticibXrhDafYPnT1A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;2021年5月19日推出的“小聪”是全球首个手语AI合成主播，其手语表达为深度学习的产物，在视频媒体中拥有广泛的使用价值。“小聪”基于《国家通用手语词典》，能够实现健听人语言与听障者手语语言的机器翻译能力，还可以完整实现手控信息及非手控信息的表达，通过机器翻译生成手语表征信息，覆盖手部动作、面部表情、口动唇动等多个维度。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.17725752508361203&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibH9s3BVicK8badvmTric58FDKzwREjkDw2D3N5nwnNYPApGLgumV9B1uJQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;299&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;定义：&lt;/strong&gt;由企业推出作为企业的“数字员工”，对外展示企业的产品、服务、文化。一类多作为“智能客服”出现,另一类则开始以偶像、红人方式在社交、短视频平台上独立“吸粉”。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;运营方式：&lt;/strong&gt;企业虚拟品牌官、形象代言人、智能客服等。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;主要代表：&lt;/strong&gt;百信银行AIYA、哈尔滨啤酒哈酱、OPPO小布等。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;460&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7962962962962963&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibHB4sQQpONyuiblib779bRxoFWMwZERS8r24kjwTdJicOyo0Q7NLRKJlLPw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;AIYA是百信银行在金融业内推出的首位“AI虚拟品牌官”，其2021年11月18日推出二次元版本，并在银行业首发了NFT数字藏品，12月30日推出超写实版本，并与央视虚拟主播小C进行互动出道。其整体推出时间短但影响力高，主要原因：一是创新能力强，通过银行业领先的创意实践，明晰的知识产权、自主技术、数字藏品应用等赢得高分；二是整体传播高举高打，通过党央媒合作，赢得了传播的高权重影响力，成为C位出道的“双优生”。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;462&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.8&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4LPacpUFibaz2uuGmFNa8lgyfulx1vFibHenQcvvXqyicVeA1hqZicyCgduTxtD7htnME8fpkXhJuofeJQriciaicVr0A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;在短短两年时间，从首位虚拟道路交通安全宣传大使、品牌公益大使，到国潮KOL、电竞主播，再到近期的新身份“华纳首位虚拟音乐艺术家”，酷女孩哈酱开始从企业的虚拟员工向“多栖艺人”发展。这拓宽了虚拟员工的运营思路，要让更多品牌看到了打开元宇宙的新钥匙。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/CdNqPPxia4lNkh0wJPdW382nvgcjkLxFjyx70dx4euZUH1Oq1WEfwrAic4yAUnhVLrT9FxDuFibqZUQtZx52JkJ6Q/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;700&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;Ø 虚拟数字人&amp;amp;元宇宙&lt;/strong&gt;&lt;span/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;不可否认的是，当前虚拟数字人是正广泛应用在元宇宙新生态中，担任着信息制造、传递的责任，是元宇宙中“人”与“人”、“人”与事物或事物与事物之间产生联系或发生孪生关系的新介质，是人类进入元宇宙的重要载体和媒介的延伸。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;作为当下热门风口，虚拟数字人吸引大量资金和企业纷纷涌入。据shilian.com了解，我国现有虚拟数字人相关企业28.8万家，仅仅在2021年，新增注册企业就超过18万家。5年时间之内，新增注册企业复合增长率接近60%。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;事实上，虚拟数字人并不是全新概念，最早可追溯至2007年。当时，以语音合成程序为基础开发的音源库“初音未来”，成为首个现象级虚拟偶像。在此后相当长时间内，虚拟数字人大多以动漫、游戏形象为主，集中应用于影视娱乐产业。后来从神舟十二号发射后出现在太空站里的数字记者，到科技巨头英伟达CEO在全球瞩目的演讲中切换数字人替身，再到双十一中京东的数字主播不间断卖货，虚拟数字人似乎在一夜之间就走入了我们的生活。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;对此，业内人士认为，近年来，技术环境的改善让虚拟数字人发展迎来利好。而得益于元宇宙概念的火爆，让虚拟员工、虚拟代言人、虚拟学生等虚拟数字人正越来越频繁地出现在公众视野，在社交、传媒、营销等领域创造现实价值。也正是虚拟数字人形象日趋逼真、交互更加顺畅，所以在越来越多领域发挥作用。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/CdNqPPxia4lNkh0wJPdW382nvgcjkLxFjyx70dx4euZUH1Oq1WEfwrAic4yAUnhVLrT9FxDuFibqZUQtZx52JkJ6Q/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;700&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;Ø 虚拟数字人发展的八大趋势&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;随着虚拟数字人的爆发式增长，作为新技术、新产业的虚拟数字技术被纳入“十四五”规划纲要，其创新应用自然将成为我国产业创新的必经之路。&lt;/span&gt;&lt;span&gt;结合项目调研、行业访谈、专家采访，报告提出了对虚拟数字人行业发展的八大展望：&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;预计2025年虚拟数字人的“繁衍”速度将超过地球人类的繁衍速度。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;虚拟数字人将成为人机交互新界面，承载数字世界的沉浸式体验。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;可编程的虚拟数字人将实现智能化、规模化生产内容，并形成新的产业生态。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;2030年，中国虚拟数字人赛道将诞生出超过10个独角兽企业。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;AI情感算法、多模态人机交互、类脑科学等技术在虚拟数字人产业带动下得到跨越式发展。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;虚拟数字人产业将催生“中之人”、“技术美术”、Vup等新职业，相关产业人才缺口高达100万。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;虚拟员工成消费品、金融、地产、物业、教育、文旅等服务行业标配。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;随着虚拟数字人的爆发式增长，可信数字身份治理体系和网络安全体系建设迫在眉睫，亟需建立可追溯的分布式数字身份体系。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;strong&gt;具体内容如下&lt;/strong&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;17&quot; data-backw=&quot;491&quot; data-ratio=&quot;0.034166666666666665&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4e0PqmkFqFNGDYrNk1nticVOiavBqQVicp5a9gjglXmb1h93XjtDIxicpI288EjSGib4bEtOv00iaTJmEo9DwlzLqiaTA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1200&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sRNtKEHqH4YrTlYO4z8IHNYdfs2lbiaB5DMTFjHGD6ickbIDvz4kGlaUQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sqGRacJTzE5ewDpbTThV54grvw3I5poakEhG1rbtLqFhcNEZtEEEN2g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s3pA3sYBpSn2E0JbOGhicMmdUWIB7nzzVEickdMoaMzBia7AY3pQYbZxBQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sYdROHfKeC8NxUcPulCdYuWavU96EbbNponnuZiaicz4hRJzQAXOriaIibg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sfiap5ib9DjerYdxtI3KFurwTDzeDkjedCFNXY7WneD7iaeW25IibZEsS1g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0smgbZO1iah6eKhIjkiaQEp1IicDdngkIR5g7OhAMqnKqMVibVAUGF39AIvw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0svED2ODRjVH9wy8jUxkFVS7HTvefU6jjnkEcJbNcx9pfsicSyLL5ibdEg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sxx8ibRpxiarIL9M6eMsn22xR7p7gCqh5lmfddS7rWme413zn06YItZ1A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sGVZttSGNdEoKa4O9sia3x29HgVBEK1MYF3zpc0mzvaPoGbT0q0NBIRg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sHZxy0WOtUTXLWJM2McKMytK8ooTd0bko7QLKQVAVNSib2lrzGicibIfPw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sKswTrjPUolZS0YibhTn3x6sE9LJVJLTbTQibshQEzHPM5R38APvmZwdw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sCDhCUicdzdFrMQLqQNgkGbUZTroVTiaCK5ibao8ibJA9lYdadeSn286pnw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sswnaNJf2kCicmtIguX23ibHssVMNzT0w3dHOZT4hMqcRO5F0EFAiaQ89g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sUBtpFo0RZXibIHFqau3zvNlf3YMyYEMrzqib5XYDjmlPBOJWqdMsL4xg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0so7iaPoUiboibJficg4VCZXqnyegtLfbhQkIlPgniba7bANuNClubqUNBf7w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sQoah9ywVqARhBtd1c6sJ071D025pfGn1iaWV0cLonQZuqNF4LpEsuhQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sBjMsh5jE83eUK9q0brB7vy4I36zIQnpiblKA9MMz3HOZ79FdzKamHgQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0syD7ia0qnmP8DrlwVsjTRz1NEzCtsGUo83PDTkXjeNpMatibnCicVkFBLA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0swJJ5HRpMh8N404Ccibcs2Oyh6D6XXqG6MuSNdV58kRP12ZtVNfDmCdA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sLOHBtKTs2R8kB1XR7ka8cvyicCDVfialC97niaXrAmqtITHNV2JxG27vg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sSAekRxjxbH73uqseaTAK9JbZeGwNibZl6r99JLhiajLS84CupqwXUZqA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sNftRuxiaX7R8MGL509XLF6V3cmcl8xo8QgzHgBfCII1C9WYD2Ufn9hw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0slwgdPRkwesIxTYWpRZgn7LUsnbRuZHb6SiaHyU6wFbic3vsqgr6lgaLg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0saU35rB15K3cLJO9n2BxLvuGicl3GdYqic1BiaibgUlaAPYXJ3Nyv8BByVg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sheMFVWrHs7lySrZLtJdlHBUIcD6pUDLIoibtZPHt3d35hWOk0qwuJog/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s44vt9FciatmicZACgxGVRnysBX9aVQNjB5dnbdZmcAaPnmXmZnDu0eOg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0srhpiauqaONrdZCbPWQWMjmQnlZSJIXtRNxyibgia9SwnEMd5UicBW2Eyjg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sS39auvXzH2KribQagicBadN1OKSqZpVsXpab1iaxXQep4K1CpxibpTbZSw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.4140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0suuVzKZP78TnM8FOPWHpBxRwV8MOLbJD9oAJS6ahH6V9piaJqCOibJr2g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s2g2TaAdPXeD4o32v01qiaO3OnPCCMniaibMRaFrgZic6aDiaXnSR89PBZicg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s15Hgc4RQ179Tmpq9bdibsfkKtXJiaOyg8BWJKDN7af9OTDx1micsuhlSQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s1CKqS5sgxTd1eUXdcQn5EAAZpmMicktntDsJjqRoMs1KlHXgoI0KpZg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0slSg9UC0LohpfjZfQLkHuhJq9GScJBWL8Ildugib1PPlKfyBoAWwpzRQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sGqxxe2q2KdRFKN2sMM22OnblbdRVuSwAPicOibkP702pJnFic9bP1yzBA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0syDL6pibxBocWKTOic6OLDJmnR13ic3B5BMUVENmY2R0lEWhNYcsgibeYEg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sD0fYibSIkto9eEQXVIwqNyLvpUuv0kY4dM1XHibXsnDypV2sQBn74WiaA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0svccLpTKGO0QOKIFJXgpfv2lG8TkfrCZRvp2QbdHIKXmNTG4plEDMSA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0s1WpbOzJPIz112RbaialPYj44Wic9UJgOcWn8XuzfZREc9zt4XyAG7y9w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sDYCZ5tYPJckwJKjZedJQyxpBibeLEBOQwH89CRDtqcTOHTuHkibb9B1g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.41640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4e0PqmkFqFP87CMR0rAzpzQq2C6z6l0sUmRt3miakzvEiaOnGw45GmrtVicyg1DVJViaIGzSPlbjk3ta1WwtEiaQCqg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg wxw-img&quot; data-backh=&quot;96&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.16666666666666666&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/4e0PqmkFqFMUXWCqTdyI9IGqEbzttbWutVicdNVyrmGmrL2NsOCroe0JjGYJNrEGlwkB2doN4zEHgDcGBxIALmA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg wxw-img&quot; data-backh=&quot;107&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.18518518518518517&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/4e0PqmkFqFMUXWCqTdyI9IGqEbzttbWuxeU5CNcprVWH7zwzvKmTpoXM4iaC2mKYEFP2bdv2u7SE5V9zCt2klog/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;▐ &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;白皮书&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;▐ &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;国际要闻&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;▐&lt;/span&gt;&lt;span&gt;&lt;strong&gt; 政策新规&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;▐ &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;数据观出品&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr/&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;__bg_gif rich_pages wxw-img&quot; data-backh=&quot;309&quot; data-backw=&quot;546&quot; data-before-oversubscription-url=&quot;https://mmbiz.qpic.cn/mmbiz_gif/4e0PqmkFqFMuBaibggU7tjdPV6sHuGLKawPDWEtXSpskoVUcV5GS4ohfWKplicpxl6TmibYnVCYP5o2Aj5icVUQsicw/?wx_fmt=gif&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.5659090909090909&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/4e0PqmkFqFMuBaibggU7tjdPV6sHuGLKawPDWEtXSpskoVUcV5GS4ohfWKplicpxl6TmibYnVCYP5o2Aj5icVUQsicw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;440&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MjM5NzA4Njg2MA==&amp;amp;mid=2651193772&amp;amp;idx=1&amp;amp;sn=85cf501c219c7d9272d1ce6573648bc8&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-linktype=&quot;2&quot; tab=&quot;innerlink&quot; textvalue=&quot;“数据观”亮相纽约时代广场 ，向世界传达“中国数谷”魅力&quot;&gt;❏&lt;span&gt;“数据观”亮相纽约时代广场 &lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section data-id=&quot;89894&quot; data-tools=&quot;135编辑器&quot;&gt;&lt;section data-id=&quot;us515156&quot;&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;52&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.09013333333333333&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4e0PqmkFqFMUXWCqTdyI9IGqEbzttbWuhxBFhGnNr3UHwSjpyewwLrKWZNHFvVbjUuGxkunECsDCLjS8rKbOag/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1875&quot;/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>001c77646b803ed0ff03ca895e4eb3fb</guid>
<title>联通实时计算平台演进与实践</title>
<link>https://toutiao.io/k/2jffo8z</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;p&gt;&lt;span&gt;&lt;span&gt;▼ 关注「&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ApacheFlink&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;」，看更多大咖 &lt;span&gt;▼&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;channels_iframe_wrp&quot;&gt;&lt;mpvideosnap class=&quot;js_uneditable custom_select_card channels_iframe&quot; data-pluginname=&quot;videosnap&quot; data-id=&quot;export/UzFfAgtgekIEAQAAAAAAIfAo6fRcAgAAAAstQy6ubaLX4KHWvLEZgBPEp4NwVktWdKf9zNPgMItrl5Mhr2DoxXs588ft2GGC&quot; data-url=&quot;https://findermp.video.qq.com/251/20304/stodownload?encfilekey=rjD5jyTuFrIpZ2ibE8T7YmwgiahniaXswqz3r3I8Eqaauz7wgtN95k5tq7DCzicHRRcNRNWb29vD2WYngSEk1Reic2dRCRjPicpZ86IUuLngHRibBY&amp;amp;adaptivelytrans=0&amp;amp;bizid=1023&amp;amp;dotrans=0&amp;amp;hy=SH&amp;amp;idx=1&amp;amp;m=&amp;amp;scene=0&amp;amp;token=x5Y29zUxcibAU8m3vT08KHocibQgUh7UNsMaJWhQJG4xIjIVribZJOUhMkfxEiahGhFicvjmqnlqicb3Y&quot; data-headimgurl=&quot;http://wx.qlogo.cn/finderhead/XxT9TiaJ1ibf3rFKHtt2yXrJpCDia37R3rjlyd6wzzicd55QmIWDrKHqRA/0&quot; data-username=&quot;v2_060000231003b20faec8c7e7881dc1dccd00ea35b077960b9c6a44e8a5c5efa3651fa144024c@finder&quot; data-nickname=&quot;ApacheFlink&quot; data-desc=&quot;联通大数据开发专家穆纯进，带你了解联通如何基于 Flink 构建新的平台架构。 #Flink #FFA2021&quot; data-nonceid=&quot;5437257292133464785&quot; data-type=&quot;video&quot;/&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot; label=&quot;Copyright Reserved by PLAYHUDONG.&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot; label=&quot;Copyright Reserved by PLAYHUDONG.&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot; label=&quot;Copyright Reserved by PLAYHUDONG.&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;摘要：&lt;/strong&gt;&lt;/span&gt;本篇内容整理自联通大数据技术专家穆纯进在 Flink Forward Asia 2021 平台建设专场的演讲。主要内容包括：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;实时计算平台背景&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;实时计算平台演进与实践&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;基于 Flink 的集群治理&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;未来规划&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;Tips：&lt;/strong&gt;点击&lt;/span&gt;&lt;span&gt;&lt;strong&gt;「阅读原&lt;/strong&gt;&lt;strong&gt;文」&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;查看原文视频 &amp;amp; 演讲PDF～&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p cid=&quot;n144&quot; mdtype=&quot;heading&quot;&gt;&lt;strong&gt;一、实时计算平台背景&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h2 cid=&quot;n144&quot; mdtype=&quot;heading&quot;&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p cid=&quot;n145&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVggpKOFFA1z5bv7E03HIicU9ibr9ctvNP6ZCYnx68S6FfsJnToxPyDSabQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;首先了解一下实时计算平台的背景。电信行业的业务系统非常复杂，所以它的数据源也是非常多的，目前实时计算平台接入了 30 多种数据源，这 30 多种数据源相对于总的数据种类来说是比较小的。即使这样，我们的数据量也达到了万亿级别，每天有 600TB 的数据增量，而且我们接入的数据源种类和大小还在持续增长。平台的用户来自于全国 31 个省份公司以及联通集团的各个子公司，尤其是在节假日会有大量用户去做规则的订阅。用户想要获取数据，需要在平台上进行订阅，我们会将数据源封装成标准化的场景，目前我们有 26 种标准化场景，支撑了 5000 多个规则的订阅。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n149&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgKFwO6NAlOCbrem0rjT5ic9hJd7ibOpic6PcUY94sZDhoVrH0icyeCr2ibvw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;订阅场景有三大类。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;用户行为类的场景有 14 个，比如位置类的场景，是关于用户进入某个区域后停留了多长时间，还有终端登网，是关于用户连接了哪个网络，4G 还是 5G 网，以及漫游、语音、产品订购等各种场景；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;用户使用类的场景有 6 个，比如用户使用了多少流量、账户余额是多少、是否有欠费停机等；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;用户触网类的场景大概有 10 个，比如业务的办理、充值缴费，还有新入户入网等。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n161&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVg8BxPhBoE0GIeaTTQCqTaasXhgg6ibDZPQeOYlYslJ4anejKjRlqydcg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对于实时计算平台来说，实时性的要求是很高的。数据从产生到进入我们的系统，大概有 5~20 秒的延迟，经过系统正常处理之后大概有 3~10 秒的延迟，我们允许的最大延迟是 5 分钟，所以必须做好实时计算平台端到端的延迟的监控。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;用户定义的场景符合要求的数据最少要下发一次，这个是有严格要求的，不能漏发，而 Flink 很好地满足了这个需求；数据的准确性要求需要达到 95%，平台实时下发的数据会保存一份到 HDFS 上，每天我们会抽取部分订阅和离线数据，按照相同的规则进行数据生成以及数据质量比对，如果差异过大就需要找到原因并保证后续下发数据的质量。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n164&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgk4wxKAVUFyLTrsrkBtCuAII7oFYryoRfSgQa29BZ8fZg1qaF3DyC9w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;本次分享更多的是 Flink 在电信行业的一次企业的深度实践：如何使用 Flink 更好地支撑我们的需求。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;通用的平台无法支撑我们的特殊场景，比如以位置类的场景为例，我们会在地图上画多个电子围栏，当用户进入围栏并在围栏里面停留一段时间，并且满足用户设定性别、年龄、职业、收入等用户特征，这样的数据才进行下发。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们的平台可以认为是一个实时场景中台，将数据进行实时的清洗处理，封装成支持多个条件组合的复杂场景，集约化地提供标准实时能力的同时，更进一步靠近业务，提供给业务方简单易用、门槛很低的接入方式。业务方通过调用标准化的接口，经过网关认证鉴权，才可以订阅我们的场景。订阅成功之后会将 Kafka 的一些连接信息和数据的 Schema 返回给订阅用户，用户订阅的筛选条件跟数据流进行匹配，匹配成功之后会以 Kafka 的形式再进行数据下发。以上就是我们的实时计算平台与下游系统交互的流程。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p cid=&quot;n169&quot; mdtype=&quot;heading&quot;&gt;&lt;strong&gt;二、实时计算平台演进与实践&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h2 cid=&quot;n169&quot; mdtype=&quot;heading&quot;&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p cid=&quot;n170&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgicUISZgguJK3qpd9QnzaicWLPKjs2OE3CticJnGMTkEf3D87icGmkGmAQQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;2020 年以前，我们的平台是使用 Kafka + Spark Streaming 来实现的，而且是采购厂商的第三方的平台，遇到了很多问题和瓶颈，难以满足我们日常的需求。现在很多企业包括我们都正在进行数字化改革，系统的自研比例也越来越高，再加上需求的驱动，自研、可灵活定制、可控的系统是迫在眉睫了。所以 2020 年我们开始接触了 Flink，并实现了基于 Flink 的实时计算平台，这个过程中我们也体会到了开源的魅力，今后也会更多地参与到社区中来。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n172&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgOOq7Ogv9SREIyByxJTz7jyia4cQZTbNGETMJoNTsMyc9w6xxWCnnliaQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们的既往平台存在很多问题。首先是三方黑盒平台，我们使用厂商的第三方平台，过多依赖了外部系统；并且在大并发下外部系统的负载会非常高，不能灵活定制个性化的需求；Kafka 的负载也特别高，因为每一个规则的订阅都会对应多个 topic，所以随着规则的增加，topic 和分区的数量也会呈线性增长，导致延时比较高。每个订阅场景会对应多个实时流，而每个实时流都会占用内存和 CPU，场景过多会导致资源消耗增长以及资源负载过高；再就是支撑的体量小，支撑场景的订阅数有限的，比如逢年过节用户订阅的数量剧增，经常需要紧急救火，无法满足日益增长的需求；此外，监控粒度也不够，无法灵活定制监控，无法进行端到端的监控，采用人肉的排查比较多。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n174&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgUwkiczyhBfAcJrT5JXy9ktIHIyQecqicU4kbDdbGyD41k48Oxwrp5dOg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;基于上述问题，我们全面自研了基于 Flink 的实时计算平台，根据每个场景的特点进行最优的定制，最大化资源的使用效率。同时我们利用 Flink 的状态减少外部依赖，降低了程序的复杂度，提升程序的性能。通过灵活定制实现了资源的优化，相同体量的需求下大大节约了资源。同时为了保证系统的低延迟率，我们进行了端到端的监控，比如增加了数据的积压、延迟、数据断传监控。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;整个平台的架构比较简单，采用了 Flink on Yarn 的运行方式，外部只依赖 HBase，数据是以 Kafka 接入并由 Kafka 下发。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n177&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgK9ib7XjM6fZGhWpCsFfOdvJQE7KoO2zC55iag1rbooKpgcv6ia75Cyhsw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Flink 的集群是独立搭建的，它独享了 550 台服务器，没有和离线计算混用，因为它对稳定性要求比较高,需要日均处理 1.5 万亿数据，近 600TB 的数据增量。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n179&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgia5bibKR5UicbQgO2JK3YCZEPXXc4vkgR3VNWqvL5RWs6gXXB5Szh52Dw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们对场景深度定制的主要原因是数据量大，同一个场景的订阅又非常多，而且每个订阅的条件又是不一样的。从 Kafka 读取一条数据的时候，这条数据要匹配多个规则，匹配中后才会下发到规则对应的 topic 里面。所以不管有多少订阅，只从 Kafka 中读取数据一次，这样能够降低对 Kafka 的消耗。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;手机打电话或者上网都会连接到基站，相同基站的数据会按一定的时长窗口和固定消息进行压缩，比如三秒钟一个窗口，或者消息达到了 1000 再进行触发，这样下游接收到的消息就会有量级的降低。然后是围栏匹配，外部系统的压力是基于基站规模的，而不是基于消息数目。再就是充分利用了 Flink 的状态，当人员进入和滞留的时候会存入状态，用 RocksDB 状态后端减少了外部依赖，简化了系统的复杂度。此外，我们还实现了亿级标签的关联不依赖外部系统。通过数据压缩、围栏匹配、进入驻留、标签关联后，我们才开始正式匹配规则。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;用户订阅场景后，订阅的规则会以 Flink CDC 的方式同步到实时计算平台，这样可以保证延迟比较低。由于人群的进入滞留会存入到状态，基于 RocksDB 的状态后端数据量比较大，我们会通过解析状态的数据进行问题排查，比如用户到底有没有在围栏之中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n183&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgd9Ll6BrG6WkRb3pyTv1tadC91GMoGriauwvPRnL9LtiaoGMKFXkAH6LQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们自定义了 HASH 算法，在不依赖于外部系统的情况下，实现了亿级标签的关联。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;在大并发下，如果每个用户都要关联外部系统获取标签的信息，那么外部系统的压力会非常大，尤其是在我们联通这么大数据量的情况下，依赖于外部系统建设的成本也很高，这些标签都是离线标签，数据相对比较稳定，比如有日更的有月更的。所以我们对用户使用自定义的哈希算法，比如有个手机号，按照哈希算法它被分配到 index 为 0 的 task_0 实例中，再通过离线计算将标签文件中的手机号也按照相同的哈希算法分配到编号为 0 的 0_tag 中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;task_0 实例在 open 方法中获取自己的 index 编号，即 index=0，然后拼接出标签文件名 0.tag，并将文件加载到自己的内存中。Task_0 实例接收到手机号后就可以从本地内存获取到此手机号的标签数据，不会造成内存的冗余浪费，提升了系统性能，减少了外部依赖。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;有标签更新的时候， open 方法也会自动加载新的标签，并刷新到自己的内存中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n187&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVguIqdnWdBSaZ91Nt34SSXCz792ViaComqGhZSR9cSgxqPPHAOJWLNAfA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上图是我们做的端到端的时延监控。因为我们的业务对延迟要求比较高，所以我们进行了事件时间的打标，比如进出 Kafka 时间的打标，这里的事件就是消息。对于算子的延迟监控，我们根据打标的时间和当前的时间计算出延迟，这里并不是每条消息来了之后都去计算，而是采用抽样的方式。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对积压断传也做了监控，是通过采集 Kafka offset 进行前后对比来判断的，另外还有对数据延迟的监控，利用事件的时间和当前的时间来计算延迟，可以监控上游系统的数据延迟。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n190&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgjAutksG72z07xaCA2RH6RxzibxT5ESvYMwiboia2yPJSCnsPC4zicdCSrg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上图是端到端延迟监控和反压监控的图表。可以看到端到端的延迟正常是在 2~6 秒之间，也符合我们的预期，因为定位的条件是比较复杂的。我们还对反压进行了监控，通过监控算子 input channel 的使用率来定位每个算子产生的反压，比如第二个图出现了严重的反压且持续了一段时间，这时候我们需要定位到具体的算子，然后去排查原因，来保证系统的低延迟。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n192&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgswFbIO7zM1YI1WvLNnL2lIQoicW1z0cZBCLyhao6LzPwXPbVNtYI7mg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上图是我们对 Kafka 集群中的每个 topic 分区的 offset，以及对每个消费者消费到的位置进行采集来定位它的断传和积压。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;首先制定一个 source 来获取 topic 列表和消费者组列表，再这些列表下发到下游，下游的算子可以采用分布式的方式去采集 offset 值，也是利用了 Flink 的特性。最后写入 Clickhouse 中进行分析。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n195&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVg7ThO5dl1kz5JkHzHZXfGvrqb3zo4TzJUfo9Z7khtHAjpefibMEmmjqA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Flink 日常监控主要包括以下几类：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;Flink 作业的监控、告警接入联通统一告警天眼平台；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;作业的运行状态、checkpoint 的异常耗时；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;算子的时延、反压、流量、条数；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;taskmanager CPU、内存的使用率，JVM GC 等指标的监控。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p cid=&quot;n202&quot; mdtype=&quot;heading&quot;&gt;&lt;strong&gt;三、基于 Flink 的集群治理&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h2 cid=&quot;n202&quot; mdtype=&quot;heading&quot;&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p cid=&quot;n203&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVg5WVrBib2kuBs3QgnXnJcLuGib9AFcQ2IqtL2g7eEWhsaPdibxDtJKicrTQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们还基于 Flink 搭建了我们的集群治理平台。搭建这个平台的背景是我们的总集群节点达到了 1 万多台，单集群最大有 900 个节点，总共 40 多个集群，总数据量单副本达到了 100 个 PB，每天有 60 万个作业运行，单个集群的 NameNode 的文件数最大达到了 1.5 亿。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n205&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVghalc0FQ43kIHx83kIwCsk6DjJQQKGIHlh7qRJI8JjfxnpB8HLehVcQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;随着公司业务的高速发展，数据的需求越来越复杂，所需要的算力也越来越大，集群的规模也越来越大，承载的数据产品也越来越多，导致 Hadoop 集群面临很大的挑战：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;文件数比较多对 nameNode 造成很大的压力，影响存储系统的稳定；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;小文件特别多，导致读取同样数据量的时候需要扫描更多文件，导致更多 NameNode RPC；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;空文件多，需要扫描更多的文件，导致更多的 RPC；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;平均文件比较小，从宏观上也体现出了小文件数比较多的；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;生产上会持续产生文件，作业输出的文件要进行调优；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;冷数据多，缺少清理的机制，浪费存储资源；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;资源负载高，而且扩容成本又太大，扩容了也无法支撑太长时间；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;作业耗时长影响产品的交付；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;作业消耗资源大，占用太多的 CPU、核数和内存；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;作业存在数据倾斜，导致执行时间非常长。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n217&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgldBCXBqsf64jqmQHOozLTYxQiajQKeCO7JAFLoFmzcXJcJpa85GUbibQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;针对这些挑战，我们搭建了基于 Flink 的集群治理架构，通过采集资源队列的信息，解析 NameNode 的元数据文件 Fsimage，采集计算引擎的作业等信息等，然后对集群做 HDFS 画像、作业画像，数据血缘、冗余计算画像、RPC 画像以及资源画像。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n219&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgx8gIQ4ftXvBZBYaMDOsWof5gpyDicRiahuoGUjo5WicCZGcyQBN0x2Jcg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;资源画像：我们会同时对多个集群的多个资源队列的情况比如它的 IO、 metric 等进行分钟级的采集，可以实时查看整个集群和细分队列的资源使用趋势。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;存储画像：我们以无侵入的方式对多集群的分布式存储进行全局性的多维度的分析。比如文件数到底分布在哪里，小文件分布在哪里，空文件分布在哪里。对于冷数据的分布，我们对每个数据库每张表的分区目录也做了精细化的画像。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;作业画像：对多集群全产品线不同计算引擎的作业，我们进行实时采集，从时间维度、队列维度以及作业提交来源等多个维度，从耗时耗资源，数据倾斜、大吞吐量、高 RPC 的作业等多方面进行洞察，找出有问题的作业，筛选出那些待优化的作业。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据血缘：通过分析生产环境 10 万级别的 SQL 语句，绘制出无侵入的、全局的、高精准的数据血缘关系。并在任意周期内提供了数据表级/账户级的调用频次、数据表的依赖关系、产线加工的流程变更、加工故障的影响范围和垃圾表的洞察等功能。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;此外我们还做了用户操作审计和元数据方面的一些画像。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n225&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVggfO5gzbicddbIC2XIfbK7QnhWiaZbyoGY00VvnXqtUCElib3RTjpc1TFA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上图是集群治理存储大屏。除了一些宏观指标比如总文件数、空文件数、空文件夹，还有冷目录数、冷数据量和小文件的占比等。我们还对冷数据进行分析，比如哪些数据最后访问在某个月的数据量有多大，由此可以看到冷数据的时间分布；还有比如 10 兆以下、50 兆以下、100 兆以下的文件分布在哪些租户上。除了这些指标，还可以精确定位到哪个库、哪张表、哪个分区存在小文件。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p cid=&quot;n227&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgKqIP7HYMHMgtBiaaGop6ibIQSODWQ7NLr6s1ZZyAU5nVA6A8aPia9KSMg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上图是集群治理的效果展示，可以看到资源负载达到 100% 的时长也明显缩短，文件数降低了 60% 以上，RPC 负载也大幅降低。每年会有千万级别的成本节约，解决了长时间的资源紧张问题，降低了扩容的机器数。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p cid=&quot;n230&quot; mdtype=&quot;heading&quot;&gt;&lt;strong&gt;四、未来规划&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h2 cid=&quot;n230&quot; mdtype=&quot;heading&quot;&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p cid=&quot;n231&quot; mdtype=&quot;paragraph&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVg0NffmgNZ5HpWYaII9TLjLgh9sib63kFeUiaprXxjHMe3MTJlrrcM32oQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;目前我们还没有一个完善的实时流管理平台，且监控比较分散，研发通用的管理和监控平台势在必行。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;面对日益增长的需求，深度定制化虽然节约了资源，提升了支撑的规模，但是它的开发效率并不理想。针对数据量不大的场景，我们也考虑了使用 Flink SQL 来搭建通用的平台，以此来提升研发效率。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;最后，我们还会继续探索 Flink 在数据湖中的应用。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;往期精选&lt;/p&gt;&lt;/section&gt;&lt;img data-ratio=&quot;2&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgRUS0CdtOd2icibfE0Ht0RW2j29q3effuz3GvVff3n0AvUuNPeCwFF0kw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;50&quot;/&gt; &lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU3Mzg4OTMyNQ==&amp;amp;mid=2247495906&amp;amp;idx=1&amp;amp;sn=8806069228df05ec3633de7a1e305227&amp;amp;chksm=fd387ea0ca4ff7b61fcde0d8b7b051b2ce91fa3bbda96789d9dc62fe1fb08077eb5a2d16e626&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4255556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgSFLCtrDvzH5KJlSjkYZO4TdngQcmkqFCgib8icaQdrQxtsicxoQ4uK1nQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU3Mzg4OTMyNQ==&amp;amp;mid=2247495878&amp;amp;idx=1&amp;amp;sn=d63bdeb4c790faf999bc038cd19131d5&amp;amp;chksm=fd387e84ca4ff792a0931917d19bbe6c28026f9ea09e0f1097b3626a84c851cb9afeaf763c0f&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4255556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgxTeRtdttl68oyksHFSk6OYnYeB3D35L59fLfoicQHfQibqn08aW13Nqg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU3Mzg4OTMyNQ==&amp;amp;mid=2247495824&amp;amp;idx=1&amp;amp;sn=332b9bb80a24856197485263c28fd093&amp;amp;chksm=fd387ed2ca4ff7c49add188b5565b8c1442df933b24b39965a2dcd88ebb4f92156cbaf0e2f0a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4255556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8AsYBicEePu7ibxvlEE3tJu8zI2yUjeoVgbf3mXydGiaqXibM3k0uuYu0gU8mxzibFsHAvlEtkkaeXdkZrJGsJGAo0g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;▼ 关注「&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Apache Flink&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;」，获取更多技术干货 &lt;span&gt;▼&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzU3Mzg4OTMyNQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6FJHxaI14AsXuzeg4SybT0hiaCSohrIY75oiaOMzhQU7RouiafjNa76k2CtD6xxB2JqnawqFqV3zg3A/0?wx_fmt=png&quot; data-nickname=&quot;Apache Flink&quot; data-alias=&quot;apacheflinkcc&quot; data-signature=&quot;Flink 中文社区官微，Flink PMC 维护&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;更多 Flink 相关技术问题，可扫码加入社区钉钉交流群～&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-fileid=&quot;100010716&quot; data-ratio=&quot;1.2078189300411524&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8AsYBicEePu6PUTQaA1BP3Fb8uViccQpspmTibIYEfM7Wv6VACia9CDQfcN8huMVCafZ5s36wThUmbYRTOzMu4hd8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;972&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;img class=&quot;__bg_gif rich_pages wxw-img&quot; data-fileid=&quot;100010714&quot; data-ratio=&quot;1&quot; data-type=&quot;gif&quot; data-w=&quot;400&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Z6bicxIx5naLWBBEcl44aIic1Mthe1nZiaramW5s4e8WwyCYYbTzu6uPBpgI6sxNXNymEnOYKpJpcrItUia7lS64mA/640?wx_fmt=gif&quot;/&gt;  &lt;/span&gt;&lt;strong&gt;&lt;span&gt;戳我，查看原文视频&amp;amp;演讲PDF～&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>160c8c28c73b7aa00365878e6542f47f</guid>
<title>React Native原理之跨端通信机制</title>
<link>https://toutiao.io/k/hlj8zl8</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6666666666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7D4HUannDz8BCaBXfiaFBAlmXruD6KJpR1CUADiaRQYTv9ZdibsHDawOVIg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2370&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;图片来源：https://unsplash.com/photos/gy08FXeM2L4&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;跨端通信&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在移动端开发场景中，能使用一份代码就能同时在安卓和 iOS 系统上运行 APP 的方案，熟称为跨端方案。而 Webview ，React Native 都是云音乐大前端团队用的比较多的跨端方案，这些方案虽然能提高开发效率，但它们不能像原生语言一样直接调用系统的能力，于是在做 HTML5（以下简称 H5） 或者 React Native（以下简称 RN） 需求的时候，开发者们经常碰到要调用 Native 能力的情况。Native 能力用原生语言编写，有自己的运行环境，RN 页面使用 JS 编写，也有独立的运行环境，这种跨越运行环境的调用被称为&lt;code&gt;跨端通信&lt;/code&gt;。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.33192389006342493&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7D7FCxHE1NyVcc0eMoVsCYAYxgkoPrP0zZcuBw7nte81PqVyxh06QMuQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;946&quot;/&gt;&lt;figcaption&gt;webView jsb&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;H5 中的&lt;code&gt;跨端通信&lt;/code&gt;称为 &lt;code&gt;JSBridge&lt;/code&gt;，在进行一次 JSBridge 调用的时候会携带调用参数，默认有 4 个参数：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ModuleId: 模块 ID&lt;br/&gt;MethodId: 方法 ID&lt;br/&gt;params: 参数&lt;br/&gt;CallbackId: JS 回调名&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其中 &lt;code&gt;ModuleId&lt;/code&gt; 和 &lt;code&gt;MethodId&lt;/code&gt; 能定位到具体调用的原生方法，&lt;code&gt;params&lt;/code&gt; 参数作为原生方法调用的参数，最后通过 &lt;code&gt;CallbackId&lt;/code&gt; 回调 JS 的回调函数，H5 就能从回调函数中拿到调用结果。该流程中主要使用了 Webview 容器中&lt;code&gt;拦截请求&lt;/code&gt;和&lt;code&gt;客户端调用 JS 函数&lt;/code&gt;的能力，比如安卓中通常使用的是 &lt;code&gt;WebChromeClient.onJsPrompt&lt;/code&gt; 方法来拦截 H5 的请求，&lt;code&gt;evaluateJavascript&lt;/code&gt; 方法用来执行回调。但是 React Native 中没有引入 Webview 来实现这些调用的能力，它采用了完全不同的方式来处理。另外，在云音乐团队的 APP 中， 会同时存在 H5 和 RN 页面，也就是同一个 APP 中两种跨端通信方式并存，但它们最后调用的原生方法却是来自同一个原生模块。本文主要从 Android 系统的 RN 实现来介绍 RN 的通信机制和桥接能力（以下简称 Bridge），并结合以上通信场景中会碰到的问题来讲解如何实现一个业务中可用的 Bridge。大体由三部分组成，首先介绍 RN 中不同的组成模块和它们各自的角色；第二部分是各个模块之间的调用方式和具体的示例；最后一部分探讨业务中的 Bridge 的实现。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;RN 组成&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在 RN 中，主要有三个重要的组成模块：&lt;code&gt;平台层&lt;/code&gt;（ Android 或者 OC 环境），&lt;code&gt;桥接层&lt;/code&gt;（ C++ ）和&lt;code&gt;JS 层&lt;/code&gt;。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;平台层负责原生组件的渲染和提供各式各样的原生能力，由原生语言实现；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;桥接模块负责解析 JS 代码，JS 和 Java/OC 代码互调，由 C++ 语言实现；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;JS 层负责跨端页面具体的业务逻辑。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8418181818181818&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7DDE6gnFgbZ4WYpTHyTDpr8ICuFYGlxcy72iaQYqLHkiciaIgGpypfPOPgQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1100&quot;/&gt;&lt;figcaption&gt;rn 通信模块&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;相比起 Webview 的结构来说，RN 的结构多了一层&lt;code&gt;桥接层&lt;/code&gt;，也就是 C++ 层。文章先来介绍一下这个模块的作用，以及为什么会多出这么一个模块。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;桥接层（C++ 层）&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;React Native 和 H5 一样，使用了 JS 作为跨端页面的开发语言，因此它必须要有一个 JS 执行引擎，而在使用 H5 的情况下，Webview 是 JS 的执行引擎，同时 Webview 还是页面的渲染引擎。RN 不一样的地方在于，已经有了自己的渲染层，这个功能交给了 Java 层，因为 RN 的 JS 组件代码最后都会渲染成原生组件。因此 RN 只需要一个 JS 执行引擎来跑 React 代码。RN 团队选择了 &lt;code&gt;JSCore&lt;/code&gt; 作为 JS 的执行引擎，而 &lt;code&gt;JSCore&lt;/code&gt; 的对外接口是用 C 和 C++ 编写的。因此平台层的 Java 代码 / OC 代码想要通过 &lt;code&gt;JSCore&lt;/code&gt; 拿到 JS 的模块和回调函数，只能通过 C++ 提供的接口获取，再加上 C++ 在 iOS 和安卓系统上也有良好的跨端运行的功能，选它作为桥接层是不错的选择。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;JSCore&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;JSCore 是桥接层中的主要模块，它是 RN 架构中的 JS 引擎，负责 JS 代码的加载和解析。先来看下它的主要 API ：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;JSContextGetGlobalObject：获取JavaScript运行环境的Global对象。&lt;br/&gt;JSObjectSetProperty/JSObjectGetProperty：JavaScript对象的属性操作：set和get。&lt;br/&gt;JSEvaluateScript：在JavaScript环境中执行一段JS脚本。&lt;br/&gt;JSObjectCallAsFunction：在JavaScript环境中调用一个JavaScript函数&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过 API 可以看出来，开发者可以用 &lt;code&gt;JSEvaluateScript&lt;/code&gt; 在 JSCore 环境中执行一段 JS 代码，也可以通过 &lt;code&gt;JSContextGetGlobalObject&lt;/code&gt; 拿到 JS 上下文的 Global 变量，然后把它转化成 C++ 可以使用的数据结构并且操作它，注入 API。而 &lt;code&gt;JSObjectSetProperty&lt;/code&gt; 和 &lt;code&gt;JSContextGetGlobalObject&lt;/code&gt; 也是比较重要的两个 API ，稍后会在通信流程中发挥作用。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;Native 模块和 JavaScript 模块&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说起通信的话，整个过程肯定存在信源和信宿，也就是消息的发送者和接收者，在 RN 的通信中，它们是 Native 和 JS 的模块，它们向对方提供能力都是以模块为功能单位的，类似 JSBridge 协议中的 ModuleID 的概念。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;Native 模块在 Android 系统下是 Java 模块，由平台代码实现，JS 通过模块 ID（moduleID） 和方法 ID（methodID） 来进行调用，一般都在 RN 源码工程的 &lt;code&gt;java/com/facebook/react/modules/&lt;/code&gt; 目录下，可以给 RN 页面开放原生系统的能力，如计时器的实现模块 &lt;code&gt;Timing&lt;/code&gt;，给 JS 代码提供计时器的能力。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;JavaScript 模块是由 JS 实现，代码在 &lt;code&gt;/Libraries/ReactNative/&lt;/code&gt; 目录下，如 App 启动模块 &lt;code&gt;AppRegistery&lt;/code&gt; ，对 Java 环境来说，作用是提供操作 JS 环境的 API，如回调，广播等。Java 的调用方法是通过 JS 暴露出来的 &lt;code&gt;callFunctionReturnFlushedQueue&lt;/code&gt; API。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;JS 环境中会维护一份所有 Native 模块的 moduleID 和 methodID 的映射 &lt;code&gt;NativeModules&lt;/code&gt;，用来调用 Native 模块的时候查找对应 ID；Java 环境中也会维护一份 JavaScript 模块的映射 &lt;code&gt;JSModuleRegistry&lt;/code&gt;，用来调用 JS 代码。而在实际的代码中，Native 模块和 JS 模块的通信需要通过中间层也就是 C++ 层的过渡，也就是说 Native 模块和 JS 模块实际上都只是在和 C++ 模块进行通信。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;C++ 和 JS 通信&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面提到，JSCore 可以让 C++ 拿到 JS 运行环境的 global 对象并能操作它的属性，而 JS 代码会在 global 对象中注入一些原生模块需要的 API，这是 JS 向 C++ 提供操作 API 的主要方式。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;RN 环境中 JS 会在 global 对象中设置了 &lt;code&gt;__fbBatchedBridge&lt;/code&gt; 变量，并在变量塞入了 4 个的 API，作为 JS 被调用的入口，主要 API 包括：&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;callFunctionReturnFlushedQueue // 让 C++ 调用 JS 模块&lt;br/&gt;invokeCallbackAndReturnFlushedQueue // 让 C++ 调用 JS 回调&lt;br/&gt;flushedQueue // 清空 JS 任务队列&lt;br/&gt;callFunctionReturnResultAndFlushedQueue // 让 C++ 调用 JS 模块并返回结果&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;JS 还在 global 中还设置了 &lt;code&gt;__fbGenNativeModule&lt;/code&gt; 方法，用来给 C++ 调用后在 JS 环境生成 Java 模块的映射对象，也就是 &lt;code&gt;NativeModules&lt;/code&gt; 模块。它的数据结构类似于（跟实际的数据结构有偏差）：&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;{&lt;br/&gt;    &quot;Timing&quot;: {&lt;br/&gt;        &quot;moduleID&quot;: &quot;1001&quot;,&lt;br/&gt;        &quot;method&quot;: {&lt;br/&gt;            &quot;createTimer&quot;: {&lt;br/&gt;                &quot;methodID&quot;: &quot;10001&quot;&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;通过 &lt;code&gt;NativeModules&lt;/code&gt; 的映射，开发者能拿到调用模块和方法的 &lt;code&gt;moduleID&lt;/code&gt; 和 &lt;code&gt;methodID&lt;/code&gt; ，在调用过程中会映射到具体的 Native 的方法。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;同样的，C++ 通过 JSCore 的 &lt;code&gt;JSObjectSetProperty&lt;/code&gt; 方法在 global 对象中塞入了几个 Native API，让 JS 能通过它们来调用 C++ 模块。主要 API 有：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;nativeFlushQueueImmediate // 立即清空 JS 任务队列&lt;br/&gt;nativeCallSyncHook // 同步调用 Native 方法&lt;br/&gt;nativeRequire  // 加载 Native 模块&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;上面介绍 API 的时候，有多个 API 的功能比较类似，就是清空 JS 的任务队列，那是因为 JS 在调用 Native 模块是异步调用，它会把调用参数包装成一个调用任务放入 JS 任务队列 &lt;code&gt;MessageQueue&lt;/code&gt; 中，然后等待 Native 的调用。调用时机一般是在触发事件的时候，事件会触发 Native 回调 JS 的回调函数，Native 模块需要通过 &lt;code&gt;__fbBatchedBridge&lt;/code&gt; 的四个 API 回调 JS 代码，而这四个 API，都有 &lt;code&gt;flushedQueue&lt;/code&gt; 功能：清空任务队列并执行所有的任务，借此来消费队列中的 Native 调用任务。但是如果某一次调用距离上一次的 &lt;code&gt;flushedQueue&lt;/code&gt; 行为有点久（一般是大于 5 ms），就会触发立即调用的逻辑，JS 调用 &lt;code&gt;nativeFlushQueueImmediate&lt;/code&gt; API，主动触发任务消费。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;平台（Java）和 C++ 的通信&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Java 跟 C++ 的互相调用通过 JNI（Java Native Interface），通过 JNI，C++ 层会暴露出来一些 API 来给 Java 层调用，来让 Java 能跟 JS 层进行通信。下面是 C++ 通过 JNI 暴露给 Java 的一些方法：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;initializeBridge // 初始化：C++ 从 Java 拿到 Native 模块，作为参数传给 JS 生成 NativeModules&lt;br/&gt;jniLoadScriptFromFile // 加载 JS 文件&lt;br/&gt;jniCallJSFunction // 调用 JS 模块&lt;br/&gt;jniCallJSCallback// 调用 JS 回调&lt;br/&gt;setGlobalVariable // 编辑 global 变量&lt;br/&gt;getJavaScriptContext // 获取 JS 运行环境&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;由上面的 API 基本可以判断出，C++ 负责的是一些中间层的角色，有 JS 的加载，解析的工作，还有提供操作 JS 运行环境的 API；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;这里操作 JS 的 API 都会走到上一节 &lt;code&gt;__fbBatchedBridge&lt;/code&gt; 的四个 API 上，如 &lt;code&gt;jniCallJSFunction&lt;/code&gt; 会调用 &lt;code&gt;callFunctionReturnFlushedQueue&lt;/code&gt;。&lt;code&gt;jniCallJSCallback&lt;/code&gt; 会调用 &lt;code&gt;invokeCallbackAndReturnFlushedQueue&lt;/code&gt;。由此，三个模块的调用链路就连接了起来。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;调用示例&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以 RN 中的 setTimeout 方法为例，走一遍调用流程。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4533799533799534&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7Dxv2HJTj0Vc55tTgEuNhEBt5OicLicBELQXFbsl0WsnQPaqyicBHgBJ7DQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1716&quot;/&gt;&lt;figcaption&gt;RN setTimeout 初始化&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Timing Class：Native 中的延时调用的实现类，被 @reactModule 装饰器描述为一个 Native 模块，在 RN 初始化的时候被放入 ModuleRegistry 映射表，用于后面的调用映射。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;ModuleRegistry 映射表构造完成后，调用 C++ 的 initializeBridge ，把 ModuleRegistry 的模块通过 __fbGenNativeModule 函数注册进 JS 环境。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;JS 代码中的 JSTimer 类 引用 Timing 模块的 createTimer 来实现 setTimeout，延迟执行函数。&lt;/p&gt;&lt;pre&gt;&lt;code&gt; // 源代码位置:/Libraries/Core/Timers/JSTimers.js&lt;br/&gt; const {Timing} = require(&#x27;../../BatchedBridge/NativeModules&#x27;);&lt;br/&gt;&lt;br/&gt; function setTimeout(func: Function, duration: number, ...args: any): number {&lt;br/&gt;    // 创建回调函数&lt;br/&gt;    const id = _allocateCallback(&lt;br/&gt;        () =&amp;gt; func.apply(undefined, args),&lt;br/&gt;        &#x27;setTimeout&#x27;,&lt;br/&gt;    );&lt;br/&gt;    Timing.createTimer(id, duration || 0, Date.now(), /* recurring */ false);&lt;br/&gt;    return id;&lt;br/&gt;},&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;setTimeout 的调用过程&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.541958041958042&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7Df5afPV4bIU1szhfgj1rW7XmmLtWwIDrEKxfjAQOleiciaNJ03ibniatvFw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1716&quot;/&gt;&lt;figcaption&gt;RN setTimeout 调用&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;当 setTimeout 在 JSTimer.js 被调用，通过 NativeModules 找到 Timing Class 的 moduleID 和 methodID，放进任务队列 &lt;code&gt;MessageQueue&lt;/code&gt; 中；&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Native 通过事件或者主动触发清空 &lt;code&gt;MessageQueue&lt;/code&gt; 队列，C++ 层把 moduleID ，methodID 和其他调用参数交给 &lt;code&gt;ModuleRegistry&lt;/code&gt; ，由它来找到 Native 模块的代码，Timing 类；&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Timing 调用 &lt;code&gt;createTimer&lt;/code&gt; 方法，调用系统计时功能实现延迟调用；&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;计时结束，Timing 类需要回调 JS 函数&lt;/p&gt;&lt;pre&gt;&lt;code&gt;// timerToCall 是回调函数的 ID 数组&lt;br/&gt;getReactApplicationContext().getJSModule(JSTimers.class)&lt;br/&gt;    .callTimers(timerToCall);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;getJSModule&lt;/code&gt; 方法会通过 &lt;code&gt;JSModuleRegistry&lt;/code&gt; 找到需要调用的 JS 模块，并调用对应的方法，该流程中调用 &lt;code&gt;JSTimers&lt;/code&gt; 模块的 &lt;code&gt;callTimers&lt;/code&gt; 方法。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Java 代码通过 JNI 接口 &lt;code&gt;jniCallJSFunction&lt;/code&gt; 通过 C++ 调用 JS 模块，并传入 module：&lt;code&gt;JSTimers&lt;/code&gt; 和 method：&lt;code&gt;callTimers&lt;/code&gt;；&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;C++ 调用 JS 暴露出来的 &lt;code&gt;callFunctionReturnFlushedQueue&lt;/code&gt; API，带上 module 和 method，回到 JS 的调用环境；&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;JS 执行 &lt;code&gt;callFunctionReturnFlushedQueue&lt;/code&gt; 方法找到 RN 初始化阶段注册好的 JSTimer 模块的 &lt;code&gt;callTimers&lt;/code&gt; 函数，进行调用。调用完毕后清空一下任务队列 &lt;code&gt;MessageQueue&lt;/code&gt;。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;RN 的 JSBridge&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上通过 RN 的 setTimeout 函数走了一遍 RN 内 Java 代码和 JS 代码的通信流程。简单来说，Java 模块和 JS 模块可以通过 NativeModules 和 JS 回调函数互相调用，来达成一次跨端调用。但是业务中的 Bridge 需要包含一些额外的场景，比如并发调用，事件监听等。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;并发调用：类似于在 web 端同时发多个请求，为了将请求结果回调到正确的回调函数内，需要保存一个请求到回调函数的映射，在 Bridge 的调用中也是一样的。而这份映射可以维护在 JS 代码中，也可以维护在 Native 代码中，在跨端方案中，两者都可行的情况下一般选择 JS 代码的方案来保持灵活性，Native 只负责处理结果并回调。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;事件监听：比如 JS 代码监听页面是否切换到后台，同一个回调函数在页面多次切换到后台的时候，应该要被调用多次，但是 RN 的 JSCallback 只允许调用一次（每一个 callback 实例会带上是否调用过的标记）， 回调显然不适合这种场景，云音乐的 Bridge 使用 RN 的事件通知：&lt;code&gt;RCTDeviceEventEmitter&lt;/code&gt; 来代替回调。&lt;code&gt;RCTDeviceEventEmitter&lt;/code&gt; 是一个纯 JS 实现的事件订阅分发模块，Native 模块通过 &lt;code&gt;getJSModule&lt;/code&gt; 可以拿到它的方法，因此可以在 Native 端发出一个 JS 事件并带上回调的参数和映射 ID 等，而不用走 JSCallback。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;回到之前的问题：如何实现 RN 的 Bridge，能让一个 Bridge 的 API 同时支持 H5 和 RN 的调用。因为 H5 和 RN 大多数的业务场景都是相同的，比如获取用户信息 user.info，设备信息 device.info 类似的接口，在 H5 和 RN 中都是会用到的。除了跨端调用的协议要保持一致外，具体的实现模块，协议解析模块都是可以复用的。其中不一样的就是调用链路。RN 链路中的主要模块包括：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;给 JS 代码调用的 NativeModule，作为调用入口，JS 代码调用它暴露出来的方法传入调用参数并开始调用流程，但是该模块不解析协议和参数，可以称作 &lt;code&gt;RNRPCNativeModule&lt;/code&gt;;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;在 Native 模块处理完后，&lt;code&gt;RNRPCNativeModule&lt;/code&gt; 使用 &lt;code&gt;RCTDeviceEventEmitter&lt;/code&gt; 生成一个事件回调给 JS 代码，并带上执行结果。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;除了以上两个不一样的模块外，其他模块都是可以复用的，如协议解析和任务分发模块，解析协议的调用模块，方法，参数等，并把它分发给具体的 Native 模块；还有 Native 具体的功能实现模块，都可以保持一致。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结合前面介绍的调用流程，开发者如果调用 &lt;code&gt;User.info&lt;/code&gt; 这个 JSBridge 来获取用户信息，调用流程如下：&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5825426944971537&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KV8By3euEQjMibqBxMX8OAyOzKCT0KW7DWAzEbXE3JNUD5uhKZb2bh9805xMytOqwicicSCW1LsXhgoLyxFRypqEw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2108&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这样的处理，能保证 H5 和 RN 能用同一份 moduleID 和 methodID 来调用 Native 的功能，而且保证在同一个模块进行处理。从开发者的角度来看，就是一个 Bridge 的 API 可以同时支持 H5 和 RN 的调用。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;相关资料&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;React Native 源代码&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;React Native 原生模块和 JS 模块交互&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;Handler 与 Looper，MessageQueue 的关系&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;React Native 通信机制详解&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;React Native 源码解析&lt;/span&gt;&lt;sup&gt;[5]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;How React Native constructs app layouts&lt;/span&gt;&lt;sup&gt;[6]&lt;/sup&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;参考资料&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;React Native 源代码: &lt;em&gt;https://github.com/facebook/react-native&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;React Native 原生模块和 JS 模块交互: &lt;em&gt;https://danke77.github.io/2016/12/07/react-native-native-modules-android/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;Handler 与 Looper，MessageQueue 的关系: &lt;em&gt;https://www.cnblogs.com/fuly550871915/p/4889838.html&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;React Native 通信机制详解: &lt;em&gt;http://blog.cnbang.net/tech/2698/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[5]&lt;/span&gt;&lt;p&gt;React Native 源码解析: &lt;em&gt;https://github.com/sucese/react-native/tree/master/doc/ReactNative%E6%BA%90%E7%A0%81%E7%AF%87&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[6]&lt;/span&gt;&lt;p&gt;How React Native constructs app layouts: &lt;em&gt;https://www.freecodecamp.org/news/how-react-native-constructs-app-layouts-and-how-fabric-is-about-to-change-it-dd4cb510d055/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>