<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>be16f0765aab6d3537e62aa94b4c6ed2</guid>
<title>打日志还能打出个线上 Bug，太难了</title>
<link>https://toutiao.io/k/9p8zgng</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;某日中午，收到告警，有一笔订单下单失败了。赶紧去 Cat 看了下错误信息，如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.19803063457330417&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39xviap51u0HOlEibxddgwK2gmPqbTt7zNicicgLdznlOBrIwPiaErl1JZJxS05U3DJOZzh1s6Ee5HdLzTQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1828&quot;/&gt;&lt;figcaption&gt;异常信息&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Web 应用调用订单服务的 RPC 接口报错了，一看错误很自主的认为这是一个序列化的问题。后面排查下来发现压根就不是，这个错误报的有点。。。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;想着是不是参数中有什么特别的东西，然后发现也没有什么特别的。这个错误是某个商品下单才会出现，不是所有的商品都会出现这个问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后尝试在本地复现，有这么一行关键的代码，贴了一部分，完整的作用是埋点打日志。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;String.format(&quot;UnifiedOrderServiceImpl.makeOrder创建订单, make order, request: MakeOrderRequest= &quot;+ request)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说实话我是没看懂这里用 String.format 的原因在哪里，不就是想拼接个字符串么？还搞个 format，搞就搞嘛，还没用占位符，骚操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;真正 Bug 的原因是 request 对象中有个 String 类型的字段，字段里面的内容有%\，format 内部就报错了，大家可以用下面这段代码复现错误：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;public static void main(String[] args) {&lt;br/&gt;   String.format(&quot;dsdsdsd&quot;+&quot;%\\sdsd&quot;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;错误信息：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;Exception in thread &quot;main&quot; java.util.UnknownFormatConversionException: Conversion = &#x27;\&#x27;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;原因是在 format 中会校验参数，然后触发了异常。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2554858934169279&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39xviap51u0HOlEibxddgwK2gmtuYmmicp2ao1Yj2gyoXzurQ1OZB23ic2iasFkxQ5QMIxsKrDwoWUWckWQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1276&quot;/&gt;&lt;figcaption&gt;判断文本内容&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虽然是很小的改动，就记录个日志而已，但也不要轻视，往往就是不够仔细，然后才会出这种问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;总结：&lt;/p&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;关于作者&lt;/strong&gt;：尹吉欢，简单的技术爱好者，《Spring Cloud 微服务-全栈技术与案例解析》, 《Spring Cloud 微服务 入门 实战与进阶》作者, 公众号&lt;strong&gt;猿天地&lt;/strong&gt;发起人。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我整理了一份很全的学习资料，感兴趣的可以微信搜索「&lt;strong&gt;猿天地&lt;/strong&gt;」，回复关键字 「&lt;strong&gt;学习资料&lt;/strong&gt;」获取我整理好了的 Spring Cloud，Spring Cloud Alibaba，Sharding-JDBC 分库分表，任务调度框架 XXL-JOB，MongoDB，爬虫等相关资料。&lt;/p&gt;&lt;p&gt;后台回复 &lt;strong&gt;&lt;span&gt;学习资料&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt; &lt;/strong&gt;领取学习视频&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.511002444987775&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39zWmaics1nAAwT4NCD77uDcf6vcXE1DAHybibTY0V3XDmf4YX1q9qYibIwz9xmRVTkEvTjP87gaKEZrQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;818&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如有收获，点个在看，诚挚感谢&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;&gt;我不差钱啊&lt;/p&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>e5983bb4b338a6d5971c9f888bf95985</guid>
<title>啥，听说你用了 Spring Boot，但是开发的接口还在裸奔？</title>
<link>https://toutiao.io/k/gtkn1lp</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;file_content markdown-body&quot;&gt;
&lt;h1&gt;
&lt;a id=&quot;popular-mvc框架&quot; class=&quot;anchor&quot; href=&quot;#popular-mvc%E6%A1%86%E6%9E%B6&quot;/&gt;Popular MVC框架&lt;/h1&gt;
&lt;h1&gt;
&lt;a id=&quot;传送门&quot; class=&quot;anchor&quot; href=&quot;#%E4%BC%A0%E9%80%81%E9%97%A8&quot;/&gt;传送门&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://gitee.com/danyuanblog/PopularMVC&quot;&gt;Gitee源码地址：https://gitee.com/danyuanblog/PopularMVC&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.danyuanblog.com:8181/doc.html&quot; rel=&quot;nofollow&quot;&gt;演示地址：http://www.danyuanblog.com:8181/doc.html&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.danyuanblog.com/blog/app/blog/blogDetail.html?id=5fe86eb74c636312f4b70955&quot; rel=&quot;nofollow&quot;&gt;官方文档地址：http://www.danyuanblog.com/blog/app/blog/blogDetail.html?id=5fe86eb74c636312f4b70955&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;
&lt;a id=&quot;1应用场景&quot; class=&quot;anchor&quot; href=&quot;#1%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF&quot;/&gt;1、应用场景&lt;/h1&gt;
&lt;h2&gt;
&lt;a id=&quot;简介&quot; class=&quot;anchor&quot; href=&quot;#%E7%AE%80%E4%BB%8B&quot;/&gt;简介&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;啥，听说你用了springboot，但是开发的接口还在裸奔？快来试试这个PopularMVC吧，它也许是你想要找的神器！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;神器亮相&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;springboot叫一键启动，popularmvc为你的springboot项目插上翅膀，力求一键起飞！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/logo.jpg&quot; alt=&quot;popularmvc logo&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;
&lt;a id=&quot;11-项目架构说明&quot; class=&quot;anchor&quot; href=&quot;#11-%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E8%AF%B4%E6%98%8E&quot;/&gt;1.1 项目架构说明&lt;/h2&gt;
&lt;h3&gt;
&lt;a id=&quot;111-popularmvc跟springboot的关系&quot; class=&quot;anchor&quot; href=&quot;#111-popularmvc%E8%B7%9Fspringboot%E7%9A%84%E5%85%B3%E7%B3%BB&quot;/&gt;1.1.1 PopularMVC跟Springboot的关系&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;说明&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PopularMVC是基于springboot开发的，自然强依赖于springboot和springmvc&lt;/li&gt;
&lt;li&gt;PopularMVC在springboot提供的能力之上，为开发者编写API接口提供了很多额外的便利性&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;示意图&lt;/p&gt;

&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;
&lt;a id=&quot;112-popularmvc项目组件架构解析&quot; class=&quot;anchor&quot; href=&quot;#112-popularmvc%E9%A1%B9%E7%9B%AE%E7%BB%84%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90&quot;/&gt;1.1.2 PopularMVC项目组件架构解析&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;架构图&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/PopularMVC%E5%86%85%E9%83%A8%E7%BB%84%E4%BB%B6%E6%9E%B6%E6%9E%84%E5%9B%BE.jpg&quot; alt=&quot;PopularMVC内部组件架构图&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;组件介绍&lt;/p&gt;
&lt;p&gt;主要分为以下几类组件&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;API调用拦截器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;基于AOP切面设计的一套API请求、响应拦截处理流程。提供了在调用接口前后做一些通用的预处理，比如说参数校验、参数装饰、访问控制、日志输出、会话控制等等。目前内置的拦截器有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统参数校验器&lt;/li&gt;
&lt;li&gt;请求参数校验器&lt;/li&gt;
&lt;li&gt;数字签名请求验签器、响应加签器&lt;/li&gt;
&lt;li&gt;接口防重复提交控制器&lt;/li&gt;
&lt;li&gt;接口用户会话控制器&lt;/li&gt;
&lt;li&gt;接口日志打印器&lt;/li&gt;
&lt;li&gt;接口访问控制器&lt;/li&gt;
&lt;li&gt;请求、响应内容装饰器&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也支持业务灵活定制通用的API调用拦截器。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;参数装饰器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;参数装饰器机制通过遍历参数内容，逐个字段进行修饰，具体修饰规则由特定的装饰器制定。常见的使用场景有，对请求参数解密、响应参数加密、响应参数国际化、响应参数脱敏等等&lt;/p&gt;
&lt;p&gt;注意：参数装饰器只能对参数内容做修饰，而无法改变参数类型。&lt;/p&gt;
&lt;p&gt;目前内置的参数装饰器有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;请求参数解密器&lt;/li&gt;
&lt;li&gt;响应参数加密器&lt;/li&gt;
&lt;li&gt;系统参数自动填充器&lt;/li&gt;
&lt;li&gt;响应参数国际化翻译器&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也支持业务灵活拓展参数装饰器。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;API响应序列化预处理器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;响应预处理器机制可以在接口返回内容给调用者之前进行额外的处理，此时可以更灵活的修饰返回内容，可以突破无法修改参数类型的限制，适用于对整个响应结构定制化处理的场景。&lt;/p&gt;
&lt;p&gt;目前内置的响应预处理器有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;API响应自动包装预处理器&lt;/li&gt;
&lt;li&gt;API响应错误码和系统参数定制化转换器&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当然，也支持业务灵活拓展。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;方法查询缓存拦截器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;提供对查询类方法调用的结果进行缓存。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;API异常统一处理器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;接口调用过程中任何步骤出现异常，均能自动处理，并反馈信息给调用者。&lt;/p&gt;
&lt;p&gt;支持对特定异常自定义处理，如果未处理，统一交由内置的默认异常处理器进行护理。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;统一国际化翻译管理器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;接口返回内容均支持国际化翻译能力。&lt;/p&gt;
&lt;p&gt;已整合了spring i18n国际化翻译能力，也支持拓展业务自定义国际化翻译器。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;统一错误码管理器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;研发人员无需再关注业务错误码的定义和国际化翻译工作，可以做到定义简单、使用简单、易于理解、配置灵活&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;支持自定义系统错误码、业务错误码&lt;/li&gt;
&lt;li&gt;支持业务错误码自动生成&lt;/li&gt;
&lt;li&gt;支持业务错误码以异常的方式抛出，系统自动处理&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;自动接口文档生成器&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;已内置swagger+knif4j，只需指定API包路径即可实现接口文档的自动生成。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;
&lt;a id=&quot;12-其他说明&quot; class=&quot;anchor&quot; href=&quot;#12-%E5%85%B6%E4%BB%96%E8%AF%B4%E6%98%8E&quot;/&gt;1.2 其他说明&lt;/h2&gt;

&lt;h1&gt;
&lt;a id=&quot;2项目模块&quot; class=&quot;anchor&quot; href=&quot;#2%E9%A1%B9%E7%9B%AE%E6%A8%A1%E5%9D%97&quot;/&gt;2、项目模块&lt;/h1&gt;

&lt;h1&gt;
&lt;a id=&quot;3入门demo&quot; class=&quot;anchor&quot; href=&quot;#3%E5%85%A5%E9%97%A8demo&quot;/&gt;3、入门demo&lt;/h1&gt;
&lt;h2&gt;
&lt;a id=&quot;31-项目结构&quot; class=&quot;anchor&quot; href=&quot;#31-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84&quot;/&gt;3.1 项目结构&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;项目结构&lt;/p&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;├─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;├─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;com&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;      &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;danyuanblog&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC6&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;          &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;framework&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC7&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;              &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;demo&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC8&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                  &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popularmvc&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC9&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                      &lt;span class=&quot;err&quot;&gt;├─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;controller&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC10&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                      &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;      &lt;/span&gt;
&lt;span id=&quot;LC11&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                      &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;TestController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;java&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC12&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                      &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;          &lt;/span&gt;
&lt;span id=&quot;LC13&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                      &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;startup&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC14&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                              &lt;span class=&quot;no&quot;&gt;StartDemoApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#项目启动类&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC15&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                              &lt;/span&gt;
&lt;span id=&quot;LC16&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;     &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resources&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC17&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;         &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yml&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#项目配置信息，可省略&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC18&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;         &lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;  &lt;/span&gt;
&lt;span id=&quot;LC19&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;         &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i18n&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#自定义国际化支持，可省略&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC20&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;             &lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;messages&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#项目自定义国际化翻译信息&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC21&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                     &lt;span class=&quot;n&quot;&gt;messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;properties&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC22&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                     &lt;span class=&quot;n&quot;&gt;messages_en_US&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;properties&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC23&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                     &lt;span class=&quot;n&quot;&gt;messages_zh_CN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;properties&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC24&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;│&lt;/span&gt;                     &lt;span class=&quot;c1&quot;&gt;#还可添加其他国际化翻译内容&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC25&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;err&quot;&gt;└─&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;pom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;xml&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;引入模块依赖，在&lt;code&gt;pom.xml&lt;/code&gt;添加&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.danyuanblog.framework&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;popular-web-mvc&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${popular-web-mvc.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2&gt;
&lt;a id=&quot;32-启用popularmvc框架&quot; class=&quot;anchor&quot; href=&quot;#32-%E5%90%AF%E7%94%A8popularmvc%E6%A1%86%E6%9E%B6&quot;/&gt;3.2 启用PopularMvc框架&lt;/h2&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* Title StartDemoApplication.java  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* Description  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @author danyuan&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @date Oct 31, 2020&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC6&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @version 1.0.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC7&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* site: www.danyuanblog.com&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC8&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;*/&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;LC9&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.danyuanblog.framework.demo.popularmvc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC10&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC11&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.boot.SpringApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC12&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.boot.autoconfigure.SpringBootApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC13&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.danyuanblog.framework.popularmvc.annotation.EnablePopularMvc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC14&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC15&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@SpringBootApplication&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC16&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@EnablePopularMvc&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC17&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StartDemoApplication&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC18&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC19&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC20&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nc&quot;&gt;SpringApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;StartDemoApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC21&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC22&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC23&quot; class=&quot;line&quot;/&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2&gt;
&lt;a id=&quot;33-测试接口代码示例&quot; class=&quot;anchor&quot; href=&quot;#33-%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B&quot;/&gt;3.3 测试接口代码示例&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;代码如下，&lt;code&gt;TestController.java&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* Title TestController.java  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* Description  &lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @author danyuan&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @date Dec 27, 2020&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC6&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* @version 1.0.0&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC7&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;* site: www.danyuanblog.com&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC8&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;*/&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;LC9&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.danyuanblog.framework.demo.popularmvc.controller&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC10&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC11&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC12&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC13&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC14&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.validation.Valid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC15&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.validation.constraints.NotBlank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC16&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.validation.constraints.NotEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC17&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.validation.constraints.Size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC18&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC19&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.validation.annotation.Validated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC20&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.web.bind.annotation.GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC21&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.web.bind.annotation.PostMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC22&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.web.bind.annotation.RequestParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC23&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.web.bind.annotation.RestController&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC24&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC25&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.danyuanblog.framework.popularmvc.exception.BusinessException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC26&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC27&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC28&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@Validated&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC29&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TestController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC30&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC31&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC32&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; * 参数自动校验、响应内容自动包装功能示例&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC33&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; * @author danyuan&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC34&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC35&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@GetMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;queryUserInfo&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC36&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;queryUserInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@Valid&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@NotBlank&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC37&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC38&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;查询用户[&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;]的信息!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC39&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC40&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//TODO: 执行业务逻辑&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC41&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC42&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//mock数据&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC43&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC44&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC45&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC46&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;sex&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;男&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC47&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;desc&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;阳光乐观外向，喜欢唱歌、打篮球！&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC48&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC49&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//返回数据&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC50&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userInfos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC51&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC52&quot; class=&quot;line&quot;/&gt;
&lt;span id=&quot;LC53&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC54&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; * 业务异常的使用示例&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC55&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; * @author danyuan&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC56&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC57&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@PostMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;user/regist&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC58&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;userRegist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@Valid&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@NotEmpty&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;/span&gt;
&lt;span id=&quot;LC59&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;nd&quot;&gt;@Valid&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@NotEmpty&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC60&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//TODO: 执行业务逻辑，发现账号已存在，直接通过抛出异常的方式提示用户&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC61&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;BusinessException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;用户名[{0}]已存在，请更换!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC62&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC63&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;
&lt;a id=&quot;34-测试接口结果&quot; class=&quot;anchor&quot; href=&quot;#34-%E6%B5%8B%E8%AF%95%E6%8E%A5%E5%8F%A3%E7%BB%93%E6%9E%9C&quot;/&gt;3.4 测试接口结果&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;接口文档访问地址：&lt;a href=&quot;http://localhost:8080/doc.html&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8080/doc.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3%E9%A6%96%E9%A1%B5.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;
&lt;a id=&quot;341-测试参数校验&quot; class=&quot;anchor&quot; href=&quot;#341-%E6%B5%8B%E8%AF%95%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C&quot;/&gt;3.4.1 测试参数校验&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;请求参数&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C_%E8%AF%B7%E6%B1%821.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C_%E8%AF%B7%E6%B1%822.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;结果&lt;/p&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;msg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[参数异常]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#错误信息概览&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;120002&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#系统错误码&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;subErrors&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC6&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC7&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;javax.validation.constraints.Size.message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#业务错误码&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC8&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;msg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[queryUserInfo.username]个数必须在6和20之间&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#详细错误信息&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC9&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC10&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC11&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC12&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;
&lt;a id=&quot;342-测试正常响应信息返回&quot; class=&quot;anchor&quot; href=&quot;#342-%E6%B5%8B%E8%AF%95%E6%AD%A3%E5%B8%B8%E5%93%8D%E5%BA%94%E4%BF%A1%E6%81%AF%E8%BF%94%E5%9B%9E&quot;/&gt;3.4.2 测试正常响应信息返回&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;请求参数&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E6%AD%A3%E5%B8%B8%E5%93%8D%E5%BA%94%E4%BF%A1%E6%81%AF%E8%BF%94%E5%9B%9E_%E8%AF%B7%E6%B1%82.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;结果
&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E6%AD%A3%E5%B8%B8%E5%93%8D%E5%BA%94%E4%BF%A1%E6%81%AF%E8%BF%94%E5%9B%9E_%E7%BB%93%E6%9E%9C.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;sex&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;男&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC5&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC6&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Jone Lacy&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC7&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;desc&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;阳光乐观外向，喜欢唱歌、打篮球！&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC8&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC9&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;
&lt;a id=&quot;343-测试业务异常的使用&quot; class=&quot;anchor&quot; href=&quot;#343-%E6%B5%8B%E8%AF%95%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%9A%84%E4%BD%BF%E7%94%A8&quot;/&gt;3.4.3 测试业务异常的使用&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;请求参数&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%9A%84%E4%BD%BF%E7%94%A8_%E8%AF%B7%E6%B1%82.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;结果&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/get-start-demo/%E6%B5%8B%E8%AF%95%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%9A%84%E4%BD%BF%E7%94%A8_%E5%93%8D%E5%BA%94.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;white&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span id=&quot;LC1&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC2&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;msg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;用户名[test]已存在，请更换!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC3&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200000&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;LC4&quot; class=&quot;line&quot;&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;
&lt;a id=&quot;35-更多功能示例&quot; class=&quot;anchor&quot; href=&quot;#35-%E6%9B%B4%E5%A4%9A%E5%8A%9F%E8%83%BD%E7%A4%BA%E4%BE%8B&quot;/&gt;3.5 更多功能示例&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;系统内置接口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E7%B3%BB%E7%BB%9F%E5%86%85%E7%BD%AE%E6%8E%A5%E5%8F%A3.png&quot; alt=&quot;系统内置接口&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;业务系统接口&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E4%B8%9A%E5%8A%A1%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3.png&quot; alt=&quot;业务系统接口&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接口文档示例&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3%E7%A4%BA%E4%BE%8B.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接口测试示例&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;接口参数校验失败测试结果示例&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E5%BC%82%E5%B8%B8%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png&quot; alt=&quot;接口参数校验失败测试结果&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接口访问成功结果示例&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E6%8E%A5%E5%8F%A3%E6%AD%A3%E5%B8%B8%E5%93%8D%E5%BA%94%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png&quot; alt=&quot;接口正常响应测试结果&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;国际化接口访问示例（英文）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E5%9B%BD%E9%99%85%E5%8C%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0_en_US.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E5%9B%BD%E9%99%85%E5%8C%96%E7%BF%BB%E8%AF%91%E5%93%8D%E5%BA%94%E4%BF%A1%E6%81%AF_en_US.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;国际化接口访问示例（中文）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E5%9B%BD%E9%99%85%E5%8C%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0_zh_CN.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/danyuanblog/PopularMVC/raw/master/doc/imgs/%E5%9B%BD%E9%99%85%E5%8C%96%E7%BF%BB%E8%AF%91%E5%93%8D%E5%BA%94%E4%BF%A1%E6%81%AF_zh_CN.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;
&lt;a id=&quot;4更多特性介绍与使用示例&quot; class=&quot;anchor&quot; href=&quot;#4%E6%9B%B4%E5%A4%9A%E7%89%B9%E6%80%A7%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B&quot;/&gt;4、更多特性介绍与使用示例&lt;/h1&gt;
&lt;h2&gt;
&lt;a id=&quot;41-参数校验示例&quot; class=&quot;anchor&quot; href=&quot;#41-%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E7%A4%BA%E4%BE%8B&quot;/&gt;4.1 参数校验示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;42-自动填充api响应参数示例&quot; class=&quot;anchor&quot; href=&quot;#42-%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85api%E5%93%8D%E5%BA%94%E5%8F%82%E6%95%B0%E7%A4%BA%E4%BE%8B&quot;/&gt;4.2 自动填充API响应参数示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;43-业务错误码使用示例&quot; class=&quot;anchor&quot; href=&quot;#43-%E4%B8%9A%E5%8A%A1%E9%94%99%E8%AF%AF%E7%A0%81%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B&quot;/&gt;4.3 业务错误码使用示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;44-接口响应国际化翻译示例&quot; class=&quot;anchor&quot; href=&quot;#44-%E6%8E%A5%E5%8F%A3%E5%93%8D%E5%BA%94%E5%9B%BD%E9%99%85%E5%8C%96%E7%BF%BB%E8%AF%91%E7%A4%BA%E4%BE%8B&quot;/&gt;4.4 接口响应国际化翻译示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;45-使用数字签名示例&quot; class=&quot;anchor&quot; href=&quot;#45-%E4%BD%BF%E7%94%A8%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%A4%BA%E4%BE%8B&quot;/&gt;4.5 使用数字签名示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;46-接口数据加解密示例&quot; class=&quot;anchor&quot; href=&quot;#46-%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%A4%BA%E4%BE%8B&quot;/&gt;4.6 接口数据加解密示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;47-接口防重复提交功能示例&quot; class=&quot;anchor&quot; href=&quot;#47-%E6%8E%A5%E5%8F%A3%E9%98%B2%E9%87%8D%E5%A4%8D%E6%8F%90%E4%BA%A4%E5%8A%9F%E8%83%BD%E7%A4%BA%E4%BE%8B&quot;/&gt;4.7 接口防重复提交功能示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;48-接口查询缓存使用示例&quot; class=&quot;anchor&quot; href=&quot;#48-%E6%8E%A5%E5%8F%A3%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B&quot;/&gt;4.8 接口查询缓存使用示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;49-接口用户会话功能使用示例&quot; class=&quot;anchor&quot; href=&quot;#49-%E6%8E%A5%E5%8F%A3%E7%94%A8%E6%88%B7%E4%BC%9A%E8%AF%9D%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B&quot;/&gt;4.9 接口用户会话功能使用示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;
&lt;a id=&quot;410-静态资源使用示例&quot; class=&quot;anchor&quot; href=&quot;#410-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B&quot;/&gt;4.10 静态资源使用示例&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;/danyuanblog/PopularMVC/blob/master/doc/MORE.md&quot;&gt;请参考使用示例&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;
&lt;a id=&quot;5业务定制化&quot; class=&quot;anchor&quot; href=&quot;#5%E4%B8%9A%E5%8A%A1%E5%AE%9A%E5%88%B6%E5%8C%96&quot;/&gt;5、业务定制化&lt;/h1&gt;
&lt;h2&gt;
&lt;a id=&quot;51-配置定制化&quot; class=&quot;anchor&quot; href=&quot;#51-%E9%85%8D%E7%BD%AE%E5%AE%9A%E5%88%B6%E5%8C%96&quot;/&gt;5.1 配置定制化&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;接口文档个性化&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;系统参数定制化&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统公共请求参数名自定义&lt;/li&gt;
&lt;li&gt;添加额外的系统公共请求参数&lt;/li&gt;
&lt;li&gt;系统公共响应参数名自定义&lt;/li&gt;
&lt;li&gt;添加额外的系统响应参数&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;业务国际化内容&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;可以通过springboot i18n添加或者定制国际化内容&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;
&lt;a id=&quot;52-组件定制化&quot; class=&quot;anchor&quot; href=&quot;#52-%E7%BB%84%E4%BB%B6%E5%AE%9A%E5%88%B6%E5%8C%96&quot;/&gt;5.2 组件定制化&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;PopularMVC提供了灵活定制通用组件的能力。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;内置的几大管理器都可以替换成自定义的管理器，如：
&lt;ul&gt;
&lt;li&gt;缓存管理器&lt;/li&gt;
&lt;li&gt;会话管理器&lt;/li&gt;
&lt;li&gt;国际化管理器&lt;/li&gt;
&lt;li&gt;数字签名管理器&lt;/li&gt;
&lt;li&gt;秘钥管理器&lt;/li&gt;
&lt;li&gt;应用管理器&lt;/li&gt;
&lt;li&gt;接口日志管理器&lt;/li&gt;
&lt;li&gt;接口调用频次控制管理器&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;可以添加自定义接口调用拦截器，实现一些通用业务&lt;/li&gt;
&lt;li&gt;可以添加自定义接口请求、响应参数装饰器，对参数进行加工&lt;/li&gt;
&lt;li&gt;可以添加自定义响应序列化预处理器，根据业务需要定制化返回信息&lt;/li&gt;
&lt;li&gt;可以添加自定义异常处理器，为目标类型的异常做额外的处理&lt;/li&gt;
&lt;li&gt;可以灵活定制和使用自定义的加解密处理器&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h1&gt;
&lt;a id=&quot;6交流与答疑&quot; class=&quot;anchor&quot; href=&quot;#6%E4%BA%A4%E6%B5%81%E4%B8%8E%E7%AD%94%E7%96%91&quot;/&gt;6、交流与答疑&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;​      此项目的设计初衷源于本人在多年API接口开发经验上，从接口规范、开发便捷易用、配置简单这些角度出发而总结出来的一套API解决方案。通过简单引入PopularMVC组件，可以快速搭建一套规范易用的API开发系统。&lt;/p&gt;
&lt;p&gt;​      开源的目的在于，一则希望此项目能帮助更多的研发人员提升API开发质量，提供大量易用的开发套件提升研发人员的开发效率；二则希望更多的人加入到开源中，促进开源项目的成长，然后服务于更多的开发者；其次希望觉得此项目不错的朋友给个Star，分享给更多的朋友，让大家一起进步！&lt;/p&gt;
&lt;p&gt;​      如果在使用此框架的过程中有任何疑问或者好的建议可以通过以下联系方式找到大部队，大家一起交流一起进步！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>ba15e6cb60bb2039971255c887239471</guid>
<title>10 天 5 千 Star！21 岁本科生给程序员开发的十六进制编辑器</title>
<link>https://toutiao.io/k/drrac8o</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;RichText ztext Post-RichText&quot;&gt;&lt;p&gt;【导语】：ImHex 是一款界面美观的十六进制编辑器，主要面向逆向工程师和程序员。如果你喜欢暗黑系编辑器，那它应该是你的菜。&lt;/p&gt;&lt;p&gt;ImHex 最近在 GitHub 上非常火热，上架五天就收获了 2.5k Star，十天 5k Star。&lt;/p&gt;&lt;p&gt;&lt;b&gt;开发者介绍&lt;/b&gt;&lt;/p&gt;&lt;p&gt;ImHex 的开发者是 WerWolv，今年 21 岁，是一个瑞士的电子工程本科大二在读学生。他着迷于嵌入式系统，底层编码，ARM 微控制器开发，操作系统以及主机自制软件和定制固件。&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1129a401c5fa6e5268eb719a39fca84b_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;200&quot; data-rawheight=&quot;240&quot; class=&quot;content_image&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;200&quot; data-rawheight=&quot;240&quot; class=&quot;content_image lazy&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-1129a401c5fa6e5268eb719a39fca84b_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;b&gt;项目地址 + 源码&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/WerWolv/ImHex&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/WerWolv/ImHe&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;示例图&lt;/b&gt;&lt;/p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1ec23f05bc889456bb1d18255e13c0ef_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;572&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic4.zhimg.com/v2-1ec23f05bc889456bb1d18255e13c0ef_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;572&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic4.zhimg.com/v2-1ec23f05bc889456bb1d18255e13c0ef_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-1ec23f05bc889456bb1d18255e13c0ef_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-3d6d693bd6a9dae297123d34785246f0_b.jpg&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;572&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic1.zhimg.com/v2-3d6d693bd6a9dae297123d34785246f0_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; data-caption=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;572&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic1.zhimg.com/v2-3d6d693bd6a9dae297123d34785246f0_r.jpg&quot; data-actualsrc=&quot;https://pic1.zhimg.com/v2-3d6d693bd6a9dae297123d34785246f0_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;b&gt;功能特点&lt;/b&gt;&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;功能性十六进制视图&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;字节&lt;br/&gt; &lt;/li&gt;&lt;li&gt;十六进制字符串&lt;br/&gt; &lt;/li&gt;&lt;li&gt;C, C++, C#, Rust, Python, Java &amp;amp; JavaScript 数组&lt;br/&gt; &lt;/li&gt;&lt;li&gt;ASCII-Art十六进制视图&lt;br/&gt; &lt;/li&gt;&lt;li&gt;HTML 自包含 div&lt;br/&gt; &lt;/li&gt;&lt;li&gt;字节修补&lt;br/&gt; &lt;/li&gt;&lt;li&gt;补丁管理&lt;br/&gt; &lt;/li&gt;&lt;li&gt;字节复制功能&lt;br/&gt; &lt;/li&gt;&lt;li&gt;字符串和16进制查找&lt;br/&gt; &lt;/li&gt;&lt;li&gt;彩色高亮显示&lt;br/&gt; &lt;/li&gt;&lt;li&gt;从开头、尾部以及当前光标位置跳转&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;li&gt;自定义类C++模式的语言，用于解析突出显示文件内容&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;基于 MIME 类型的自动加载&lt;br/&gt; &lt;/li&gt;&lt;li&gt;数组、指针、结构，共用体，枚举，位域，使用声明，大小端支持&lt;br/&gt; &lt;/li&gt;&lt;li&gt;有用的错误信息，语法高亮和错误标记&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p class=&quot;ztext-empty-paragraph&quot;&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;数据导入&lt;br/&gt; &lt;/li&gt;&lt;li&gt;数据导出&lt;br/&gt; &lt;/li&gt;&lt;li&gt;数据检查器允许将数据解析为多种类型（小端和大端）&lt;br/&gt; &lt;/li&gt;&lt;li&gt;支持大文件快速、高校载入&lt;br/&gt; &lt;/li&gt;&lt;li&gt;字符串查找&lt;br/&gt; &lt;/li&gt;&lt;li&gt;支持文件hash&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;支持自定义初始值和多项式的 CRC16 和 CRC32&lt;br/&gt; &lt;/li&gt;&lt;li&gt;MD4, MD5&lt;br/&gt; &lt;/li&gt;&lt;li&gt;SHA-1, SHA-224, SHA-256, SHA-384, SHA-512&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;li&gt;支持多种不同的架构的拆解器&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;ARM32 (ARM, Thumb, Cortex-M, aarch32)&lt;br/&gt; &lt;/li&gt;&lt;li&gt;ARM64&lt;br/&gt; &lt;/li&gt;&lt;li&gt;MIPS (MIPS32, MIPS64, MIPS32R6, Micro)&lt;br/&gt; &lt;/li&gt;&lt;li&gt;x86 (16 位, 32 位, 64 位)&lt;br/&gt; &lt;/li&gt;&lt;li&gt;owerPC (32 bit, 64 bit)&lt;br/&gt; &lt;/li&gt;&lt;li&gt;Sparc&lt;br/&gt; &lt;/li&gt;&lt;li&gt;SystemZ&lt;br/&gt; &lt;/li&gt;&lt;li&gt;XCore&lt;br/&gt; &lt;/li&gt;&lt;li&gt;M68K&lt;br/&gt; &lt;/li&gt;&lt;li&gt;TMS320C64X&lt;br/&gt; &lt;/li&gt;&lt;li&gt;M680X&lt;br/&gt; &lt;/li&gt;&lt;li&gt;Ethereum&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;li&gt;书签&lt;br/&gt; &lt;/li&gt;&lt;li&gt;数据分析&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;基于文件解析器和 MIME 类型的数据库的文件magic&lt;br/&gt; &lt;/li&gt;&lt;li&gt;字节分布图&lt;br/&gt; &lt;/li&gt;&lt;li&gt;熵图&lt;br/&gt; &lt;/li&gt;&lt;li&gt;最大熵和平均熵&lt;br/&gt; &lt;/li&gt;&lt;li&gt;加密 / 压缩文件检测&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;li&gt;帮助工具&lt;br/&gt; &lt;/li&gt;&lt;ul&gt;&lt;li&gt;Itanium 和 MSVC demangler&lt;br/&gt; &lt;/li&gt;&lt;li&gt;ASCII 码表&lt;br/&gt; &lt;/li&gt;&lt;li&gt;正则表达式替换&lt;br/&gt; &lt;/li&gt;&lt;li&gt;数学表达式求值器（计算器）&lt;br/&gt; &lt;/li&gt;&lt;li&gt;十六进制颜色选取器&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;li&gt;模式语言和数学计算内置速查表&lt;br/&gt; &lt;/li&gt;&lt;li&gt;在深夜使用时不会毁掉你的视网膜&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;b&gt;编译&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;你的编译工具要兼容 C ++ 20，比如GCC 10.2.0。更重要的是，要想编译ImHex，你还需要下列的依赖：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;GLFW3&lt;br/&gt; &lt;/li&gt;&lt;li&gt;libmagic, libgnurx, libtre, libintl, libiconv&lt;br/&gt; &lt;/li&gt;&lt;li&gt;libcrypto&lt;br/&gt; &lt;/li&gt;&lt;li&gt;capstone&lt;br/&gt; &lt;/li&gt;&lt;li&gt;libLLVMDemangle&lt;br/&gt; &lt;/li&gt;&lt;li&gt;nlohmann json&lt;br/&gt; &lt;/li&gt;&lt;li&gt;Python 3&lt;br/&gt; &lt;/li&gt;&lt;/ul&gt;&lt;p&gt;以上所有的依赖安装脚本，可以在下面的链接中找到，主要支持 Arch Linux、Fedora、 Debian/Ubuntu 和、或 MSYS2 ： &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/WerWolv/ImHex/blob/master/dist&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/WerWolv/ImHe&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;x/blob/master/dist&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;安装完以上的依赖后，执行如下命令，构建ImHex：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;mkdir build  
cd build  
cmake ..  
make -j  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在 macOS 下构建 ImHex，可使用下面的命令：&lt;/p&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;brew bundle --no-lock --file dist/Brewfile  
mkdir build  
cd build  
CC=$(brew --prefix llvm)/bin/clang CXX=$(brew --prefix llvm)/bin/clang++ PKG_CONFIG_PATH=&quot;$(brew --prefix openssl)/lib/pkgconfig&quot;:&quot;$(brew --prefix)/lib/pkgconfig&quot; cmake ..  
make -j  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;喜欢的朋友，可以试一下。&lt;/p&gt;&lt;p&gt;- EOF -&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>dc00ded59ead3e8d5d59a6d49e7ff30b</guid>
<title>广告系统架构解密</title>
<link>https://toutiao.io/k/3ydgnwy</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;p class=&quot;original_area_primary&quot;&gt;
                                                                                                &lt;/p&gt;

                    
                                            &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3NTIwOTYxMw==&amp;amp;mid=2447527693&amp;amp;idx=1&amp;amp;sn=d3814222ed9f57edd44883b9f7074f1f&amp;amp;chksm=8b62e1efbc1568f9e8350118d88b713c961dc8f700190062abc6e43f421c00139cd4dd1409f6&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;博客园 x 丝芙兰 , build 更美的你&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;博客园 x 丝芙兰 , build 更美的你&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;&lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;img data-ratio=&quot;0.563725471496582&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/AaabKZjib2kbg4zuIEDFjUSR9O7Q7ZVMXmdjb8ib6icBL8BfbK2WdIswiaDib85gSMweYBNqficFE0WdpqDkM3TEdqNA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;408&quot; data-backw=&quot;578&quot; data-backh=&quot;325&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;广告、增值服务、佣金，是互联网企业最常见的三种盈利手段。在这3大经典中，又以广告所占的市场份额最大，几乎是绝大部分互联网平台最主要的营收途径，业务的重要性不言而喻。&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;从技术角度来说，广告业务涉及到 &lt;/span&gt;&lt;span&gt;AI算法、大数据处理、检索引擎、高性能和高可用的工程架构 &lt;/span&gt;&lt;span&gt;等多个方向，同样有着不错的技术吸引力。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我从去年开始接触广告业务，到现在差不多一年时间了。这篇文章将结合我的个人经验，同时参考业界的优秀案例，阐述下广告系统的&lt;span&gt;架构&lt;/span&gt;实践方案，希望让大家有所收获。&lt;/span&gt;&lt;span&gt;内容包括以下3部分&lt;/span&gt;&lt;span&gt;：&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;01 广告业务简介&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;广告，&lt;span&gt;可以说无处不在。&lt;/span&gt;微信、&lt;span&gt;抖&lt;/span&gt;&lt;span&gt;音&lt;/span&gt;、B站、&lt;span&gt;百度、&lt;/span&gt;淘宝等等&lt;span&gt;，这些占据用户时间最长的 APP， 到处都能看到广告的影子。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;我们每天随处可见的广告，它背后的业务逻辑到底是什么样的呢？&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;在分享广告系统的架构之前，先给大家&lt;span&gt;快速&lt;/span&gt;普及下业务知识。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;1. 广告业务的核心点是平衡&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为什么说广告业务的核心点是&lt;span&gt;「&lt;/span&gt;&lt;/span&gt;&lt;span&gt;平衡&lt;/span&gt;&lt;span&gt;&lt;span&gt;」&lt;/span&gt;？可以从广告的标准定义来理解。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;广告被定义为：&lt;/span&gt;&lt;span&gt;广告主以付费方式通过互联网平台向用户传播商品或者服务信息的手段&lt;/span&gt;&lt;span&gt;。这个定义中涉及到 &lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;广告主、平台、用户&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt; &lt;/span&gt;&lt;/strong&gt;&lt;span&gt;3个主体，但是这3个主体的利益关注点各不相同。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5833333333333334&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwc6dib6ATqjCjr0Fibwq2SWiaic49j95GZse1cAet8ouT3RiciaxrABC2LXLBw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;504&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图1：&lt;/span&gt;&lt;span&gt;广告业务的三角平衡&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span/&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;有时候&lt;/span&gt;这三者的利益是冲突的，比如平台增加了广告位数量，收益肯定增加，但用户体验可能变差，因此广告业务最终要寻找的是三方的平衡&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;站在平台的角度来看广告业务，它在&lt;/span&gt;&lt;span&gt;保证用户体验的同时，要兼顾绝大部分广告主的ROI（确保他们是可以赚到钱的），在此基础上再考虑将平台的收入最大化，这样才是一个健康的广告生态。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;2. 从收入的分解公式认清广告的本质&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;p&gt;广告业务发展了几十年，广告费用的结算方式也诞生了很多种，我们最常见的有以下几种：&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;CPT&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;：&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;按时间计费，独占性包时段包位置&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;CPM：&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;按照每千次曝光计费&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;CPC：&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;按照点击计费&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;CPA：&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;按照行为计费（比如下载、注册等）&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6308186195826645&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbg4zuIEDFjUSR9O7Q7ZVMXl2o6YibrWHckSWpeicibltosFibU8XrrtzEYUW797mGzJff71zLt2PbL3g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;623&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图2：&lt;/span&gt;&lt;span&gt;广告费用的结算方式演进&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;之所以有不同的结算方式，其实也是随着广告市场的发展逐渐衍生出来的，最开始流量稀缺，平台占优势，再到今天逐渐成了买方市场，广告主作为需求方的谈判权变大。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;上面这个图可以看出，由于CPA代表了广告主最终想要的转化效果，因此按CPA结算时对广告主最有利，但是对平台最不利。结算方式演进到今天，其实也是一种平衡，所以处于平衡点附近的CPM和CPC是最常见的结算方式。&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;以CPC为例，收入可分解成下面这个公式：&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.1674074074074074&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbg4zuIEDFjUSR9O7Q7ZVMXyS1s2v518qvSBic2AsTpOqAxS7qcVbibdczOSibrXLr0Kg3K0EZNWX3tw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;675&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;其中，PV表示系统的访问量，PVR和ASN表示广告的填充率，CTR表示广告的点击率，ACP表示广告的平均点击价格。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;上述各个指标都可以通过一系列的广告策略来提升。&lt;/span&gt;&lt;span&gt;比如填充率可通过开发更多的广告主来实现，&lt;/span&gt;&lt;span&gt;CTR可通过AI算法做到精准投放来提升，&lt;/span&gt;&lt;span&gt;ACP可通过精准流量溢价或者提升广告主ROI来完成。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;掌握上面这个收入分解公式，对于理解广告业务至关重要，任何业务上的动作几乎都能关联到这个公式的某个指标上。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;3. 广告的核心业务流程&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;广告业务发展到今天，随着广告主对投放效果的诉求不断加强，精准定向以及实时竞价是目前最主流的业务形态。&lt;/span&gt;&lt;span/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对互联网平台来说，初期一般都是采用&lt;span&gt;「&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;自营的竞价广告网络&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;」&lt;/span&gt;来实现商业变现，简单理解：就是利用平台自有的流量以及自主开发的广告主来实现业务闭环。&lt;/span&gt;&lt;span&gt;本文所分享的广告架构主要针对这种业务形态&lt;/span&gt;&lt;span&gt;，它的核心业务流程如下图所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.6225489974021912&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/AaabKZjib2kaFibAspYXvmgJZic0c9KBdTnciaykibBnVuRiaIjdldljOXbSCSgSLRVbGL4u28ttERyvnaI1Pdkcoiaicg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;408&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图3：&lt;/span&gt;&lt;span&gt;广告的核心业务流程&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;广告主先通过投放平台发布广告，可设置一系列的定向条件，比如投放城市、投放时间段、人群标签、出价等。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;span&gt;投放动作完成后，广告会被存放到广告库、同时进入索引库，以便能被广告检索引擎召回&lt;/span&gt;。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;C端请求过来后，广告引擎会完成召回、算法策略、竞价排序等一系列的逻辑，最终筛选出Top N个广告，实现广告的千人千面。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;用户点击广告后，会触发广告扣费流程，这时候平台才算真正获得收益。&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;上面是广告业务的核心流程，随着平台流量以及广告主规模进一步增大，往往会从&lt;span&gt;「&lt;/span&gt;自营型竞价网络&lt;span&gt;」&lt;/span&gt;逐渐向&lt;span&gt;「&lt;/span&gt;联盟广告以及RTB实时竞价&lt;span&gt;」&lt;/span&gt;方向发展，类似于&lt;span&gt;阿里妈妈&lt;/span&gt;、&lt;/span&gt;&lt;span&gt;腾讯广点通、头条巨量引擎，此时业务复杂度和技术架构&lt;span&gt;会再上一个台阶&lt;/span&gt;，本文不作展开，后续再跟大家详细分享&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;02 面临的技术挑战&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对广告业务有了初步了解后，再来看下广告系统面临的技术挑战：&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;1、&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;高并发&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：广告引擎和C端流量对接，请求量大（平峰往往有上万QPS），要求&lt;span&gt;实时&lt;span&gt;响应&lt;/span&gt;&lt;/span&gt;，必须在几十毫秒内返回结果。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;2、&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;业务逻辑复杂&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：一次广告请求，涉及到多路召回、算法模型打分、竞价排序等复杂的业务流程，策略多，执行链路长。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;3、&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;稳定性要求高&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：广告系统直接跟收入挂钩，广告引擎以及计费平台等核心系统的稳定性要求很高，可用性至少要做到3个9。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;4、&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;大数据存储和计算&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：随业务发展，推广数量以及扣费订单数量很容易达到千万甚至上亿规模，另外收入报表的聚合维度多，单报表可能达到百亿级别的记录数。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;5、&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;账务的准确性&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：广告扣费属于金融性质的操作，需要做到不丢失、不重复，否则会损害某一方的利益。另外，如果收入数据不准确，还可能影响到业务决策。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;03 广告系统架构详解&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;了解了广告业务的目标和技术挑战后，接下来详细介绍下广告系统的整体架构和技术方案。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;346&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.5990338164251208&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwctPemBL4dpqZoxHXnCc92SSAvtSJkqhuSDKC2YjFIv4RwSLYWGqP7iaQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1035&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图4：广告系统的整体架构&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;上面是我们公司&lt;span&gt;目&lt;/span&gt;&lt;span&gt;前&lt;/span&gt;的广告系统架构图，&lt;span&gt;这个架构适用于广告业务初期，&lt;/span&gt;&lt;span&gt;针对的是&lt;/span&gt;&lt;span/&gt;&lt;span&gt;「&lt;/span&gt;&lt;span&gt;自营型的竞价网络和站内流量&lt;/span&gt;&lt;span&gt;」，不涉及联盟广告。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;下面针对各个子系统做下说明：&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;广告投放系统&lt;/strong&gt;&lt;/span&gt;：供广告主使用，核心功能包括会员续费、广告库管理、设定推广条件、设置广告出价、查看投放效果等。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;广告运营后台&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：供平台的产品运营使用，核心功能包括广告位管理、广告策略管理、以及各种运营工具。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;广告检索平台&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：承接C端的高并发请求，负责从海量广告库中筛选出几个或者几十个广告，实时性要求高，这个平台通常由多个微服务组成。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;AB实验平台&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：广告业务的稳定器，任何广告策略上的调整均可以通过此平台进行灰度实验，观察收入指标的变化。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;广告计费平台&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：面向C端，负责实时扣费，和收入直接挂钩，&lt;span&gt;可用性要求高。&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;账务管理中心&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：广告业务中的财务系统，统管金额相关的业务，包括充值、冻结、扣费等。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;大数据平台&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;：整个广告系统的底盘，需要聚合各种异构数据源，完成离线和实时数据分析和统计，产出业务报表，生产模型特征等。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;下面再针对架构中的技术难点展开做下介绍。&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;1. 广告数据的存储&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;广告系统要存储的数据多种多样，特点各不相同，采用的&lt;span&gt;是&lt;/span&gt;&lt;span&gt;多模的数据存储方式。&lt;/span&gt;&lt;span/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;393&quot; data-backw=&quot;552&quot; data-ratio=&quot;0.7119565217391305&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwczqqNQgCezYouibQnvFX3axIPUj4SNFpzTSwdm5KUvYTwhYicicgoS6DPg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;552&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图5：广告数据的多模存储&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;OLTP场景，包括广告库、创意库、会员库、广告产品库、广告策略库等，这些都存储在MySQL中，数据规模较大的广告库和创意库，按照广告主ID Hash做分库分表。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;OLAP场景，涉及到非常多的报表，聚合维度多，单表的记录数可能达到百亿级别，底层采用HDFS和HBase存储&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;面向广告检索场景的索引数据，包括正排索引和倒排索引，采用Redis和ES来存储。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;存储上还需要解决的一个问题是：广告的同步问题。广告投放完成后，首先会存储在MySQL数据库中，接下来需要把广告实时传输到检索系统中，完成正排索引以及倒排索引的更新。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;330&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.5709969788519638&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwcHAiaWa7KPvHZo78cgplGOPhT4Gyns5skz3UKu8TKG2kjqLicXuvT7jGw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;662&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;图6：广告索引的&lt;span&gt;更新&lt;/span&gt;&lt;/span&gt;&lt;span&gt;流程&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;索引更新服务，有几个要点说明下：&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;span&gt;2. 广告检索平台的整体流程&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;广告检索平台负责承接C端的流量请求，从海量广告库中筛选出最合适的前N个广告，并在几十毫秒内返回结果，它是一个多级筛选和排序的过程。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;437&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7564766839378239&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbg4zuIEDFjUSR9O7Q7ZVMXkaibrkAasMmmymvDxyoBcUFXtesryqZxDgICY3mwIQM8U0cwRLcSdVA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;772&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;图7：广告检索平台的整体&lt;/span&gt;&lt;span&gt;流程&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;Recall层侧重算法模型，Search层侧重业务。从下到上，计算复杂度逐层增加，候选集逐层减少。（说明：&lt;span&gt;搜索广告场景和推荐广告场景在某些子模块上存在差异，但整体流程基本一致，这里不作展开）&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;性能设计是检索平台的重点，通常有以下手段：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;做好服务分层，各层均可水平扩展。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;采用Redis缓存，避免高并发请求直接打到数据库，缓存可按业务规划多套，进行分流。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;采用多线程并行化某些子流程，比如多路召回逻辑、多模型打分逻辑。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;热点数据进行本地缓存，比如广告位的配置信息以及策略配置信息，在&lt;span&gt;服务启动时就可以预加载到本地，然后定时进行同步。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;非核心流程&lt;/span&gt;设置超时熔断走降级逻辑，比如溢价策略（不溢价只是少赚了，不影响广告召回）。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;和&lt;span&gt;主流程无关的逻辑异步执行&lt;/span&gt;，&lt;span&gt;比如扣费信息&lt;span&gt;缓&lt;/span&gt;&lt;span&gt;存&lt;/span&gt;、召回结果缓存等。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;精简RPC返回结果或者Redis缓存对象的结构，去掉不必要的字段，减少IO数据包大小。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;GC优化，包括JVM堆内存的&lt;span&gt;设置&lt;/span&gt;、垃圾收集器的选择、GC频次优化和GC耗时优化。&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;3. 计费平台的技术方案&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;计费平台也是一个核心系统，主要完成实时扣费功能。比如CPC结算方式下，广告主设置的预算是50元，每次点击扣1元，当扣费金额达到预算时，需要将广告及时下线。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;除此之外，计费平台还需要支持CPM、CPT等多种结算方式，以及支持反作弊、余额撞线处理、扣费订单的摊销和对账等功能。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;计费平台的特点是：并发高、数据量大、同时可用性要求高，需要做到不少扣，不重复扣。下面以CPC实时点击扣费为例，详细说下技术方案。&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;521&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.9013452914798207&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwcYhRXGvaTJg3icM4yn8MJ1ia3Xn7LVBkWukvXdLxdOM6S9XPGXT2V8ZibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;669&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;图8：CPC实时扣费流程&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;首先，整个扣费流程做了异步化处理，当收到实时扣费请求后，系统先将扣费时用到的信息缓存到Redis，然后发送MQ消息，这两步完成后扣费动作就算结束了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这样做的好处是：能确保扣费接口的性能，同时利用MQ的可靠性投递和重试机制确保整个扣费流程的最终一致性。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为了提高可用性，针对Redis和MQ不可用的情况均采用了降级方案。Redis不可用时，切换到TiKV进行持久化；MQ投递失败时，改成线程池异步处理。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;另外，每次有效点击都需要生成1条扣费订单，面临大数据量的存储问题。目前我们采用的是MySQL分库分表，后期会考虑使用HBase等分布式存储。另外，订单和账务系统之间的数据一致性，采用大数据平台做天级别的增量抽取，通过Hive任务完成对账和监控。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;4. OLAP海量数据报表的技术方案&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据报表是也是广告平台的核心业务，它是广告主、平台运营人员进行投放优化、业务决策的依据。&lt;/span&gt;&lt;span&gt;先来看下广告数据仓库的分层结构：&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;353&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.6103151862464183&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AaabKZjib2kbzcFiaxB4bdlqYY4icsLGmwcUUdgq9DmJPyXHEM8OL33aRFr9TcfClXeibzcJg1sMrKoCibE8oDrluyQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;698&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图9：广告数据仓库的分层结构&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;源数据层&lt;/strong&gt;&lt;/span&gt;：对应各种源数据，包括&lt;span&gt;HDFS中实时采集的&lt;/span&gt;前后端日志，增量或者全量同步的MySQL业务数据表。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;数据仓库层&lt;/strong&gt;&lt;/span&gt;：包含维度表和事实表，通常是对源数据进行清洗后的数据宽表，比如行为日志表、推广宽表、用户宽表等。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;数据集市层&lt;/strong&gt;&lt;/span&gt;：对数据进行轻粒度的汇总表，比如广告效果表、用户行为的全链路表、用户群分析表等。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;数据应用层&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：上层应用场景直接使用的数据表，包括多维分析生成的各种收入报表、Spark任务产出的算法模型特征和画像数据等。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;采用这样的分层结构，和软件分层思想类似，提高了数据的维护性和复用性&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;再来看应用层报表部分面临的挑战：&lt;/span&gt;&lt;/span&gt;&lt;span&gt;聚合维度多，&lt;/span&gt;&lt;span&gt;需要分时、分广告位、分推广等几十个维度；&lt;/span&gt;&lt;span&gt;&lt;span&gt;单表最大达到百亿级别；支持时间范围的实时查询。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;span&gt;这部分由公司的大数据部门维护，采用了开源的技术方案，离线部分使用Kylin，数据存储在HBase中；实时部分使用Flink和Spark Streaming，数据存储在Druid中。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;写在最后&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本文详细介绍了广告系统的初期架构和核心技术方案。随着业务演进，架构也会随之变得更加复杂，但是&lt;/span&gt;&lt;span&gt;大数据存储、&lt;span&gt;高&lt;/span&gt;&lt;span&gt;并发、&lt;/span&gt;高可用，始终是广告业务的技术难点&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;关于广告系统的稳定性保障、广告策略的可扩展性设计、RTB实时竞价的系统架构等有价值的内容，后续再分享给大家，欢迎关注我的公号。&lt;/span&gt;&lt;span&gt;针对本篇文章，如果有任何疑问或者建议，可以留言讨论&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&amp;lt;END&amp;gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;js_blockquote_wrap&quot; data-type=&quot;2&quot; data-url=&quot;&quot; data-author-name=&quot;&quot; data-content-utf8-length=&quot;56&quot; data-source-title=&quot;&quot;&gt;&lt;section class=&quot;js_blockquote_digest&quot;&gt;&lt;p&gt;&lt;span&gt;作者：IT人的职场进阶&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;博客园文章地址： &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;cnblogs.com/luojunwu/p/14113473.html&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;em&gt;&lt;span&gt;阅读更多&lt;/span&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.8333333333333334&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/WlIksv5EUJllR9ukZuZLccXHWbYMNSicJwNJSMvHZ8iacblib9ztmjCnRJ4nkxicqP8eDQ8ibIx1HejCSPWUrJicoTcQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;img class=&quot;__bg_gif&quot; data-ratio=&quot;0.6197183&quot; data-type=&quot;gif&quot; data-w=&quot;71&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/WlIksv5EUJk8tE5ud0tIZDibXsrImVibSlrLkUBQWqf0MTWKC1XVPKK6d0tysrjFLoianv0f8MwTjbnr1F5fibGcUg/640?wx_fmt=gif&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;查看「博客园12月活动」及每日中奖名单&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>0ae9e4b9eaa12632bc6ce7c2d309e392</guid>
<title>静态博客如何高性能插入评论</title>
<link>https://toutiao.io/k/ezkvu3s</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;content&quot;&gt;
            &lt;h2 id=&quot;-前言&quot;&gt;🌏 前言&lt;/h2&gt;
&lt;p&gt;我们知道，静态博客由于不带有动态功能，所以针对评论这种动态需求比较大众的做法就是使用第三方评论系统。第三方评论的本质其实就是使用 JS 去调取第三方服务接口获取评论后动态渲染到页面中。虽然它很好的解决了这个问题，但是由于需要请求接口，在体验上远比动态博客的直出效果要差很多。所以当我把博客从动态博客 Typecho 迁移到静态博客 Hugo 上来时，就一直在思考这个问题。直到我看到了 Hugo 的 &lt;code&gt;getJSON&lt;/code&gt; 方法，发现原来静态博客也是能够像动态博客一样直出评论的。&lt;/p&gt;
&lt;p&gt;大部分的静态博客的原理是解析存储内容的文件夹，使用一些模板语言遍历数据生成一堆 HTML 文件。而 Hugo 除了解析 Markdown 内容之外，还支持额外的数据获取方法 &lt;code&gt;getJSON&lt;/code&gt;。由于有了 &lt;code&gt;getJSON&lt;/code&gt; 方法的出现，我们可以实现在博客编译构建过程中动态的去获取评论接口数据，将其渲染到页面中，实现评论数据的直出效果。关于 &lt;code&gt;getJSON&lt;/code&gt; 的更多介绍，可以查看 Hugo 文档&lt;a href=&quot;https://gohugo.io/templates/data-templates/&quot;&gt;数据模板&lt;/a&gt;一节。&lt;/p&gt;
&lt;h2 id=&quot;-方案&quot;&gt;🎃 方案&lt;/h2&gt;
&lt;p&gt;高性能方案基本思路是在需要评论数据的地方通过 &lt;code&gt;getJSON&lt;/code&gt; 方法调用接口获取评论数据并进行模板渲染。当评论更新的时候，我们需要触发重新构建。实现这个方案依赖三个关键要素：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;构建过程支持调取接口获取数据&lt;/li&gt;
&lt;li&gt;评论服务提供 HTTP 接口返回数据&lt;/li&gt;
&lt;li&gt;博客部署服务支持钩子触发重新构建&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我的博客使用的是 Hugo 静态博客系统，如上文所说通过 &lt;code&gt;getJSON&lt;/code&gt; 即可解决第一个问题。而我的评论服务使用的是自研的 &lt;a href=&quot;https://waline.js.org&quot;&gt;Waline&lt;/a&gt; 评论系统，它提供了评论数、评论列表、最近评论等基础接口满足我们的数据获取需求。并且 Waline 提供了丰富的&lt;a href=&quot;https://waline.js.org/server/basic.html#%E8%AF%84%E8%AE%BA-hooks&quot;&gt;钩子功能&lt;/a&gt;，支持在评论发布的时候触发自第一方法。我的博客部署在 Vercel 上，它提供了 &lt;a href=&quot;https://vercel.com/docs/more/deploy-hooks&quot;&gt;Deploy Hooks&lt;/a&gt; 功能，通过 URL 即可触发重新构建。也就是说我只要在 Waline 评论发布的钩子中调用 Vercel 的钩子 URL 触发重新构建即可解决第三个问题。&lt;/p&gt;
&lt;h2 id=&quot;-实现&quot;&gt;🥪 实现&lt;/h2&gt;
&lt;p&gt;我的博客上有三处地方和评论有关，分别是首页侧边栏的最近评论，文章标题下方的评论数，以及文章详情页底部的评论列表展示。&lt;/p&gt;
&lt;h3 id=&quot;-最近评论&quot;&gt;🍞 最近评论&lt;/h3&gt;
&lt;p&gt;Waline 最近评论接口：&lt;a href=&quot;https://waline.js.org/api.html#%E8%AF%84%E8%AE%BA%E6%8E%A5%E5%8F%A3&quot;&gt;文档&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{ $walineURL := .Site.Params.comment.waline.serverURL }}
&amp;lt;h2 class=&quot;widget-title &quot;&amp;gt;最近回复&amp;lt;/h2&amp;gt;
&amp;lt;ul class=&quot;widget-list recentcomments&quot;&amp;gt;
  {{ $resp := getJSON $walineURL &quot;/comment?type=recent&quot; }}
  {{ range $resp }}
  &amp;lt;li class=&quot;recentcomments&quot;&amp;gt;
    &amp;lt;a href=&quot;{{.Site.BaseURL}}{{ .url }}&quot;&amp;gt;{{ .nick }}&amp;lt;/a&amp;gt;：{{ .comment | safeHTML | truncate 22 }}
  &amp;lt;/li&amp;gt;
  {{ end }}
&amp;lt;/ul&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-文章评论数&quot;&gt;🧀 文章评论数&lt;/h3&gt;
&lt;p&gt;Waline 获取文章对应的评论数接口：&lt;a href=&quot;https://waline.js.org/api.html#%E8%AF%84%E8%AE%BA%E6%95%B0&quot;&gt;文档&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{ $walineURL := .Site.Params.comment.waline.serverURL }}
{{ $count := getJSON $walineURL &quot;/comment?type=count&amp;amp;url=/&quot; .Slug &quot;.html&quot; }}
&amp;lt;a href=&quot;{{ .Permalink }}#comments&quot; title=&quot;{{ .Title }}&quot;&amp;gt;
  &amp;lt;i class=&quot;fas fa-comment mr-1&quot;&amp;gt;&amp;lt;/i&amp;gt;
  &amp;lt;span&amp;gt;{{- if gt $resp 0}}{{$resp}} 条评论{{else}}暂无评论{{end -}}&amp;lt;/span&amp;gt;
&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-评论列表&quot;&gt;🍯 评论列表&lt;/h3&gt;
&lt;p&gt;评论列表由于有分页的存在，不像最近评论和评论数一样简单的调用接口即可。先获取评论数，发现有评论时先获取第一页的评论，主要是用来获取总共有多少页评论。之后再从第二页开始循环获取评论数据。最终将获取到的数据全部存到 &lt;code&gt;{{$scratch.Get &quot;comments&quot;}}&lt;/code&gt; 数组中，使用模板语法渲染该数组数据即可。&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{$baseUrl := .Site.Params.comment.waline.serverURL}}
{{$slug := .Slug}}
{{$count := getJSON $baseUrl &quot;/comment?type=count&amp;amp;url=/&quot; $slug &quot;.html&quot; }}
{{$scratch := newScratch}}
{{$scratch.Add &quot;comments&quot; slice}}

{{if gt $count 0}}
  {{$comments := getJSON $baseUrl &quot;/comment?path=/&quot; $slug &quot;.html&amp;amp;page=1&amp;amp;pageSize=100&quot;}}
  {{range $cmt := $comments.data}}
    {{$scratch.Add &quot;comments&quot; $cmt}}
  {{end}}

  {{$totalPages := $comments.totalPages}}
  {{if gt $totalPages 1}}
    {{range $page := seq 2 $totalPages}}
      {{$comments := getJSON $baseUrl &quot;/comment?path=/&quot; $slug &quot;.html&amp;amp;pageSize=100&amp;amp;page=&quot; $page}}
      {{range $cmt := $comments.data}}
        {{$scratch.Add &quot;comments&quot; $cmt}}
      {{end}}
    {{end}}
  {{end}}
{{end}}

&amp;lt;div class=&quot;vcards&quot;&amp;gt;
  {{range $cmt := $scratch.Get &quot;comments&quot;}}
  &amp;lt;div class=&quot;vcard&quot; id={{$cmt.objectId}}&amp;gt;
    &amp;lt;img class=&quot;vimg&quot; src=&quot;https://gravatar.loli.net/avatar/{{$cmt.mail}}?d=mp&quot;&amp;gt;
    &amp;lt;div class=&quot;vh&quot;&amp;gt;
      &amp;lt;div class=&quot;vhead&quot;&amp;gt;
        &amp;lt;a class=&quot;vnick&quot; rel=&quot;nofollow&quot; href=&quot;{{$cmt.link}}&quot; target=&quot;_blank&quot;&amp;gt;{{$cmt.nick}}&amp;lt;/a&amp;gt;
        &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.browser}}&amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.os}}&amp;lt;/span&amp;gt;
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vmeta&quot;&amp;gt;
        &amp;lt;span class=&quot;vtime&quot;&amp;gt;{{dateFormat $cmt.insertedAt &quot;2006-01-02 03:04:05&quot;}}&amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;vat&quot;&amp;gt;回复&amp;lt;/span&amp;gt;
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vcontent&quot; data-expand=&quot;查看更多...&quot;&amp;gt;
        {{$cmt.comment | safeHTML}}
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vreply-wrapper&quot;&amp;gt;&amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vquote&quot;&amp;gt;
        {{range $cmt := $cmt.children}}
        &amp;lt;div class=&quot;vh&quot; id=&quot;{{$cmt.objectId}}&quot;&amp;gt;
          &amp;lt;div class=&quot;vhead&quot;&amp;gt;
            &amp;lt;a class=&quot;vnick&quot; rel=&quot;nofollow&quot; href=&quot;{{$cmt.link}}&quot; target=&quot;_blank&quot;&amp;gt;{{$cmt.nick}}&amp;lt;/a&amp;gt;
            &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.browser}}&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.os}}&amp;lt;/span&amp;gt;
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vmeta&quot;&amp;gt;
            &amp;lt;span class=&quot;vtime&quot;&amp;gt;{{dateFormat $cmt.insertedAt &quot;2006-01-02 03:04:05&quot;}}&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;vat&quot;&amp;gt;回复&amp;lt;/span&amp;gt;
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vcontent&quot; data-expand=&quot;查看更多...&quot;&amp;gt;
            {{$cmt.comment | safeHTML}}
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vreply-wrapper&quot;&amp;gt;&amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
        {{end}}
      &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
  {{end}}
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-构建触发&quot;&gt;🍳 构建触发&lt;/h3&gt;
&lt;p&gt;Waline 在评论发布、更新和删除阶段都支持自定义钩子，在钩子中触发 Vercel 的构建钩子即可完成发布评论重新构建的流程。&lt;/p&gt;
&lt;p&gt;按照如下内容修改服务端部署的 &lt;code&gt;index.js&lt;/code&gt; 文件，&lt;a href=&quot;https://waline.js.org/server/basic.html#%E8%AF%84%E8%AE%BA-hooks&quot;&gt;查看文档&lt;/a&gt;了解全部的 Waline 钩子。&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Waline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;@waline/vercel&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;https&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;https://api.vercel.com/v1/integrations/deploy/xxxxx&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Waline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postSave&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;approved&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postUpdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postDelete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&quot;-后记&quot;&gt;🍾 后记&lt;/h2&gt;
&lt;p&gt;通过以上操作，就能在不损失用户体验的情况下实现评论数据的动态支持了。有些人可能会担心是否会在构建阶段造成超多的接口请求。这里大可不用担心，Hugo 自己会在构建的时候做接口的缓存，同 URL 的接口调用会走缓存数据而不会重新调用。&lt;/p&gt;
&lt;p&gt;除了用户体验之外，由于只会在构建的时候触发数据的获取，针对有调用次数配额的第三方评论服务也能节省额度。当然，理论上构建次数是远小于访问次数的，所以额度节省的结论是能成立的。如果说你的构建次数要比访问次数还要大的话，那这种方法就无法节省额度了。&lt;/p&gt;
&lt;p&gt;当然这种方式也会有带来些问题，主要是评论的更新没那么快。好在 Hugo 的构建速度非常快，一两分钟的时间也能接受。而针对用户评论的发布，则可以通过评论发布后先假插入缓解该问题。&lt;/p&gt;

        &lt;/div&gt;

        
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>