<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>284babd2bb027cf223da67c684a1dc31</guid>
<title>一文熟悉 Presto</title>
<link>https://toutiao.io/k/4xt1kuj</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;strong&gt;&lt;span&gt;1. Presto&lt;span&gt;介绍&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.1 Presto&lt;span&gt;简介&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.1.1 Presto&lt;span&gt;概述&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Presto是一个分布式SQL查询引擎，用于查询分布在一个或多个异构数据源上的大型数据集。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.1.2 Presto&lt;span&gt;架构&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5275862068965518&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLc2bicVBpvKShemp7ORBG6KHZJj1icsZibkJLXW4bt6OHKibYHmgfjicc1PicXicWEjNscaAqnoMEKpYzvFQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;580&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.1.3 &lt;span&gt;官网地址&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;就在&lt;/span&gt;2020&lt;span&gt;年&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;&lt;span&gt;月&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;&lt;span&gt;日&lt;/span&gt;&lt;span&gt;,prestosql&lt;/span&gt;&lt;span&gt;与&lt;/span&gt;&lt;span&gt;facebook&lt;/span&gt;&lt;span&gt;正式分裂&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;并改名为&lt;/span&gt;&lt;span&gt;trino.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;https://prestosql.io/&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://trino.io&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.1.4 Prestodb VS Prestosql(trino)&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;根据目前社区活跃度和使用广泛度&lt;/span&gt;,&lt;span&gt;更加推荐&lt;/span&gt;&lt;span&gt;prestosql.&lt;/span&gt;&lt;span&gt;具体区别参考博文&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://armsword.com/2020/05/02/the-difference-between-prestodb-and-prestosql/&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2 Prestosql&lt;span&gt;的安装和使用&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.1 prestosql&lt;span&gt;版本的选择&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在&lt;/span&gt;presto330&lt;span&gt;版本里已经提到&lt;/span&gt;&lt;span&gt;,jdk8&lt;/span&gt;&lt;span&gt;只支持到&lt;/span&gt;&lt;span&gt;2020-03&lt;/span&gt;&lt;span&gt;月发行的版本&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;详情参考&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;https://prestosql.io/docs/current/release/release-330.html&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在&lt;/span&gt;2020&lt;span&gt;年&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;月&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;号&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;社区发布的&lt;/span&gt;&lt;span&gt;332&lt;/span&gt;&lt;span&gt;版本开始&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;需要&lt;/span&gt;&lt;span&gt;jdk11&lt;/span&gt;&lt;span&gt;的版本&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;由于现在基本都使用的是&lt;/span&gt;&lt;span&gt;jdk8,&lt;/span&gt;&lt;span&gt;所以我们选择&lt;/span&gt;&lt;span&gt;presto315&lt;/span&gt;&lt;span&gt;版本的&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;此版本在&lt;/span&gt;&lt;span&gt;jdk8&lt;/span&gt;&lt;span&gt;的环境下是可用的&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;如果我们生产环境是&lt;/span&gt;&lt;span&gt;jdk8,&lt;/span&gt;&lt;span&gt;但是又想使用新版的&lt;/span&gt;&lt;span&gt;presto,&lt;/span&gt;&lt;span&gt;可以为&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;单独指定&lt;/span&gt;&lt;span&gt;jdk11&lt;/span&gt;&lt;span&gt;即可使用&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;最后附录部分会给出使用&lt;/span&gt;&lt;span&gt;jdk11&lt;/span&gt;&lt;span&gt;的配置方式&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.2 &lt;span&gt;集群安装规划&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;host&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;worker&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;linux121&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;√&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;×&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;linux122&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;×&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;√&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;linux123&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;×&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td valign=&quot;center&quot;&gt;&lt;p&gt;&lt;span&gt;√&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.3 Presto Server&lt;span&gt;的安装&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;&lt;span&gt;安装包下载地址&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;https://repo1.maven.org/maven2/io/prestosql/presto-server/315/presto-server-315.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;presto-server-315.tar.gz&lt;span&gt;上传到服务器上&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这里导入到&lt;/span&gt;&lt;span&gt;linux121&lt;/span&gt;&lt;span&gt;服务器上的&lt;/span&gt;&lt;span&gt;/opt/software&lt;/span&gt;&lt;span&gt;目录下&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;并解压至&lt;/span&gt;&lt;span&gt;/opt/servers&lt;/span&gt;&lt;span&gt;目录下&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 software]# tar -zvxf presto-server-315.tar.gz -C /opt/servers/&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;3. &lt;/span&gt;&lt;span&gt;&lt;span&gt;创建&lt;/span&gt;presto&lt;span&gt;的数据目录&lt;/span&gt;&lt;span&gt;(presto&lt;/span&gt;&lt;span&gt;集群的每台机器都要创建&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;用来存储日志这些&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 presto-server-315]# mkdir -p /file/data/presto&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;4. &lt;/span&gt;&lt;span&gt;&lt;span&gt;在安装目录&lt;/span&gt;/opt/servers/presto-server-315&lt;span&gt;下创建&lt;/span&gt;&lt;span&gt;etc&lt;/span&gt;&lt;span&gt;目录&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;用来存放各种配置文件&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 presto-server-315]# mkdir etc&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.4 Node Properties&lt;span&gt;配置&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在&lt;/span&gt;/opt/servers/presto-server-315/etc&lt;span&gt;路径下&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;配置&lt;/span&gt;&lt;span&gt;node&lt;/span&gt;&lt;span&gt;属性&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;注意&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;集群中每台&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;node.id&lt;/span&gt;&lt;span&gt;必须不一样&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;后面需要修改集群中其它节点的&lt;/span&gt;&lt;span&gt;node.id&lt;/span&gt;&lt;span&gt;值&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 etc]# vim node.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;环境名称&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;自己任取&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;集群中的所有&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;节点必须具有相同的环境名称&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node.environment=develop&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;支持字母&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;数字&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;对于每个节点&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这必须是唯一的&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;这个标识符应该在重新启动或升级&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;时保持一致&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node.id=1&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;的日志和其它数据的存储目录&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;自己创建前面创建好的数据目录&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node.data-dir=/file/data/presto&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.5 JVM Config&lt;span&gt;配置&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在&lt;/span&gt;/opt/servers/presto-server-315/etc&lt;span&gt;目录下添加&lt;/span&gt;&lt;span&gt;jvm.config&lt;/span&gt;&lt;span&gt;配置文件&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;并填入如下内容&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 etc]# vim jvm.config&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;参考官方给的配置&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;根据自身机器实际内存进行配置&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-server&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;最大&lt;/span&gt;&lt;span&gt;jvm&lt;/span&gt;&lt;span&gt;内存&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-Xmx15G&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:-UseBiasedLocking&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;GC&lt;/span&gt;&lt;span&gt;的策略&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:+UseG1GC&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:G1HeapRegionSize=32M&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:+ExplicitGCInvokesConcurrent&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:+ExitOnOutOfMemoryError&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:+HeapDumpOnOutOfMemoryError&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:ReservedCodeCacheSize=512M&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-Djdk.attach.allowAttachSelf=true&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-Djdk.nio.maxCachedBufferSize=2000000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.6 Config Properties&lt;span&gt;配置&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;The config properties file, etc/config.properties, contains the configuration for the Presto server. Every Presto server can function as both a coordinator and a worker, but dedicating a single machine to only perform coordination work provides the best performance on larger clusters.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Presto&lt;span&gt;是由一个&lt;/span&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;节点和多个&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;节点组成&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;由于在单独一台服务器上配置&lt;/span&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;有利于提高性能&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;所以在&lt;/span&gt;&lt;span&gt;linux121&lt;/span&gt;&lt;span&gt;上配置成&lt;/span&gt;&lt;span&gt;coordinator,&lt;/span&gt;&lt;span&gt;在&lt;/span&gt;&lt;span&gt;linux122,linux123&lt;/span&gt;&lt;span&gt;上配置为&lt;/span&gt;&lt;span&gt;worker(&lt;/span&gt;&lt;span&gt;如果实际机器数量不多的话可以将在协调器上部署&lt;/span&gt;&lt;span&gt;worker.)&lt;/span&gt;&lt;span&gt;在&lt;/span&gt;&lt;span&gt;/opt/servers/presto-server-315/etc&lt;/span&gt;&lt;span&gt;目录下添加&lt;/span&gt;&lt;span&gt;config.properties&lt;/span&gt;&lt;span&gt;配置文件&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;这是针对&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;所在节点的配置信息&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;针对&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;所在节点配置信息后面会配置&lt;/span&gt;&lt;span&gt;.):&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux122 etc]# vim config.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该节点是否作为&lt;/span&gt;&lt;span&gt;coordinator,&lt;/span&gt;&lt;span&gt;如果是&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;就允许该&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;实例充当协调器&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;coordinator=true&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;允许在协调器上调度工作&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;即配置&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;节点&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;为&lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;就是不允许&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;对于较大的集群&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;协调器上的处理工作可能会影响查询性能&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;因为机器的资源无法用于调度&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;管理和监视查询执行的关键任务&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;如果需要在协调器所在节点配置&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;节点改为&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;即可&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node-scheduler.include-coordinator=false&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;HTTP&lt;/span&gt;&lt;span&gt;服务器的端口&lt;/span&gt;&lt;span&gt;.Presto&lt;/span&gt;&lt;span&gt;使用&lt;/span&gt;&lt;span&gt;HTTP&lt;/span&gt;&lt;span&gt;进行所有内部和外部通信&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http-server.http.port=7788&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;每个查询可以使用的最大分布式内存量。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory=12GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户内存量&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory-per-node=5GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户和系统内存量，其中系统内存是读取器，写入器和网络缓冲区等在执行期间使用的内存。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-total-memory-per-node=6GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该参数默认值时&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;30%.&lt;/span&gt;&lt;span&gt;且这个值加上&lt;/span&gt;&lt;span&gt;query.max-total-memory-per-node&lt;/span&gt;&lt;span&gt;的值不能大于&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的值&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;否则无法启动&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;memory.heap-heaproom-per-node=2GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#discover-server&lt;span&gt;是&lt;/span&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;内置的服务&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;负责监听&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;discovery-server.enabled=true&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;发现服务器的&lt;/span&gt;&lt;span&gt;URI.&lt;/span&gt;&lt;span&gt;因为已经在&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;协调器中启用了&lt;/span&gt;&lt;span&gt;discovery,&lt;/span&gt;&lt;span&gt;所以这应该是&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;协调器的&lt;/span&gt;&lt;span&gt;URI&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;discovery.uri=http://linux121:7788&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.7 Catalog Properties&lt;span&gt;配置&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Presto&lt;span&gt;可以支持多个数据源&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;在&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;里面叫&lt;/span&gt;&lt;span&gt;catalog,&lt;/span&gt;&lt;span&gt;这里以配置支持&lt;/span&gt;&lt;span&gt;Hive&lt;/span&gt;&lt;span&gt;和&lt;/span&gt;&lt;span&gt;MySQL&lt;/span&gt;&lt;span&gt;的数据源为例&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;配置一个&lt;/span&gt;&lt;span&gt;Hive&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;catalog&lt;/span&gt;&lt;span&gt;和多个&lt;/span&gt;&lt;span&gt;MySQL&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;catalog:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;在&lt;/span&gt;&lt;span&gt;etc&lt;/span&gt;&lt;span&gt;目录下创建&lt;/span&gt;&lt;span&gt;catalog&lt;/span&gt;&lt;span&gt;目录&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 etc]# mkdir catalog&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Hive&lt;span&gt;的&lt;/span&gt;&lt;span&gt;catalog:&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;在&lt;/span&gt;&lt;span&gt;catalog&lt;/span&gt;&lt;span&gt;目录下创建&lt;/span&gt;&lt;span&gt;hive.properties&lt;/span&gt;&lt;span&gt;文件&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 catalog]# vim hive.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;代表&lt;/span&gt;&lt;span&gt;hadoop2&lt;/span&gt;&lt;span&gt;代版本&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;并不是单单指&lt;/span&gt;&lt;span&gt;hadoop2.x&lt;/span&gt;&lt;span&gt;的版本&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;而是&lt;/span&gt;&lt;span&gt;hadoop&lt;/span&gt;&lt;span&gt;第二代&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;固定写法&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connector.name=hive-hadoop2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;metastore&lt;/span&gt;&lt;span&gt;的地址&lt;/span&gt;&lt;span&gt;(hive&lt;/span&gt;&lt;span&gt;必须启用&lt;/span&gt;&lt;span&gt;metastore)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;hive.metastore.uri=thrift://linux123:9083&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;如果&lt;/span&gt;&lt;span&gt;hdfs&lt;/span&gt;&lt;span&gt;是高可用必须增加这个配置&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;如果不是高可用&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;可省略&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;如果&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;所在的节点没有安装&lt;/span&gt;&lt;span&gt;Hadoop,&lt;/span&gt;&lt;span&gt;需要从其它&lt;/span&gt;&lt;span&gt;hadoop&lt;/span&gt;&lt;span&gt;节点复制这些文件到&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;的节点&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;hive.config.resources=/opt/servers/hadoop-2.9.2/etc/hadoop/core-site.xml,/opt/servers/hadoop-2.9.2/etc/hadoop/hdfs-site.xml&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;MySQL&lt;span&gt;的&lt;/span&gt;&lt;span&gt;catalog(&lt;/span&gt;&lt;span&gt;第一个对接的是&lt;/span&gt;&lt;span&gt;a&lt;/span&gt;&lt;span&gt;业务线的&lt;/span&gt;&lt;span&gt;Mysql):&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;通过文件名称区分不同的&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;数据来源&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 catalog]# vim mysql_a.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;配置&lt;/span&gt;&lt;span&gt;Mysql&lt;/span&gt;&lt;span&gt;源&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;这里必须是&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connector.name=mysql&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定连接&lt;/span&gt;&lt;span&gt;Mysql&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;url&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-url=jdbc:mysql://linux123:3306&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;的主机名&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-user=root&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;的密码&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-password=12345678&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;MySQL&lt;span&gt;的&lt;/span&gt;&lt;span&gt;catalog(&lt;/span&gt;&lt;span&gt;第二个对接的是&lt;/span&gt;&lt;span&gt;b&lt;/span&gt;&lt;span&gt;业务线的&lt;/span&gt;&lt;span&gt;Mysql):&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;通过文件名称区分不同的&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;数据来源&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 catalog]# vim mysql_b.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;配置&lt;/span&gt;&lt;span&gt;Mysql&lt;/span&gt;&lt;span&gt;源&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;这里必须是&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connector.name=mysql&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定连接&lt;/span&gt;&lt;span&gt;Mysql&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;url&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-url=jdbc:mysql://linux121:3306&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;的主机名&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-user=root&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;mysql&lt;/span&gt;&lt;span&gt;的密码&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;connection-password=123456&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.8 &lt;span&gt;分发安装目录到集群中其它节点上&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;linux121&lt;span&gt;上配置好的&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;安装包分发到集群中的其它节点&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;这里使用的是自己写的分发脚本&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 servers]# rsync-script /opt/servers/presto-server-315/&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.9 &lt;span&gt;修改&lt;/span&gt;&lt;span&gt;node.id&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;修改&lt;/span&gt;linux122&lt;span&gt;和&lt;/span&gt;&lt;span&gt;linux123&lt;/span&gt;&lt;span&gt;机器上&lt;/span&gt;&lt;span&gt;node.properties&lt;/span&gt;&lt;span&gt;配置文件中的&lt;/span&gt;&lt;span&gt;node.id(&lt;/span&gt;&lt;span&gt;因为每台机器&lt;/span&gt;&lt;span&gt;node.id&lt;/span&gt;&lt;span&gt;必须要不一样&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux122 etc]# vim node.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node.id=2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux123 etc]# vim node.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;node.id=3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.10 &lt;span&gt;修改&lt;/span&gt;&lt;span&gt;work&lt;/span&gt;&lt;span&gt;节点的配置信息&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;修改&lt;/span&gt;worker&lt;span&gt;节点&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;即&lt;/span&gt;&lt;span&gt;linux122&lt;/span&gt;&lt;span&gt;和&lt;/span&gt;&lt;span&gt;linux123&lt;/span&gt;&lt;span&gt;机器&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;上的&lt;/span&gt;&lt;span&gt;config.properties&lt;/span&gt;&lt;span&gt;配置文件&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;里面的配置内容与&lt;/span&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;所在的节点是不一样的&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux122 etc]# vim config.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该节点是否作为&lt;/span&gt;&lt;span&gt;coordinator,&lt;/span&gt;&lt;span&gt;因为是&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;节点&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这里是&lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;coordinator=false&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;访问端口&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;可以自己指定&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http-server.http.port=7788&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;每个查询可以使用的最大分布式内存量。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory=12GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户内存量&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory-per-node=5GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户和系统内存量，其中系统内存是读取器，写入器和网络缓冲区等在执行期间使用的内存。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-total-memory-per-node=6GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该参数默认值时&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;30%.&lt;/span&gt;&lt;span&gt;且这个值加上&lt;/span&gt;&lt;span&gt;query.max-total-memory-per-node&lt;/span&gt;&lt;span&gt;的值不能大于&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的值&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;否则无法启动&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;memory.heap-heaproom-per-node=2GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;discovery-server&lt;/span&gt;&lt;span&gt;的地址&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这样&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;才能找到它&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;与上面的端口须一致&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;discovery.uri=http://linux121:7788&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux123 etc]# vim config.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该节点是否作为&lt;/span&gt;&lt;span&gt;coordinator,&lt;/span&gt;&lt;span&gt;如果是&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;就是作为协调器&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;coordinator=false&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;访问端口&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;可以自己指定&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http-server.http.port=7788&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;每个查询可以使用的最大分布式内存量。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory=12GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户内存量&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-memory-per-node=5GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查询可在任何一台计算机上使用的最大用户和系统内存量，其中系统内存是读取器，写入器和网络缓冲区等在执行期间使用的内存。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;query.max-total-memory-per-node=6GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;该参数默认值时&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;30%.&lt;/span&gt;&lt;span&gt;且这个值加上&lt;/span&gt;&lt;span&gt;query.max-total-memory-per-node&lt;/span&gt;&lt;span&gt;的值不能大于&lt;/span&gt;&lt;span&gt;-Xmx&lt;/span&gt;&lt;span&gt;的值&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;否则无法启动  &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;memory.heap-heaproom-per-node=2GB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;discovery-server&lt;/span&gt;&lt;span&gt;的地址&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这样&lt;/span&gt;&lt;span&gt;worker&lt;/span&gt;&lt;span&gt;才能找到它&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;与上面的端口须一致&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;discovery.uri=http://linux121:7788&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.11 &lt;span&gt;以&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;用户启动服务&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;如果是以&lt;/span&gt;root&lt;span&gt;用户就可以直接启动了&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;我们这里使用&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;用户启动&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;还需要进行下面的操作&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;须保证每台已存在&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;用户&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;presto&lt;span&gt;的数据目录&lt;/span&gt;&lt;span&gt;/file/data/presto&lt;/span&gt;&lt;span&gt;所有者修改为&lt;/span&gt;&lt;span&gt;presto:presto(&lt;/span&gt;&lt;span&gt;使用自己写的脚本一次性修改集群中每个节点&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 ~]# myssh chown -R presto:presto /file/data/presto/&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;presto&lt;span&gt;的安装目录&lt;/span&gt;&lt;span&gt;/opt/servers/presto-server-315&lt;/span&gt;&lt;span&gt;所有者修改为&lt;/span&gt;&lt;span&gt;presto:presto&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 ~]# myssh chown -R presto:presto /opt/servers/presto-server-315/&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.12 &lt;span&gt;启动&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;服务&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;分别在&lt;/span&gt;linux121,linux122,linux123&lt;span&gt;上启动&lt;/span&gt;&lt;span&gt;Presto Server(&lt;/span&gt;&lt;span&gt;为了连接&lt;/span&gt;&lt;span&gt;hive,&lt;/span&gt;&lt;span&gt;需要先要保证&lt;/span&gt;&lt;span&gt;Hive&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;metastore&lt;/span&gt;&lt;span&gt;是启动的&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;这里使用后台进程启动的命令&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux121 presto-server-315]$ bin/launcher start&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux122 presto-server-315]$ bin/launcher start&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux123 presto-server-315]$ bin/launcher start&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;说明&lt;/span&gt;:&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;若启动有问题去查看日志&lt;/span&gt;.&lt;span&gt;日志目录在前面指定的数据目录的&lt;/span&gt;&lt;span&gt;var/log&lt;/span&gt;&lt;span&gt;下&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;即&lt;/span&gt;&lt;span&gt;/file/data/presto/var/log&lt;/span&gt;&lt;span&gt;目录下&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.13 &lt;span&gt;启动成功后会看到多了一个&lt;/span&gt;&lt;span&gt;PrestoServer&lt;/span&gt;&lt;span&gt;进程&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux121 presto-server-315]$ jps&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;14881 PrestoServer&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.2.14 &lt;span&gt;访问&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;webui&lt;/span&gt;&lt;span&gt;界面&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;http://linux121:7788&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.45517241379310347&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLc2bicVBpvKShemp7ORBG6KHib1hO8aVtJ38R7WYrwSIqgVLuJE6B12RFvwzZ1icazk7dauHJhSK6wtQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;580&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.3 Presto&lt;span&gt;命令行&lt;/span&gt;&lt;span&gt;Client&lt;/span&gt;&lt;span&gt;的安装&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;&lt;span&gt;下载&lt;/span&gt;Presto&lt;span&gt;的客户端&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;下载&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;对应的版本&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;https://repo1.maven.org/maven2/io/prestosql/presto-cli/315/presto-cli-315-executable.jar&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;presto-cli-315-executable.jar&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;上传至服务器&lt;/span&gt;,&lt;span&gt;放在&lt;/span&gt;&lt;span&gt;linux121&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;/opt/servers/presto-server-315/bin&lt;/span&gt;&lt;span&gt;目录下&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3. &lt;/span&gt;&lt;span&gt;&lt;span&gt;为方便使用&lt;/span&gt;,&lt;span&gt;修改&lt;/span&gt;&lt;span&gt;jar&lt;/span&gt;&lt;span&gt;包名称为&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux121 bin]$ mv presto-cli-315-executable.jar presto&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;4. &lt;/span&gt;&lt;span&gt;&lt;span&gt;给文件增加执行权限&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 presto-server-315]# chmod +x presto&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.4 Presto&lt;span&gt;的基本使用&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;&lt;span&gt;启动&lt;/span&gt;presto&lt;span&gt;客户端并选择连接的数据源&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;这里以&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;为例&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[presto@linux121 presto-server-315]$ ./presto \&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--server linux121:7788 \&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--catalog hive \(&lt;span&gt;可选&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--schema test \(&lt;span&gt;可选&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--user xiaobai (&lt;span&gt;可选&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;说明&lt;/span&gt;:&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--server&lt;span&gt;指定的是&lt;/span&gt;&lt;span&gt;coordinator&lt;/span&gt;&lt;span&gt;的地址&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--catalog&lt;span&gt;指定的是连接的数据源&lt;/span&gt;&lt;span&gt;.(&lt;/span&gt;&lt;span&gt;跟配置文件里面的名称一致&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--schema&lt;span&gt;指定的是连接哪个数据库&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;这里是&lt;/span&gt;&lt;span&gt;test&lt;/span&gt;&lt;span&gt;数据库&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;Presto&lt;span&gt;命令行操作&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查看所有的数据库&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;presto:test&amp;gt; show schemas;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查看某个库下的所有表&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;presto:test&amp;gt; show tables;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;查看一条&lt;/span&gt;&lt;span&gt;sql&lt;/span&gt;&lt;span&gt;查询&lt;/span&gt;&lt;span&gt;(6&lt;/span&gt;&lt;span&gt;亿多条数据比&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;快很多&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;presto:test&amp;gt; select count(1) from test.test_hive;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;   _col0   &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-----------&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; 620756992&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.5 Presto&lt;span&gt;可视化客户端的安装&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;了解&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Presto&lt;span&gt;可视化客户端有多种&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;这里我们选择使用&lt;/span&gt;&lt;span&gt;yanagishima-20.0&lt;/span&gt;&lt;span&gt;版本&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;&lt;span&gt;将&lt;/span&gt;yanagishima-20.0.zip&lt;span&gt;安装包上传至&lt;/span&gt;&lt;span&gt;linux121&lt;/span&gt;&lt;span&gt;服务器上&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;&lt;span&gt;解压&lt;/span&gt;yanagishima-20.0.zip&lt;span&gt;安装包&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 software]# unzip yanagishima-20.0.zip -d /opt/servers&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;3. &lt;/span&gt;&lt;span&gt;&lt;span&gt;进入到&lt;/span&gt;/opt/servers/yanagishima-20.0/conf/&lt;span&gt;目录下&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;修改&lt;/span&gt;&lt;span&gt;yanagishima.properties&lt;/span&gt;&lt;span&gt;配置文件&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 conf]# vim yanagishima.properties&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;可以删除原文件的内容&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;然后重新填入下面的内容&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定&lt;/span&gt;&lt;span&gt;jetty&lt;/span&gt;&lt;span&gt;的端口&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;类似&lt;/span&gt;&lt;span&gt;tomcat&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;web&lt;/span&gt;&lt;span&gt;容器的一个组件&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;jetty.port=8080&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;#&lt;span&gt;指定数据源&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;presto.datasources=presto_test&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;presto.coordinator.server.presto_test=http://linux121:7788&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;catalog.presto_test=hive&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;schema.presto_test=ods&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;sql.query.engines=presto&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;4. &lt;/span&gt;&lt;span&gt;&lt;span&gt;启动&lt;/span&gt;yanagishima&lt;/span&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;[root@linux121 yanagishima-20.0]# nohup bin/yanagishima-start.sh 1&amp;gt;/dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;5. &lt;/span&gt;&lt;span&gt;webUI&lt;span&gt;访问界面&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;http://linux121:8080/&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6 &lt;span&gt;附录&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;补充知识&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6.1 &lt;span&gt;使用新版的&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;为其单独配置&lt;/span&gt;&lt;span&gt;jdk11&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在&lt;/span&gt;presto&lt;span&gt;的各集群节点上安装&lt;/span&gt;&lt;span&gt;jdk11.0.9(&lt;/span&gt;&lt;span&gt;注意不要配置&lt;/span&gt;&lt;span&gt;jdk11&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;JAVA_HOME.&lt;/span&gt;&lt;span&gt;这里是在&lt;/span&gt;&lt;span&gt;/opt/servers/jdk-11.0.9&lt;/span&gt;&lt;span&gt;目录下&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;然后在&lt;/span&gt;&lt;span&gt;$PRESTO_HOME/bin/launcher&lt;/span&gt;&lt;span&gt;文件中增加下面&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;行参数&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;PATH=/opt/servers/jdk-11.0.9/bin/:$PATH&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;注意&lt;/span&gt;:&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;一定要加在&lt;/span&gt;exec &quot;$(dirname &quot;$0&quot;)/launcher.py&quot; &quot;$@&quot;&lt;span&gt;之前&lt;/span&gt;&lt;span&gt;!!!&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;然后按照上面的配置好之后&lt;/span&gt;,&lt;span&gt;就可启动&lt;/span&gt;&lt;span&gt;presto&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6.2 &lt;span&gt;修改&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;访问&lt;/span&gt;&lt;span&gt;HDFS&lt;/span&gt;&lt;span&gt;的用户名&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;当&lt;/span&gt;Kerberos&lt;span&gt;没有与&lt;/span&gt;&lt;span&gt;HDFS&lt;/span&gt;&lt;span&gt;一起使用时&lt;/span&gt;&lt;span&gt;,Presto&lt;/span&gt;&lt;span&gt;默认将使用启动&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;进程的&lt;/span&gt;&lt;span&gt;OS&lt;/span&gt;&lt;span&gt;用户访问&lt;/span&gt;&lt;span&gt;HDFS(&lt;/span&gt;&lt;span&gt;即操作系统用户&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;例如&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;如果&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;是以&lt;/span&gt;&lt;span&gt;root&lt;/span&gt;&lt;span&gt;用户运行的 &lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;它访问&lt;/span&gt;&lt;span&gt;HDFS&lt;/span&gt;&lt;span&gt;的权限即为&lt;/span&gt;&lt;span&gt;root&lt;/span&gt;&lt;span&gt;用户的权限&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;如果需要修改该用户&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;可以在&lt;/span&gt;&lt;span&gt;$PRESTO_HOME/etc/jvm.config&lt;/span&gt;&lt;span&gt;中设置系统属性来覆盖默认使用的用户&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;比如以&lt;/span&gt;&lt;span&gt;xiaobai&lt;/span&gt;&lt;span&gt;用户来访问&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;增加如下&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;Shell&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-DHADOOP_USER_NAME=xiaobai&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6.3 Presto-338&lt;span&gt;版本之前查询&lt;/span&gt;&lt;span&gt;MySQL&lt;/span&gt;&lt;span&gt;时可能遇到的&lt;/span&gt;&lt;span&gt;Bug&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;在实际场景中&lt;/span&gt;,&lt;span&gt;我们对于&lt;/span&gt;&lt;span&gt;smallint,int&lt;/span&gt;&lt;span&gt;等整数类型的值都是使用的无符号类型的&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;所以它存的值比标准的会大一倍&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;这时如果使用&lt;/span&gt;&lt;span&gt;Presto&lt;/span&gt;&lt;span&gt;查询时可能会遇到&lt;/span&gt;&lt;span&gt;&quot;outside valid range...&lt;/span&gt;&lt;span&gt;的错误&lt;/span&gt;&lt;span&gt;&quot;.&lt;/span&gt;&lt;span&gt;这个问题在&lt;/span&gt;&lt;span&gt;338&lt;/span&gt;&lt;span&gt;版本中被修复&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;具体可参考&lt;/span&gt;&lt;span&gt;github&lt;/span&gt;&lt;span&gt;的代码&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://github.com/trinodb/trino/commit/ed1c554acf31db6bab9d2f971419e798ab15289a&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6.4 Presto WebUI&lt;span&gt;监控页面的含义&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.47586206896551725&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLc2bicVBpvKShemp7ORBG6KHAfVGBKoTEu5hkPm04WhRkSvHPWpOO0ryEtugwbk54LVbvrVHhzic1OQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;580&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.44310344827586207&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLc2bicVBpvKShemp7ORBG6KHkvOC0nnW5KHGXvwdRFy5e8pBQG9ibk5yN0PZqqEfy8M8s56WLWg60kQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;580&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.4793103448275862&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLc2bicVBpvKShemp7ORBG6KH3cDiaRg9ZT2brQUpRzMjXTVh6BES5wyS2oW8JKfGxRJ5WOqqUyRa2uw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;580&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.6.5 &lt;span&gt;使用&lt;/span&gt;&lt;span&gt;Presto sql&lt;/span&gt;&lt;span&gt;实现几个常见的&lt;/span&gt;&lt;span&gt;SQL&lt;/span&gt;&lt;span&gt;场景&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;场景&lt;/span&gt;1: &lt;span&gt;分组求&lt;/span&gt;&lt;span&gt;topN&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;SQL&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--1.&lt;span&gt;在&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;test&lt;/span&gt;&lt;span&gt;库下车间&lt;/span&gt;&lt;span&gt;presto1&lt;/span&gt;&lt;span&gt;表&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;create table hive.test.presto1(&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;sid&quot; int comment &#x27;&lt;span&gt;学生&lt;/span&gt;&lt;span&gt;id&#x27;,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;sname&quot; varchar(50) comment &#x27;&lt;span&gt;学生姓名&lt;/span&gt;&lt;span&gt;&#x27;,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;cname&quot; varchar(50) comment &#x27;&lt;span&gt;班级名称&lt;/span&gt;&lt;span&gt;&#x27;,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;total_score&quot; int comment &#x27;&lt;span&gt;考试总分&lt;/span&gt;&lt;span&gt;&#x27;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--2.&lt;span&gt;往表中插入数据&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;insert into hive.test.presto1 values(1101,&#x27;&lt;span&gt;孙悟空&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;1&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,500),(1102,&#x27;&lt;/span&gt;&lt;span&gt;猪八戒&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;1&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,600),(1103,&#x27;&lt;/span&gt;&lt;span&gt;如来佛祖&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;1&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,600)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,(1104,&#x27;&lt;span&gt;观音菩萨&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;2&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,480),(1105,&#x27;&lt;/span&gt;&lt;span&gt;姜子牙&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;2&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,500),(1106,&#x27;&lt;/span&gt;&lt;span&gt;李达康&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;2&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,550)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,(1107,&#x27;&lt;span&gt;王瞎子&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;3&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,500),(1108,&#x27;&lt;/span&gt;&lt;span&gt;姜子牙&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;3&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,500),(1109,&#x27;&lt;/span&gt;&lt;span&gt;凤姐&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;3&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,550),(1110,&#x27;&lt;/span&gt;&lt;span&gt;张无忌&lt;/span&gt;&lt;span&gt;&#x27;,&#x27;3&lt;/span&gt;&lt;span&gt;班&lt;/span&gt;&lt;span&gt;&#x27;,480)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--3.&lt;span&gt;查看数据&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;select * from hive.test.presto1;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--4.&lt;span&gt;计算出每个班级总分排在前&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;名的学生信息&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;分数相同就名次并列&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;如果第一名有&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;个并列&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;那么分数第&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;的就排名第&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;了&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;语法与&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;一模一样&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;sid&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,sname&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,cname&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,total_score&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;from&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;(&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        sid&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        ,sname&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        ,cname&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        ,total_score&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        ,rank() over(partition by cname order by total_score desc) as dn&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        from hive.test.presto1&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;)t1&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;where dn&amp;lt;=2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;场景&lt;/span&gt;2: &lt;span&gt;求连续&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;table cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;SQL&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--1.&lt;span&gt;创建&lt;/span&gt;&lt;span&gt;hive.test.presto2&lt;/span&gt;&lt;span&gt;表&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;create table hive.test.presto2(&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;user_id&quot; int comment &#x27;&lt;span&gt;用户&lt;/span&gt;&lt;span&gt;id&#x27;,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&quot;login_time&quot; varchar(50) comment &#x27;&lt;span&gt;登陆时间&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;精确到秒&lt;/span&gt;&lt;span&gt;&#x27;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--2.&lt;span&gt;往表中插入数据&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;insert into hive.test.presto2 values(1001,&#x27;2020-12-30 12:10:15&#x27;),(1001,&#x27;2020-12-30 13:10:15&#x27;),(1001,&#x27;2020-12-31 10:00:00&#x27;),(1001,&#x27;2021-01-01 15:00:00&#x27;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,(1002,&#x27;2020-12-25 12:10:15&#x27;),(1002,&#x27;2020-12-26 13:10:15&#x27;),(1002,&#x27;2020-12-27 10:00:00&#x27;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;,(1003,&#x27;2020-12-25 12:08:50&#x27;),(1003,&#x27;2020-12-25 13:10:15&#x27;),(1003,&#x27;2020-12-26 10:00:00&#x27;),(1003,&#x27;2020-12-26 11:00:00&#x27;),(1003,&#x27;2020-12-28 18:00:00&#x27;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--3.&lt;span&gt;查询表的数据&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;select * from hive.test.presto2 order by user_id,login_time;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;--4.&lt;span&gt;求出连续&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;天都有登陆的用户&lt;/span&gt;&lt;span&gt;id(&lt;/span&gt;&lt;span&gt;语法与&lt;/span&gt;&lt;span&gt;hive&lt;/span&gt;&lt;span&gt;有一些区别&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;distinct user_id&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;from&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;(&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        user_id&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        ,date_add(&#x27;day&#x27;,-rn,date(login_date)) as date_diff&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        from&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        (&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                user_id&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                ,login_date&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                ,row_number() over(partition by user_id order by login_date) as rn&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                from&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                (                         &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        select&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        user_id&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        ,format_datetime(cast(login_time as timestamp),&#x27;yyyy-MM-dd&#x27;) as login_date&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        from hive.test.presto2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                        group by user_id,format_datetime(cast(login_time as timestamp),&#x27;yyyy-MM-dd&#x27;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;                )t1&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        )t2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;)t3&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;group by  user_id,date_diff&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;having count(user_id)&amp;gt;=3&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;说明&lt;/span&gt;:&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;写&lt;/span&gt;sql&lt;span&gt;使用的工具是&lt;/span&gt;&lt;span&gt;dbeaver&lt;/span&gt;&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;presto.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;&lt;span&gt;投稿来自群友！！！&lt;/span&gt;&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;img data-type=&quot;gif&quot; class=&quot;__bg_gif&quot; data-ratio=&quot;0.08658008658008658&quot; data-w=&quot;462&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/dXCnejTRMLfaPKxaibsZ7cCiaozWvibvo25R8yoqsvvTmiaG2PAMap0daZ8F31icEtXsianE5bA67SQ5Lh1fAbT9yLvA/640?wx_fmt=gif&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486194&amp;amp;idx=1&amp;amp;sn=ec78e61a34dfaa54f2e78f67b3b7c765&amp;amp;chksm=ea68e03edd1f69289909e16fc98e735912069471d205cc00c232f959439cd6808ce7b5908548&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;2020大数据面试题真题总结(附答案)&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485691&amp;amp;idx=1&amp;amp;sn=d6cb1353031e07e4b02cd903d8b57911&amp;amp;chksm=ea68e237dd1f6b210f65f25ef42dabf4453d3bfa36fe8f33b149c0ff5329f77b9b792eef7882&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文探究数据仓库体系(2.7万字建议收藏)&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486497&amp;amp;idx=1&amp;amp;sn=4498d46a2d7e3a1b3eecd5bda171d3f5&amp;amp;chksm=ea68e6eddd1f6ffb7cb6b19263178fc0e5d1f564dd11eaf6f932c119904d65cb99b2dc613a90&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文探究Hadoop(3万字长文，建议收藏)&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485965&amp;amp;idx=1&amp;amp;sn=2fc0899c82dffe7721c55ad717cd2678&amp;amp;chksm=ea68e0c1dd1f69d70689408d9e9f66f00a638d851b9ffb50484d697ecf05f9b0f2989a10b80d&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文带你走进HIVE的世界(1.8W字建议收藏)&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486303&amp;amp;idx=1&amp;amp;sn=c1f58c14372ae9ba22dc9c464ae04143&amp;amp;chksm=ea68e193dd1f6885c3fa1903114ea62aa9f6ee4ee78384c667306fd815c37de9cf1fb300212a&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文带你全方位了解Flink(3.2W字建议收藏)&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485858&amp;amp;idx=1&amp;amp;sn=75a3a3dd71a612b5ac4412c423554787&amp;amp;chksm=ea68e36edd1f6a785b739bd2ec2f0cc94f5d3679ac40f631fbd61abad96e9652bea14cc705f5&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;你要悄悄学会HBase，然后惊艳所有人(1.7万字建议收藏)&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485999&amp;amp;idx=1&amp;amp;sn=b7e6e0aabb77504e920ff4342f44d26f&amp;amp;chksm=ea68e0e3dd1f69f56ac2c97839cf8d043d9b503b5461fe006fa14a9974375a386cd66000aadd&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文带你深入了解kafka并提供52道企业常见面试题(1.8W字建议收藏)&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486107&amp;amp;idx=1&amp;amp;sn=b1fb84db241e15defd91eb3a6a3699c9&amp;amp;chksm=ea68e057dd1f69411f72e646bdffd28d0ac1682ede5d613c698d5fff18f1b861de39627d86ea&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;非常全面的DolphinScheduler(海豚调度)安装使用文档&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485048&amp;amp;idx=1&amp;amp;sn=5fc1219f4947bea9743cd938cec510c7&amp;amp;chksm=ea68ecb4dd1f65a2df364d79272e0e472a394c5b13b5d55d848c89d9498ccb7ea78a933fbdea&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;Hive调优，数据工程师成神之路&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485039&amp;amp;idx=1&amp;amp;sn=140c3bc720da51765292fe3f5082fe38&amp;amp;chksm=ea68eca3dd1f65b5aef4d6f7ab0c33d3d3033bcc0eead1650be079687e0b4e898562bfe4d25b&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;数据质量那点事&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485186&amp;amp;idx=1&amp;amp;sn=85fbe5703c56aa2dcfd2980fccbab4f6&amp;amp;chksm=ea68edcedd1f64d8e2d8c3da6b456fcaa4b105f2216a2bddb2393a7380498166225de5e855b4&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;简述元数据管理&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247484074&amp;amp;idx=1&amp;amp;sn=f1b74ec65a9d0101cafb7741046e29f9&amp;amp;chksm=ea68e866dd1f61703304e4f01fb97d3b1f98aba6ea3fc5a9fb258b4c5e4e317d79edd7f15267&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;简单聊一聊大数据学习之路&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-type=&quot;png&quot; data-ratio=&quot;0.4259501965923984&quot; data-w=&quot;763&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLeibmoxSpRXUevnVIz4RyV0AUrglXsIgLOkFMNuffPAh5lZbwOnSoRHbZqT12VyKibm0EmnTicXBSRTg/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>379f4d913224a719e7f9c1af8dd37c00</guid>
<title>一个产品需求的研发流程是怎样的？</title>
<link>https://toutiao.io/k/fb90qrq</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;1. 前言&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以前在不足百人的小公司待过，产品需求的研发并没有什么正规的流程，通常是产品提了需求之后，技术部门简单评审一下就开始写代码，本地和测试环境没问题就直接发布线上了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;后来去了某二线互联网公司，&lt;span&gt;大概几千人。&lt;/span&gt;虽然跟一线大厂还差很多，但需求的研发流程跟大厂大同小异。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;前段时间运营小姐姐找我了解一些开发相关的内容，&lt;/span&gt;&lt;span&gt;就跟她讲到了我们的开发流程。&lt;/span&gt;&lt;span&gt;这里简单做个小结。&lt;/span&gt;&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;2. 整体概述&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个相对完整的需求研发流程大致如下图所示：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7219123505976096&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_jpg/ophTb90oYCRicibRwUEawU6RuBbhnTtd3ZERMVO7oczeic36Yj88fVoTFS8kBPpK1fKkTc8ySBamkOLgyZVvfSNFQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1255&quot;/&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;PS: 该流程仅供参考，不同公司可能会有所不同，但主流程大体相似。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面简要介绍各个环节的主要内容。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;3. 流程分析&lt;/span&gt;&lt;/h1&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;0. 产品提出需求&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;产品通常是对接「运营」和「研发」的，是运营和研发之间的桥梁。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;运营过程中产生的需求一般会反馈给产品，产品把需求的主要功能整理成需求文档（Product Requirements Document, PRD），并画出产品原型图（常用工具：Axure）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;PRD 通常主要包含：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;需求背景。就是为什么要做这个需求？想要达成怎样的目的？&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;需求细节。各部分如何实现，包括业务逻辑以及如何交互等。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;1. PRD 评审&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;PRD 完成之后，产品经理（或者项目经理）就约一个会议室，邀请开发、测试、运营、交互设计师等人一起开会，详细说明本次需求，主要是讨论需求的可行性，比如技术能否实现、逻辑是否有问题等。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;2. 交互评审&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;产品给出的原型图可能不够具体，细节部分就要由交互设计师来出设计稿了（常用工具：Sketch、Figma 等）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如某个按钮具体放到哪里、宽高多少、颜色值多少、点击后如何跳转，等等。&lt;span&gt;然后设&lt;/span&gt;&lt;span&gt;计师会根据设计稿切图并给到前端开发人员。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;3. 技术评审&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;就是确定技术方案，这部分工作就要由我们开发人员来主导了。主要包括如下部分：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;需求整体可以分为哪几个模块？&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;需要哪些业务方配合？是否需要对接二方、三方？&lt;span&gt;各业务方之间是如何交互的？&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;表结构如何设计？&lt;span&gt;接口如何定义？&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;有没有技术难点？&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;主要是开发同学向大家阐述详细的技术实现方案，评估一下是否有不合理之处。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;&lt;span&gt;对于架构图、流程图和时序图，常用画图工具有 ProcessOn、draw.io、OmniGraffle、StarUML 等。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;4. 开发测试排期&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过技术评审，一个需求具体有多少工作量大致就可以确定了。&lt;span&gt;此时就要给出一个比较详细的排期了，主要包括：&lt;/span&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;开发时间：单纯的开发「总人时」需要多久（时间通常以 0.5 天/人、或者 0.25 天&lt;span&gt;/人&lt;/span&gt;为单位）&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;联调时间：前后端联调、后端跟其他第二方、第三方联调需要多久&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;提测时间：哪天可以交付测试同学进行测试（如果需求比较紧急，可以分批提测，也就是拆分成不同的功能模块提测）&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;测试时间：通常包括测试环境、预发布环境、生产环境回归测试，这几个时间都要算上&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通常「开发排期 + 联调排期 + 测试排期」就是这个需求的实施时间，这几个时间确定之后需求的发布上线时间基本就定了。但也要考虑到期间可能产生的一些意外情况。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;5. 输出技术文档&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;技术评审需要输出技术文档，把此次需求使用哪些技术、增加哪些配置、设计哪些表记录下来，涉及到流程图、架构图也要形成文档，以便过段时间之后再看，或者后面交接给其他人维护。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此外，后端开发通常还要先给出接口定义、入参出参等（该过程可以前后端讨论确定），以便前端同学 Mock 数据。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;6. 测试用例评审&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试同学把本期需求的功能点全部列出来，向大家说明自己如何去测试、期望得到怎样的结果等。如果有的接口对 QPS、RT 等要求较高，一般会进行「压测」来确定是否满足要求。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;&lt;span&gt;有点类似测试的“技术评审”。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;7. 前后端各自开发&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这时候总算可以撸代码了！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前后端按照之前的接口定义各自开发。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;8. 前后端联调&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开发分别在本地自测以后，前后端一起走下整体流程。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;PS: 有时候提测之前测试同学会给出一个冒烟测试用例&lt;span&gt;（非必须）&lt;/span&gt;，通常是主流程和一些核心部分逻辑，当这些地方都没问题时，才可以提测。&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;9. 提测&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;提测就是正式告诉测试同学这个需求已经初步开发完成，可以进行测试了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一般以邮件的形式告知，包含相关测试同学、项目经理、开发、产品等人，以便各方了解项目进度。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;PS: &lt;span&gt;如有特殊情况导致延期，需要提前发邮件告知各需求方延期的原因。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;10. 测试环境测试&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试同学在测试环境按照之前的测试用例各种测、各种找 bug……改 bug……找 bug……改 bug……&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;bug 整体改完之后，会叫产品经理初步验收一下是否符合预期。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;11. 预发布环境测试&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试环境的数据可能不够正式，主要是用来测试各个流程能够走通。而到了预发布环境，各种配置和数据库就跟生产环境基本一致了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果预发布环境没问题，就准备发布生产环境了。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;12. 发布生产环境&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;发布生产环境之前，通常是需要做些准备工作的：比如创建数据表、新增配置等，通常要运维同学配合添加和修改（因为开发通常没这个权限）。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;13. 线上回归测试&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;发布成功之后，测试同学需要进行回归测试，也就是在生产环境把需求再验证一次。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;全部通过之后，就叫产品正式验收了，产品觉得 OK，才能说明这次需求 OK 的。&lt;span&gt;产品点头之后，这个&lt;/span&gt;&lt;span&gt;需求才算真正开发完成。&lt;/span&gt;&lt;span&gt;之后可能还会有些其他收尾工作，但非必须。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;14. 项目复盘总结&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这部分并非必须。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一般在需求过程中问题比较多时，会复盘一下问题主要出在哪里，以后如何规避等。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;15. 需求完成&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;至此，一个比较完整的需求研发流程就结束了。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;4. 补充说明&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;1. Code Review&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通常的 Code Review 在测试环境流程通过之后。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虽然经过测试功能上没问题了，但代码中可能潜藏一些问题难以测出来。此时可以叫几个开发小哥还有老大，一起找个地方把关键部分的代码 Review 一下，看是否有潜在的漏洞，或者代码在哪部分写得不够合理。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这部分做好的话其实对个人成长帮助挺大的，但有些公司可能会忽略这部分，尤其是排期紧张的时候。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;2. 说明&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上述流程只是根据个人平时开发经历总结的，仅供参考。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;若需求比较简单，可能会把一些步骤省略掉。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;PS: 运营小姐姐说此前还觉得我们做需求应该很快，不明白为啥开发一个需求要这么久，待我跟她讲完开发流程，她保证以后再也不催我们了。&lt;/p&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>15555f3d314b903a2e862883b6e608b7</guid>
<title>CTO 们邀请你加入码农周刊 VIP，升职加薪不再难！</title>
<link>https://toutiao.io/k/z9xjxc0</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;码农周刊 VIP 新年特惠&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;原价 365 元/年&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;，现价仅需 108 元！&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;全年 52 期「VIP 会员专属邮件周报」&lt;br/&gt;只限 VIP 会员加入的交流圈子&lt;br/&gt;大厂「内推机会」&lt;br/&gt;N 多福利，你值得拥有！&lt;br/&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;CTO 们邀请你加入码农周刊 VIP，升职加薪不再难！&lt;br/&gt;↓↓↓&lt;/strong&gt;&lt;strong/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-cropselx1=&quot;31&quot; data-cropselx2=&quot;291&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;350&quot; data-ratio=&quot;1.0857487922705313&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/AjN1jquNav9LRTqibic3sUoh5tv76OXCpNTWbZ0gCYsFDShjwfRVvM157WDel2cr2dy5ghjxDCCwRc2Mu8bgehnA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;828&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;「码农周刊 VIP 会员」是什么？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;简介版&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;码农周刊 VIP 会员 = 全年 52 期「VIP 会员专属邮件周报」 + 只限 VIP 会员加入的交流圈子 + 大厂「内推机会」 + N 多福利&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;详细版&lt;/span&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;点击「阅读原文」即可查看详细介绍&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;CTO 们邀请你加入码农周刊 VIP，升职加薪不再难！&lt;br/&gt;↓↓↓&lt;/strong&gt;&lt;strong/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-cropselx1=&quot;31&quot; data-cropselx2=&quot;291&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;350&quot; data-ratio=&quot;1.0857487922705313&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/AjN1jquNav9LRTqibic3sUoh5tv76OXCpNTWbZ0gCYsFDShjwfRVvM157WDel2cr2dy5ghjxDCCwRc2Mu8bgehnA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;828&quot;/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3ce1ac70e452eda94cc89469e628a2d6</guid>
<title>软件架构基础（一）：架构师的 8 大核心能力</title>
<link>https://toutiao.io/k/mk9kqnq</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;strong data-darkmode-bgcolor-16068282692859=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16068282692859=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16068282692859=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16068282692859=&quot;rgb(0, 0, 0)&quot; data-style=&quot;font-size: medium; white-space: normal; caret-color: rgb(52, 73, 94); max-width: 100%; color: rgb(0, 0, 0); font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; text-align: left; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__1&quot; data-darkmode-color-16094149065186=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16094149065186=&quot;rgb(0, 0, 0)&quot;&gt;&lt;span data-darkmode-bgcolor-16068282692859=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16068282692859=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16068282692859=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16068282692859=&quot;rgb(136, 136, 136)&quot; data-darkmode-color-16094149065186=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16094149065186=&quot;rgb(136, 136, 136)&quot;&gt;&lt;span data-darkmode-bgcolor-16068282692859=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16068282692859=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16068282692859=&quot;rgb(217, 33, 66)&quot; data-darkmode-original-color-16068282692859=&quot;rgb(217, 33, 66)&quot; data-darkmode-color-16094149065186=&quot;rgb(217, 33, 66)&quot; data-darkmode-original-color-16094149065186=&quot;rgb(217, 33, 66)&quot;&gt;▲ &lt;/span&gt;&lt;span data-darkmode-bgcolor-16068282692859=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16068282692859=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16068282692859=&quot;rgb(39, 84, 255)&quot; data-darkmode-original-color-16068282692859=&quot;rgb(2, 30, 170)&quot; data-style=&quot;max-width: 100%; color: rgb(2, 30, 170); text-align: center; font-size: 11px; letter-spacing: 1px; visibility: visible;&quot; class=&quot;js_darkmode__2&quot; data-darkmode-color-16094149065186=&quot;rgb(39, 84, 255)&quot; data-darkmode-original-color-16094149065186=&quot;rgb(2, 30, 170)&quot;&gt;点击上方&quot;多颗糖&quot;&lt;/span&gt;&lt;span data-darkmode-bgcolor-16068282692859=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16068282692859=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16068282692859=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16068282692859=&quot;rgb(62, 62, 62)&quot; data-style=&quot;max-width: 100%; color: rgb(62, 62, 62); text-align: center; font-size: 11px; letter-spacing: 1px; visibility: visible;&quot; class=&quot;js_darkmode__3&quot; data-darkmode-color-16094149065186=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16094149065186=&quot;rgb(62, 62, 62)&quot;&gt;关注公众号&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;《软件架构基础（Fundamentals of Software Architecture）》被誉为和《设计数据密集型应用》一样经典的后端书籍，架构师的入门指南。本篇为该书第一章的读书笔记，2021 年第一个目标就是和大家一起读完这本书。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.3226600985221675&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhB7Jv4gHI8AQBGRolrSlMMhNLvV32cmZA51czvSH8fvIKDFFEfibRexMw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;812&quot;/&gt;&lt;/p&gt;&lt;p&gt;如今，全球范围内“架构师”这一头衔炒得十分火热，但没有真正的指南来帮助开发人员成为软件架构师。&lt;/p&gt;&lt;p&gt;这本书主要有三部分内容：基础、架构风格、技术和软技能。基础部分是关于软件体系结构的一般概念；架构风格部分介绍了不同的架构风格，并以一些架构特征标准进行评价；技术和软技能部分涵盖了很多好的概念，包括做出健康的架构决策、风险分析技术、演讲能力、管理团队关系、谈判、架构师职业规划等。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;架构就是关于重要的东西......不管那是什么。—— Ralph Johnson&lt;/p&gt;&lt;/blockquote&gt;&lt;h2&gt;1. 什么是软件架构&lt;/h2&gt;&lt;p&gt;学习架构就像学习艺术一样，读者必须要在特定的背景下去理解它。&lt;/p&gt;&lt;p&gt;在一个动态系统中，不存在一劳永逸的解决方案。&lt;/p&gt;&lt;p&gt;学习架构时，必须放在上下文中理解。架构师做的许多决定都是基于他们所处的实际情况。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;例如，在 20 世纪末的主要目标是有效地利用共享资源，因为当时所有的基础设施都是昂贵的商业化产品：操作系统、服务器和数据库等等。如果你在 2002 年告诉主管，“我有一个革命性的架构好主意，每个服务都运行在自己隔离的机器上，有自己的专用数据库……（即描述今天的微服务架构）所以，我需要 50 个 Windows 的许可证，另外 30 个服务器许可证，以及至少 50 个数据库许可证。”在 2002 年想构建这样的微服务架构成本之高难以想象。然而这几年，随着开源运动的兴起，以及 DevOps 的出现，我们可以合理地构建一个如上所述的架构。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;整个行业都在努力精确定义“软件架构”，有些称为系统的蓝图，有些定义为开发的路线图。本书关于架构的定义主要从四个方面：&lt;/p&gt;&lt;h4&gt;&lt;span&gt;系统的结构指的是系统实现架构风格的类型（如微服务、分层或微内核）。但仅仅通过结构来描述一个架构，并不能完全阐明一个架构。&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6964924838940587&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhBtCQv2FHH8A6vamHZ2QefZNwC81bWiagAsaeh6ZiaGQQV13N54JYOhl4Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1397&quot;/&gt;&lt;/p&gt;&lt;p&gt;￼&lt;/p&gt;&lt;h4&gt;&lt;span&gt;架构特性多以 &quot;&lt;em&gt;-ility&lt;/em&gt;&quot; 结尾（例如 Availability、Scalability）&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6964924838940587&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhBTlkT7LCZeO3Z7oYrmvVjQ3eMMMeKVEnW2LRuLE276F4x7hjHcwIVEw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1397&quot;/&gt;&lt;/p&gt;&lt;p&gt;￼&lt;/p&gt;&lt;h4&gt;&lt;span&gt;架构决策定义了系统应该如何构建的规则。例如，架构师可能会做出一个架构决策，即在分层架构中只有业务层和服务层可以访问数据库（见图），限制表现层直接调用数据库。架构决策形成了系统的约束，并指导开发团队什么是允许的，什么是不允许的。&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7050823192555477&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhBfBo6ZbhHUk7MEmKf8GFa46NR2XxKdFmmWjDnicVdyA0McNOSyRN8a7w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1397&quot;/&gt;&lt;/p&gt;&lt;p&gt;￼&lt;/p&gt;&lt;h4&gt;&lt;span&gt;设计原则与架构决策的不同之处在于，设计原则是一个指导方针，而不是一个硬性规定。例如，图示的设计原则指出，开发团队应该在微服务架构中的服务之间传递异步消息来提高性能。一个架构决策永远不可能涵盖服务之间通信的每一个条件和选项，设计原则为首选方法（在本例中，异步消息传递）提供指导，允许开发人员在特定情况下选择更合适的通信协议（如 REST 或 gRPC）。&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6964924838940587&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhBVjS7UVDeyUxohJFdVrMK50jISI59tibmArclDTkcn9NktyZYwtibW1Ng/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1397&quot;/&gt;&lt;/p&gt;&lt;p&gt;￼&lt;/p&gt;&lt;h2&gt;2. 对架构师的 8 个期待&lt;/h2&gt;&lt;h3&gt;2.1 做出架构决定&lt;/h3&gt;&lt;p&gt;架构师应确定架构和设计原则，用于指导团队、部门或整个企业的技术决策。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;架构师应该指导而不是指定技术选择&lt;/strong&gt;。例如，架构师应该决定开发团队使用基于响应式 (Reactive) 的框架进行开发，从而指导开发团队在 Angular、Elm、React.js、Vue 或其他任何基于响应式的 Web 框架之间做出选择。&lt;/p&gt;&lt;p&gt;架构师偶尔需要做出特定的技术决策，以保留特定的架构特性，如可扩展性、性能或可用性。&lt;/p&gt;&lt;p&gt;架构师经常为找到正确的界线而苦恼。&lt;/p&gt;&lt;h3&gt;2.2 持续分析架构&lt;/h3&gt;&lt;p&gt;多数架构都会经历结构性衰变，当开发人员进行编码或设计变更时，会影响到所需的架构特性，如性能、可用性和可扩展性。架构师需要评估三年或更长时间前定义的架构在今天的可行性。&lt;/p&gt;&lt;p&gt;另一方面，架构师还常常忘记测试和发布环境。敏捷性有很大的好处，如果团队需要几周的时间来测试变更，而发布又需要几个月的时间，那么架构师就无法实现整体架构的敏捷性。&lt;/p&gt;&lt;h3&gt;2.3 紧跟最新趋势&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;架构师要跟上最新的技术和行业趋势。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;开发人员必须掌握他们每天使用的最新技术，以保持代码能力(并保住一份工作！)。架构师有一个更关键的要求，就是要掌握最新的技术和行业趋势。架构师所做的决定往往是长期的，难以改变的，了解和跟踪关键趋势有助于架构师为未来做好准备，做出正确的决定。&lt;/p&gt;&lt;h3&gt;2.4 确保遵守各项决定&lt;/h3&gt;&lt;p&gt;架构师要不断验证开发团队是否遵循架构师定义、记录和传达的架构决策和设计原则。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;考虑这样的场景：架构师做出一个决定，在分层架构中限制对数据库的访问，只限于业务层和服务层（而不是表现层）。这意味着表现层必须经过架构的所有层才能进行最简单的数据库调用。用户界面开发人员可能不同意这个决定，出于性能考虑而直接访问数据库。然而，架构师做出这个架构决策是有特定原因的：控制变化。通过保持各层独立，可以在不影响表现层的情况下进行数据库变更。如果不确保架构决策的合规性，就会发生类似这样的违规行为，架构将无法满足所需的架构特性，应用程序或系统将无法按预期工作。&lt;/p&gt;&lt;/blockquote&gt;&lt;h3&gt;2.5 多样化的接触和经验&lt;/h3&gt;&lt;p&gt;架构师要接触多种多样的技术、框架、平台和环境。&lt;/p&gt;&lt;p&gt;现在的大多数环境都是异构的，一个架构师至少应该知道如何与多个系统和服务对接，不管这些系统或服务是用什么语言、平台和技术编写的。&lt;/p&gt;&lt;p&gt;最好方法之一是让架构师延伸自己的舒适区，只关注单一技术或平台是一个安全的避风港，一个好的软件架构师应该积极寻找机会，以获得多种语言、平台和技术的经验，关注技术广度而不只是技术深度。&lt;/p&gt;&lt;h3&gt;2.6 具备业务领域知识&lt;/h3&gt;&lt;p&gt;一个架构师要有一定的业务领域专业知识。&lt;/p&gt;&lt;p&gt;有效的软件架构师不仅了解技术，还了解业务问题。&lt;strong&gt;如果没有业务领域的知识，就很难理解业务问题、目标和需求，很难设计出满足业务需求的有效架构。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;最成功的架构师是那些拥有广泛的、实践性的技术知识，再加上对某一特定领域的深刻了解的人。这些软件架构师能够使用这些利益相关者所能理解的领域知识和语言，与主管和业务用户进行有效的沟通。&lt;/p&gt;&lt;h3&gt;2.7 具备人际交往能力&lt;/h3&gt;&lt;p&gt;架构师应具备卓越的人际交往能力，包括团队合作、促进和领导能力。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;拥有卓越的领导力和人际交往能力是大多数开发人员和架构师难以企及的期望&lt;/strong&gt;。作为技术专家，开发人员和架构师喜欢解决技术问题，而不是人的问题。&lt;/p&gt;&lt;p&gt;架构师不仅要为团队提供技术指导，还要带领开发团队完成架构的实施。无论架构师的角色和头衔是什么，领导能力是成为一个软件架构师不可或缺的。&lt;/p&gt;&lt;h3&gt;2.8 理解和驾驭企业政治&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;架构师要了解企业的政治氛围，并能驾驭政治。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;在一本关于软件架构的书中谈论谈判和驾驭办公室政治，可能看起来比较奇怪。主要的一点是，&lt;strong&gt;几乎架构师的每一个决策都会受到挑战&lt;/strong&gt;。由于涉及到成本或工作量（时间）的增加，架构决策会受到产品、项目经理、开发和业务利益相关者的挑战，因为他们觉得自己的方法更好。无论在哪种情况下，架构师都必须驾驭公司的政治，并应用基本的谈判技巧来获得批准。&lt;/p&gt;&lt;p&gt;架构师不像开发，可以自行设计代码结构、类、设计模式甚至是语言而不需要批准，架构师做出广泛而重要的决策，必须为几乎每一个决策进行论证和争取。&lt;/p&gt;&lt;h2&gt;3. 架构师和其它的交集&lt;/h2&gt;&lt;h3&gt;3.1 工程实践&lt;/h3&gt;&lt;p&gt;将软件开发过程与软件工程实践分开是有益的。所谓过程，我们指的是如何组建和管理团队，如何进行会议以及工作流组织，指的是人们如何组织和互动的机制。而&lt;strong&gt;软件工程实践则是指那些已经说明了的、可重复效益的与过程无关的实践。&lt;/strong&gt;例如，持续集成是一种经过验证的工程实践，它不依赖于特定的过程。&lt;/p&gt;&lt;p&gt;注重工程实践很重要：&lt;/p&gt;&lt;p&gt;unknown unknowns 是软件系统的克星：没有人知道会出现的东西，却又意外地出现了。例如：某个意外的 bug 出现。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;所有的架构都会因为 unknown unknowns 而变成迭代式的，敏捷只是认识到了这一点，并且更早去做了。（All architectures become iterative because of unknown unknowns, Agile just recognizes this and does it sooner.）&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;迭代流程更符合软件架构的本质，试图使用像瀑布这样的陈旧流程来构建微服务这样的现代系统的团队会发现，一个陈旧的流程忽视了软件如何结合在一起的现实，会产生大量的摩擦。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.54177897574124&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA1sLqkl0nicPpFFBzwPJGIhBKiaGewtzqYY6nq5aibPYnrfV4gPsK1xsTiahKjQlvRUXXK8SMCono5EUQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;742&quot;/&gt;&lt;/p&gt;&lt;p&gt;￼&lt;/p&gt;&lt;p&gt;如图所示，&lt;strong&gt;软件系统的架构由需求和所有其他架构特征组成&lt;/strong&gt;。&lt;/p&gt;&lt;p&gt;采用敏捷工程实践，如持续集成、自动机器供应和类似的实践，使构建弹性架构变得更容易。这也说明了架构与工程实践是如何相互交织在一起的。&lt;/p&gt;&lt;h3&gt;3.2 运维/DevOps&lt;/h3&gt;&lt;p&gt;架构和相关领域之间最近最明显的交集发生在 DevOps 的出现。许多公司认为运维是与软件开发是分离的，在 20 世纪 90 年代和 2000 年代设计的架构都假设架构师无法控制运维，架构师们被迫围绕引入的限制进行防御性设计。因此，他们构建了能够在内部处理规模、性能、弹性和其他一系列能力的架构。这种设计的副作用是大大增加了架构的复杂性。&lt;/p&gt;&lt;p&gt;微服务风格架构的构建者们意识到，通过在架构和运维之间建立一个联络点，架构师可以简化设计，依靠运维来处理他们最擅长的事情。因此，意识到资源的挪用导致了意外的复杂性，架构师和运维合作创建了微服务。&lt;/p&gt;&lt;h3&gt;3.3 流程&lt;/h3&gt;&lt;p&gt;软件架构与软件开发过程大多是正交的（相互不可替代的），大多数关于软件架构的书籍都忽略了软件开发过程。例如，在过去的几十年里，由于软件的性质，许多公司都采用了敏捷开发方法。架构师在敏捷项目中得到更快的反馈，这使得架构师可以更积极地进行实验。&lt;/p&gt;&lt;p&gt;所有的架构都会变成迭代式的，这只是时间问题。为此，我们要在整个过程中假设敏捷方法论的基线，并允许适当的例外。例如，许多单体架构因为年龄、政治或其他与软件无关的因素而使用旧流程的情况还是很常见的。&lt;/p&gt;&lt;h3&gt;3.4 数据&lt;/h3&gt;&lt;p&gt;很大一部分严肃的应用程序开发包括外部数据存储，通常采用关系型(或越来越多的 NoSQL)数据库的形式。然而，许多关于软件架构的书籍只对架构的这一重要方面进行了轻描淡写的处理。代码和数据具有共生关系：两者缺一不可。&lt;/p&gt;&lt;h2&gt;4. 软件架构法则&lt;/h2&gt;&lt;p&gt;软件架构第一定律：&lt;br/&gt;&lt;strong&gt;软件架构中的所有东西都是一种权衡。(Everything in software architecture is a trade-off.)&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;我们对软件架构的定义超越了结构的范畴，包含了原则、特性等，架构的范围比单纯的结构更广，体现在我们的软件架构第二定律中：&lt;br/&gt;&lt;strong&gt;为什么比怎么做更重要。（Why is more important than how.）&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;欢迎关注我的公众号：&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.36484375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hBL5R2neMA2qgPwzomIicebbmoOGzU1IsUWQMb3xr4nLcjtfIy5Zwyia3HTKnIJ8xc9NFkkPBkL8MEAfh3YdNuaQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3896b73c77f2d7ee3107b531ede24c4a</guid>
<title>k8s 学习之路（一）：安装</title>
<link>https://toutiao.io/k/cr25auq</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;什么是 Kubernetes&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;随着微服务架构被越来越多的公司使用，大部分单体应用正逐步被拆解成小的、独立运行的微服务。微服务的优势这里不做探讨，但是其带来的服务维护问题大大增加，若想要在管理大量微服务的情况下还需要让资源利用率更多且硬件成本相对更低，那么基于容器部署的微服务的一些自动化设施的需求就这样诞生了，于是就有了 Kubernetes，其提供的特性有：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;服务发现和负载均衡&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;存储编排&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;自动发布和回滚&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;自愈&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;密钥及配置管理&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;安装&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;单机安装&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于单机安装&lt;code&gt;k8s&lt;/code&gt;，我使用的相关环境如下：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;macOS：Catalina 10.15.1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Docker Desktop Vesion：3.0.2&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Kubernetes：1.19.3&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由于镜像的下载涉及到网络原因，因此这里使用了开源项目&lt;span&gt;k8s-docker-desktop-for-mac&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;来解决这个问题，需要注意的是要修改&lt;code&gt;images&lt;/code&gt;的相关镜像的版本，要和此时&lt;code&gt;Kubernetes&lt;/code&gt;配对上才行，比如我设置的是：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;k8s.gcr.io/kube-proxy:v1.19.3=gotok8s/kube-proxy:v1.19.3&lt;br/&gt;k8s.gcr.io/kube-controller-manager:v1.19.3=gotok8s/kube-controller-manager:v1.19.3&lt;br/&gt;k8s.gcr.io/kube-scheduler:v1.19.3=gotok8s/kube-scheduler:v1.19.3&lt;br/&gt;k8s.gcr.io/kube-apiserver:v1.19.3=gotok8s/kube-apiserver:v1.19.3&lt;br/&gt;k8s.gcr.io/coredns:1.7.0=gotok8s/coredns:1.7.0&lt;br/&gt;k8s.gcr.io/pause:3.2=gotok8s/pause:3.2&lt;br/&gt;k8s.gcr.io/etcd:3.4.13-0=gotok8s/etcd:3.4.13-0&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;随后打开&lt;code&gt;Docker&lt;/code&gt;，进入设置界面，勾选&lt;code&gt;Enable Kubernetes&lt;/code&gt;即可：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3861003861003861&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP70wxWBibs0Tt5lvp2afKeoQmYUdd0czyIVlJK0iaZwBjFMLw6a5h7BCCw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2072&quot;/&gt;&lt;figcaption&gt;image-20201220195307360&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不出意外，界面左下角会出现&lt;code&gt;Kubernetes running&lt;/code&gt;的提示，这样就安装成功了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果状态一直处于&lt;code&gt;Kubernetes starting&lt;/code&gt;状态，可在终端执行以下命令然后重启&lt;code&gt;Docker&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;rm -rf ~/.kube&lt;br/&gt;rm -rf ~/Library/Group\ Containers/group.com.docker/pki/&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;集群安装&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;准备&lt;span/&gt;&lt;/h4&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;准备三台机器，比如（使用的配置是 4 核 8G，IP 换成你自己的）：&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;执行：&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;hostnamectl set-hostname node02&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;echo &quot;127.0.0.1 $(hostname)&quot; &amp;gt;&amp;gt; /etc/hosts&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行：&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;hostnamectl set-hostname node01&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;echo &quot;127.0.0.1 $(hostname)&quot; &amp;gt;&amp;gt; /etc/hosts&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行：&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;hostnamectl set-hostname master&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;echo &quot;127.0.0.1 $(hostname)&quot; &amp;gt;&amp;gt; /etc/hosts&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;192.16.0.11：Master：&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;192.16.0.12：Node01&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;192.16.0.13：Node02&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Kubernetes 版本：v1.19.3&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Docker 版本：19.03.12&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开始前请检查以下事项：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;CentOS 版本&lt;/span&gt;：&amp;gt;= 7.6&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;CPU&lt;/span&gt;：&amp;gt;=2&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;em&gt;IP&lt;/em&gt;：互通&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;关闭&lt;span&gt;swap&lt;/span&gt;：&lt;code&gt;swapoff -a&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;配置国内 kubernetes 源：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;cat &amp;gt; /etc/yum.repos.d/kubernetes.repo &amp;lt;&amp;lt;EOF&lt;br/&gt;[kubernetes]&lt;br/&gt;name=Kubernetes&lt;br/&gt;baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/&lt;br/&gt;enabled=1&lt;br/&gt;gpgcheck=1&lt;br/&gt;repo_gpgcheck=1&lt;br/&gt;gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg&lt;br/&gt;EOF&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;安装相关依赖工具：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;yum install -y kubelet-1.19.3 kubeadm-1.19.3 kubectl-1.19.3&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 设置开机启动&lt;/span&gt;&lt;br/&gt;systemctl enable kubelet.service &amp;amp;&amp;amp; systemctl start kubelet.service&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 查看状态&lt;/span&gt;&lt;br/&gt;systemctl status kubelet.service&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;初始化 Master&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在主节点（&lt;code&gt;192.16.0.11&lt;/code&gt;）执行以下命令：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;export&lt;/span&gt; MASTER_IP=192.168.5.91&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; APISERVER_NAME=apiserver.demo&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; POD_SUBNET=10.100.0.1/16&lt;br/&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;span&gt;${MASTER_IP}&lt;/span&gt;    &lt;span&gt;${APISERVER_NAME}&lt;/span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/hosts&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;新建脚本&lt;code&gt;init_master.sh&lt;/code&gt;:&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;vim init_master.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;添加：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;#!/bin/bash&lt;br/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 只在 master 节点执行&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 脚本出错时终止执行&lt;/span&gt;&lt;br/&gt;&lt;span&gt;set&lt;/span&gt; -e&lt;br/&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; [ &lt;span&gt;${#POD_SUBNET}&lt;/span&gt; -eq 0 ] || [ &lt;span&gt;${#APISERVER_NAME}&lt;/span&gt; -eq 0 ]; &lt;span&gt;then&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;echo&lt;/span&gt; -e &lt;span&gt;&quot;\033[31;1m请确保您已经设置了环境变量 POD_SUBNET 和 APISERVER_NAME \033[0m&quot;&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;echo&lt;/span&gt; 当前POD_SUBNET=&lt;span&gt;$POD_SUBNET&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;echo&lt;/span&gt; 当前APISERVER_NAME=&lt;span&gt;$APISERVER_NAME&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;exit&lt;/span&gt; 1&lt;br/&gt;&lt;span&gt;fi&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 查看完整配置选项 https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2&lt;/span&gt;&lt;br/&gt;rm -f ./kubeadm-config.yaml&lt;br/&gt;cat &amp;lt;&amp;lt;EOF &amp;gt; ./kubeadm-config.yaml&lt;br/&gt;apiVersion: kubeadm.k8s.io/v1beta2&lt;br/&gt;kind: ClusterConfiguration&lt;br/&gt;&lt;span&gt;# k8s 版本&lt;/span&gt;&lt;br/&gt;kubernetesVersion: v1.19.3&lt;br/&gt;imageRepository: registry.aliyuncs.com/k8sxio&lt;br/&gt;controlPlaneEndpoint: &lt;span&gt;&quot;&lt;span&gt;${APISERVER_NAME}&lt;/span&gt;:6443&quot;&lt;/span&gt;&lt;br/&gt;networking:&lt;br/&gt;  serviceSubnet: &lt;span&gt;&quot;10.96.0.0/16&quot;&lt;/span&gt;&lt;br/&gt;  podSubnet: &lt;span&gt;&quot;&lt;span&gt;${POD_SUBNET}&lt;/span&gt;&quot;&lt;/span&gt;&lt;br/&gt;  dnsDomain: &lt;span&gt;&quot;cluster.local&quot;&lt;/span&gt;&lt;br/&gt;EOF&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# kubeadm init&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 根据您服务器网速的情况，您需要等候 3 - 10 分钟&lt;/span&gt;&lt;br/&gt;kubeadm config images pull --config=kubeadm-config.yaml&lt;br/&gt;kubeadm init --config=kubeadm-config.yaml --upload-certs&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 配置 kubectl&lt;/span&gt;&lt;br/&gt;rm -rf /root/.kube/&lt;br/&gt;mkdir /root/.kube/&lt;br/&gt;cp -i /etc/kubernetes/admin.conf /root/.kube/config&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 安装 calico 网络插件&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 参考文档 https://docs.projectcalico.org/v3.13/getting-started/kubernetes/self-managed-onprem/onpremises&lt;/span&gt;&lt;br/&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;安装calico-3.13.1&quot;&lt;/span&gt;&lt;br/&gt;rm -f calico-3.13.1.yaml&lt;br/&gt;wget https://kuboard.cn/install-script/calico/calico-3.13.1.yaml&lt;br/&gt;kubectl apply -f calico-3.13.1.yaml&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果出错：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; issue 01&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; [ERROR FileContent--proc-sys-net-bridge-bridge-nf-call-iptables]: /proc/sys/net/bridge/bridge-nf-call-iptables contents are not &lt;span&gt;set&lt;/span&gt; to 1&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 所有机器执行&lt;/span&gt;&lt;br/&gt;echo 1 &amp;gt; /proc/sys/net/bridge/bridge-nf-call-iptables&lt;br/&gt;echo 1 &amp;gt; /proc/sys/net/bridge/bridge-nf-call-ip6tables&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;检查&lt;code&gt;master&lt;/code&gt;初始化结果：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 直到所有的容器组处于 Running 状态&lt;/span&gt;&lt;br/&gt;watch kubectl get pod -n kube-system -o wide&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 查看 master 节点初始化结果&lt;/span&gt;&lt;br/&gt;kubectl get nodes -o wide&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如下图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1771019677996422&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP7S4LvCb4BubgcUknanNicxX9SRLAY7S2y9hicpQ0ucUyImpNHRELfrSuQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2236&quot;/&gt;&lt;figcaption&gt;image-20201221165311482&lt;/figcaption&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;获得 join 命令参数&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;直接在&lt;code&gt;master&lt;/code&gt;执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubeadm token create --print-join-command&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如此时输出：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 有效期两小时&lt;/span&gt;&lt;br/&gt;kubeadm join apiserver.demo:6443 --token vh5hl9.9fccw1mzfsmsp4gh     --discovery-token-ca-cert-hash sha256:6970397fdc6de5020df76de950c9df96349ca119f127551d109430c114b06f40&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;初始化 Node&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在所有&lt;code&gt;node&lt;/code&gt;执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;export MASTER_IP=192.168.5.91&lt;br/&gt;export APISERVER_NAME=apiserver.demo&lt;br/&gt;echo &quot;${MASTER_IP}    ${APISERVER_NAME}&quot; &amp;gt;&amp;gt; /etc/hosts&lt;br/&gt;&lt;span&gt;&lt;br/&gt;#&lt;/span&gt;&lt;span&gt; 替换为 master 节点上 kubeadm token create 命令的输出&lt;/span&gt;&lt;br/&gt;kubeadm join apiserver.demo:6443 --token vh5hl9.9fccw1mzfsmsp4gh     --discovery-token-ca-cert-hash sha256:6970397fdc6de5020df76de950c9df96349ca119f127551d109430c114b06f40&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;检查初始化结果&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在&lt;code&gt;master&lt;/code&gt;节点执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubectl get nodes -o wide&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;输出结果如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06032285471537808&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP77E233I5bvAVvibHH3Mbuibsl4DiaBQsictKibIAWTsxibDtmib8ubzrZmwjBQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2354&quot;/&gt;&lt;figcaption&gt;image-20201221181016264&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;Kubernetes Dashboard&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Dashboard&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;可以将容器化应用程序部署到&lt;code&gt;Kubernetes&lt;/code&gt;集群，对容器化应用程序进行故障排除，以及管理集群资源。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;安装&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;安装命令如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.1.0/aio/deploy/recommended.yaml -O recommended.yaml&lt;br/&gt;&lt;br/&gt;kubectl apply -f recommended.yaml&lt;br/&gt;kubectl get pods --namespace=kubernetes-dashboard -o wide&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此处执行完会发现&lt;code&gt;STATUS&lt;/code&gt;都是&lt;code&gt;ContainerCreating&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;NAME                                         READY   STATUS    RESTARTS   AGE    IP          NODE             NOMINATED NODE   READINESS GATES&lt;br/&gt;dashboard-metrics-scraper-79c5968bdc-bdz9d   1/1     `ContainerCreating`   0          100m   10.1.0.20   docker-desktop   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;&lt;br/&gt;kubernetes-dashboard-7448ffc97b-z8222        1/1     `ContainerCreating`   0          100m   10.1.0.19   docker-desktop   &amp;lt;none&amp;gt;           &amp;lt;none&amp;gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查看日志找找原因（注意 NAME）：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubectl describe pod dashboard-metrics-scraper-79c5968bdc-bdz9d --namespace=kubernetes-dashboard&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;发现是因为&lt;code&gt;metrics-scraper:v1.0.6&lt;/code&gt;镜像下载不下来，手动执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;docker pull kubernetesui/metrics-scraper:v1.0.1&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;拉下来之后就妥了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后我们需要将访问形式改为&lt;code&gt;NodePort&lt;/code&gt;访问：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubectl --namespace=kubernetes-dashboard edit service kubernetes-dashboard&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 将里面的 &lt;span&gt;type&lt;/span&gt;: ClusterIP 改为 &lt;span&gt;type&lt;/span&gt;: NodePort&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;保存后，执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubectl --namespace=kubernetes-dashboard get service kubernetes-dashboard&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;终端输出：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;NAME                   TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE&lt;br/&gt;kubernetes-dashboard   NodePort   10.98.194.124   &amp;lt;none&amp;gt;        443:31213/TCP   107m&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;Token&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在浏览器访问：&lt;code&gt;https://0.0.0.0:31213/&lt;/code&gt;:&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2933227344992051&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP7aQdxZ4mCgG9Tyy7l5tNqfOxpjibwd8iciabRc9OekwyJmNRDBATUmOicEA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2516&quot;/&gt;&lt;figcaption&gt;image-20201220201125802&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;看界面需要生成&lt;code&gt;Token&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;vim admin-user.yaml&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 输入&lt;/span&gt;&lt;br/&gt;apiVersion: v1&lt;br/&gt;kind: ServiceAccount&lt;br/&gt;metadata:&lt;br/&gt;  name: admin-user&lt;br/&gt;  namespace: kubernetes-dashboard&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 保存退出&lt;/span&gt;&lt;br/&gt;vim admin-user-role-binding.yaml&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 输入&lt;/span&gt;&lt;br/&gt;apiVersion: rbac.authorization.k8s.io/v1&lt;br/&gt;kind: ClusterRoleBinding&lt;br/&gt;metadata:&lt;br/&gt;  name: admin-user&lt;br/&gt;roleRef:&lt;br/&gt;  apiGroup: rbac.authorization.k8s.io&lt;br/&gt;  kind: ClusterRole&lt;br/&gt;  name: cluster-admin&lt;br/&gt;subjects:&lt;br/&gt;- kind: ServiceAccount&lt;br/&gt;  name: admin-user&lt;br/&gt;  namespace: kubernetes-dashboard&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 保存退出&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;br/&gt;#&lt;/span&gt;&lt;span&gt; 执行命令加载配置&lt;/span&gt;&lt;br/&gt;kubectl create -f admin-user.yaml&lt;br/&gt;kubectl create -f admin-user-role-binding.yaml&lt;br/&gt;&lt;span&gt;&lt;br/&gt;#&lt;/span&gt;&lt;span&gt; 若出现已存在&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 执行：kubectl delete -f xxx.yaml 即可&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;获取令牌：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin-user | awk &#x27;{print $1}&#x27;)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;复制&lt;code&gt;token&lt;/code&gt;到刚才的界面登录即可，登录后界面如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.515230635335074&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP7zz4LiaUeLc7u0RiaL4BQwOGjlPXbyTtBice7etpE6eibfyjZTXJumwOleQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;4596&quot;/&gt;&lt;figcaption&gt;image-20201220201512486&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果想延长&lt;code&gt;Token&lt;/code&gt;的有效时间：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20616030801540078&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YRBRJvZXcIX8lHghVMIfD1EsK5y8drP70IfxgqH0icLoUoNfpM6WY6TNia1DkaqR361aRvYqWCUbTxKgR5cD4OdA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2857&quot;/&gt;&lt;figcaption&gt;image-20201221204143993&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后在&lt;code&gt;containners-&amp;gt;args&lt;/code&gt;加上&lt;code&gt;--token-ttl=43200&lt;/code&gt;。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;部署镜像&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下拉一个你自己想部署的镜像，具体命令如下（主节点执行）：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 部署&lt;/span&gt;&lt;br/&gt;kubectl run hello --image=xxx/hello --port=5000&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 列出 pod&lt;/span&gt;&lt;br/&gt;kubectl get pods&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 创建一个服务对象&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; NodePort 在所有节点（虚拟机）上开放一个特定端口，任何发送到该端口的流量都被转发到对应服务&lt;/span&gt;&lt;br/&gt;kubectl expose po hello --port=5000 --target-port=5000 --type=NodePort  --name hello-http&lt;br/&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; 列出服务&lt;/span&gt;&lt;br/&gt;kubectl get services&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;参考&lt;/span&gt;&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;本部分参考文章如下：&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt; 使用 kubeadm 安装 kubernetes_v1.19.x&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;Web 基础配置篇（十六）: Kubernetes 集群的安装使用&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Kubernetes in Action 中文版&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;参考资料&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;k8s-docker-desktop-for-mac: &lt;em&gt;https://github.com/gotok8s/k8s-docker-desktop-for-mac&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;Dashboard: &lt;em&gt;https://github.com/kubernetes/dashboard&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;使用kubeadm安装kubernetes_v1.19.x: &lt;em&gt;https://kuboard.cn/install/install-k8s.html#%E6%A3%80%E6%9F%A5-centos-hostname&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;Web基础配置篇（十六）: Kubernetes集群的安装使用: &lt;em&gt;https://www.pomit.cn/p/2366402025269761#1010602&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>