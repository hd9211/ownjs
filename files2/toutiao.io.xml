<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>652151a5cb097ffd2bbbead2ddcabb42</guid>
<title>“拖文件自动上传到远程服务器”，支持多种平台的原生终端。</title>
<link>https://toutiao.io/k/ea4uy8e</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;container app-preview post-body&quot;&gt;
  &lt;div class=&quot;preview&quot;&gt;&lt;p&gt;1 、在本地使用 trzsz -d ssh x.x.x.x 登录服务器。加 -d 是开启拖文件上传功能，默认是不开启的。&lt;/p&gt;

&lt;p&gt;2 、将 trz 和 tsz 放到服务器某个 PATH 目录下，要有可执行权限。执行命令 trz -v 不会报错即可。&lt;/p&gt;

&lt;p&gt;项目地址：&lt;a href=&quot;https://github.com/trzsz/trzsz-go&quot;&gt;https://github.com/trzsz/trzsz-go&lt;/a&gt; ，给个 Star 支持下？&lt;/p&gt;

&lt;p&gt;在 Release 中下载的 zip 里就是三个 trzsz、trz、tsz 可执行程序，也可以自己 clone 下来 make 编译。&lt;/p&gt;
&lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>8529d286688febc9e07a238f4c6a1f14</guid>
<title>Go练手：日志监控告警</title>
<link>https://toutiao.io/k/x8vfmww</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;
            &lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;qqmusic class=&quot;js_editor_qqmusic qqmusic_iframe js_uneditable custom_select_card&quot; musicid=&quot;5452000&quot; mid=&quot;0047ZZ003LNkpq&quot; albumurl=&quot;https://y.gtimg.cn/music/photo_new/T002R68x68M000000TkAp53XAoUM.jpg&quot; audiourl=&quot;http://isure6.stream.qqmusic.qq.com/C200002SbdVS3daDlF.m4a?guid=2000000052&amp;amp;vkey=539EAFE334758E25D9BE48341C65360BBD1B954365C5C1C2756EDEBBE47391922C0940D1726733DB4EA08FBC278D6EECB0B806190B03817A&amp;amp;uin=&amp;amp;fromtag=20052&quot; music_name=&quot;Have A Cuppa Tea&quot; singer=&quot;The Kinks - Muswell Hillbillies [Deluxe Edition]&quot; play_length=&quot;212&quot; src=&quot;/mp/readtemplate?t=app_editor/music&amp;amp;singer=The%20Kinks%20-%20Muswell%20Hillbillies%20%5BDeluxe%20Edition%5D&amp;amp;music_name=Have%20A%20Cuppa%20Tea&amp;amp;albumurl=https%3A%2F%2Fy.gtimg.cn%2Fmusic%2Fphoto_new%2FT002R68x68M000000TkAp53XAoUM.jpg&amp;amp;musictype=1&quot; musictype=&quot;1&quot; otherid=&quot;0047ZZ003LNkpq&quot; albumid=&quot;000TkAp53XAoUM&quot; jumpurlkey=&quot;&quot; data-pluginname=&quot;insertaudio&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;“&lt;/span&gt;&lt;/strong&gt;李白乘舟将欲行，忽闻日志报警&lt;/span&gt;&lt;span&gt;声。&lt;/span&gt;&lt;span&gt;匆匆电话询同事，得知已被炒鱿鱼。&lt;/span&gt;&lt;strong&gt;&lt;span&gt;”&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;场景：&lt;/strong&gt;监控&lt;strong&gt;日志文件/文件夹&lt;/strong&gt;，触发&lt;strong&gt;关键字&lt;/strong&gt;后，发送&lt;span&gt;告警消息到&lt;/span&gt;企微、钉钉等。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;01&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;—&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;文件夹/文件监控&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;一般来说，日志文件都会按照一定的时间间隔分割，如何方便监&lt;/span&gt;控&lt;span&gt;到新增的文件呢？&lt;/span&gt;&lt;span&gt;Go的标准库&quot;path/filepath&quot;中提供了Glob方法，可以很方便&lt;/span&gt;&lt;span&gt;将目录中的文件查出来。&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;matches, _ := filepath.Glob(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;./*.*o*&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; _, filename := &lt;span class=&quot;code-snippet__keyword&quot;&gt;range&lt;/span&gt; matches {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  fmt.Println(filename)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;只要我们定时扫描就可以将新增的文件找出来了，如果对实时性要求高可以使用类似inotify相关机制的库来实现，例如：https://github.com/fsnotify/fsnotify，&lt;span&gt;但文件匹配就需要自己搞了。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;02&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;—&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;关键字监控&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;日常监控文件内容变更，最常用的方法莫过于：tail -f file.log | grep &quot;关键字&quot;。tail监控文件变更的机制我并不了解，最粗暴简单的方法就是一直读取文件，还有一种就是上面提到的inotify机制，文件变更时会发送事件通知。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;file, _ := os.Open(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;main.go&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;reader := bufio.NewReader(file)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  content, err := reader.ReadBytes(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;\n&#x27;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; err != &lt;span class=&quot;code-snippet__literal&quot;&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; err == io.EOF {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      time.Sleep(&lt;span class=&quot;code-snippet__number&quot;&gt;500&lt;/span&gt; * time.Millisecond)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;span class=&quot;code-snippet__keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; bytes.Contains(content, []&lt;span class=&quot;code-snippet__keyword&quot;&gt;byte&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;报警关键字&quot;&lt;/span&gt;)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    fmt.Println(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;服务器挂了，抓紧开电脑!&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;03&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;—&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;告警&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;如果不考虑告警规则的话，这个是最好实现的。只有CURL请求接口即可~&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;讲了这么多，代码呢？&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;速取链接：&lt;/span&gt;&lt;span&gt;https://github.com/zhjx922/alert (&lt;/span&gt;&lt;span&gt;点击阅读原文也可以&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.1391465677179964&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KVuQcAewaQT4CkH2CvPWTj8N6AuD98zstqPNUvv2qagpMHdDzvicksT1mmMJLG6ZHLDByBiaKGYiaZPqHzcA3tP4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1078&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                          
              &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                  &lt;p class=&quot;tips_global&quot; aria-hidden=&quot;true&quot; id=&quot;js_a11y_reward_qr_title&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                    &lt;p role=&quot;option&quot; aria-labelledby=&quot;js_a11y_reward_qr_word js_a11y_comma js_a11y_reward_qr_title js_a11y_reward_qr_money&quot; aria-describedby=&quot;js_a11y_reward_qr_tips &quot; class=&quot;reward_tips&quot; id=&quot;js_a11y_reward_qr_word&quot;&gt;写文章不为挣钱，只为混口饭吃&lt;/p&gt;
                  &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img alt=&quot;赞赏二维码&quot; class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                  &lt;p aria-hidden=&quot;true&quot; id=&quot;js_a11y_reward_qr_tips&quot; class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                &lt;/div&gt;
                                              
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>33ed643e348a08f8229809cc561ccd43</guid>
<title>线上真实排队系统重构案例分享——实战篇</title>
<link>https://toutiao.io/k/4vki4nq</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;写在前面&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上篇文章聊了聊 &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU5NTg1ODg2MQ==&amp;amp;mid=2247484221&amp;amp;idx=1&amp;amp;sn=1467781e7846cd3fcbefe668dc29ca90&amp;amp;chksm=fe6ac7ffc91d4ee9b2a8e57abef12750b8ff3d87f256e2b30fb9e3e19db676744658b9bd7abd&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;如何设计可落地的重构技术方案——理论篇&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;如何设计可落地的重构技术方案——理论篇&lt;/a&gt; 这篇文章主要以最近正在做的线上重构项目——乘客排队系统重构为场景，介绍一篇完整的系统重构技术方案。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;详细技术方案介绍&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;一、背景&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、现状:&lt;/p&gt;&lt;section&gt;* 目前线上乘客排队性能瓶颈很明显，主要采用Redis  List存储结构。随着队列中订单量增大，查询、插入、判断订单是否在队列中等操作RT指数级增长。&lt;/section&gt;&lt;section&gt;* 目前乘客排队架构，无法满足业务扩展需求，为支撑之后业务快速迭代，乘客排队重构迫在眉睫。&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;2、调研事项&lt;/section&gt;&lt;section&gt;* 使用Mysql存储排队信息可行性分析(线下环境压测) &lt;/section&gt;&lt;section&gt;* 对外接口和影响范围梳理(目前对外提供的20个左右接口分析)，&lt;/section&gt;&lt;section&gt;表格如下:&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;接口名称&lt;/th&gt;&lt;th&gt;接口路径&lt;/th&gt;&lt;th&gt;调用方&lt;/th&gt;&lt;th&gt;QPS&lt;/th&gt;&lt;th&gt;RT(995)&lt;/th&gt;&lt;th&gt;平均RT&lt;/th&gt;&lt;th&gt;备注&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;入队&lt;/td&gt;&lt;td&gt;/queue/enter&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;二、目标&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、对外接口不变，从底层存储改造，兼容目前线上显示场景，乘客排名显示和出队解耦。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;排名显示保留普通队列、渠道队列、优先队列(包含绝对优先), 按入队时间排序&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;出队排序因子入队时根据固定规则计算, 采用更加灵活的策略算法计算出队优先级， 出队时只需根据排序因子排序，从而间接决定出队顺序,&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、数据存储排名采用Redis有序集合，队列信息新增mysql存储，分128张表。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、解决目前性能瓶颈问题，支持后续业务快速迭代，以及后续需求扩展。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;三、整体方案&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、新老方案对比&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重构前存储架构: redis: list数据结构  ,  key：蜂巢中心点 + 车型 + 队列类型 &lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重构后存储架构: &lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;       排名队列: redis有序集合, key: 蜂巢中心点 + 车型 + 队列类型(为了兼容老的) &lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;       队列信息表:  queue_info_xxx,   mysql存储， 按蜂巢中心点 hash分表，订单号 + 车型 建联合唯一索引&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;部分接口新—老对比&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;接口&lt;/th&gt;&lt;th&gt;查看排名&lt;/th&gt;&lt;th&gt;是否在队列中&lt;/th&gt;&lt;th&gt;入队&lt;/th&gt;&lt;th&gt;出队&lt;/th&gt;&lt;th&gt;插队&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;重构前&lt;/td&gt;&lt;td&gt;1. 循环所有队列中所有元素，循环判断计算位置，2.查询算法组计算预估时间&lt;/td&gt;&lt;td&gt;遍历查询出队列所有元素，循环判断是否contain&lt;/td&gt;&lt;td&gt;先判断是否在队列中存在，这里也会判断根据命中不同队列类型，写入redis 队列(list) 中&lt;/td&gt;&lt;td&gt;根据车型循环&amp;amp;多队列类型循环出队，并记录log&lt;/td&gt;&lt;td&gt;权益卡插队&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;重构后&lt;/td&gt;&lt;td&gt;通过订单号从”队列信息表“ 中查询排队信息，存在排队记录，判断是否存在排名，若不存在排名显示M+(排名队列存在上线控制)，否则查询”排名队列“直接返回顺序 。查询算法组计算预估时间&lt;/td&gt;&lt;td&gt;直接查询&quot;队列信息表&quot;判断是否存在记录&lt;/td&gt;&lt;td&gt;先写入&quot;队列信息表&quot;，若未超过排号阈值，则写入对应&quot;排名队列&quot;&lt;/td&gt;&lt;td&gt;更新&quot;队列信息表&quot;状态，若存在排名，则从排名队列中移除，并异步通知候补，并记录log&lt;/td&gt;&lt;td&gt;直接通过更新队列信息表”order_by“字段 即可改变出队顺序&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重构前瓶颈分析: 每次请求都会将队列中元素全部取出循环遍历(当排队订单量增大时，RT呈指数级增长，卖个关子，原因大家可以想想为啥？)&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重构后存储架构优势: 将原来的O(n)时间复杂度，变为O(1)复杂度。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、重构后架构图&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6204259967231022&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kulR6Bq67W96Y3QbiammBAHWHa6YY1rjibBibagsibia1wKnWV319evQKpWYPE41tkAL7AfhSBHlI1nHgrl6ibw7NSqA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1831&quot;/&gt;&lt;/figure&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;关于队列大小统计问题:&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;排名未限流队列:   直接通过ZCARD获取 (O(1)  时间复杂度)&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;排名限流队列: 通过计数器获取总长度 (O(1)), 降级通过ZCARD获取&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2）关于新增运力撮合——查询列表【橙色部分】可能存在瓶颈问题——后期优化方向有2种
可以排名前N抽离出缓冲集合
队列截断 —— 大小超过N转为其它表存储&lt;/p&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;其它流程图: 入队、出队流程图 （此处省略）&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;表结构设计&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt; queue_info_[001 ~ 128] : 排队信息表 按蜂巢中线点 hash % 128 规则分表，数据按天归档&lt;/p&gt;&lt;p&gt;&lt;span&gt;   &lt;/span&gt;&lt;span&gt;queue_manager : &lt;/span&gt;&lt;span&gt;排&lt;/span&gt;&lt;span&gt;名队列管理表 主要控制是否限流状态，和蜂巢队列信息&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;queue_log_[001~128]&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt; 订单入队&amp;amp;出队记录表，按蜂巢中线点  hash % 128 规则分表，后期再考虑归档。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;详细表结构 —— 省略&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;四、排序字段(order_by) 设计&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;针对排队场景，时间越小，越在前。可以使用时间差逆序计算，公式如下: ~(-1L &amp;lt;&amp;lt; 39L) &amp;amp; (~(毫秒级时间差))&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其它规则此处省略.&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;五、历史队列场景兼容问题&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;排名显示:   普通队列、渠道队列、优先队列&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;订单出队:  通过权重系数不同配置，最后计算出不同排序&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;六、灰度方案&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;按城市灰度，先选小流量城市。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;七、回滚方案&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关闭城市灰度开关，已存在队列中数据会影响，需要迁移工具刷新数据&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;八、数据归档方案 &amp;amp; 兜底方案&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据归档:   乘客排队信息按天归档&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;兜底策略:  长时间(可配置)排队状态未变更(可能出现异常)，强制退出&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;九、数据监控&amp;amp;报警&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;乘客排队Grafana监控:
监控指标:  城市、蜂巢、车型、普通队列数、渠道队列数、优先队列数
报警: 队列数超过阈值钉钉报警&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;十、时间规划&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;方案调研的接口(20个接口)增加改造方案、责任人，进度项&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;接口名称&lt;/th&gt;&lt;th&gt;接口路径&lt;/th&gt;&lt;th&gt;调用方&lt;/th&gt;&lt;th&gt;QPS&lt;/th&gt;&lt;th&gt;RT(995)&lt;/th&gt;&lt;th&gt;平均RT&lt;/th&gt;&lt;th&gt;备注&lt;/th&gt;&lt;th&gt;改造方案&lt;/th&gt;&lt;th&gt;责任人&lt;/th&gt;&lt;th&gt;进度&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;入队&lt;/td&gt;&lt;td&gt;/queue/enter&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;XXX&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8293991416309013&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/kulR6Bq67W96Y3QbiammBAHWHa6YY1rjib7IreKmXSpLKLiaDcax2R6LJ5wLsFOH7O7yMDH1y0sjo7Gt70PSpFegQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1864&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意: 接口自测 和 CR是在开发阶段完成的，监控报警不影响测试的开发，可以在测试阶段开发。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;十一、关联组&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;略&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;十二、所需资源&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;略&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;总结&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重构需要考虑到细节很多，需要考虑到每一个可能出现瓶颈的地方，以及后续优化，扩展问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所有改动项，必须责任到个人(避免遗漏)，另外提测之前必须全部自测通过(单元测试)。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;目前该方案代码开发已经基本完成，下一篇文章继续以排队系统重构为场景，将给大家聊一聊灰度阶段压测方案如何设计，敬请期待。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;欢迎关注&quot;浅谈架构&quot;公众号，不定期分享原创技术文章，后续有机会给大家直播分享系统重构技术细节。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.36484375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kulR6Bq67WicS8obXBjC9RqxibSJcgOsnicwSlKjFSxuEECwjZjYS8Y9zpmCdyv6z4yeSicSQSDNz2XUzRppBjuGXQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;figcaption&gt;file&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>632e9713d972e4f9fa514be467eb85cc</guid>
<title>PyScript：让 Python 在 Web 中跑起来</title>
<link>https://toutiao.io/k/9pcbq29</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;section&gt;
作者 | Yong Cui&lt;/section&gt;&lt;section&gt;
译者 | 平川&lt;/section&gt;&lt;section&gt;
策划 | 邓艳琴&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;本文最初发布于 Better Programming。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;这是下一个大事件吗？如果继续发展下去，有可能。&lt;/p&gt;&lt;p&gt;在 2022 年 PyCon 美国大会期间，作为主题发言人之一的 Peter Wang 公布了 PyScript——一种在 HTML 中直接编写 Python 脚本的方法。或许你不知道 Peter，但你可能听说过 Anaconda，这是最流行的 Python 和 R 分发版之一，主要应用于数据科学。Peter 是 Anaconda 的 CEO 和联合创始人。&lt;/p&gt;&lt;p&gt;换言之，PyScript 是由一家著名的科技公司开发的，这可能有利于保证它在不久的将来成为可行的方案。它在 Python 和 Web 开发者中受到了极大的关注，GitHub 上已有超过 10k 颗星。然而，它是否能成为一个成功的、有竞争力的产品，取决于长期的时间和开发投入。目前，它还有一些已知的缺陷（将在最后讨论）。&lt;/p&gt;&lt;p&gt;闲话少说，让我们快速了解一下这个令人振奋的产品吧！&lt;/p&gt;&lt;section&gt;
&lt;span&gt;py-script 标签&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;我们知道，HTML 文件是大多数网站最常见的元素。在创建网站时，我们的工作就是直接或间接地通过一些框架来编制 HTML 文件。在典型的 HTML 文件中，你会看到各种类型的标签。例如，定义了 HTML 页面的元数据和关键信息，&lt;/p&gt;&lt;p&gt;如前所述，PyScript 允许你在 HTML 中编写 Python 脚本，它使用一个特殊的标签 py-script。在这个标签中，你可以嵌入 Python 脚本。要了解它是如何工作的，可以创建一个 HTML 文件，在其中添加以下代码，并使用 Chrome 浏览器打开该文件。在 Chrome 浏览器中，你应该能够看到类似下面这样的内容：&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;NlV5&quot;&gt;&lt;span line-inline=&quot;X6fZ&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.45024469820554647&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp05VR0U9siaibRlMOAia5CoQxenAv5rMchCOYzy5A0Ucr4LgXOKpGCuUHicQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1226&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6602870813397129&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0YVJmfYmRLybFzpnyT504qTryQicibM4TAvaliaDLJqS79X20tzO1HaAicQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;418&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;作者截图&lt;/span&gt;&lt;/p&gt;&lt;p&gt;在上面的代码片段中，你可能已经注意到以下三个关键点：&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;link 标签定义了一个外部样式表。在这个例子中，我们使用了 PyScript 提供的 css 文件。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;我们使用 script 标签来嵌入一个由 src 定义、由 PyScript 托管的外部脚本。我们还使用了 defer，这样脚本会在下载和页面解析完成后执行——本质上是一种延迟执行，而不是实时执行。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;最有趣的部分是 py-script 标签。如你所见，print(&quot;Hello, World!&quot;) 是 Python 代码。当执行 HTML 文件时，就可以看到代码求值结果。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;这很酷，不是吗？如果你不熟悉 Web 开发，但了解 Python，就可以使用 PyScript 嵌入任何有效的 Python 代码。让我们再看一个例子。&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;TAII&quot;&gt;&lt;span line-inline=&quot;fnbc&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42724458204334365&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0mQxGOjPfs26G4PG8KrVruTwIZjZicZZGQ4f1l22aNAbJgLd2gCBYx4g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1292&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5369649805447471&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0BNV4JHORKPibIQK28ZnGvuQO5N7tGg0aicVjdaseibO30jw8jezfY37Iw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;514&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;另一个 PyScript 示例（图片由作者提供）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;在这里，我们写了一些需要计算的代码，可以看到，脚本得到了正确的执行。&lt;/p&gt;&lt;section&gt;
&lt;span&gt;py-env 标签&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;在编写更复杂的代码时，就需要使用第三方库。在这种情况下，我们可以利用 py-env 标签。你可能已经猜到的，env 是 environment 的缩写。py-env 标签中列出了运行代码所需的 Python 包。&lt;/p&gt;&lt;p&gt;你可能知道，许多数据科学家都使用 pandas 进行数据处理工作。让我们看看下面的例子。&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;fVTx&quot;&gt;&lt;span line-inline=&quot;6Fxo&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5048076923076923&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0SFibA5PFgiaOMMW6dJa4nzQh9rzFN6j878C9tn9ica6AujpcrOBzrPpPA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1248&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6114790286975718&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0wVQCJ8IEtgdAnVhnZVsOCI7pXTUTRiaib5CnWNlbDA9wlAfYNIbZY93w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;453&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;使用包的 PyScript（图片由作者提供）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;如你所见，我们在 py-env 标签中指定了依赖项（即 pandas），该标签包含在 head 标签中。如果页面需要多个依赖项，可以在这里把它们全部列出：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;xml&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__tag&quot;&gt;&amp;lt;&lt;span class=&quot;code-snippet__name&quot;&gt;py-env&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  - pandas&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  - matplotlib&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  - numpy&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__tag&quot;&gt;&amp;lt;/&lt;span class=&quot;code-snippet__name&quot;&gt;py-env&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;如你所见，在 py-script 标签中，我们确实可以使用 pandas 库来创建一个 DataFrame 对象。然而，当我们把打印出来时就会发现，它是一行，而不是一个结构化的数据表。没有一个适当的结构，我们就无法理解这些数据。幸运的是，我们可以使用 write 函数（下文会讨论）。&lt;/p&gt;&lt;section&gt;
&lt;span&gt;将内容写入指定标签&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;除了 Python 中的标准打印函数 print，作为脚本的一部分，PyScript 有自己的 write 函数，可以将数据发送到页面上指定的 Web 元素中。请看下面的例子：&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;f4Lc&quot;&gt;&lt;span line-inline=&quot;TuZd&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5264847512038523&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0VzePdIa5jGicVsQsJbpDgMegM1oAvaT8TfMXAHIT2Jic5CibA8xGibya0w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1246&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4608695652173913&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0DLiapQPmQGUEllHPIAqDZurv3t9W8yT8cxYsMZQXE7HiatKvOAHbVHyA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;460&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;PyScript 写函数 write（图片由作者提供）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;与之前的例子相比，上述代码片段有两个重大变化：&lt;/p&gt;&lt;p&gt;write 函数不仅能够打印表格，还能够打印数字。下面的例子向你展示了我们如何使用 matplotlib（一个流行的 Python 包，用于数据可视化）来显示由 Python 创建的图。&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;Vshg&quot;&gt;&lt;span line-inline=&quot;hmiT&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8181818181818182&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0wWcdWEV6nCHGZkylMfJeIiaibAYTdNiaBcFQmHMDcFBIxqPzYZI5N2kVQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1254&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8588039867109635&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0Xe1Dhae0skwvVde7myjJSriceO32CAMZY01BvLQ8ZswlISlhBsDPENg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;602&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;PyScript 打印图（图片由作者提供）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;如你所见，write 函数以期望的方式显示了图。&lt;/p&gt;&lt;section&gt;
&lt;span&gt;py-repl 标签&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;Python 学习的最好方法之一是使用 REPL：读取（Read）、求值（Evaluate）、打印（Print）和循环（Loop）。也就是说，使用一个交互式的 Python 控制台，输入一些代码，Python 对其进行求值并打印适当的输出，然后重复这个过程。Web 页面也可以提供这样的 REPL 环境，比如 Jupyter Notebook。&lt;/p&gt;&lt;p&gt;PyScript 可以使用 py-repl 标签提供与此类似的东西。在这个元素中，你可以让用户自己编写代码，也可以以编程方式输入代码。请看下面的例子：&lt;/p&gt;&lt;p&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;1w4X&quot;&gt;&lt;span line-inline=&quot;I8uB&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5467836257309941&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0t1kbLtW6jibKYdIY1ibnHYSiboVvGPele8TCmZH1beQGzAfpLnBVr3MRQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1368&quot;/&gt;&lt;span data-copy-origin=&quot;https://shimo.im&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p ql-global-para=&quot;true&quot; line=&quot;0PAu&quot;&gt;&lt;span line-inline=&quot;HT32&quot; ql-global=&quot;true&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8404494382022472&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/XIibZ0YbvibkXXIXAHf9nfKzD2Lycuuzp0WFRmQZonSpkGhgCakdlJUVDEOvomF2eEWOs00AQFPhJsJQRSaI6I7A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;445&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;PyScript REPL（图片由作者提供）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;如你所见，上图中有一个单元格，其中包括在 py-repl 标签中指定的代码。值得注意的是，单元格中的代码可以引用我们之前在 py-script 标签中定义的变量。一切看起来都很协调。&lt;/p&gt;&lt;section&gt;
&lt;span&gt;感想&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;本文介绍的内容是现阶段 PyScript 所能提供的主要亮点。它似乎是一个很有前途的产品，因为它提供了一个灵活的框架，让 Python 程序员可以在没有太多 Web 开发知识的情况下创建 Web 应用。然而，也有其他类似的成功的产品，因此，竞争会很激烈。&lt;/p&gt;&lt;p&gt;例如，如果我需要为自己的数据科学项目创建一个 Web 应用，我就会直接使用 Streamlit。它的功能已经相对成熟。请注意，虽然都与 Web 开发有关，但 PyScript 和 Streamlit 属于不同的产品系。PyScript 应该更通用，因为它的目标是让你可以在任何网页上嵌入任何 Python 代码，Streamlit 做不到这一点。&lt;/p&gt;&lt;p&gt;在 PyScript 为更多的人所接受之前，它有几个问题必须解决。例如，Web 页面的加载速度非常慢。如果你尝试跟着本教程运行代码，可能就会注意到，在 Web 页面的显示会有一个明显的滞后。&lt;/p&gt;&lt;p&gt;尽管如此，我还是觉得这个产品会继续发展，我的信心主要来自于它的开发者——给我们带来极好的 Anaconda 工具的 Anaconda 团队。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;查看英文原文：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://betterprogramming.pub/running-python-script-on-the-web-using-pyscript-the-next-big-thing-8ace9543d75&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9738565ea3bba9fa8e5690260fe498a2</guid>
<title>失去才懂珍惜？Apache Ambari 项目即将重启，再次进入 Apache 孵化器</title>
<link>https://toutiao.io/k/1vqpjs3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;
            &lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzIxMjI3NTI5OQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/DicvpKIBbiaxdvguk5d6BgaNvk9mvMnmticIjibcW5fOibhicUCZDRVGq2SfEib6bRT7djd8icz5HV0sWuKkse9k0Ve7ow/0?wx_fmt=png&quot; data-nickname=&quot;Java与大数据架构&quot; data-alias=&quot;deltalake_bigdata&quot; data-signature=&quot;7年老码农，10W关注者。【Java与大数据架构】全面分享Java编程、Spark、Flink、Kafka、Elasticsearch、数据湖等干货。&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;今年的1月份，Cloudera 的工程师、Apache Ambari PMC 主席 Jayush Luniya 曾经给社区发了一份提议将 Apache Ambari 一定 Attic 的邮件。原因是在过去的两年里，Ambari 只发布了一个版本（2.7.6），大多数提交者（Committer）和 PMC 成员都没有积极参与到这个项目中来。按照 &lt;span&gt;Apache 的项目生命周期&lt;sup&gt;[1]&lt;/sup&gt;&lt;/span&gt;，其应该是 reached its end of life；所以需要将其从 Apache 项目移到 Apache Attic 项目中。具体可以参见 《&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA5MTc0NTMwNQ==&amp;amp;mid=2650736359&amp;amp;idx=1&amp;amp;sn=3a661e3da5f4ceca7a0b7b721191f53b&amp;amp;chksm=887c1b91bf0b9287320c3765192bab4298785ac76ee4b09a641820c3d0f1e63d7174260dc44b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Apache 董事会即将终止 Apache Ambari 项目&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;Apache 董事会即将终止 Apache Ambari 项目&lt;/a&gt;》。&lt;/p&gt;&lt;p&gt;在大数据圈里，熟悉和使用 Apache Ambari 的大有人在，国内外很多公司都使用它来进行 Hadoop 的集群管理和监控。虽然说 Apache Ambari 终止维护后，我们还是可以使用它，但是后面遇到问题社区是没人帮忙解决的，需要自己维护，而且社区里面已经没其它开源的方案可以替代。在过去的近半年的时间里，相关社区成员进行了大量讨论，很多成员都觉得重启 Apache Ambari 很有必要。&lt;/p&gt;&lt;p&gt;于是在2022年6月10日，来自 Pivotal 的 Roman Shaposhnik（同时也是 Apache Bigtop 创建者），给社区发了一份名为《 &lt;span&gt;Rebooting Ambari PMC via board resolution&lt;sup&gt;[2]&lt;/sup&gt;&lt;/span&gt;》的邮件，这也意味着 Apache Ambari 将从 Apache Attic 项目中移除，再次进入到 Apache 孵化项目中。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.682875264270613&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nvpeMpM6qbKS8Lx87Qk8qyzUZgz7xqd7BDOhMrdCPHEHvDKA3pibrS9wakdelbXVJnw6HT5xbJYFKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;946&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果想及时了解Spark、Hadoop或者HBase相关的文章，欢迎关注微信公众号：过往记忆大数据&lt;/span&gt;&lt;/p&gt;&lt;p&gt;上面邮件其实是重新成立 Apache Ambari PMC 的董事会，同时重启 Apache Ambari 项目。新的 Apache Ambari PMC 成员如下：&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;Atri Sharma (atri)&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;Devaraj Das (ddas)&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;Evans Ye (evansye)&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;Uma Maheswara Rao G (umamahesh)&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;Roman Shaposhnik (rvs)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Roman Shaposhnik 也担任 Apache Ambari 的副总裁，依照并服从董事会和基金会章程的指示，并对 Apache Ambari 项目责任范围内的项目管理负有主要责任；PMC 成员负责创建和维护 Apache Ambari 开源软件，并向公众免费分发。当前 Apache Ambari 项目的首要任务是离开 Attic，并恢复正常的项目状态，包括可以提交 PR。&lt;/p&gt;&lt;p&gt;Apache Ambari 的重启来之不易，其终止生命的原因是社区不活跃导致的，所以这次重启之后，建议大家踊跃贡献，使其发展的更好。&lt;/p&gt;&lt;h4&gt;引用链接&lt;/h4&gt;&lt;p&gt;&lt;code&gt;[1]&lt;/code&gt; Apache 的项目生命周期: &lt;em&gt;https://attic.apache.org/process.html&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[2]&lt;/code&gt; Rebooting Ambari PMC via board resolution: &lt;em&gt;https://lists.apache.org/thread/9yq7sw5scovdzo7bs4clzcm2447plf18&lt;/em&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                          
              &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                  &lt;p class=&quot;tips_global&quot; aria-hidden=&quot;true&quot; id=&quot;js_a11y_reward_qr_title&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                    &lt;p role=&quot;option&quot; aria-labelledby=&quot;js_a11y_reward_qr_word js_a11y_comma js_a11y_reward_qr_title js_a11y_reward_qr_money&quot; aria-describedby=&quot;js_a11y_reward_qr_tips &quot; class=&quot;reward_tips&quot; id=&quot;js_a11y_reward_qr_word&quot;/&gt;
                  &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img alt=&quot;赞赏二维码&quot; class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                  &lt;p aria-hidden=&quot;true&quot; id=&quot;js_a11y_reward_qr_tips&quot; class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                &lt;/div&gt;
                                              
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>