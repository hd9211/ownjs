<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>bffd49032b4d1ef777d7c503d7bf1f6f</guid>
<title>直播与 RTC 融合</title>
<link>https://toutiao.io/k/lexvyfc</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;h2 cid=&quot;n2&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;1. 背景介绍&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n3&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;直播和RTC（Real Time Communication）技术一直是以两种完全不同的形态发展的。直播通常应用于广播电视、体育赛事直播、游戏直播、秀场直播等场合，而RTC视频通话最典型的场景就是视频会议和传统的视频通话。随着近些年直播引入更多的互动方式，直播和RTC技术的界限也越来越模糊。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n4&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;从信息传输的角度，直播是单向的信息传输，而RTC是双向的信息传输，但这个并不构成本质意义上的区别，因为双向的RTC可以拆解成两个单向的信息传输流。带来本质差别的是对延迟的要求，不同的延迟对底层传输协议和分发网络有不一样的挑战。早期的互联网的底层基础设施较差（低带宽、高丢包率、高延迟），通过互联网公网来传输无法满足RTC的指标要求，使得传统RTC应用都采用专网或专线的方式来实现。而大规模的直播技术则利用成熟的CDN基础设施来实现直播的功能（牺牲一定的延迟），比如苹果推出的HLS协议，就是把视频流切成一段一段的分片，利用传统的文件CDN网络来实现分发。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n5&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;移动设备和4G网络的普及让手机直播成为流行的一种方式，各CDN厂商为了抓住商机，也纷纷进入直播CDN的建设。为了进一步降低延迟，各CDN厂商普遍采用以Adobe公司的RTMP和FLV协议为主要传输协议，铺设了新一代的直播CDN分发基础设施。这套基础设施在秀场直播、游戏直播、体育赛事直播领域获得了巨大的成功。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n6&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;当直播成为一种主流的应用形态后，各种各样纷繁复杂的变化随之而来。最显著的就是引入了主播与粉丝的互动。不管是文字聊天、礼物打赏、直播答题，无一例外的都是更加强调互动的实时性。主播能在第一时间回应粉丝的动作，让观众获得了参与感，极大的提升了用户黏性。更进一步，当观众可以请求与主播进行“现场连麦“时，更是直接以“面对面”的方式进行交流。现场连麦其实已经进入RTC的场合了，只不过在这个场景下，底层技术实现还是以两种不同的架构体系来完成的。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n7&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;再来看纯RTC最典型的视频会议场景。视频会议的参与方都能与其他人以“完全实时”的方式进行语音、视频、共享桌面等方式进行沟通、交流与互动。对于近几年来兴起的云视频会议，则还可以把会议房间里的音视频流转推出来进行“直播”，供不在会议房间里的人观看。这个时候，整体的参与者就分成了两个部分，一部分是房间内的成员，他们之间是“完全实时”的，另一部分，就是房间外的普通观众。这就构成了一种新型的“场内”和“场外”模式，场内的人能相互感知，场内的人则无法直接感知场外的人，但所有的一举一动又可以被场外的人观看到。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n8&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;直播可以加入RTC连麦互动，同样视频会议可以转推出来进行直播，不管从哪一个场景，都在往另外一个方向进行延伸。从用户的视角，这两者的界限在逐渐模糊。&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n92&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2. 直播和RTC融合统一方案&lt;/span&gt;&lt;/h2&gt;&lt;h3 cid=&quot;n176&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2.1 SFU分发网络是基础，RTC分发CDN化是趋势&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n181&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;传统的视频会议或多人视频通话软件，一般都限定在几十个人以内。直播系统则不然，通常可以几万甚至上百万的人在同一个房间，不太可能一台机器上处理一个”房间“里的所有转发任务，必须通过级联或完全分布式的网络结构来承载。直播体系采用的是类似消息队列中的Pub和Sub的语义，传统的WebRTC本身是点对点通信的语义，需要有SFU服务来承载放大的流量转发任务。除了流量放大，还要解决节点覆盖问题，让不同地域、不同运营商接入的用户都能找到比较近的点接入，而SFU内部的网络结构，则是分发厂商自己构建。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n238&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;当前各个云厂商都有自己的RTC分发网络，虽然当前还不能完全实现互联互通。但是未来应该是会朝着标准化的方式发展。比如都会提供网关，支持以WebRTC的协议标准接入进行推拉流。虽然当前WebRTC的标准在视频体验上和私有传输协议的厂商们相比还有一定的差距，但随着5G、WIFI6等网络基础设施的改进，这方面的差距会越来越小。&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n179&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2.2 典型的应用方式&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n177&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;以常见的秀场直播和教学培训场景为例，主播和互动嘉宾都采用RTC的分发网络进行低延迟的互动。对于支持RTC的普通观众同样能用RTC网络加入网络，只订阅下行的流，从而获得超低延迟的体验。当前的RTC-分发网络也能支持超大规模的RTC方式直播。而对于不支持RTC的观众，则只能观看通过MCU合流转推出来的直播流，和原有的普通直播保持相同的体验。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6265625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Uwpaickwgz7WA9KI7Pibup24zYnSJ1g1JzDsdqaRQCxZeOBazq2DodhBnpuicT8pF4ROH9KxgyF7LlplM8y1fBZeQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n112&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span/&gt;&lt;/p&gt;&lt;h3 cid=&quot;n25&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2.3 主要的障碍&lt;/span&gt;&lt;/h3&gt;&lt;h4 cid=&quot;n180&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;设备兼容性问题&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n26&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;对于RTC而言，既有编解码、又有音频的3A算法（回声消除、降噪、自动增益控制），这些实现如果都用软件方式实现，会非常消耗CPU资源。通常情况下，设备端系统会自带一些编解码硬件加速、系统自带的3A算法，一方面能降低CPU消耗，另外一方面系统自带的实现能更匹配硬件设备获得更好的效果。在实际的应用中，苹果的iOS设备系统自带的硬件加速编解码和RTC的音频3A算法表现都比较好，但Android生态的设备，这方面的表现相对比较差，有很多兼容性的问题。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n27&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;对于直播而言，不会有回声消除、降噪等方面的问题，单纯只对解码有加速需求，整体来说兼容性就好很多。如果用RTC技术来做直播，会带来更多的兼容性问题。&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n28&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;直播与RTC的切换问题&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n29&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;RTC和直播本身可以完全统一，按相同方式管理，但存几个问题:&lt;/span&gt;&lt;/p&gt;&lt;h5 cid=&quot;n30&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;1）Web端支持问题&lt;/span&gt;&lt;/h5&gt;&lt;p cid=&quot;n31&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;在不支持WebRTC的浏览器版本上，只能用传统直播来播放，一方面延迟会较高，另一方面无法参与推流（也就是只能当观众，无法成为主播或嘉宾），降低了Web端用户参与的程度。&lt;/span&gt;&lt;/p&gt;&lt;h5 cid=&quot;n32&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2）成本问题&lt;/span&gt;&lt;/h5&gt;&lt;p cid=&quot;n33&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;通常来说，有一定量级的直播业务会采用95%分位的峰值带宽来计费，而RTC通讯则是通过通话时长的方式计费。如果都换算到带宽方式，RTC的价格会比直播的价格高出很多。这个是由于RTC要保证低延迟的分发效果，同时还要满足跨运营商、跨地域的访问，一般采用的是BGP机房，而普通的直播则采用的是价格更加低廉的单线机房（BGP机房的带宽成本是普通机房的5-10倍）。&lt;/span&gt;&lt;/p&gt;&lt;h5 cid=&quot;n34&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;3）切换问题&lt;/span&gt;&lt;/h5&gt;&lt;p cid=&quot;n35&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;出于成本考虑，可以把不参与互动的普通观众切换到普通直播上来。这种方式确实带来成本的节省。但是普通观众的身份不是固定的，他可以通过申请以“连麦”的方式加入到直播间，与直播间的主播进行实时的音视频连线互动。但是由于底层使用的分发网络是基于不同基础设施，在终端上需要有一个切换过程。而这个切换并不是“无缝”的，用户会有明确的感知。这里就需要在成本和用户体验之间做一个权衡。&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n61&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;3. 新一代编码技术AV1在互动直播场景下的应用&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n118&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;目前广泛应用的视频编码标准是H.264，HEVC也逐步普及。但是编码器的发展没有停下脚步，H.266、VVC、EVC、AV1等新的编码标准逐步涌现。其中AV1编码标准因为其零版税、优异的压缩效率以及开源社区的支持，越来越受到人们的关注。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n227&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;AV1编码除了压缩效率有较大的提升外，还有一个特别适合视频会议、在线教育的场景的特性，就是SCC（Screen Content Coding）技术。在会议和教学培训场景，通常都会播放ppt内容。ppt内容有三个方面的特性：&lt;/span&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;1. 内容很少变化&lt;/span&gt;&lt;/strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;：只有翻页时才会有画面变化；&lt;/span&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;2. 绝对不变&lt;/span&gt;&lt;/strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;：屏幕内容，不会像传感器一样对光线变化敏感（拿摄像机去拍静止不动的真实画面，得到的图像数据还是会有细微的变化，而屏幕生成的内容是每个bit都一样）；&lt;/span&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;3. 大部分是文字&lt;/span&gt;&lt;/strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;。对于屏幕内容，一般编码器都有一些tune可以进行一些优化。尽管有这些方面的优化，但是对于屏幕上的文字内容，效果还是不那么好。HEVC在扩展的标准（extensions)里提供了SCC的编码工具，专门用来编码屏幕内容，但是主标准的Profile里并未支持。AV1则把SCC工具放到了主标准里，不用再担心是否支持扩展标准的问题了。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n226&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;3.1 直播如何应用AV1&lt;/span&gt;&lt;/h3&gt;&lt;h4 cid=&quot;n196&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;1）直播CDN对AV1的扩展支持&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n197&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;Adobe公司当初发布的标准并不支持新一代的编码标准，无法在RTMP协议和FLV容器里面使用诸如HEVC(H.265)的新编码标准。苹果在2017年发售的设备里支持了HEVC，很多直播厂商都开始尝试基于HEVC的直播。早期的直播CDN厂商为了支持新的编码标准，自己对RTMP、FLV协议做了扩展。由于各厂家都按同样的方式进行了支持，形成了行业内的事实标准。&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n124&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;2）云端转码&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n126&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;对于终端设备上不能进行实时编码的场合，可以在云端进行转码。内容生产端可以用H.264或HEVC以较高的码率推流到云端，云端再实时进行转码，以AV1的格式进行输出。虽然云端转码需要消耗服务端的算力资源，消耗一定的成本，但当观看的人数规模上去后，节省的带宽成本就会远超转码成本。合适的做法就是只针对热门观看的直播流进行云端的转码，至于如何判断热门也有两种方式：一种是根据主播粉丝数预测，另外一种就是根据实际的观看人数后触发，保障转码开启后新进入的用户能看到AV1的直播流。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.509375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Uwpaickwgz7WA9KI7Pibup24zYnSJ1g1JzRzs9wYIq7iaHoVWPickwYxxInCgN9GcJiaR5BbwawDAB5kzK2rLAcAEmA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 cid=&quot;n90&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;3）客户端直接推AV1码流&lt;/span&gt;&lt;br/&gt;&lt;/h4&gt;&lt;p cid=&quot;n174&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;除了云端转码，还可以终端直接编码实时的AV1码流。当前主要是在PC端，分辨率不是太高的场合可以采用这种方式。对于上行直接推AV1的场合，PC和移动端就可以直接从CDN拉流播放了，对于不支持AV1解码的，还需要在云端转一路H264出来。随着时间的推移，未来这种方式会越来越占主流。&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n208&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;3.2 WebRTC中如何应用AV1&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n209&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;前面提到，目前Google的WebRTC项目已经整合了对AV1的支持。当前AOM联盟已经给出了AV1码流在rtp协议上的payload format建议文档（&lt;/span&gt;&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://aomediacodec.github.io/av1-rtp-spec/&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt;），同时也规定AV1的SDP信息描述。下面是个简单的例子。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; lang=&quot;&quot; cid=&quot;n218&quot; mdtype=&quot;fences&quot;&gt;&lt;span role=&quot;presentation&quot;&gt;m=video 49170 RTP/AVPF 98&lt;/span&gt;&lt;br/&gt;&lt;span role=&quot;presentation&quot;&gt;a=rtpmap:98 AV1/90000&lt;/span&gt;&lt;br/&gt;&lt;span role=&quot;presentation&quot;&gt;a=fmtp:98 profile=2; level-idx=8; tier=1;&lt;/span&gt;&lt;/pre&gt;&lt;p cid=&quot;n216&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;不过，普通的用户能使用上支持AV1的Chrome版本，估计还需要一段时间。由于当前AV1的编码需要很大的计算能力，AOM开源的编解码器性能都不是非常好，很难做到实时编解码。在解码端，dav1d是目前解码性能最好的AV1开源解码器，解码AV1的开销已经可以和HEVC的解码相当。Web端上由于有WebAssembly的支持，也可以实现在Web端的AV1支持了。在编码端，虽然Google已经把AV1的支持整合到了WebRTC之中（使用的aom的编码器，Chrome的90版dev），但目前AOM的AV1编码器在终端设备上还无法进行大分辨率的实时编码。不过已经有一些厂商推出了闭源的编码器，性能已经可以在PC端实时编码720p的视频。&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n207&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;4. 最后&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n166&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;直播和RTC技术越来越走向融合，本文讨论了直播和RTC融合的典型应用方案和主要障碍。另外也讨论了新一代编码标准AV1在直播和RTC中的落地方案与挑战。相信在不久的将来，用RTC技术来做超低延迟直播的方式会越来越普遍，直播与RTC也不会有清晰的界限。同时大家也能在不久的将来享受AV1给我们带来的用户体验提升。最近谷歌也宣布了一个基于人工智能的语音编码器Lyra，和AV1配合起来能做到以极低的码率实现视频通话。科技是第一生产力，视频技术发展也让我们的生活更美好。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n68&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n71&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n72&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n73&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>56284b534fc2506c548318bd5780f977</guid>
<title>架构实践全景图</title>
<link>https://toutiao.io/k/nu45i3g</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;markdown-body detail-content&quot;&gt;&amp;#13;
                &amp;#13;
                &lt;p&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/2103092b3c6d7e6f639c&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;p&gt;&lt;strong&gt;业务架构&lt;/strong&gt;是跨系统的业务架构蓝图，&lt;strong&gt;应用架构、数据架构、技术架构&lt;/strong&gt;是解决方案的不同方面。&lt;/p&gt;&amp;#13;
&lt;p&gt;多年来，全球业界已在业务架构、应用架构、数据架构、技术架构方面积累了大量经验。&lt;/p&gt;&amp;#13;
&lt;p&gt;近几年，数字化转型呼唤“懂行人”&lt;strong&gt;打通四种架构&lt;/strong&gt;，确保技术支撑业务、业务支撑战略。&lt;/p&gt;&amp;#13;
&lt;p&gt;本文就带大家来厘清这几种架构之间的脉络关系。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;其中，文中涉及的缩写全称如下。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;BA：Business Architecture，业务架构&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;DA：Data Architecture，数据架构&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;AA：Applications Architecture，应用架构&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;TA：Technology Architecture，技术架构&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;以下内容节选自&lt;strong&gt;《业务架构 应用架构 数据架构 实战》&lt;/strong&gt;一书！&lt;/p&gt;&amp;#13;
&lt;hr/&gt;&amp;#13;
&lt;h3 id=&quot;h3--ba-da-aa-ta-&quot;&gt;&lt;a name=&quot;战略、BA、DA、AA、TA五者的关系&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;战略、BA、DA、AA、TA五者的关系&lt;/h3&gt;&lt;p&gt;现在，我们来总览一下战略、BA、DA、AA、TA五者之间的边界与关系。如下图所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/210320bab64a95c1ca32&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;&lt;strong&gt;首先，公司管理层是战略的提出者和总设计师。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，一家大银行的全局战略规划出自何处？&lt;strong&gt;答：&lt;/strong&gt;管理层是规划者，规划发展部是协助者。规划发展部持续研究行业政策方向、持续关注宏观环境变化、持续跟踪友商发力动向。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;其次，业务架构师是业务架构蓝图的设计师和描述者。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，一个在银行的信息科技部工作的业务架构师。要研究战略、领会战略，把战略作为推动业务架构设计的原动力，定义出详细的业务架构蓝图。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;最后，解决方案由专业分工更细的数据架构师、应用架构师、技术架构师负责。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，银行的信息科技部一般有架构办公室，部门中有专职或兼任的数据架构师、应用架构师、技术架构师，还要有专门的安全架构师。&lt;/p&gt;&amp;#13;
&lt;p&gt;所以，战略、BA、DA、AA、TA这五者，实际位于以下三个层次上：&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;公司战略；&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务架构；&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;方案架构。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;这五者的核心关系，概括为以下几点：&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;战略是公司高层的设计，却是业务架构师的需求；&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务架构师的工作是“战略进，业务架构出”；&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务架构是业务架构师的设计，却是数据、应用、技术架构师的需求；&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环环相扣，上层驱动下层，下层支撑上层。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;h3 id=&quot;h3-ba-da-aa-ta-&quot;&gt;&lt;a name=&quot;BA、DA、AA、TA的实际工作内容&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;BA、DA、AA、TA的实际工作内容&lt;/h3&gt;&lt;p&gt;承接上文，公司战略层——业务架构层——方案架构层，三层大局已定。&lt;/p&gt;&amp;#13;
&lt;p&gt;那么，&lt;strong&gt;战略、BA、DA、AA、TA这五项工作，具体的内容有哪些呢？&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，确定战略驱动因素（Driver）之后，业务架构师应做哪些分析？&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，组织结构分析在哪里？应用项目划分在哪里？技术选型在哪里？&lt;/p&gt;&amp;#13;
&lt;p&gt;下图总结了BA、DA、AA、TA的实际内容。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/2103783b048aae214b5a&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;h4 id=&quot;h4-1-&quot;&gt;&lt;a name=&quot;1. 公司战略层。战略是业务架构设计的驱动力。&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;1. 公司战略层。战略是业务架构设计的驱动力。&lt;/h4&gt;&lt;p&gt;眼尖的朋友从上图中可以看出：战略规划需要广泛的外部分析、内部分析、基于SWOT的战略决策分析、最终制定出产品战略、服务战略、合作战略、渠道战略、市场战略、竞争战略等方面的具体方针。&lt;/p&gt;&amp;#13;
&lt;h4 id=&quot;h4-2-5-&quot;&gt;&lt;a name=&quot;2. 业务架构层。业务架构蓝图必须有企业标准，笔者推荐给企业的标准是5要素。&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;2. 业务架构层。业务架构蓝图必须有企业标准，笔者推荐给企业的标准是5要素。&lt;/h4&gt;&lt;p&gt;组织结构+业务功能+业务流程，这是经典的“老三样”，对应于“谁”“干什么”“怎么干”，符合国内老一代信息科技老总们的口味。&lt;/p&gt;&amp;#13;
&lt;p&gt;在业务架构蓝图中，应加上商业模式。九个格子的商业模式画布，比较新，有用且好用。我们后续再讲。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;在业务架构蓝图中，应加上业务数据。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;有利因素是，业务数据和业务功能、业务流程紧密相关，也属同一思维层次。不利因素是，有人争辩业务数据应属于数据架构。我看中的是有利因素，照顾的实践是：业务架构师的工作产物《业务架构书》要包含业务数据才完整。&lt;/p&gt;&amp;#13;
&lt;h4 id=&quot;h4-3-&quot;&gt;&lt;a name=&quot;3. 方案架构层。涉及数据架构、应用架构、技术架构。&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;3. 方案架构层。涉及数据架构、应用架构、技术架构。&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;数据架构的核心&lt;/strong&gt;是数据类型和来源。&lt;/p&gt;&amp;#13;
&lt;p&gt;例如，一家电商企业要把员工角色数据、员工操作日志、商品数据、订单数据、用户登录记录、用户搜索记录、用户评价记录、用户投诉记录等多种要管理的数据类型识别出来，才能有针对性地设计数据模型、数据存储与分布、数据流等。数据流是场景化的，业务功能不同，相关的数据流可能不同。数据流又常涉及数据产生、数据使用、数据加工、数据存储等。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;应用架构的核心&lt;/strong&gt;是识别出应用功能，并映射到应用项目。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;技术架构的核心&lt;/strong&gt;是识别出技术需求并映射到技术选型。笔者推荐的技术架构5要素包括：&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;技术需求——技术服务列表，或结构化地画出技术参考架构、技术栈。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;技术选型——技术平台、技术产品、技术框架、中间件。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;物理选型——硬件选型、网络选型。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;分布设计——部署结构、负载均衡。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;选型管理——面向行业的技术指标、企业中长期的技术选型标准。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;h3 id=&quot;h3--&quot;&gt;&lt;a name=&quot;从战略到架构，再到实施的实际过程&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;从战略到架构，再到实施的实际过程&lt;/h3&gt;&lt;h4 id=&quot;h4-1-&quot;&gt;&lt;a name=&quot;1. 从战略到架构&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;1. 从战略到架构&lt;/h4&gt;&lt;p&gt;首先，看看战略、BA、DA、AA、TA五个环节对应的岗位和产物，如下图所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/210361eae2910494b8ac&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;例如，银行、保险、证券等企业，都有自己的信息科技部，鲜有例外。架构办公室这个部门，是CIO的左右手。架构办有专职或兼任的业务架构师、数据架构师、应用架构师、技术架构师，还有专门的安全架构师。&amp;#13;
&lt;/p&gt;&lt;p&gt;业务架构师负责设计业务架构，内容包括业务功能、业务流程、商业模式、组织结构和业务数据等。业务架构师的输出，有的企业叫《业务架构书》，有的企业叫《业务需求书》。&lt;/p&gt;&amp;#13;
&lt;p&gt;业务架构师的输出，是数据、应用、技术架构师的输入。最典型的例子就是业务流程。BA架构师设计业务流程，数据、应用、技术架构师思考完成业务流程需要的数据支撑、系统协作、技术平台。&lt;/p&gt;&amp;#13;
&lt;h4 id=&quot;h4-2-&quot;&gt;&lt;a name=&quot;2. 从架构到实施&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;2. 从架构到实施&lt;/h4&gt;&lt;p&gt;下面，重点看架构路线图环节和实施规划环节。如下图所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/2103063ddc8042f9413c&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;要点是钉到岗位，落到文档，细到机构调整、技术采购、项目研发等工作包。&amp;#13;
&lt;/p&gt;&lt;p&gt;&lt;strong&gt;环节1：战略。&lt;/strong&gt;公司管理层牵头、规划发展部全程支持。产出物：《xx-xx年战略规划书》。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环节2：业务架构。&lt;/strong&gt;信息科技部的架构师团队的业务架构师负责。产出物：《业务架构书》。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环节3：方案架构。&lt;/strong&gt;信息科技部的架构师团队负责。产出物：《技术方案书》。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环节4：架构路线图。&lt;/strong&gt;涉及预算，CIO牵头制定、董事会批准。产出物：架构路线图。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环节5：实施规划。&lt;/strong&gt;CIO牵头制定。产出物：实施计划。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;环节6：项目管控。&lt;/strong&gt;采取研发的项目由PMO负责，采取购买的项目由总经理办公室（总经办）负责。&lt;/p&gt;&amp;#13;
&lt;h3 id=&quot;h3--da-aa-ta-&quot;&gt;&lt;a name=&quot;业务驱动——小试业务流程驱动的DA、AA、TA设计&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;业务驱动——小试业务流程驱动的DA、AA、TA设计&lt;/h3&gt;&lt;h4 id=&quot;h4-0-&quot;&gt;&lt;a name=&quot;0. 案例背景&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;0. 案例背景&lt;/h4&gt;&lt;p&gt;前文，我们弄清了BA、DA、AA、TA间的脉络关系，但太粗。&lt;/p&gt;&amp;#13;
&lt;p&gt;在此，我们“细看”业务流程在BA、DA、AA、TA间“穿针引线”的过程。总体而言：&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;在BA设计环节——业务流程被详细定义&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;在DA、AA、TA设计环节——业务流程是设计的驱动因素&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;本节的例子，仅围绕“买入股票”示范从业务流程到应用程序，又到数据实体，再到技术组件这条主线设计。&lt;/p&gt;&amp;#13;
&lt;h4 id=&quot;h4-1-&quot;&gt;&lt;a name=&quot;1. 业务架构&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;1. 业务架构&lt;/h4&gt;&lt;p&gt;作为示例，笔者简单画一下“买入股票”的业务流程图。&lt;/p&gt;&amp;#13;
&lt;p&gt;用Archimate语言建模，如下图所示。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务功能——买入股票。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务流程——由买入挂单、规则检查、上报给交易所等步骤组成。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;实现关系——业务流程到业务功能的箭头。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务数据——买入申报指令。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;业务事件——图中“交易所回报”事件会触发券商“处理成交结果”，当收市时，“当日收市”事件也会触发相应业务处理。可见，用好业务事件，有利于把“条件触发的业务场景”表达清楚。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/210321ac3cdb3604190d&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;h4 id=&quot;h4-2-&quot;&gt;&lt;a name=&quot;2. 应用架构&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;2. 应用架构&lt;/h4&gt;&lt;p&gt;应用架构师应思考：&lt;strong&gt;买入股票业务流程需要哪些应用服务支持呢？&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;1）&lt;/strong&gt;业务流程一级的买入挂单、规则检查、上报给交易所、处理成交结果，需要IT应用服务支持，分别为挂单录入、规则检查、委托上报、接收回报、结果显示。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;2）&lt;/strong&gt;进一步地，这些IT应用服务要由具体的应用系统来实现，分别为券商App、券商集中交易系统。如下图所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/210304034aa05c5972a5&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;h4 id=&quot;h4-3-&quot;&gt;&lt;a name=&quot;3. 数据架构&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;3. 数据架构&lt;/h4&gt;&lt;p&gt;数据架构师应思考：&lt;strong&gt;买入股票业务流程需要哪些数据支持呢？&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;1）&lt;/strong&gt;券商的集中交易系统作为后台，首先要将委托记录排队，以备异步处理。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;2）&lt;/strong&gt;券商App不保存“投资人账户”信息，但交易后台要保存，由证券经纪业务后台做交易规则检查。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;3）&lt;/strong&gt;由证券经纪业务后台负责的交易规则检查，会用到投资人账户和投资人资产等数据信息，例如，账户余额不足时是不允许挂单成功的。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;4）&lt;/strong&gt;后台存储“回报记录”数据，也是为了异步处理。如下图所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/2103ef99aee2037355d4&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;h4 id=&quot;h4-4-&quot;&gt;&lt;a name=&quot;4. 技术架构&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;4. 技术架构&lt;/h4&gt;&lt;p&gt;技术架构师应思考：&lt;strong&gt;买入股票业务流程需要哪些技术组件支持呢？&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;1）&lt;/strong&gt;挂单录入、结果显示等技术，由客户端应用程序支持。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;2）&lt;/strong&gt;规则检查、委托上报和接收回报是可重用的应用功能，可考虑实现成服务或微服务。&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;3）&lt;/strong&gt;基础设施的技术选型，由技术架构师决定。如下图1-8所示。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/210382b010f9dd14cff9&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;h3 id=&quot;h3-u603Bu7ED3&quot;&gt;&lt;a name=&quot;总结&quot; class=&quot;reference-link&quot;/&gt;&lt;span class=&quot;header-link octicon octicon-link&quot;/&gt;总结&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;本文重点 “理清BA、DA、AA、TA间的逻辑关系”，如下图所示。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;正向逻辑：战略决定业务，业务决定技术。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;strong&gt;反向逻辑：技术支撑业务，业务支撑战略。&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/21032ff115acfa372f30&quot; alt=&quot;&quot;/&gt;&amp;#13;
&lt;/p&gt;&lt;hr/&gt;&amp;#13;
&lt;p&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/21033988799ee1a7f8cc&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;&lt;strong&gt;《业务架构 应用架构 数据架构 实战》&lt;/strong&gt;&lt;br/&gt;温昱 著&amp;#13;
&lt;/p&gt;&lt;p&gt;&lt;strong&gt;每一页都是实践经验的总结，参考性超强&lt;/strong&gt;&lt;br/&gt;&lt;strong&gt;每一页都简洁明了重点突出，可读性超强&lt;/strong&gt;&lt;br/&gt;&lt;strong&gt;大局＋架构＋文档，三大篇，操作性超强&lt;/strong&gt;&lt;/p&gt;&amp;#13;
&lt;p&gt;本书思路清晰，每一个概念、每一项方法都给出了简要透彻的阐述。同时又结合实践，给读者看得见、摸得着的项目实感，帮助读者迅速上手。本书还有一个作用，就是能提升读者对IT及其业务的认知层次，为长远职业发展提供助力。&lt;br/&gt;&lt;img src=&quot;http://download.broadview.com.cn/Original/2103c1416217ae1dbc40&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;（扫码了解本书详情）&amp;#13;
&amp;#13;
            &lt;/p&gt;&lt;/div&gt;&amp;#13;
&amp;#13;
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>f0878a9937fed34550107ffaac013688</guid>
<title>Kubelet 从入门到放弃系列：GPU 加持</title>
<link>https://toutiao.io/k/ynak46f</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p cid=&quot;n178&quot; mdtype=&quot;paragraph&quot;&gt;在Kubernetes 1.10中Device Plugins升为Beta特性，在Kubernetes 1.8时，为了给第三方厂商通过插件化的方式将设备资源接入到Kubernetes，给容器提供Extended Resources。&lt;/p&gt;&lt;p cid=&quot;n179&quot; mdtype=&quot;paragraph&quot;&gt;通过Device Plugins方式，用户无需要改Kubernetes的代码，由第三方设备厂商开发插件，实现Kubernetes Device Plugins的相关接口即可（仔细想想，Kubernetes中的volume管理是否也是类似的逻辑？CSI、CNI、CRI？）。&lt;/p&gt;&lt;p cid=&quot;n180&quot; mdtype=&quot;paragraph&quot;&gt;目前Device Plugins典型实现有：&lt;/p&gt;&lt;p cid=&quot;n313&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        a） AMD GPU插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n315&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        b）Intel设备插件：GPU、FPGA和QuickAssist设备&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n317&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        c）KubeVirt用于硬件辅助的虚拟化设备插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n181&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        d）Nvidia提供的GPU插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n182&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        e）高性能低延迟RDMA卡插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n183&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        f）低延迟Solarflare万兆网卡驱动&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n319&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        g）SR-IOV网络设备插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n321&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        h）Xilinx FPGA设备插件&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n184&quot; mdtype=&quot;paragraph&quot;&gt;    Kubelet启动Device plugins服务端，对应设备商启动Device Plugin服务，对外暴露几个gRPC Service提供服务，并通过/var/lib/kubelet/device-plugins/kubelet.sock与Kubelet通信。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;        其中Kubelet问题描述：&lt;/section&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;Events:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  Type     Reason         Age                   From               Message&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  ----     ------         ----                  ----               -------&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  Normal   Scheduled      &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;m                   &lt;span class=&quot;code-snippet__keyword&quot;&gt;default&lt;/span&gt;-scheduler  Successfully assigned gpu-&lt;span class=&quot;code-snippet__keyword&quot;&gt;operator&lt;/span&gt;-resources/nvidia-device-plugin-daemonset-f99md to cl-gpu-md&lt;span class=&quot;code-snippet__number&quot;&gt;-0&lt;/span&gt;-f4gm6&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  Warning  InspectFailed  &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;m (x3 over &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;m)     kubelet            Failed to inspect image &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;nvcr.io/nvidia/k8s/cuda-sample:vectoradd-cuda10.2&quot;&lt;/span&gt;: rpc error: code = Unavailable desc = all SubConns are &lt;span class=&quot;code-snippet__keyword&quot;&gt;in&lt;/span&gt; TransientFailure, latest connection error: connection error: desc = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;transport: Error while dialing dial unix /run/containerd/containerd.sock: connect: connection refused&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n366&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        其中Nvidia Device Plugin Daemonset某一个Pod相关错误，如下&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;sql&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;2021/02/11 01:32:29 Loading NVML&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;2021/02/11 01:32:29 Failed to initialize NVML: could not &lt;span class=&quot;code-snippet__keyword&quot;&gt;load&lt;/span&gt; NVML library.&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;01&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;29&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;If&lt;/span&gt; this &lt;span class=&quot;code-snippet__keyword&quot;&gt;is&lt;/span&gt; a GPU node, did you &lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt; the docker &lt;span class=&quot;code-snippet__keyword&quot;&gt;default&lt;/span&gt; runtime &lt;span class=&quot;code-snippet__keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;`nvidia`&lt;/span&gt;?&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;01&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;29&lt;/span&gt; You can &lt;span class=&quot;code-snippet__keyword&quot;&gt;check&lt;/span&gt; the prerequisites &lt;span class=&quot;code-snippet__keyword&quot;&gt;at&lt;/span&gt;: https://github.com/NVIDIA/k8s-device-&lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;01&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;29&lt;/span&gt; You can learn how &lt;span class=&quot;code-snippet__keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt; the runtime &lt;span class=&quot;code-snippet__keyword&quot;&gt;at&lt;/span&gt;: https://github.com/NVIDIA/k8s-device-&lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;01&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;29&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;If&lt;/span&gt; this &lt;span class=&quot;code-snippet__keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;not&lt;/span&gt; a GPU node, you should &lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt; up a toleration &lt;span class=&quot;code-snippet__keyword&quot;&gt;or&lt;/span&gt; nodeSelector &lt;span class=&quot;code-snippet__keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;only&lt;/span&gt; deploy this &lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;on&lt;/span&gt; GPU nodes&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;span&gt;      该问题由于containerd的配置文件containerd.toml未将default_runtime_name = &quot;runc&quot;修改为default_runtime_name = &quot;nvidia&quot;,&lt;/span&gt;&lt;span&gt;相关问题：&lt;/span&gt;&lt;span&gt;https://github.com/NVIDIA/gpu-operator/issues/143&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;       &lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;h6 cid=&quot;n394&quot; mdtype=&quot;heading&quot;&gt;&lt;strong&gt;        &lt;/strong&gt;&lt;span&gt;&lt;strong&gt;b. kubelet cgroup driver配置&lt;/strong&gt;&lt;/span&gt;&lt;/h6&gt;&lt;section&gt;&lt;span&gt;        &lt;/span&gt;&lt;span&gt;相关问题：&lt;/span&gt;&lt;span&gt;https://github.com/NVIDIA/libnvidia-container/issues/119&lt;/span&gt;&lt;/section&gt;&lt;p cid=&quot;n403&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;      &lt;/span&gt;&lt;span&gt;在kubelet配置的cgroup driver为systemd时，Nvidia的container prestart hook在处理cgroup路径逻辑与containerd不一致。&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;sql&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;containerd[76114]: time=&quot;2020-12-04T08:52:13.029072066Z&quot; level=error msg=&quot;StartContainer for &quot;7a1453c6e7ab8af7395ccc8dac5efcffa94a0834aa7b252e1dcd5b51f92bf13e&quot; failed&quot; error=&quot;failed to &lt;span class=&quot;code-snippet__keyword&quot;&gt;create&lt;/span&gt; containerd task: OCI runtime &lt;span class=&quot;code-snippet__keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;failed&lt;/span&gt;: container_linux.go:&lt;span class=&quot;code-snippet__number&quot;&gt;370&lt;/span&gt;: &lt;span class=&quot;code-snippet__keyword&quot;&gt;starting&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;container&lt;/span&gt; process caused: process_linux.go:&lt;span class=&quot;code-snippet__number&quot;&gt;459&lt;/span&gt;: &lt;span class=&quot;code-snippet__keyword&quot;&gt;container&lt;/span&gt; init caused: Running hook &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n403&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        解决方案为升级libnvidia-container或者container-toolkit。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n403&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        接下来，介绍部署相关内容。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n426&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;h5 cid=&quot;n120&quot; mdtype=&quot;heading&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;        &lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;2.2 Containerd方式&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/h5&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;‍‍‍&lt;/span&gt;       &lt;/span&gt;&lt;strong&gt;&lt;span&gt; 1）&lt;/span&gt;&lt;span&gt;版本说明&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;span/&gt;软件&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;版本说明&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;CentOS&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;7&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;内核&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;4.19.25&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;GPU型号&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;Tesla T4&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;driver版本&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;418.39&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;CUDA版本&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;10.1&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;K8S&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;1.18.5&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;Nvidia Device Plugin&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;0.7.3&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;Containerd&lt;br/&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot; colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;v1.4.3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;runc&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;/td&gt;&lt;td valign=&quot;top&quot;&gt;1.0.0-rc1&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;      &lt;/span&gt;&lt;strong&gt;2）安装&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;       &lt;/span&gt;&lt;strong&gt;&lt;span&gt;注：&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;下文为内网离线部署，若各位在联网环境下，只需参考部署步骤及部署配置即可&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;        &lt;/span&gt;&lt;strong&gt;&lt;span&gt;a. 安装驱动&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;shell&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; tar ‐zxvf gpu.tar.gz &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; gpu/runtime &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; tar ‐zxvf dependency.tar.gz &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; dependency &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; ./lspci/ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; yum localinstall ‐y *.rpm &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; lspci | grep ‐i nvidia &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; ../devel &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; yum localinstall ‐y *.rpm &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; yum localinstall ‐y *.rpm &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; lsmod | grep nouveau &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; rmmod nouveau &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; ../../../driver &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; sh cuda_10.1.105_418.39_linux.run &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;span&gt;        结果验证&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;shell&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; nvidia‐smi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.575503355704698&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HDR5NXtUkG0KLpGl7aibP8L6Ib4PprAwcXVicoaiazLE3ujRBxQ48wEicfxoUuvbHj5ra3Sb7Vj4iaz4thjRfRibL7pg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;596&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;        附：安装驱动图&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;       &lt;span&gt;(1) 输入accept，回车&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6044260027662517&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HDR5NXtUkG0KLpGl7aibP8L6Ib4PprAwc983ecH5HJpkajyINboLb3SDP1hxZIibWNIS3l9ycSl1DOIoNqIUxzCQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;723&quot;/&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;        (2) 选择install，回车&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5076071922544951&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HDR5NXtUkG0KLpGl7aibP8L6Ib4PprAwcepaeZksmPia1Zib6N6wBkfeG7AqEdOEp4exE7UuQBPaOvBrHV98uPQXA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;723&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        &lt;strong&gt;2）配置Containerd&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;shell&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; ../runtime &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; cp runc /usr/bin/ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; tar ‐zxvf containerd‐1.4.3‐linux‐amd64.tar.gz &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; cp bin/* /usr/bin/ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; nvidia‐container‐runtime &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; yum localinstall ‐y *.rpm&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;h5 cid=&quot;n889&quot; mdtype=&quot;heading&quot;&gt;      &lt;span&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;修改containerd启动参数 &lt;/span&gt;&lt;/h5&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;shell&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt; 配置containerd的参数 &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; mkdir /etc/containerd/ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; vi /etc/containerd/config.toml &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt; 配置containerd.service &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; vi /usr/lib/systemd/system/containerd.service &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; systemctl daemon‐reload &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; systemctl restart containerd &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt; 配置crictl &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; tar ‐zxvf crictl‐v1.18.0‐linux‐amd64.tar.gz &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; mv crictl /usr/bin/ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; vi /etc/profile &lt;span class=&quot;code-snippet__built_in&quot;&gt;alias&lt;/span&gt; crictl=&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;crictl ‐‐runtime‐endpoint unix:///run/containerd/containerd.sock&#x27;&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;source&lt;/span&gt; /etc/profile &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;/span&gt; 测试containerd和nvidia‐container‐runtime安装是否成功 &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;test&lt;/span&gt;‐image &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; ctr images import cuda‐vector‐add_v0.1.tar &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;$&lt;/span&gt; ctr images push ‐‐plain‐http registry.paas/cmss/cuda‐vector‐add:v0.1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;        执行检验&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;ctr run ‐t ‐‐gpus &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt; registry.paas/cmss/cuda‐vector‐&lt;span class=&quot;code-snippet__keyword&quot;&gt;add&lt;/span&gt;:v0&lt;span class=&quot;code-snippet__number&quot;&gt;.1&lt;/span&gt; cp nvidia‐smi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;h5 cid=&quot;n889&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;&lt;strong&gt;        &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;结果如下&lt;/span&gt;&lt;/h5&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.575503355704698&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HDR5NXtUkG0KLpGl7aibP8L6Ib4PprAwcXVicoaiazLE3ujRBxQ48wEicfxoUuvbHj5ra3Sb7Vj4iaz4thjRfRibL7pg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;596&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;        清理容器&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;nginx&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attribute&quot;&gt;ctr&lt;/span&gt; c rm cp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p cid=&quot;n484&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;        &lt;/span&gt;&lt;span&gt;配置config.toml&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n496&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;执行containerd config default &amp;gt; /etc/containerd/config.toml生成配置，并做如下修改：&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n496&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;    &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.4702774108322325&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HDR5NXtUkG0KLpGl7aibP8L6Ib4PprAwchyB0CN7LYU519XMO4y0T0X2paLiaCpp5SWV2iawCzv79H13Lvuhd5wibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;757&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n496&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        &lt;strong&gt;注意&lt;/strong&gt;：如上所述，1）default_runtime_name值为nvidia，2）新增一个runtimes 3）若有内部镜像仓库，可修改docker.io为内部仓库名称&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p cid=&quot;n496&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        &lt;/span&gt;&lt;span&gt;配置containerd.service&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;ini&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__section&quot;&gt;[Unit]&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;Description&lt;/span&gt;=containerd container runtime &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;Documentation&lt;/span&gt;=https://containerd.io After=network.target&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;[Service]&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;ExecStartPre&lt;/span&gt;=‐/sbin/modprobe overlay &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;ExecStart&lt;/span&gt;=/usr/bin/containerd &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;KillMode&lt;/span&gt;=process &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;Delegate&lt;/span&gt;=&lt;span class=&quot;code-snippet__literal&quot;&gt;yes&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;LimitNOFILE&lt;/span&gt;=&lt;span class=&quot;code-snippet__number&quot;&gt;1048576&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;LimitCORE&lt;/span&gt;=infinity &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;TasksMax&lt;/span&gt;=infinity &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__section&quot;&gt;[Install]&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attr&quot;&gt;WantedBy&lt;/span&gt;=multi‐user.target    &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n504&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;        c. 部署Device Plugin&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n508&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;        在部署完Kubernetes集群后，修改kubelet运行时配置：&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;ruby&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ vi /apps/conf/kubernetes/kubelet.env ‐‐container‐runtime=remote ‐‐container‐runtime‐endpoint=&lt;span class=&quot;code-snippet__symbol&quot;&gt;unix:&lt;/span&gt;/&lt;span class=&quot;code-snippet__regexp&quot;&gt;//run&lt;/span&gt;&lt;span class=&quot;code-snippet__regexp&quot;&gt;/containerd/containerd&lt;/span&gt;.sock&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n508&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span/&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;sql&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ cd device‐plugin &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ docker &lt;span class=&quot;code-snippet__keyword&quot;&gt;load&lt;/span&gt; ‐i k8s‐device‐plugin_v0&lt;span class=&quot;code-snippet__number&quot;&gt;.7&lt;/span&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;.3&lt;/span&gt;.tar &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ docker push&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;// https://github.com/NVIDIA/k8s-device-&lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt;/tree/&lt;span class=&quot;code-snippet__keyword&quot;&gt;master&lt;/span&gt;/deployments/&lt;span class=&quot;code-snippet__keyword&quot;&gt;static&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ kubectl &lt;span class=&quot;code-snippet__keyword&quot;&gt;apply&lt;/span&gt; ‐f nvidia‐device‐plugin.yml &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ kubectl &lt;span class=&quot;code-snippet__keyword&quot;&gt;logs&lt;/span&gt; ‐f nvidia‐device‐&lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt;‐daemonset‐q9svq ‐nkube‐&lt;span class=&quot;code-snippet__keyword&quot;&gt;system&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;36&lt;/span&gt; Loading NVML &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;Starting&lt;/span&gt; FS watcher. &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;Starting&lt;/span&gt; OS watcher. &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; Retreiving plugins. &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;Starting&lt;/span&gt; GRPC &lt;span class=&quot;code-snippet__keyword&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;nvidia.com/gpu&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;Starting&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;to&lt;/span&gt; serve &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;nvidia.com/gpu&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;on&lt;/span&gt; /&lt;span class=&quot;code-snippet__keyword&quot;&gt;var&lt;/span&gt;/lib/kubelet/device‐ plugins/nvidia‐gpu.sock &lt;span class=&quot;code-snippet__number&quot;&gt;2021&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;code-snippet__number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;06&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;32&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;42&lt;/span&gt; Registered device &lt;span class=&quot;code-snippet__keyword&quot;&gt;plugin&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;nvidia.com/gpu&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;with&lt;/span&gt; Kubelet&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n496&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;        d. 功能测试&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;sql&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ cd test‐image &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ kubectl apply ‐f demo.yml&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;// https://github.com/NVIDIA/gpu-operator/blob/master/tests/gpu-pod.yaml&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;$ kubectl logs ‐f cuda‐vector‐add &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;[Vector addition of 50000 elements] &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;Copy input data from the host memory to the CUDA device &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;CUDA kernel launch &lt;span class=&quot;code-snippet__keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;196&lt;/span&gt; blocks &lt;span class=&quot;code-snippet__keyword&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;256&lt;/span&gt; threads &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;Copy &lt;span class=&quot;code-snippet__keyword&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;from&lt;/span&gt; the CUDA device &lt;span class=&quot;code-snippet__keyword&quot;&gt;to&lt;/span&gt; the host &lt;span class=&quot;code-snippet__keyword&quot;&gt;memory&lt;/span&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;Test&lt;/span&gt; PASSED &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;Done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3c55d4ef5bee69ff76f8c55106bbdfef</guid>
<title>一个惊人快速的终端录像工具，也能录制 VSCode 和 Chrome 窗口</title>
<link>https://toutiao.io/k/7wxzuz6</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;RichText ztext Post-RichText&quot;&gt;&lt;p&gt;【导语】：t-rec 是一款惊人的快速终端记录器，可以生成 gif 图像。&lt;/p&gt;
&lt;h3&gt;简介&lt;/h3&gt;
&lt;p&gt;t-rec 是使用 Rust 实现的一款快速终端记录器，结果可生成动图或视频，有以下特点：&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;以每秒 4 帧的速度录制终端&lt;/li&gt;
&lt;li&gt;生成高质量的小尺寸动画 gif 图像或 mp4 视频&lt;/li&gt;
&lt;li&gt;内置空闲帧检测和优化(用于超级流体演示)&lt;/li&gt;
&lt;li&gt;应用(可以禁用)边框装饰效果，如投影&lt;/li&gt;
&lt;li&gt;在 MacOS 和 Linux 上运行&lt;/li&gt;
&lt;li&gt;使用本地高效的 api&lt;/li&gt;
&lt;li&gt;在没有任何云服务的情况下运行，完全脱机&lt;/li&gt;
&lt;li&gt;支持终端尺寸大于 80x24&lt;/li&gt;
&lt;li&gt;字体和颜色均可正常显示&lt;/li&gt;
&lt;li&gt;支持基于 curses 的程序&lt;/li&gt;
&lt;li&gt;支持转义序列&lt;/li&gt;
&lt;li&gt;没有记录和重放-只是一个简单的命令来管理&lt;/li&gt;
&lt;li&gt;隐藏功能:记录任意窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-6cbea6d3e13dfd2de483083139d7a787_b.jpg&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1014&quot; data-rawheight=&quot;715&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic4.zhimg.com/v2-6cbea6d3e13dfd2de483083139d7a787_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1014&quot; data-rawheight=&quot;715&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic4.zhimg.com/v2-6cbea6d3e13dfd2de483083139d7a787_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-6cbea6d3e13dfd2de483083139d7a787_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;项目地址：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://link.zhihu.com/?target=https%3A//github.com/sassman/t-rec-rs&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;github.com/sassman/t-re&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;c-rs&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;下载安装&lt;/h3&gt;
&lt;p&gt;t-rec 仅支持在 MacOS 和 Linux 安装使用，方法如下：&lt;/p&gt;
&lt;h4&gt;在MacOS下安装使用&lt;/h4&gt;


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;brew install imagemagick  
cargo install -f t-rec   &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;在Linux下安装使用&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;sudo apt-get install imagemagick  
wget https://github.com/sassman/t-rec-rs/releases/download/v0.5.0/t-rec_0.5.0_amd64.deb  
sudo dpkg -i t-rec_0.5.0_amd64.deb  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;sudo snap install t-rec --classic  
/snap/bin/t-rec --version  
t-rec 0.4.3  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;#先安装依赖imagemagick  
sudo apt-get install libx11-dev imagemagick  
cargo install -f t-rec  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ubuntu 20.10 GNOME下使用效果：  &lt;/p&gt;
&lt;p&gt;
&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_b.gif&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;643&quot; data-rawheight=&quot;432&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;643&quot; data-rawheight=&quot;432&quot; data-thumbnail=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_r.jpg&quot; data-actualsrc=&quot;https://pic4.zhimg.com/v2-e5572471c9a0ea9c816096407dbc6417_b.gif&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ubuntu 20.10 i3wm下使用效果：  &lt;/p&gt;
&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_b.gif&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;588&quot; data-rawheight=&quot;800&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;588&quot; data-rawheight=&quot;800&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-d8902cfef4cfbfa8021fae5dbbaa2c21_b.gif&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;linux mint 20 cinnamon下使用效果：  &lt;/p&gt;
&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_b.gif&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;388&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;622&quot; data-rawheight=&quot;388&quot; data-thumbnail=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_r.jpg&quot; data-actualsrc=&quot;https://pic3.zhimg.com/v2-b5da3a077b8e6496468154c2d259095e_b.gif&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ArcoLinux 5.4 Xfwm4下使用效果：  &lt;/p&gt;
&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_b.gif&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;814&quot; data-rawheight=&quot;514&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;814&quot; data-rawheight=&quot;514&quot; data-thumbnail=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_b.jpg&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-3cc1802fb89bd56371911dbc2a644259_b.gif&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4&gt;使用命令详解&lt;/h4&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;t-rec [FLAGS] [OPTIONS] [shell or program to launch]  
FLAGS:  
    -h, --help       打印帮助信息  
    -l, --ls-win     显示窗口ID，设置环境变量&#x27;WINDOWID&#x27;去录制指定的窗口  
    -n, --natural    自然的打字体验并禁用空闲检测和采样优化  
    -q, --quiet      静音模式，不提示:“Press Ctrl+D to end recording”  
    -V, --version    显示版本信息  
    -v, --verbose    详细信息  

OPTIONS:  
    -b, --bg &amp;lt;bg&amp;gt;          背景颜色[默认: transparent]，[可选: white, black,transparent]  
    -d, --decor &amp;lt;decor&amp;gt;    装饰效果 [默认: shadow]  [可选: shadow, none]  
    -m, --video &amp;lt;video&amp;gt;    对gif生成一个mp4视频[默认: mp4]  [可选: mp4]  

ARGS:  
    &amp;lt;shell or program to launch&amp;gt;    启动指定的程序，例如 &#x27;/bin/sh&#x27;  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4&gt;录制指定的窗口&lt;/h4&gt;
&lt;ul&gt;&lt;li&gt;通过环境变量TERM_PROGRAM指定录制Google Chrome窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;TERM_PROGRAM=&quot;google chrome&quot; t-rec  

Frame cache dir: &quot;/var/folders/m8/084p1v0x4770rpwpkrgl5b6h0000gn/T/trec-74728.rUxBx3ohGiQ2&quot;  
Recording window: &quot;Google Chrome 2&quot;  
Press Ctrl+D to end recording  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-f228ccffa9e8ec6faa9c8dbb04ae8b2d_b.jpg&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic2.zhimg.com/v2-f228ccffa9e8ec6faa9c8dbb04ae8b2d_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1080&quot; data-rawheight=&quot;713&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic2.zhimg.com/v2-f228ccffa9e8ec6faa9c8dbb04ae8b2d_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-f228ccffa9e8ec6faa9c8dbb04ae8b2d_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;通过环境变量WINDOWID指定录制VSCode窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot;&gt;t-rec --ls-win | grep -i code  
Code | 27600  

# set the WINDOWID variable and run t-rec  
WINDOWID=27600 t-rec  

Frame cache dir: &quot;/var/folders/m8/084p1v0x4770rpwpkrgl5b6h0000gn/T/trec-77862.BMYiHNRWqv9Y&quot;  
Press Ctrl+D to end recording  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;figure data-size=&quot;normal&quot;&gt;&lt;noscript&gt;&lt;img src=&quot;https://pic2.zhimg.com/v2-a9ed6352c420b2246fb9e3f0256bd151_b.jpg&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1079&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb&quot; data-original=&quot;https://pic2.zhimg.com/v2-a9ed6352c420b2246fb9e3f0256bd151_r.jpg&quot;/&gt;&lt;/noscript&gt;&lt;img src=&quot;&quot; alt=&quot;&quot; data-size=&quot;normal&quot; data-rawwidth=&quot;1079&quot; data-rawheight=&quot;977&quot; class=&quot;origin_image zh-lightbox-thumb lazy&quot; data-original=&quot;https://pic2.zhimg.com/v2-a9ed6352c420b2246fb9e3f0256bd151_r.jpg&quot; data-actualsrc=&quot;https://pic2.zhimg.com/v2-a9ed6352c420b2246fb9e3f0256bd151_b.jpg&quot;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;开源前哨&lt;/code&gt; 日常分享热门、有趣和实用的开源项目。参与维护 10万+ Star 的开源技术资源库，包括：Python、Java、C/C++、Go、JS、CSS、Node.js、PHP、.NET 等。&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>02e0d4b92c979f066cb152874634b3e5</guid>
<title>聊聊项目打包发布到 maven 私仓常见的几种方式</title>
<link>https://toutiao.io/k/7sexyoc</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;1.0344827586206897&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EPUeFZ7ty9CfkibKcARoDSRvY9fxotBZUiaqmesxs0TePmeM0ibafMJ3LM7IFvXia66S2ibyRCkhkGiaYUuy4lnT076Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;58&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;0.5714285714285714&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_svg/6XFhg7ldObyL6BJWO6fglOSCzuYh5p0BZA4ytIpMEiaicpn04ibsZ9RhzLYD3ibMYVKRX7FOvdcaueIdN92YMAUcbQicnKdeRhJAia/640?wx_fmt=svg&quot; data-type=&quot;svg&quot; data-w=&quot;7&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;点击上方&lt;span data-mid=&quot;&quot;&gt;蓝字&lt;/span&gt;关注我们&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h1 data-mid=&quot;&quot;&gt;01&lt;/h1&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;前言&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在早期没有使用maven之前，我们引用一些公有jar或者api jar，我们可能会采用这样的方式，通过手动导入这些jar到项目的classpath路径进行引用。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;有了maven后，我们公司内部可能就会搭建maven私仓比如nexus，然后把这些公有jar或者api jar上传到nexus私仓，在pom.xml配置一下这些jar的坐标就可以引用。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;今天我们的话题就是来聊聊项目打包发布到maven私仓常见的几种方式&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h1 data-mid=&quot;&quot;&gt;02&lt;/h1&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;发布到maven私仓的步骤&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h1 data-mid=&quot;&quot;&gt;01&lt;/h1&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;在maven的settings.xml中&amp;lt; servers &amp;gt;节点配置用户名和密码，形如下&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;servers&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus-releases&lt;span&gt;&amp;lt;/&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;admin&lt;span&gt;&amp;lt;/&lt;span&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;admin123&lt;span&gt;&amp;lt;/&lt;span&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus-snapshots&lt;span&gt;&amp;lt;/&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;admin&lt;span&gt;&amp;lt;/&lt;span&gt;username&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;      &lt;span&gt;&amp;lt;&lt;span&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;admin123&lt;span&gt;&amp;lt;/&lt;span&gt;password&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt; &lt;span&gt;&amp;lt;/&lt;span&gt;servers&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;注：&lt;/strong&gt;&lt;span&gt; 其中id可先看做是一个标识。username和password为nexus私仓的用户名和密码&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h1 data-mid=&quot;&quot;&gt;02&lt;/h1&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;指定发布到nexus私仓的url并进行发布&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;方式一：pom.xml文件添加distributionManagement节点&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;0.9444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Rqe8ZlXI8qsNPLgD6ew1MzerlZqzSpZxVR3uLdds998fWr8FsaibXefKoNhS1M8Yyeuq7qSOriaUTwmCNlSXyNBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;36&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;形如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;distributionManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;!--正式版本--&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;&lt;span&gt;repository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            &lt;span&gt;&amp;lt;!-- 在settings.xml中&amp;lt;server&amp;gt;的id--&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            &lt;span&gt;&amp;lt;&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus-releases&lt;span&gt;&amp;lt;/&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            &lt;span&gt;&amp;lt;&lt;span&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://192.168.0.11:8081/nexus/content/repositories/releases/&lt;span&gt;&amp;lt;/&lt;span&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;/&lt;span&gt;repository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;!--快照版本--&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;&lt;span&gt;snapshotRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;             &lt;span&gt;&amp;lt;&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus-snapshots&lt;span&gt;&amp;lt;/&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;             &lt;span&gt;&amp;lt;&lt;span&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://192.168.0.11:8081/nexus/content/repositories/snapshots/&lt;span&gt;&amp;lt;/&lt;span&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;/&lt;span&gt;snapshotRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;distributionManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;注：&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果存在parent，只需在parent中的pom.xml中配置，没有则在本项目的pom.xml配置即可&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&amp;lt; repository &amp;gt;节点下的&amp;lt; id &amp;gt;对应maven的配置文件settings.xml文件中的server的id，两者必须保持一致&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;上传到私仓的是正式版本还是快照版本，取决于pom.xml文件version中是SNAPSHOT还是RELEASE。比如你项目中配置如下&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.example&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;demo&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;0.0.1-SNAPSHOT&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;则上传到私仓的就是快照版本。最后执行maven的deploy命令进行发布&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;方式二：在maven的settings.xml中&amp;lt; profiles &amp;gt;节点配置&amp;lt; properties &amp;gt;，并在&amp;lt; properties &amp;gt;指定 &amp;lt; altSnapshotDeploymentRepository &amp;gt; 和&amp;lt; altReleaseDeploymentRepository &amp;gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;0.9444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Rqe8ZlXI8qsNPLgD6ew1MzerlZqzSpZxVR3uLdds998fWr8FsaibXefKoNhS1M8Yyeuq7qSOriaUTwmCNlSXyNBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;36&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;形如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;profiles&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;     &lt;span&gt;&amp;lt;&lt;span&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;   &lt;span&gt;&amp;lt;&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span&gt;&amp;lt;/&lt;span&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;     &lt;span&gt;&amp;lt;&lt;span&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;&lt;span&gt;altSnapshotDeploymentRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;             nexus-snapshots::default::http://192.168.0.11:8081/repository/maven-snapshots/&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;/&lt;span&gt;altSnapshotDeploymentRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;&lt;span&gt;altReleaseDeploymentRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            nexus-releases::default::http://192.168.0.11:8081/repository/maven-releases/&lt;br mpa-from-tpl=&quot;t&quot;/&gt;         &lt;span&gt;&amp;lt;/&lt;span&gt;altReleaseDeploymentRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;     &lt;span&gt;&amp;lt;/&lt;span&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;  &lt;span&gt;&amp;lt;/&lt;span&gt;profiles&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;  &lt;span&gt;&amp;lt;&lt;span&gt;activeProfiles&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;activeProfile&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span&gt;&amp;lt;/&lt;span&gt;activeProfile&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;  &lt;span&gt;&amp;lt;/&lt;span&gt;activeProfiles&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;注：&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;nexus-snapshots和 nexus-releases要和maven的配置文件settings.xml文件中的server的id，两者必须保持一致&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;属性altSnapshotDeploymentRepository和altReleaseDeploymentRepository是随maven-release-plugin 2.8版一起引入的。低于2.8版本，执行mvn deploy时，则会报如下错误&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;Deployment &lt;span&gt;failed:&lt;/span&gt; repository element was &lt;span&gt;not&lt;/span&gt; specified &lt;span&gt;in&lt;/span&gt; the POM inside distributionManagement element &lt;span&gt;or&lt;/span&gt; &lt;span&gt;in&lt;/span&gt; -DaltDeploymentRepository=id::layout::url parameter&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;解决方案就是在发布的项目中指定一下2.8版本以上的插件，形如下&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;&lt;span&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            &lt;span&gt;&amp;lt;&lt;span&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;                &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-deploy-plugin&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;                &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.8.2&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;            &lt;span&gt;&amp;lt;/&lt;span&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;        &lt;span&gt;&amp;lt;/&lt;span&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;最后再执行maven的deploy命令进行发布&lt;br/&gt;&lt;/span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;方式三：通过mvn deploy指定参数&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;0.9444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Rqe8ZlXI8qsNPLgD6ew1MzerlZqzSpZxVR3uLdds998fWr8FsaibXefKoNhS1M8Yyeuq7qSOriaUTwmCNlSXyNBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;36&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;形如下&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;mvn deploy -DskipTests -DaltSnapshotDeploymentRepository=nexus-snapshot&lt;span&gt;s:&lt;/span&gt;:defaul&lt;span&gt;t:&lt;/span&gt;:http&lt;span&gt;s:&lt;/span&gt;//YOUR_NEXUS_URL/snapshots&lt;br mpa-from-tpl=&quot;t&quot;/&gt;-DaltReleaseDeploymentRepository=nexus-release&lt;span&gt;s:&lt;/span&gt;:defaul&lt;span&gt;t:&lt;/span&gt;:http&lt;span&gt;s:&lt;/span&gt;//YOUR_NEXUS_URL/releases&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;同理上述命令要执行成功，得确保deploy插件是基于2.8版本以上&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;形如下&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-preserve=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;pre&gt;&lt;code&gt;mvn deploy:deploy-file -DskipTests -Dfile=jar包文件地址,绝对路径 -DgroupId=组名 -DartifactId=项目名称 -Dversion=版本号 -Dpackaging=jar -DrepositoryId=私库&lt;span&gt;id&lt;/span&gt;（和setting.xml文件中的server的&lt;span&gt;id&lt;/span&gt;保持一致） -Durl=私仓地址&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;方式四：通过nexus的可视化界面进行上传jar发布&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;0.9444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Rqe8ZlXI8qsNPLgD6ew1MzerlZqzSpZxVR3uLdds998fWr8FsaibXefKoNhS1M8Yyeuq7qSOriaUTwmCNlSXyNBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;36&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;如下图&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.4959770114942529&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NW0r9OxcmxLsbXpD4Q6FFHEePiaup8h2D7bqy0jh65vcfujHVVgiaBhOkwkaCJVbfaAVdQBM5X7ibhmQOR8qIH8Eg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1740&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h1 data-mid=&quot;&quot;&gt;03&lt;/h1&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;这几种发布方式的选择&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;方式一，通过distributionManagement这种方式发布，可能是大多数人的选择。但如果要发布的项目很多，我们就可以考虑使用方式二，通过在全局的settings文件配置altSnapshotDeploymentRepository 和altReleaseDeploymentRepository进行发布，只需配置一次，所有项目就都可以发布，无需在多个项目pom指定&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;方式一和方式二比较适合公司自己内部开发项目，对于一些第三方提供的jar，推荐使用mvn deploy -DrepositoryId=私库id（和settings.xml文件中的server的id保持一致） -Durl=私仓地址的方式或者直接使用nexus可视化界面上传的方式&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>