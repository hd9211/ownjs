<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>5abaac07012560800d482eba8da87e09</guid>
<title>Google、Facebook 等均开始支持的 HTTP3 到底是个什么鬼？</title>
<link>https://toutiao.io/k/xgonsfg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;article class=&quot;article-content&quot;&gt;
&lt;p&gt;最近一段时间以来，关于HTTP/3的新闻有很多，越来越多的国际大公司已经开始使用HTTP/3了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16036129562310-5.jpg&quot; alt=&quot;-w649&quot;/&gt;￼ &lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16036129871026-5.jpg&quot; alt=&quot;-w659&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;所以，HTTP/3已经是箭在弦上了，全面使用只是个时间问题，那么，作为一线开发者，我们也是时候了解下到底什么是HTTP/3，为什么需要HTTP/3了。&lt;/p&gt;
&lt;p&gt;那么，本文就来讲解一下到底什么是HTTP/3？他用到了哪些技术？解决了什么问题？&lt;/p&gt;
&lt;h3&gt;HTTP/2 存在的问题&lt;/h3&gt;
&lt;p&gt;在撰写本文之前，我专门写了一篇文章《&lt;a href=&quot;https://www.hollischuang.com/archives/5928&quot;&gt;HTTP/2做错了什么？刚刚辉煌2年就要被弃用了！？&lt;/a&gt;》分析HTTP/2存在的问题以及背后的原因。&lt;/p&gt;
&lt;p&gt;这里就不详细介绍了，强烈建议大家先阅读下这篇文章，有助于本文的学习。&lt;/p&gt;
&lt;p&gt;在&lt;a href=&quot;https://www.hollischuang.com/archives/5928&quot;&gt;上一篇文章&lt;/a&gt;中我们提到过HTTP/2因为底层使用的传输层协议仍然是TCP，所以他存在着TCP队头阻塞、TCP握手延时长以及协议僵化等问题。&lt;/p&gt;
&lt;p&gt;这导致HTTP/2虽然使用了多路复用、二进制分帧等技术，但是仍然存在着优化空间。&lt;/p&gt;
&lt;h3&gt;QUIC协议&lt;/h3&gt;
&lt;p&gt;我们知道，HTTP/2之所以”被弃用”，是因为他使用的传输层协议仍然是TCP，所以HTTP/3首要解决的问题就是绕开TCP。&lt;/p&gt;
&lt;p&gt;那么如果研发一种新的协议，同样还是会因为受到中间设备僵化的影响，导致无法被大规模应用。所以，研发人员们想到了一种基于UDP实现的方式。&lt;/p&gt;
&lt;p&gt;于是，Google是最先采用这种方式并付诸于实践的，他们在2013年推出了一种叫做QUIC的协议，全称是Quick UDP Internet Connections。&lt;/p&gt;
&lt;p&gt;从名字中可以看出来，这是一种完全基于UDP的协议。&lt;/p&gt;
&lt;p&gt;在设计之初，Google就希望使用这个协议来取代HTTPS/HTTP协议，使网页传输速度加快。2015年6月，QUIC的网络草案被正式提交至互联网工程任务组。2018 年 10 月，互联网工程任务组 HTTP 及 QUIC 工作小组正式将基于 QUIC 协议的 HTTP（英语：HTTP over QUIC）重命名为HTTP/3。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;所以，我们现在所提到的HTTP/3，其实就是HTTP over QUIC，即基于QUIC协议实现的HTTP。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;那么，想要了解HTTP/3的原理，只需要了解QUIC就可以了。&lt;/p&gt;
&lt;p&gt;QUIC协议有以下特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基于UDP的传输层协议：它使用UDP端口号来识别指定机器上的特定服务器。&lt;/li&gt;
&lt;li&gt;可靠性：虽然UDP是不可靠传输协议，但是QUIC在UDP的基础上做了些改造，使得&lt;strong&gt;他提供了和TCP类似的可靠性&lt;/strong&gt;。它提供了数据包重传、拥塞控制、调整传输节奏以及其他一些TCP中存在的特性。&lt;/li&gt;
&lt;li&gt;实现了无序、并发字节流：&lt;strong&gt;QUIC的单个数据流可以保证有序交付，但多个数据流之间可能乱序&lt;/strong&gt;，这意味着单个数据流的传输是按序的，但是多个数据流中接收方收到的顺序可能与发送方的发送顺序不同！&lt;/li&gt;
&lt;li&gt;快速握手：&lt;strong&gt;QUIC提供0-RTT和1-RTT的连接建立&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;使用TLS 1.3传输层安全协议：与更早的TLS版本相比，TLS 1.3有着很多优点，但使用它的最主要原因是其握手所花费的往返次数更低，从而能降低协议的延迟。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;那么，QUIC到底属于TCP/IP协议族中的那一层呢？我们知道，QUIC是基于UDP实现的，并且是HTTP/3的所依赖的协议，那么，按照TCP/IP的分层来讲，他是属于传输层的，也就是和TCP、UDP属于同一层。&lt;/p&gt;
&lt;p&gt;如果更加细化一点的话，因为QUIC不仅仅承担了传输层协议的职责，还具备了TLS的安全性相关能力，所以，可以通过下图来理解QUIC在HTTP/3的实现中所处的位置。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084541722246.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;接下来我们分别展开分析一下QUIC协议。先来看下他是如何建立连接的。&lt;/p&gt;
&lt;h3&gt;QUIC的连接建立&lt;/h3&gt;
&lt;p&gt;我们知道，TCP这种可靠传输协议需要进行三次握手，也正是因为三次握手，所以需要额外消耗1.5 RTT，而如果再加上TLS的话，则需要消耗3-4个 RTT连接。&lt;/p&gt;
&lt;p&gt;那么，QUIC是如何建立连接的呢？如何减少RTT的呢？&lt;/p&gt;
&lt;p&gt;QUIC提出一种新的连接建立机制，基于这种连接接机制，实现了快速握手功能，一次QUIC连接建立可以实现使用 0-RTT 或者 1-RTT 来建立连接。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/1_lfXH5BHQt_ltGCq-KEvlUQ.gif&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;QUIC在握手过程中使用Diffie-Hellman算法来保证数据交互的安全性并合并了它的加密和握手过程来减小连接建立过程中的往返次数。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Diffie–Hellman (以下简称DH)密钥交换是一个特殊的交换密钥的方法。它是密码学领域内最早付诸实践的密钥交换方法之一。 DH可以让双方在完全缺乏对方(私有)信息的前提条件下通过不安全的信道达成一个共享的密钥。此密钥用于对后续信息交换进行对称加密。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;QUIC 连接的建立整体流程大致为：QUIC在握手过程中使用Diffie-Hellman算法协商初始密钥，初始密钥依赖于服务器存储的一组配置参数，该参数会周期性的更新。初始密钥协商成功后，服务器会提供一个临时随机数，双方根据这个数再生成会话密钥。客户端和服务器会使用新生的的密钥进行数据加解密。&lt;/p&gt;
&lt;p&gt;以上过程主要分为两个步骤：初始握手（Initial handshake）、最终（与重复）握手（Final (and repeat) handshake），分别介绍下这两个过程。&lt;/p&gt;
&lt;h4&gt;初始握手（Initial handshake）&lt;/h4&gt;
&lt;p&gt;在连接开始建立时，客户端会向服务端发送一个打招呼信息，（inchoate client hello (CHLO)），因为是初次建立，所以，服务端会返回一个拒绝消息（REJ），表明握手未建立或者密钥已过期。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084544311013.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;但是，这个拒绝消息中还会包含更多的信息（配置参数），主要有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Server Config：一个服务器配置，包括服务器端的Diffie-Hellman算法的长期公钥（long term Diffie-Hellman public value）&lt;/li&gt;
&lt;li&gt;Certificate Chain：用来对服务器进行认证的信任链&lt;/li&gt;
&lt;li&gt;Signature of the Server Config：将Server Config使用信任链的叶子证书的public key加密后的签名&lt;/li&gt;
&lt;li&gt;Source-Address Token：一个经过身份验证的加密块，包含客户端公开可见的IP地址和服务器的时间戳。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在客户端接收到拒绝消息（REJ）之后，客户端会进行数据解析，签名验证等操作，之后会将必要的配置缓存下来。&lt;/p&gt;
&lt;p&gt;同时，在接收到REJ之后，客户端会为这次连接随机产生一对自己的短期密钥（ephemeral Diffie-Hellman private value） 和 短期公钥（ephemeral Diffie-Hellman public value）。&lt;/p&gt;
&lt;p&gt;之后，客户端会将自己刚刚产生的短期公钥打包一个Complete CHLO的消息包中，发送给服务端。这个请求的目的是将自己的短期密钥传输给服务端，方便做前向保密，后面篇幅会详细介绍。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084544723763.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;在发送了Complete CHLO消息给到服务器之后，为了减少RTT，客户端并不会等到服务器的响应，而是立刻会进行数据传输。&lt;/p&gt;
&lt;p&gt;为了保证数据的安全性，客户端会自己的短期密钥和服务器返回的长期公钥进行运算，得到一个初始密钥（initial keys）。&lt;/p&gt;
&lt;p&gt;有了这个初识密钥之后，客户端就可以用这个密钥，将想要传输的信息进行加密，然后把他们安全的传输给服务端了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084545018794.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;另外一面，接收到Complete CHLO请求的服务器，解析请求之后，就同时拥有了客户端的短期公钥和自己保存的长期密钥。这样通过运算，服务端就能得到一份和客户端一模一样的初始密钥（initial keys）。&lt;/p&gt;
&lt;p&gt;接下来他接收到客户端使用初始密钥加密的数据之后，就可以使用这个初识密钥进行解密了，并且可以将自己的响应再通过这个初始密钥进行加密后返回给客户端。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;所以，从开始建立连接一直到数据传送，只消耗了初始连接连接建立的 1 RTT&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;最终（与重复）握手&lt;/h3&gt;
&lt;p&gt;那么，之后的数据传输就可以使用初始密钥（initial keys）加密了吗？&lt;/p&gt;
&lt;p&gt;其实并不完全是，因为初始密钥毕竟是基于服务器的长期公钥产生的，而在公钥失效前，几乎多有的连接使用的都是同一把公钥，所以，这其实存在着一定的危险性。&lt;/p&gt;
&lt;p&gt;所以，为了达到前向保密 (Forward Secrecy) 的安全性，客户端和服务端需要使用彼此的短期公钥和自己的短期密钥来进行运算。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在密码学中，前向保密（英语：Forward Secrecy，FS）是密码学中通讯协议的安全属性，指的是长期使用的主密钥泄漏不会导致过去的会话密钥泄漏。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;那么现在问题是，客户端的短期密钥已经发送给服务端，而服务端只把自己的长期密钥给了客户端，并没有给到自己的短期密钥。&lt;/p&gt;
&lt;p&gt;所以，服务端在收到Complete CHLO之后，会给到服务器一个server hello(SHLO)消息，这个消息会使用初始密钥（initial keys）进行加密。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084546070880.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;这个CHLO消息包中，会包含一个服务端重新生成的短期公钥。&lt;/p&gt;
&lt;p&gt;这样客户端和服务端就都有了对方的短期公钥（ephemeral Diffie-Hellman public value）。&lt;/p&gt;
&lt;p&gt;这样，客户端和服务端都可以基于自己的短期密钥和对方的短期公钥做运算，产生一个仅限于本次连接使用的前向保密密钥 (Forward-Secure Key)，后续的请求发送，都基于这个密钥进行加解密就可以了。&lt;/p&gt;
&lt;p&gt;这样，双方就完成了最终的密钥交换、连接的握手并且建立了QUIC连接。&lt;/p&gt;
&lt;p&gt;当下一次要重新创建连接的时候，客户端会从缓存中取出自己之前缓存下来的服务器的长期公钥，并重新创建一个短期密钥，重新生成一个初识密钥，再使用这个初始密钥对想要传输的数据进行加密，向服务器发送一个Complete CHLO 请求即可。这样就达到了0 RTT的数据传输。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084546708647.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;所以，如果是有缓存的长期公钥，那么数据传输就会直接进行，准备时间是0 RTT&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;以上，通过使用Diffie-Hellman算法协商密钥，并且对加密和握手过程进行合并，大大减小连接过程的RTT ，使得基于QUIC的连接建立可以少到1 RTT甚至0 RTT。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;以下，是Google官网上面的一张关于QUIC连接建立的流程图，可以帮助大家理解这个过程。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16083656591382.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;另外，通过以上关于握手建立的过程，我们也可以知道，QUIC在整个过程中通过加解密的方式很好的保证了安全性。&lt;/p&gt;
&lt;h3&gt;多路复用&lt;/h3&gt;
&lt;p&gt;基于TCP的协议实现的HTTP有一个最大的问题那就是队头阻塞问题，那么，在这方面，QUIC是如何解决这个问题的呢？&lt;/p&gt;
&lt;p&gt;TCP传输过程中会把数据拆分为一个个按照顺序排列的数据包，这些数据包通过网络传输到了接收端，接收端再按照顺序将这些数据包组合成原始数据，这样就完成了数据传输。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084557274127.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;但是如果其中的某一个数据包没有按照顺序到达，接收端会一直保持连接等待数据包返回，这时候就会阻塞后续请求。这就发生了TCP队头阻塞。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084557140945.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;p&gt;类似于HTTP/2，&lt;strong&gt;QUIC在同一物理连接上可以有多个独立的逻辑数据流，这些数据流并行在同一个连接上传输，且多个数据流之间间的传输没有时序性要求，也不会互相影响。&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;数据流（Streams）在QUIC中提供了一个轻量级、有序的字节流的抽象化&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;QUIC的单个数据流可以保证有序交付，但多个数据流之间可能乱序。这意味着单个数据流的传输是按序的，但是多个数据流中接收方收到的顺序可能与发送方的发送顺序不同！&lt;/p&gt;
&lt;p&gt;也就是说同一个连接上面的多个数据流之间没有任何依赖（不要求按照顺序到达），即使某一个数据包没有达到，也只会影响自己这个数据流，并不会影响到到其他的数据流。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hollischuang.com/wp-content/uploads/2020/12/16084558177970.jpg&quot; alt=&quot;&quot;/&gt;￼&lt;/p&gt;
&lt;h3&gt;连接迁移&lt;/h3&gt;
&lt;p&gt;对于TCP连接的识别，需要通过服务器和客户端过双方的ip和端口四个参数进行的。在网络切换的场景中，比如手机切换网络，那么自身的ip就会发生变化。这就导致之前的TCP连接就会失效，就需要重新建立。&lt;/p&gt;
&lt;p&gt;这种场景对于移动端设备普及的今天来说，还是比较频繁的。&lt;/p&gt;
&lt;p&gt;所以，在这一点上，QUIC进行了优化。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;QUIC协议使用特有的UUID来标记每一次连接，在网络环境发生变化的时候，只要UUID不变，就能不需要握手，继续传输数据。&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;可靠性&lt;/h3&gt;
&lt;p&gt;TCP之所以被称之为可靠链接，不仅仅是因为他有三次握手和四次关闭的过程，还因为他做了很多诸如&lt;strong&gt;流量控制、数据重传、拥塞控制&lt;/strong&gt;等可靠性保证。&lt;/p&gt;
&lt;p&gt;这也是为什么一直以来都是以TCP作为HTTP实现的重要协议的原因。&lt;/p&gt;
&lt;p&gt;那么，QUIC想要取代TCP，就需要在这方面也做出努力，毕竟UDP自身是不具备这些能力的。&lt;/p&gt;
&lt;p&gt;TCP拥塞控制是TCP避免网络拥塞的算法，是互联网上主要的一个拥塞控制措施。经典的算法实现有很多，诸如TCP Tahoe 和 Reno、TCP Vegas、TCP Hybla、TCP New Reno、TCP Westwood和Westwood+以及TCP BIC 和 CUBIC等等。&lt;/p&gt;
&lt;p&gt;QUIC协议同样实现了&lt;strong&gt;拥塞控制&lt;/strong&gt;。不依赖于特定的拥塞控制算法，并且提供了一个可插拔的接口，允许用户实验。默认使用了 TCP 协议的 Cubic 拥塞控制算法。&lt;/p&gt;
&lt;p&gt;关于&lt;strong&gt;流量控制&lt;/strong&gt;，QUIC提供了基于stream和connection两种级别的流量控制，既需要对单个 Stream 进行控制，又需要针对所有 Stream 进行总体控制。&lt;/p&gt;
&lt;p&gt;QUIC的连接级流控，用以限制 QUIC 接收端愿意分配给连接的总缓冲区，避免服务器为某个客户端分配任意大的缓存。连接级流控与流级流控的过程基本相同，但转发数据和接收数据的偏移限制是所有流中的总和。&lt;/p&gt;
&lt;h3&gt;弊端&lt;/h3&gt;
&lt;p&gt;以上，我们介绍了很多QUIC的相比较于TCP的优点，可以说这种协议相比较于TCP确实要优秀一些。&lt;/p&gt;
&lt;p&gt;因为他是基于UDP的，并没有改变UDP协议本身，只是做了一些增强，虽然可以避开中间设备僵化的问题，但是，在推广上面也不是完全没有问题的。&lt;/p&gt;
&lt;p&gt;首先，&lt;strong&gt;很多企业、运营商和组织对53端口（DNS）以外的UDP流量会进行拦截或者限流&lt;/strong&gt;，因为这些流量近来常被滥用于攻击。&lt;/p&gt;
&lt;p&gt;特别是一些&lt;strong&gt;现有的UDP协议和实现易受放大攻击（amplification attack）威胁，攻击者可以控制无辜的主机向受害者投放发送大量的流量。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;所以，基于UDP的QUIC协议的传输可能会受到屏蔽。&lt;/p&gt;
&lt;p&gt;另外，因为UDP一直以来定位都是不可靠连接，所以有很多中间设备对于他的支持和优化程度并不高，所以，出现丢包的可能性还是比较搞的。&lt;/p&gt;
&lt;h3&gt;总结&lt;/h3&gt;
&lt;p&gt;下表是我总结的HTTP/2和HTTP/3的异同点，有一些本文介绍过，有一些个人认为并不是特别重要的，本文中并没有提及，大家感兴趣的可以自行学习下。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;特性&lt;/th&gt;
&lt;th&gt;HTTP/2&lt;/th&gt;
&lt;th&gt;HTTP/3&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;传输层协议&lt;/td&gt;
&lt;td&gt;TCP&lt;/td&gt;
&lt;td&gt;基于UDP的QUIC&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;默认加密&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;独立的数据流&lt;/td&gt;
&lt;td&gt;否&lt;/td&gt;
&lt;td&gt;是&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;队头阻塞&lt;/td&gt;
&lt;td&gt;存在TCP队头阻塞&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;报头压缩&lt;/td&gt;
&lt;td&gt;HPACK&lt;/td&gt;
&lt;td&gt;QPACK&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;握手时延&lt;/td&gt;
&lt;td&gt;TCP+TLS 的 1-3 RTT&lt;/td&gt;
&lt;td&gt;0-1 RTT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;连接迁移&lt;/td&gt;
&lt;td&gt;无&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;服务器推送&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;多路复用&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;流量控制&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;数据重传&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;拥塞控制&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;td&gt;有&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://http3-explained.haxx.se/&quot;&gt;https://http3-explained.haxx.se/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/46403.pdf&quot;&gt;The QUIC Transport Protocol: Design and Internet-Scale Deployment&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.codenong.com/cs106840038/&quot;&gt;https://www.codenong.com/cs106840038/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://nan01ab.github.io/2018/12/QUIC.html&quot;&gt;https://nan01ab.github.io/2018/12/QUIC.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/@chester.yw.chu/http-3-%E5%82%B3%E8%BC%B8%E5%8D%94%E8%AD%B0-quic-%E7%B0%A1%E4%BB%8B-5f8806d6c8cd&quot;&gt;https://medium.com/@chester.yw.chu/http-3-傳輸協議-quic-簡介-5f8806d6c8cd&lt;/a&gt;&lt;/p&gt;
&lt;center&gt;&lt;b&gt;(全文完)&lt;/b&gt;&lt;/center&gt;&lt;hr/&gt;&lt;center&gt;&lt;b&gt;扫描二维码，关注作者微信公众号&lt;/b&gt;&lt;/center&gt;&lt;img src=&quot;http://www.hollischuang.com/wp-content/uploads/2019/04/二维码.png&quot;/&gt;
&lt;/article&gt;
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>56fe9e0fc9490a806db4508a896bc879</guid>
<title>关于中台的思考和尝试</title>
<link>https://toutiao.io/k/t4shd8f</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section class=&quot;article-body&quot; data-redirect-url=&quot;https://www.linkedin.com/login?session_redirect=https%3A%2F%2Fcn%2Elinkedin%2Ecom%2Fpulse%2F%25E5%2585%25B3%25E4%25BA%258E%25E4%25B8%25AD%25E5%258F%25B0%25E7%259A%2584%25E6%2580%259D%25E8%2580%2583%25E5%2592%258C%25E5%25B0%259D%25E8%25AF%2595-dongbai-guo-%25E9%2583%25AD%25E4%25B8%259C%25E7%2599%25BD-&quot;&gt;&lt;p&gt;这周末在QCon上海做关于架构师的独立思考的主题演讲， 其中用中台做案例。 因为演讲时间有限， 关于中台的思考没办法讲得非常透彻， 这里就多花时间描述一下， 做为补充。也期望能与大家形成思想碰撞。&lt;/p&gt;&lt;h2&gt;1.  中台的定义&lt;/h2&gt;&lt;p&gt;围绕中台的争议非常多。 但是往往争议的原因是连中台这个概念都完全没有达成共识，是毫无意义的争吵。  那么我们的讨论先从定义中台这个概念开始。 定义中台我认为可以有两个角度， 一个是从中台本身的价值和出发点来的： &lt;strong&gt;中台是在多个部门之间共享的开发资源所提供的业务能力， 数据能力和计算能力的集合。&lt;/strong&gt;另一个定义从中台的相对定位来的： &lt;strong&gt;前台是面向终端用户的一组业务能力。 业务中台是对前台应用的抽象， 提供多个前台业务之间共享的业务逻辑，数据和计算能力。 &lt;/strong&gt;我想特别强调这个定义是相对中性的， 我们能够通过这个定义区分什么东西是中台，什么不是中台。 有的中台定义严格来说不是定义， 比如说 “中台是提升效率和加速业务增长的一种工具。” “中台是我们战略目标。” “中台就是一个革命性的设计。” 似乎不做中台就成了反革命一样，就是落后生产力的代表。 其实中台本质上是一个对业务能力的抽象和共享的过程，一直存在，也谈不上革命。 甚至业务中台这个概念也没有那么新： Oracle Fusion Middleware 早在2006年就发布了， 覆盖了多个包括企业智能，团队协作，内容等多个领域。&lt;/p&gt;&lt;p&gt;我想特别强调中台和前台的定义差别。 &lt;strong&gt;前台服务单个业务，&lt;/strong&gt; &lt;strong&gt;目标是就是这个业务的增长。 &lt;/strong&gt;前台必须紧贴业务做好差异化。 前台的定位要考虑到竞争环境，目标客群， 业务成长阶段，运营人员能力， 人才供给，监管环境等因素。前台要有自己的技术内容， 定制流程， 流程对接和个性化数据应用。 &lt;strong&gt;中台服务整个集团&lt;/strong&gt;，&lt;strong&gt;目标往往是降低成本， 加强管控， 或者是扩大规模优势 。&lt;/strong&gt; 中台的定位在以集团利益最大化的前提下最大化服务前台业务的需求。 中台有自己的技术实现， 研发流程， 和数据标准。 而&lt;strong&gt;后台是不具备任何业务语义的基础计算能力。 &lt;/strong&gt;下图就是对这种定位的一个示意：&lt;/p&gt;&lt;h3&gt;1.1 对待中台的两种极端态度&lt;/h3&gt;&lt;p&gt;当前对中台的看法主要有两种极端，一种是认为中台是一个完全错误的方向， 要紧急刹车， 另一种是认为中台就是技术终局， 是业务增长的不二法门。 我们先分别讨论一下这两种观点。 我开始讨论QCon的演讲话题的时候， 中台只是多个备选话题之一， 但是当我意识到大家对待这个话题非常极端的时候， 我才觉得有必要把这个话题讲通讲透。 最终选择以中台做为架构师独立思考的能力的一个案例。这是题外话。&lt;/p&gt;&lt;p&gt;先说中台是否是个完全错误的方向？ 想思考清楚这个方向是否错误， 我们可以先看到中台最初的动力来自哪里？  不论是甲骨文还是后来的阿里， 其实本质动因是一个大公司内部的大业务呈军阀割据现象，导致多条业务线重复造轮。由此而衍生出其他的问题， 比如说团队之间内耗严重；小业务无资源， 增长乏力；整个公司数字资产不统一， 损失机会成本； 业务线也不能对核心系统做打磨，业务线不稳定。   因为这些原因， 所以阿里的高管们就以美国海军陆战队和Supercell的组织形式为启发， 做了“大(业务)中台， 小(业务)前台”的策略。 这里先不谈中台是否能解决这些问题， 或者是说战略启发是否正确， 但是毫无疑问的是， 中台想解决的问题既没有过时， 也依然正在不同的公司里发生， 所以这些问题也必须解决。 也就是说从问题定义角度来说， 中台是个完全正确的方向。&lt;/p&gt;&lt;p&gt;那么中台是否是这些问题的完美解决方案？ 中台是不是万能药？我们已经知道答案是否定了。 现在看来中台的解决方案至少有以下几个缺陷：&lt;/p&gt;&lt;p&gt;1.   &lt;strong&gt;对创新的遏制&lt;/strong&gt;： 一个被完全中台化的业务导致集团内部过分分工， 任何前台业务都被认为是中台能力的线性组合。  举个例子， 有的公司会有接近或超过千人的供应链中台，搜索广告中台，内容中台等等， 而多数业务前台少则几个人，多不过几十人。 前台团队任何一个人哪怕是全职和一个中台域对接， 也无法理解该域的全貌或者是跟得上这个中台的演变。 这意味着前台业务完全无法在这些中台相关的领域做创新。 本来的创新业务变成无从创新， 当初的动力变成了中台的最大的诅咒。 有说法说，一个业务靠拖拉拽就能编排出来了， 这不是创新是什么？ 事实证明这种创新完全无用。 没有任何一个投资人会把自己的钱投到一个可以被大公司拖拉拽出来的商业模式的。 真正的创新不是现有能力的线性组合。      &lt;/p&gt;&lt;p&gt;2.   &lt;strong&gt;反人性&lt;/strong&gt;：中台自身的场景往往缺乏前瞻设计 ，是对现有场景的抽象。 而当某个创新在一个前线业务线孵化出来之后，中台团队会通过强制收编该能力来扩大自己的能力， 同时强迫前台团队下线一个他们研发了很久的创新。 这种行为往往造成精英人才的流失， 使得本来就受到遏制的前台创新变得更为匮乏。  &lt;/p&gt;&lt;p&gt;3.   &lt;strong&gt;过渡设计&lt;/strong&gt;： 中台经常以最全的最复杂的实现来应对任何一个简单的应用场景。大量成熟行业和强监管环境下的需求被带入到了创新业务中。 在带来了大量的运营复杂性的同时增加了用户（买家，卖家，本地运营）的学习难度。 这就是我们常讲的膨胀软件(Bloatware): 巨大， 复杂， 缓慢，低效。&lt;/p&gt;&lt;p&gt;4.   &lt;strong&gt;丧失对客户心智的追求&lt;/strong&gt;： 中台团队的产品和研发的核心技能在于抽象和降本。 前台业务的核心能力在于对商业机会的捕捉和新商业机会的创造。 这是两种完全不同的技能，往往对应着完全不同类型的人才。一个长期在多个业务中间找共性来降本的人是不会专注在最大化前台业务增长的。&lt;/p&gt;&lt;p&gt;之前做中台的公司往往被以上一个或者多个问题所困扰。 也就是说中台事实上不是完美的。 为什么呢？&lt;/p&gt;&lt;h2&gt;2.1 思考中台的本质&lt;/h2&gt;&lt;p&gt;我们先思考一下中台的本质。中台本质是把一些分散的重复的开发工作集中起来， 通过共享同一个研发团队来提升不同业务线之间的共性， 也就是通过抽象和统一来获取增量价值。  具体的增量可以分成以下几类：&lt;/p&gt;&lt;p&gt;&lt;strong&gt;1.  以零成本研发加速上线&lt;/strong&gt;： 对完全可以复用的标准化功能集中开发，未来以低研发成本上线， 比如说一些无状态的计算能力，类似SDK。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;2.  提升业务稳定性&lt;/strong&gt;：对产品差异不大的领域通过集中研发运维而获取更高的业务稳定性。 这样一个团队开发的底层服务能够同时服务多个业务场景， 聚合所有的流量来加速积累。 同时研发同学也通过更多的场景来加速打磨设计。 常见的领域是会员，营销， 交易，资金等服务。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;3.  加速技术和业务能力扩散&lt;/strong&gt;：把整个集团的能力尽量跨BU复制。这包括两种类型，一种是类似SaaS服务的场景，比如说Chatbot，直播，内容等领域，另一种是类似ISV的场景，由一个中央的团队同时提供研发，对内服务和运营，比如说安全，风控，财务，人力资源等。 &lt;/p&gt;&lt;p&gt;&lt;strong&gt;4.  统一数据资产 &lt;/strong&gt;：在集团内部统一数据标准，最大化数据复用， 把一个场景积累的数据优势应用到其他的业务场景中去，逐渐建设企业的数据壁垒。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;5.  集团层次的资源高效利用&lt;/strong&gt;：把部分资源中央化，变成全集团资源， 比如说商品中台不但包括商品库， 也包括商品质量控制体系，背后的货源，相关货源的价格以及服务竞争力。 而商家中台，不仅仅是包含商家的信息，还包括商家的合作意愿和对集团品牌的信任，从而使得商家更愿意和一个新孵化的初创业务合作。集团真正想跨BU复用的是从一个大业务孵化而来的竞争力，而不是信息本身。 &lt;/p&gt;&lt;p&gt;从研发和管理难度来说从１到５逐渐变难，而带来的增量价值也依次变得更大。&lt;/p&gt;&lt;p&gt;从这个本质来看， 那么中台似乎就是完美的， 那么之前提到的不完美有从哪里来的呢？ 我们有必要更深度的思考一下。 &lt;/p&gt;&lt;h3&gt;2.1.1 中台的适用范围&lt;/h3&gt;&lt;p&gt;首先我们思考一下上面的要求， 我们把这些要求归类成六类， 其中第一种场景细分成低成本上线和加速上线两个类别， 那么这些类别有以下的共同特征：&lt;/p&gt;&lt;p&gt;0.  低成本上线： 同一个功能模块在多个场景中被使用， 要求该能力的接口确定性高。&lt;/p&gt;&lt;p&gt;1.  加速上线： 同一个基础能力不需修改或者简单修改即可上线， 也就是模块化支持，要求高API确定性和好的功能通用性。&lt;/p&gt;&lt;p&gt;2.  提升稳定性： 同一个业务能力持续打磨， 要求需求同时具备高的接口稳定性和好的跨业务线通用性。&lt;/p&gt;&lt;p&gt;3.  加速能力扩散： 基础业务能力可以跨业务线模式， 要求该能力具备比较好的通用性, 可以在多个业务线之间共享。&lt;/p&gt;&lt;p&gt;4.  统一数据资产： 数据模型可以在多个业务线之间统一， 对功能的通用性要求高， 且业务需求相对稳定。&lt;/p&gt;&lt;p&gt;5.  集团资源高效利用：业务能力共享， 不仅仅是技术资源， 其实是业务能力有高通用性且需求稳定。&lt;/p&gt;&lt;p&gt;下图把这几个特征分别放在一个四象限图里面。这四个象限的横轴代表技术演化稳定性，竖轴代表功能的通用性。中台的优势领域在第三象限，这个象限技术具有高确定性，业务功能通用。第二象限属于比较稳定但是不通用的小众行业。第四象限属于普遍流行但是高速变化的领域，比如说内容和服饰或者端上的交互。而第一象限属于创新业务，不但定制化程度高且快速演化，比如说面向垂直行业或者初创技术。也就是说：&lt;strong&gt;中台的使用范围是有限的，仅仅限于技术演化相对慢且功能通用性高的场景中。&lt;/strong&gt;这是我们得出的第一个结论。过往中台的失败案例也往往集中在把中台强推到创新业务中的情况。 &lt;/p&gt;&lt;h3&gt;2.1.2 中台的组织机制&lt;/h3&gt;&lt;p&gt;那么为什么即便是中台在相对优势的领域我们也没有取得类似Supercell那样的效率呢？ 他们不过是100~200人便撑起一个独角兽， 甚至是跨多个大洲的超级独角兽？ 值得一提的类似Supercell的中台并非个案， 仅仅百万人口的小国爱沙尼亚就有4个独角兽， 他们的中台团队也不过是百人左右。 那么国内的中台为啥动辄就是成百上千人的研发团队呢？我有幸深度接触过芬兰和爱沙尼亚的几家独角兽， 我觉得导致这个巨大差异的根源在于研发文化和资源环境。这两个国家由于历史和文化传统，造就了崇尚简约，尊重原创，和组织扁平的研发文化。 而我们国家的高科技从业人口全球第一， 过去的十年间每年又有大量的新从业者。 这些新从业者又普遍有大厂情节， 期望为一个技术品牌相对比较高且收入稳定的公司工作。 也就是说大厂同时具备了孵化中台的条件且有源源不断的对成长没有太多诉求的劳动力。 这其实是不断重复造轮的必要条件。  &lt;/p&gt;&lt;p&gt;当前几乎所有的大厂都有同样的晋升和薪酬激励机制，就是一个人管理的研发越多， 层级越高， 收入也越高。这种机制有个巨大的弊端， 一个奖励组织膨胀的机制必然会带来组织膨胀。而组织膨胀的最终因为康威定理的作用也必然导致膨胀的系统， 也就是前面提到的膨胀软件(Bloatware)。 这个就是不断重复造轮的充分条件。  &lt;/p&gt;&lt;p&gt;大量的劳动力供给和鼓励膨胀的机制合在一起， 结果就是团队上下不断加速重复造破轮子。 下图就是对这个过程示意。 某个研发经理从状态1开始， 带领一个小团队。他这个时候他对应的层级是2， 收入是3。某一天， 他启动一个大项目， 给这个项目一个冠冕堂皇的名字， 比如说“拿破仑项目”。 他的团队急速膨胀到4。 项目上线时间一到， 不论完成与否质量如何， 他立即对外发战报， 做宣讲， 我们取得了“滑铁卢大捷！”。 紧接着他的上级内举不避亲， 把他从层级2提拔到5， 收入也相应的从3调整到6。 然后周而复始， 他再启动“拿破仑二世项目”继续开发膨胀软件。 很快他的“成功”也很快被疯狂复制。公司变得臃肿迟缓。&lt;/p&gt;&lt;p&gt;这个现象当然不局限于中台， 整个公司都在膨胀。 但是这种膨胀对中台而言却是灾难性的。 一个膨胀的业务线伤害到自己， 但一个膨胀的中台放缓的是整个集团。&lt;/p&gt;&lt;p&gt;所以我们有了第二条重要结论：&lt;strong&gt; 中台的建设要有与之匹配的组织文化机制。 &lt;/strong&gt;&lt;/p&gt;&lt;h2&gt;3. 寻找中台的合理组织机制&lt;/h2&gt;&lt;p&gt;那么什么样的机制才是一个合理的组织文化机制呢？ 很遗憾我自己也不知道正确答案。 但是我们或多或少可以从过去的失败中寻求教训，从历史中寻找启发。&lt;/p&gt;&lt;p&gt;先来思考一下过去的失败。 我归纳下来大致有这么几个根因：1. 对哪个团队做中台或者哪个人来设计中台的决策是个自顶而下的中央决策过程。 做中台的人没有所必须的抽象能力和业务理解，类似过去封建王朝的分封的过程。受封的仅仅是生在帝王家， 有没有治理和决策能力不重要。  2. 中台的推行机制往往是个掠夺的过程。对业务线的创新直接复制， 不尊重发明者的知识产权和劳动。中台所到处，寸草不生。 3. 中台能力一旦发布， 独家专供， 哪怕功能不完善， 设计不合理也不允许业务团队复制或分支。 4.  中台为了做规模强制向业务线推行，业务线被迫削足适履，消耗严重。每次中台升级小的BU更是叫苦不迭，故障频发。&lt;/p&gt;&lt;p&gt;其实这几个问题并非中台所独有。上面的四个问题其实和封建社会的分封机制类似，本来应该有市场选择,良性竞争和创新来完成的事情变成了强权和行会。其实这个问题是有解决方案的。 伴随工业革命带来的人类劳动力巨大释放（具体见Berkley 大学De Long 教授对人类文明史的人均GDP分析）背后也有完整的机制，这些机制就是我们可以借鉴的出路：1. 机会配置由市场决定。 2. 尊重知识产权和创新， 保护参与者的创新意愿。  3. 通过自由准入维持市场活力。4最终由规模效应形成统一的事实标准。&lt;/p&gt;&lt;p&gt;虽然我还不能确定是否这是完整且合理中台机制， 但是我们的思想实验至少给了我们避免过去的失败的一些希望：1. 谁来做中台，谁的设计才是真正合理的中台设计由市场决定。 2. 尊重原创， 通过溯源和产权机制保护创新。  3. 自由准入， 不做独家专供。4 不强制推行， 设计统一是演化的结果， 而不是行政命令。&lt;/p&gt;&lt;h2&gt;4. 中台的演进机制探索&lt;/h2&gt;&lt;p&gt;不过哪怕有个这个机制， 我们还是要认识到中台天然的局限性， &lt;strong&gt;中台不是万能的， 它仅仅合适在高确定性和高通用性场景下创造增量价值。&lt;/strong&gt;没有合理的期望设定其实还会让迭代过程漫长而艰苦。 在一个竞争环境下， 错误的目标设定不但会带来大量的资本和时间消耗，而且对员工士气打击也很大， 甚至会最终毁掉一家公司。&lt;/p&gt;&lt;p&gt;从公司层面来看， 中台要降低成本， 但是抽象带来的增值是有天花板的。 抽象的终局是个零和游戏， 就不过是把前台的事情交割给中台去做。 没有价值创造，只有权力转移。 另外，中台要加速业务迭代也有逐渐减少的边际收入。  一个健康的行业中需求是永远进化的，不存在超前的完美设计为未来不断创造价值。中台在业务起初产生最大的价值，其后逐渐衰减。&lt;/p&gt;&lt;p&gt;从一个团队或者是BU角度来看，小BU期望通过中台带来业务增长，但事实上大BU的需求总是优先， 会占用几乎所有的中台资源。 小BU的需求永远排在第二位，会饿死在等待的途中。 另外中台靠合理的设计创造价值， 我们期望中台的设计是最优的， 但是真正有能力的架构师不一定在你所依赖的中台团队。 你接触的中台边界不一定合理。 如果中台很复杂， 跨团队的沟通也会变得更艰难。 中台创造的增量价值就越小了。&lt;/p&gt;&lt;p&gt;从个人来看，每个人都期望能力提升， 但是擅于发现机会也擅于抽象的人不一定在中台团队。 每个人都期望职业高速发展， 但是高增长的团队往往是高风险的前台团队，而高稳定的中台团队往往变化缓慢。 所以没有不论中台还是前台团队， 人才的配置不一定是最优的。&lt;/p&gt;&lt;p&gt;知道了这些局限性， 我们才能对中台设定合理的期望。 有了合理的期望， 我们还需要建设合理的迭代机制。 这里我们还是可以借鉴其他领域的成功路径。 我认为对中台机制探索应该向任何科学探索一样， 是个从假设到实验， 到结果分析， 到修正，最终到正确结论的过程。  我们从相对合理的中台诉求出发， 做合理的机制设计， 通过实施，到效果验证，然后对机制不断修正， 来最终得出逼近真理的一个机制。&lt;/p&gt;&lt;h2&gt;&lt;strong&gt;5.  &lt;/strong&gt;车好多的中台实践&lt;/h2&gt;&lt;p&gt;在分享车好多的中台实现机制之间， 我想先讲一下我为什么要分享车好多的机制。 每一个机制设计和迭代都是一个漫长的过程。 虽然我们刚刚开始， 但是我把我们中台的机制完整的分享出来，也欢迎大家采用， 甚至是加入到我们的建设中来。 我也想听到反馈， 尤其是你们已经发现机制漏洞的地方，那么我们就能够共同进步。&lt;/p&gt;&lt;h3&gt;5.1 为什么考虑在车好多做中台&lt;/h3&gt;&lt;p&gt;首先，考虑在车好多做中台的原因和之前提到的几个原因类似： 加速技术能力和业务能力扩散，整合数据资产，最大化公司资源利用。 那么具体什么时间启动有这么几个考虑， 第一和下图有关， 就是中台启动之后的复杂度的变化情况。 首先， 随着时间中台服务的调用频次逐渐上升， 往往呈指数上涨， 其次就是BU数目逐渐上升， 最后就是变更频次逐渐变少。 太早上线其实价值不大， 因为极端情况就是一两条业务线之间做复用， 中台带来的合力还抵不上增加的重构成本， 沟通成本和人力开销。这一点上车好多有8条不同的业务线， 有了足够的场景复杂度和中台增值空间， 但是也不至于像某些公司有成百条业务线，建设难度非常大。  另外车好多的业务天生是低频业务， QPS低于传统电商３～４个数量级， 所以做中台有绝对优势。 最后车好多的主流业务和新兴业务都在不同层次的迭代当中，所以我们的变更频次比较高， 对做中台也是利好。 &lt;/p&gt;&lt;p&gt;以上的三个因素， 分别是决定中台的研发复杂度的核心指标，我们可以大致建模为中台变更复杂度=（QPS*Count(BU)/变更频次)。任何一个服务， QPS越低，依赖这个服务的BU数越少，迭代的越频繁， 那么变更的难度越小， 变更带来的风险越小。 如下图所示。 在中台建设期间， 由于自动化测试能力还不够，接口设计不完善， 团队同学的运维和沟通能力也还在成长中， 那么风险上升就会相对比较快。 等到了中台建设相对完善了。风险的增长和迭代难度就相对变缓。   车好多的优势是QPS增长不快， 原因是汽车交易本来就是个低频事件， 全年全国不过是千万量级，和传统电商完全没办法比， 而车好多自生的业务迭代速度非常快， 变更频繁， BU数增长很慢， 也就是车好多的中台变更复杂度随着时间的变化非常慢， 留给车好多的中台建设时间相对就比较充裕。 另外车好多的最大的两个板块新车和二手车有很大的相似性， 所以建设中台可以从这两个板块的最相似业务线出手来打造能力， 这也是优势。&lt;/p&gt;&lt;p&gt;但是车好多的中台也有自己的挑战：首先三大板块新车，二手车和车后的差异大，而且业务所处的阶段不一样， 有的在做增长，有的在做转型，有的在做赛道探索。所以同样有前面第二节里提到的中台适用范围的挑战。 另外整个产业互联网行业还不同于传统互联网，我们的产品技术还在从生产工具到核心生产力的过渡过程中。 也就是说技术的投入是有限的，技术带来的增量价值也待验证， 所以研发投入不能过度超前。 最后一个挑战是这几大板块对应着数万亿的线下市场，所以车好多的业务与线下高度结合， 流程往往以天计算， 因此变革要和行业的适配能力和期望相符。 &lt;/p&gt;&lt;h3&gt;5.2车好多的中台定位和组织文化保障&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;定位 – &lt;/strong&gt;车好多中台要解决的问题集中在集团高确定性和高通用性领域的技术和数据共享，我们不对创新业务探索加速。 车好多中台是技术产业链的规模化之后的分工， 它的核心是对研发成本的优化和某些计算和运营资源的集中化管控和共享。&lt;/p&gt;&lt;p&gt;在组织保障层面上， 我们以加速业务迭代为目标， 通过市场机制加速中台的进化，我们通过内部开源且允许分支的方式加速进化和保障自由准入。我们鼓励原创，以物质，奖金，股票和晋升激励和固定人员投入来放大团队原创的动力。&lt;/p&gt;&lt;p&gt;在文化保障上，技术上我们关注设计, 崇尚简约, 鼓励创新。 对中台保持一个客观的态度， 中台回报不一定为正，也要迭代进化甚至消亡。 中台既不是管理方式，也不是价值观。我们尊重学术自由， 中台设计没有权威， 逻辑面前人人平等。&lt;/p&gt;&lt;p&gt;下图是车好多的中台构成， 所有的业务线共享数据，计算，研发效能，和企业效能中台， 业务线对业务中台形成部分依赖， 算法能力我们还没有中台化， 更多是个共享的组织， 而不是共享的技术能力， 所以用虚线表示。  每个中台域的研发范围如图所示。 业务线则按需定制， 我们通过控制业务线的研发人数防止膨胀软件。&lt;/p&gt;&lt;h3&gt;5.3 对中台软件的要求&lt;/h3&gt;&lt;p&gt;以前各家公司开发中台， 很少对中台软件做出系统性要求。 中台团队想交付什么就交付什么。 这些软件的质量参差不齐， 往往是项目的时间节点一到， 中台团队就三呼完美，那时候就有什么算什么， 业务团队如果稍有抱怨， 未来的需求就免不了受打压。为了避免这种情况， 我们对中台的软件做了一个定性要求。 这些定性要求又可以大致分成两类， 一类是必要条件， 一类是充分条件。&lt;/p&gt;&lt;p&gt;先说必要条件： 1. 中台软件必须具有可解释性， 也就是中台能力可以被分解成一组可以被完整描述的行为。 这里特别要强调完整描述， 有些团队做中台， 先不说自己能做什么， 而是先占领一个关键词之后问你想要什么？你想要什么我们就可以做什么。  这个就是典型的圈地心态。对做什么功能，解决什么问题完全没有任何前瞻思考， 结果就是越做越无序， 前台团队跟着变得越来越低效。 2. 中台必须具备可验证性，也就是说中台和计算的结果可以验证， 也就是中台的交付的功能可以确定性的被证伪或者被证真。   这是独立测试和边界稳定需求， 很多中台是从业务线里划分出来的。 因为需求繁忙， 往往对自己的边界也不做清晰定义， 也没有完备的自动化功能测试，更别说场景集成测试了。 哪怕有边界，也经常变动， 没有兼容能力。 这个要求就是对能力的验证和兼容性做限制， 避免中台堕入深不可测状态。      &lt;/p&gt;&lt;p&gt;再说充分条件： 1. 中台软件必须具备可隔离性，中台能力应该由多个相对独立的模块构成， 每个模块对相关实体的状态改变必须隔离在模块内部。 这个要求是确保前台对中台可以做到最小化。 而且对中台的依赖可以局限在前台的个别业务模块中， 这样对某个中台的依赖不会带来整个系统的稳定性降低。   这个要求可以防止中台过渡侵入到前台，无序扩张。 2. 中台的模块必须可以被局部替代，中台的各模块加载独立，且个别模块所封装能力可以被等价接口所替代而不影响剩余的模块功能。 这个要求和前面可解释性/可验证性一起就可以允许业务线对中台形成部分依赖， 而不是只要依赖某个中台的一个功能， 就必须所有功能全依赖，永远全家桶。 3. 中台能力可以被第三方扩展和传播。 也就是说中台的某个模块可以被前台团队重写后发布给全集团使用。 这样可以避免中台能力仅仅独家定制，创新被遏制在远离前台的后台团队。&lt;/p&gt;&lt;p&gt;为什么说前面两个要求是必要条件呢？ 因为他们合在一起就是要解决中台提供能力的可封装性和可用性， 也就是说一个前台团队根据能力的描述可以决定是否使用一个中台功能。 而后面三个是充分条件， 就是中台提供的能力前台业务线也可以选择不用， 或者部分使用那些有价值的模块。  这样中台既可用， 亦可弃， 才满足了中台做为一个通用能力加速业务线迭代的充分必要条件。&lt;/p&gt;&lt;h3&gt;5.4 车好多中台的设计原则&lt;/h3&gt;&lt;p&gt;中台设计和使用上我们有如下原则： 1. 业务优先。 多数时候由业务线同学决定架构选型， 而不是中央决策。 2. 反膨胀软件。 对中台API稳定性和数据模型兼容性做强制要求， 避免中台膨胀过快。  3. 避免复杂依赖。 整个中台要求扁平化微服务化设计，降低依赖深度，加速功能发现。 4. 模块化开发。 各模块有明确边界，独立文档，可独立设计/发布/被替代/升级。 模块尽量以原子服务模式向往透出，模块间依赖主要是服务依赖。&lt;/p&gt;&lt;p&gt;中台的具体边界和抽象深度是个非常有挑战的问题，往往是个平衡，没有对错。 对此我们做了&lt;strong&gt;设计追求&lt;/strong&gt;的建议。 就是期望各中台团队在交付压力允许的情况下最大化的做到以下两点： 1. 边界合理： 寻找中台的正确边界，平衡研发成本和业务迭代速度。 中台的边界应当使得API最简化。   2. 中台对多个业务的抽象逼近最优， 模型在信息量最大的情况下能够保持相对稳定。下面两张图就是个具体的例子， 前一个模型简单， 相对稳定， 但是在这个模型下能够提供的服务粒度粗。 第二个模型更复杂， 这个模型下能够提供相对更细粒度的服务。  后者能够适用多个车好多业务线的现有模式， 且信息容易更大，所以在当前的业务矩阵之下是个更好的模型。  &lt;/p&gt;&lt;p&gt;5.5. 车好多的中台组织和孵化机制&lt;/p&gt;&lt;p&gt;车好多之前没有中台，怎么孵化出中台来也是个挑战。 孵化中台有多个方式： 1. &lt;strong&gt;自由竞争制： &lt;/strong&gt;个人或者团队自主入场， 自主投入。代码开源，去中心化研发， 通过统一发现机制对外露出。  2. &lt;strong&gt;中央授权制&lt;/strong&gt;： 由公司做顶层决策，不做团队调整， 做项目强制统一多个技术分支。  3. &lt;strong&gt;集中孵化制&lt;/strong&gt;： 由公司做顶层决策， 对团队先做整合， 之后由该团队孵化中台。 4. &lt;strong&gt;重点扶持制&lt;/strong&gt;： 不对称的做研发人员补贴，对特定领域做引导， 加速该领域的中台建设。 视情况不同， 我们这几种组织和孵化机制都有采用。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;中台的孵化具体有如下几个平行的方向： 1. 逐步建设市场机制&lt;/strong&gt;： 由前台业务线研发做选型决策，保障业务优先。 同时通过HC管理引导最优决策，靠市场和预算驱动最经济的决策， 防止中台和前台的膨胀软件。 在考核指标上前台考核业务增长。 中台则考核前台接入成本, 前台新需求延迟, 前台定制成本和接口高稳定性。 2. &lt;strong&gt;建设自由准入能力，同时鼓励经营和创新。&lt;/strong&gt; 除了前面提到的内部开源且允许分支。 我们会逐步建设去中心化研发体系， 加速分布式创新。 同时为了鼓励中台经营， 通过控制业务线分支权利来说防止重复造轮。 3. &lt;strong&gt;人才流转策略&lt;/strong&gt;：中台和前台必须有统一的研发体系和统一人才流转机制，保持双方的活力。对有基本的能力，偏好和专业度差异的研发人才做定向培养， 支持转岗。4. &lt;strong&gt;保障业务连续性和人员稳定性&lt;/strong&gt;：对中台我们会保留一定程度的顶层设计，避免大范围技术和组织重构。&lt;/p&gt;&lt;h3&gt;5.5 关于人才&lt;/h3&gt;&lt;p&gt;最后我讲讲人才。 不论设计多么完美的机制， 最终还是要靠人来实现。 合理的机制仅仅能够避免引人误入歧途， 但是价值创造还是要靠优秀的人才。&lt;/p&gt;&lt;p&gt;我们车好多对人才的画像可以总结成两句话： 做学问要包容求真， 做人要有良知和勇气。  第一点是期望我们的人才能够保持开阔的视野， 对新事物和不同观点的包容，和不断探索寻求真正有价值洞察的欲望， 从而发现别人不能发现的机会。  第二点是希望我们的人才能够为公司做正确的决策， 不断的让正确的事情发生。 同时他也要有勇气，愿意站出来阻止错误的事情发生。我们当下虽然有一些这样的人才，但也渴望更多的这样的人才加入。 &lt;/p&gt;&lt;h2&gt;&lt;strong&gt;5.  &lt;/strong&gt;结语&lt;/h2&gt;&lt;p&gt;中台不是万能的， 但是可以在高确定性和高通用性场景下能创造增量价值。 中台应该有合理的应用场景和时间窗口， 需要用一些设计原则来约束， 也需要相应的组织机制支持。中台有自己的生命周期， 要做阶段性的重构和重定位。这就是我对中台的大致理解。&lt;/p&gt;&lt;p&gt;车好多的中台实践不是标准答案，甚至不一定正确。 我的分享是仅仅是为了带动高质量的思想碰撞， 也希望得到大家的帮助和反馈。 谢谢大家。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>66a2444b8c0cfe09080ea70bdeb36fe0</guid>
<title>Spring Boot 2 整合 OAuth2 组件，模拟第三方授权访问</title>
<link>https://toutiao.io/k/ibroeej</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;h1&gt;&lt;span&gt;一、模式描述&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.49322033898305084&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uUIibyNXbAvB6ZOPaheeXAdoTJB5q98zmld3ib8vuh0kYIcymKOTocn3Fhcbkrbg4LKsukQSDFmu6cs5OEJAlx6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1180&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;授权服务&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;验证第三方服务的身份，验证邮箱用户的身份，记录和管理认证Token，为资源服务器提供Token校验。场景：第三方网站借助用户的邮箱登录，并访问邮箱账户的基础信息，头像、名称等。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;资源服务&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;第三方服务通过邮箱账户登录后需要获取的一些信息，即理解为资源，存储邮箱账户的数据资源。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;第三方服务&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;即借助邮箱用户的账户，快速登录第三个服务，免去繁杂的注册流程，有助于快速积累新用户。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;交互流程&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;第三方服务给用户开放快速邮箱登录功能，引导用户调到邮箱认证服务，通过认证后返回身份令牌到第三方服务，第三方服务携带令牌访问邮箱的资源服务，获取一些基本的邮箱用户信息。&lt;/p&gt;&lt;h1&gt;&lt;span&gt;二、项目配置管理&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span&gt;1、案例结构&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7249283667621776&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uUIibyNXbAvB6ZOPaheeXAdoTJB5q98zmtUGEhnrEPxFd73ZdyV0jmweNK7MqywhyqxwQWDH5ib5lJC3q24BTa7w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;698&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;核心依赖&lt;/strong&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-web&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.security.oauth&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-security-oauth2&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.1.3.RELEASE&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-security&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里有两个核心组件依赖：OAuth2组件和Security组件。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;模块划分&lt;/strong&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;auth-server：授权服务&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;resource-server：资源服务器&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;third-server：第三个服务&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;span&gt;2、配置描述&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;【授权服务】&lt;/p&gt;&lt;p&gt;&lt;strong&gt;OAuth2配置&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;这里的配置管理的是第三方的授权流程和发放给第三方的身份证明ClientID和密码，实际的场景就是第三方借助邮箱账号登录，首先就是向邮箱管理方提供材料，获取访问邮箱服务的身份证明，然后才能对接开放服务，这种模式在第三方对接业务中很常见。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * 模拟第三方授权配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@EnableAuthorizationServer&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;AuthConfig&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;AuthorizationServerConfigurerAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Resource&lt;/span&gt;&lt;br/&gt;    ClientDetailsService clientDetailsService;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 资源服务器校验Token&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(AuthorizationServerSecurityConfigurer security)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        security.checkTokenAccess(&lt;span&gt;&quot;permitAll()&quot;&lt;/span&gt;).allowFormAuthenticationForClients();&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 第三方客户端请求配置，和资源服务访问的配置，不设置默认都可以访问，提供默认回调地址&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(ClientDetailsServiceConfigurer clients)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        clients.inMemory()&lt;br/&gt;                .withClient(&lt;span&gt;&quot;third01&quot;&lt;/span&gt;)&lt;br/&gt;                .secret(&lt;span&gt;new&lt;/span&gt; BCryptPasswordEncoder().encode(&lt;span&gt;&quot;third01&quot;&lt;/span&gt;))&lt;br/&gt;                .resourceIds(&lt;span&gt;&quot;resource-01&quot;&lt;/span&gt;)&lt;br/&gt;                .authorizedGrantTypes(&lt;span&gt;&quot;authorization_code&quot;&lt;/span&gt;,&lt;span&gt;&quot;refresh_token&quot;&lt;/span&gt;)&lt;br/&gt;                .scopes(&lt;span&gt;&quot;all&quot;&lt;/span&gt;)&lt;br/&gt;                .redirectUris(&lt;span&gt;&quot;http://localhost:8082/notify.html&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 配置访问端点&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(AuthorizationServerEndpointsConfigurer endpoints)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        endpoints.authorizationCodeServices(authorizationCodeServices()).tokenServices(tokenServices());&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 内存管理&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;AuthorizationCodeServices &lt;span&gt;authorizationCodeServices&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InMemoryAuthorizationCodeServices();&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * Token管理规则&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;AuthorizationServerTokenServices &lt;span&gt;tokenServices&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        DefaultTokenServices services = &lt;span&gt;new&lt;/span&gt; DefaultTokenServices();&lt;br/&gt;        services.setClientDetailsService(clientDetailsService);&lt;br/&gt;        services.setSupportRefreshToken(&lt;span&gt;true&lt;/span&gt;);&lt;br/&gt;        services.setTokenStore(tokenStore());&lt;br/&gt;        services.setAccessTokenValiditySeconds(&lt;span&gt;3600&lt;/span&gt;);&lt;br/&gt;        services.setRefreshTokenValiditySeconds(&lt;span&gt;3600&lt;/span&gt;*&lt;span&gt;7&lt;/span&gt;);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; services;&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;TokenStore &lt;span&gt;tokenStore&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InMemoryTokenStore();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通常需要数据库存储第三方信息，可以到第OAuth2开源项目中，获取表结构放到本地数据库中，然后这里换成数据源加载模式即可，简单的流程管理都在源码里写了SQL语句，数据源引入即可。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Security配置&lt;/strong&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * 模拟本地用户配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;SecurityConfig&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;WebSecurityConfigurerAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 密码加密方式&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; PasswordEncoder &lt;span&gt;passwordEncoder&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; BCryptPasswordEncoder();&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 内存中虚拟用户和角色&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(AuthenticationManagerBuilder auth)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        auth.inMemoryAuthentication()&lt;br/&gt;                .withUser(&lt;span&gt;&quot;user&quot;&lt;/span&gt;)&lt;br/&gt;                .password(&lt;span&gt;new&lt;/span&gt; BCryptPasswordEncoder().encode(&lt;span&gt;&quot;123456&quot;&lt;/span&gt;))&lt;br/&gt;                .roles(&lt;span&gt;&quot;user&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 表单登录&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(HttpSecurity http)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        http.csrf().disable().formLogin();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;基于这里的配置管理邮箱用户的认证流程，例如使用邮箱账号密码登录验证，判断授权是否成立，这里管理的是服务本地的邮箱账号，基于数据源存储数据在下面案例中都有。&lt;/p&gt;&lt;p&gt;关于Spring框架中安全认证的相关的几个组件，在使用OAuth2之前可以先了解一下。&lt;/p&gt;&lt;p&gt;【资源服务】&lt;/p&gt;&lt;p&gt;主要功能有三块，配置第三方携带的Token身份令牌校验机制，即访问授权服务校验接口，这里是OAuth2自定义好的接口；配置resourceId资源服务的编号，用来控制第三个服务能访问的资源服务范围，属于大的权限点控制；模拟校验用户的Role角色，较精细的控制权限。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * 资源服务管理配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@EnableResourceServer&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ResourceServerConfig&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;ResourceServerConfigurerAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * Token令牌校验&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;RemoteTokenServices &lt;span&gt;tokenServices&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        RemoteTokenServices services = &lt;span&gt;new&lt;/span&gt; RemoteTokenServices();&lt;br/&gt;        services.setCheckTokenEndpointUrl(&lt;span&gt;&quot;http://localhost:8080/oauth/check_token&quot;&lt;/span&gt;);&lt;br/&gt;        services.setClientId(&lt;span&gt;&quot;third01&quot;&lt;/span&gt;);&lt;br/&gt;        services.setClientSecret(&lt;span&gt;&quot;third01&quot;&lt;/span&gt;);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; services;&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 服务资源ID配置&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(ResourceServerSecurityConfigurer resources)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        resources.resourceId(&lt;span&gt;&quot;resource-01&quot;&lt;/span&gt;).tokenServices(tokenServices());&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 模拟用户权限规则&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;configure&lt;/span&gt;&lt;span&gt;(HttpSecurity http)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        http.authorizeRequests()&lt;br/&gt;                .antMatchers(&lt;span&gt;&quot;/user/**&quot;&lt;/span&gt;).hasRole(&lt;span&gt;&quot;user&quot;&lt;/span&gt;)&lt;br/&gt;                .anyRequest().authenticated();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;【第三方服务】&lt;/p&gt;&lt;p&gt;主要提供两个流程的模拟：请求授权服务获取身份令牌；携带身份令牌请求资源服务获取数据。这里则是授权码回调接口的处理方式。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;@Controller&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;NotifyController&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Logger LOG = LoggerFactory.getLogger(NotifyController.class);&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Resource&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; RestTemplate restTemplate;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/notify.html&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;notify&lt;/span&gt;&lt;span&gt;(String code, Model model)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (code != &lt;span&gt;null&lt;/span&gt;) {&lt;br/&gt;            MultiValueMap&amp;lt;String, String&amp;gt; map = &lt;span&gt;new&lt;/span&gt; LinkedMultiValueMap&amp;lt;&amp;gt;();&lt;br/&gt;            map.add(&lt;span&gt;&quot;code&quot;&lt;/span&gt;, code);&lt;br/&gt;            map.add(&lt;span&gt;&quot;client_id&quot;&lt;/span&gt;, &lt;span&gt;&quot;third01&quot;&lt;/span&gt;);&lt;br/&gt;            map.add(&lt;span&gt;&quot;client_secret&quot;&lt;/span&gt;, &lt;span&gt;&quot;third01&quot;&lt;/span&gt;);&lt;br/&gt;            map.add(&lt;span&gt;&quot;redirect_uri&quot;&lt;/span&gt;, &lt;span&gt;&quot;http://localhost:8082/notify.html&quot;&lt;/span&gt;);&lt;br/&gt;            map.add(&lt;span&gt;&quot;grant_type&quot;&lt;/span&gt;, &lt;span&gt;&quot;authorization_code&quot;&lt;/span&gt;);&lt;br/&gt;            Map&amp;lt;String,String&amp;gt; resp = restTemplate.postForObject(&lt;span&gt;&quot;http://localhost:8080/oauth/token&quot;&lt;/span&gt;, map, Map.class);&lt;br/&gt;            String accessToken = resp.get(&lt;span&gt;&quot;access_token&quot;&lt;/span&gt;);&lt;br/&gt;            LOG.info(&lt;span&gt;&quot;身份令牌：{}&quot;&lt;/span&gt;,accessToken);&lt;br/&gt;            HttpHeaders headers = &lt;span&gt;new&lt;/span&gt; HttpHeaders();&lt;br/&gt;            headers.add(&lt;span&gt;&quot;Authorization&quot;&lt;/span&gt;, &lt;span&gt;&quot;Bearer &quot;&lt;/span&gt; + accessToken);&lt;br/&gt;            HttpEntity&amp;lt;Object&amp;gt; httpEntity = &lt;span&gt;new&lt;/span&gt; HttpEntity&amp;lt;&amp;gt;(headers);&lt;br/&gt;            ResponseEntity&amp;lt;String&amp;gt; entity = restTemplate.exchange(&lt;span&gt;&quot;http://localhost:8081/user/resource&quot;&lt;/span&gt;, HttpMethod.GET, httpEntity, String.class);&lt;br/&gt;            model.addAttribute(&lt;span&gt;&quot;notifyMsg&quot;&lt;/span&gt;, entity.getBody());&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;notify&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h1&gt;&lt;span&gt;三、测试流程&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.415625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uUIibyNXbAvB6ZOPaheeXAdoTJB5q98zmmuNYCZdX5vMYRxICRny54jBxturHqbxiaOlwXeaEPxePK59wBuNQ8Mw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;通过上述测试流程，对比常见的第三方登录机制，理解OAuth2的授权码模式。&lt;/p&gt;&lt;h1&gt;&lt;span&gt;四、源代码地址&lt;/span&gt;&lt;/h1&gt;&lt;pre&gt;&lt;code&gt;GitHub·地址&lt;br/&gt;https:&lt;span&gt;//github.com/cicadasmile/middle-ware-parent&lt;/span&gt;&lt;br/&gt;GitEE·地址&lt;br/&gt;https:&lt;span&gt;//gitee.com/cicadasmile/middle-ware-parent&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.3783359497645212&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uUIibyNXbAvCjMheLZtcM2iaVMBOpIUKR4CDRCG9FLT5K6NmGXvG7exrW0TSuDjnTKJQ5PDq8j8Y7PHDd17Z3gicA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1274&quot;/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>cb3a8058d0a1a8fd30b5801e2d60ed92</guid>
<title>为什么要鼓励重复造轮子？| 码农周刊第 327 期</title>
<link>https://toutiao.io/k/fvbrmmu</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;body class=&quot;issue&quot; id=&quot;readabilityBody&quot;&gt;
        &lt;h1&gt;为什么要鼓励重复造轮子？| 码农周刊第 327 期&lt;/h1&gt;
        &lt;h2&gt;码农周刊第327期（2020-12-23）&lt;/h2&gt;
        &lt;p&gt;☞ &lt;a href=&quot;https://weekly.manong.io/bounce?nid=327&amp;amp;aid=20216&amp;amp;url=http%3A%2F%2Fwww.huodongxing.com%2Fevent%2F1573487912300%3Fcoupon%3DMNZK&quot; target=&quot;_blank&quot;&gt;汇聚云计算、区块链、数据等技术顶级大咖！点击抢购&lt;font&gt;限时早鸟票&lt;/font&gt;！&lt;/a&gt;&lt;br/&gt;&amp;#13;
&lt;a href=&quot;https://weekly.manong.io/bounce?nid=327&amp;amp;aid=20216&amp;amp;url=http%3A%2F%2Fwww.huodongxing.com%2Fevent%2F1573487912300%3Fcoupon%3DMNZK&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://img.toutiao.io/ads/qiniu_326.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/a&gt;&lt;br/&gt;&amp;#13;
&lt;small&gt;&lt;a href=&quot;https://weekly.manong.io/bounce?nid=327&amp;amp;aid=19185&amp;amp;url=https%3A%2F%2Fjinshuju.net%2Ff%2FV7DxN9&quot; target=&quot;_blank&quot;&gt;商务合作&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;
        
        &lt;h3 id=&quot;程序设计&quot;&gt;程序设计&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;关注云计算、数据、区块链三大技术主题，云集十余位业内大咖和顶尖技术人。&lt;font&gt;早鸟票限时抢购中&lt;/font&gt;&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;从 Druid 到 ClickHouse&lt;/p&gt;
        
        &lt;p&gt;实战总结&lt;/p&gt;
        
        &lt;p&gt;实践验证&lt;/p&gt;
        &lt;h3 id=&quot;VIP会员专区&quot;&gt;VIP会员专区&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;能够低成本、无侵入的收集代码覆盖率数据&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;通过它可以在异常时直接 dump 出一个迷你内存快照。快照中没有任何敏感信息，更重要的是文件非常小的同时数据也相对完整，非常适合离线分析 OOM 及其他类型异常的调查定位。&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;适合新手&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;在传统的计算机科学课程中，从操作系统、编程语言到机器学习，这些高大上课程和主题已经非常多了。然而有一个至关重要的主题却很少被专门讲授，而是留给学生们自己去探索。这部分内容就是：精通工具。&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;干货满满&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_3041.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
        &lt;h3 id=&quot;工具资料&quot;&gt;工具资料&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;关注云计算、数据、区块链三大技术主题，云集十余位业内大咖和顶尖技术人。&lt;font&gt;早鸟票限时抢购中&lt;/font&gt;&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;Service Mesh 篇&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;详细介绍&lt;/p&gt;
        
        &lt;p&gt;系列文章&lt;/p&gt;
        
        &lt;p&gt;入门介绍&lt;/p&gt;
        
        &lt;p&gt;系列文章&lt;/p&gt;
        
        &lt;p&gt;图文并茂&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        
        &lt;p&gt;经验总结&lt;/p&gt;
        
        &lt;p&gt;结合代码&lt;/p&gt;
        
        &lt;p&gt;代码示例&lt;/p&gt;
        
        &lt;p&gt;完整代码&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        &lt;h3 id=&quot;编程语言&quot;&gt;编程语言&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;关注云计算、数据、区块链三大技术主题，云集十余位业内大咖和顶尖技术人。&lt;font&gt;早鸟票限时抢购中&lt;/font&gt;&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;值得收藏&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;背景介绍&lt;/p&gt;
        
        &lt;p&gt;深入讲解&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        
        &lt;p&gt;一步步教你&lt;/p&gt;
        
        &lt;p&gt;一步步教你&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;结合代码&lt;/p&gt;
        
        &lt;p&gt;适合新手&lt;/p&gt;
        
        &lt;p&gt;详细介绍&lt;/p&gt;
        
        &lt;p&gt;简明介绍&lt;/p&gt;
        &lt;h3 id=&quot;每周独家号推荐&quot;&gt;每周独家号推荐&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 429587 即可&lt;/p&gt;
        
        &lt;p&gt;分享OPPO前沿互联网技术及活动&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 429344 即可&lt;/p&gt;
        
        &lt;p&gt;实时分享K8S等云原生技术、教程、资讯&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 392908 即可&lt;/p&gt;
        
        &lt;p&gt;一群靠谱的人，愿为phper带来一些值得细细品味的精神食粮&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 56197 即可&lt;/p&gt;
        
        &lt;p&gt;关注系统架构，做到实现功能、可靠、易用、高效率、可维护、可移植和优雅。&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 42200 即可&lt;/p&gt;
        &lt;h3 id=&quot;每周一书&quot;&gt;每周一书&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;本书从一些经典算法出发，为读者展示了 100 个 Python 趣味编程实例。欢迎到&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;兑换阅读。&lt;/p&gt;
        &lt;h3 id=&quot;编程之外&quot;&gt;编程之外&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;关注云计算、数据、区块链三大技术主题，云集十余位业内大咖和顶尖技术人。&lt;font&gt;早鸟票限时抢购中&lt;/font&gt;&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;欢迎探讨&lt;/p&gt;
        
        &lt;p&gt;经验总结&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_3041.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
        &lt;p&gt;
        &lt;/p&gt;
        
        
        
        
        &lt;div class=&quot;qrcode&quot;&gt;
  &lt;img src=&quot;https://img.toutiao.io/ads/vip_qrcode.png&quot; alt=&quot;Qrcode 258&quot;/&gt;&lt;span&gt;加入码农周刊VIP会员&lt;/span&gt;
&lt;/div&gt;
    &lt;/body&gt;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>736a84544aa8f150e1f559cf634f80c3</guid>
<title>漫画：理解了 TCP 连接的实现以后，客户端的并发也爆发了</title>
<link>https://toutiao.io/k/ng2dp1y</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI0MjEwMDMzNQ==&amp;amp;mid=2652517890&amp;amp;idx=1&amp;amp;sn=9cafd69e198174f653387f769a1a7821&amp;amp;chksm=f2efe702c5986e144c5feb8482cd4a1f933f891062b49e391815db7b42b3cadc018e13e7658a&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;漫画 | 一台Linux服务器最多能支撑多少个TCP连接？&lt;/a&gt;文章里有介绍服务器能支撑的连接数远不止65535，但客服端呢，是不是受限于此呢，本文给你解惑。&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.660569105691057&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w1YsrKR3kQRdricIiaiaocj2vXVR1OICEeeH2QDLoc1WkJMnUcpufDJNwA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;492&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;5000 65000&quot;&lt;/span&gt; &amp;gt; /proc/sys/net/ipv4/ip_local_port_range&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.6382113821138211&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wB2RboLqD9ZSlVEC3Az3EtJNic3hRXicPjJnGq11xNAcmvicJQbuxJ8S3Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;492&quot;/&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;连接1：192.168.1.101 5000 192.168.1.100 8090&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;连接2：192.168.1.101 5001 192.168.1.100 8090&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;连接N：192.168.1.101 ...  192.168.1.100 8090&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;连接6W：192.168.1.101 65000 192.168.1.100 8090&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.5630081300813008&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wPoBTicLFQwdicQV0S3cicz3LZkXJcfGW0icKlIr61iaIPQXw2FHkR2lxo3A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;492&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7987804878048781&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w2KxWM3uhXrSZH02ykJRyDyK8JddOoTo9REEbfQl1YCrMx6skXfasSA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;492&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;//修改整个系统能打开的文件描述符为20W&lt;br/&gt;&lt;span&gt;echo&lt;/span&gt; 200000 &amp;gt; /proc/sys/fs/file-max&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;//修改所有用户每个进程可打开文件描述符为20W&lt;br/&gt;&lt;span&gt;#vi /etc/sysctl.conf&lt;/span&gt;&lt;br/&gt;fs.nr_open=210000&lt;br/&gt;&lt;span&gt;#sysctl -p&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#vi /etc/security/limits.conf&lt;/span&gt;&lt;br/&gt;*  soft  nofile  200000&lt;br/&gt;*  hard  nofile  200000&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意: limits中的hard limit不能超过nr_open, 所以要先改nr_open。而且最好是在sysctl.conf中改。避免重启的时候 hard limit生效了，nr_open不生效导致启动问题。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.7656565656565657&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wtxezuuponhiaarx0HcNtHyqiahUoNdzfqZH3VQ3dUjL7YyFZNWibEXbfw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;495&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.8988095238095237&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w56hIr5oiaicKjoxYapiaRtUzbstDMCOmJkACzRQbtvbrPZeicX9f7F91Yw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;504&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“socket中有一个主要的数据结构sock_common，在它里面有两个联合体。”&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// file: include/net/sock.h&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;sock_common&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span&gt;union&lt;/span&gt; {&lt;br/&gt;  __addrpair skc_addrpair; &lt;span&gt;//TCP连接IP对儿 &lt;/span&gt;&lt;br/&gt;  &lt;span&gt;&lt;span&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;   __be32 skc_daddr;&lt;br/&gt;   __be32 skc_rcv_saddr;&lt;br/&gt;  };&lt;br/&gt; }; &lt;br/&gt; &lt;span&gt;union&lt;/span&gt; {&lt;br/&gt;  __portpair skc_portpair; &lt;span&gt;//TCP连接端口对儿&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;&lt;span&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;   __be16 skc_dport;&lt;br/&gt;   __u16 skc_num;&lt;br/&gt;  };&lt;br/&gt; };&lt;br/&gt; ......&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“其中skc_addrpair记录的是TCP连接里的IP对儿，skc_portpair记录的是端口对儿。”&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.9899396378269618&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wCAic89GSP4NJDX9RnRQxzQQzX9dwe9ic51OJznhiaPtrqKlibxPgKOGdbA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;497&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-cropselx1=&quot;20&quot; data-cropselx2=&quot;507&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;252&quot; data-ratio=&quot;0.4782051282051282&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wY2OlI34yDWmVTP7QKVMC3WVRAW2h3aOyRibTEiaEcASy5wzPEbBm8Vuw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1560&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“在网络包到达网卡之后，依次经历DMA、硬中断、软中断等处理，最后被送到socket的接收队列中了。”&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.5174537987679672&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w3PRQibX9sxx0S9szM2c4sYXZl1spNHkIlrWz6gveEZibGkU64mvhQCsQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;487&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“对于TCP协议来说，协议处理的入口函数是tcp_v4_rcv。我们看一下它的代码”&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// file: net/ipv4/tcp_ipv4.c&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;int&lt;/span&gt; &lt;span&gt;tcp_v4_rcv&lt;/span&gt;&lt;span&gt;(struct sk_buff *skb)&lt;/span&gt;&lt;br/&gt;&lt;/span&gt;{&lt;br/&gt; ......&lt;br/&gt; th = tcp_hdr(skb); &lt;span&gt;//获取tcp header&lt;/span&gt;&lt;br/&gt; iph = ip_hdr(skb); &lt;span&gt;//获取ip header&lt;/span&gt;&lt;br/&gt;&lt;br/&gt; sk = __inet_lookup_skb(&amp;amp;tcp_hashinfo, skb, th-&amp;gt;source, th-&amp;gt;dest);&lt;br/&gt; ......&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.33059548254620125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w0ueWaLTHEfSJZx5fCwxr4rJ6qbVMX3hJMCyydcgDE8sbicRxzxSkTsg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;487&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// file: include/net/inet_hashtables.h&lt;/span&gt;&lt;br/&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;inline&lt;/span&gt; &lt;span&gt;&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;sock&lt;/span&gt; *__&lt;span&gt;inet_lookup&lt;/span&gt;(&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;net&lt;/span&gt; *&lt;span&gt;net&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;struct&lt;/span&gt; &lt;span&gt;inet_hashinfo&lt;/span&gt; *&lt;span&gt;hashinfo&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be32&lt;/span&gt; &lt;span&gt;saddr&lt;/span&gt;, &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be16&lt;/span&gt; &lt;span&gt;sport&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be32&lt;/span&gt; &lt;span&gt;daddr&lt;/span&gt;, &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be16&lt;/span&gt; &lt;span&gt;dport&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;dif&lt;/span&gt;)&lt;br/&gt;{&lt;/span&gt;&lt;br/&gt; u16 hnum = ntohs(dport);&lt;br/&gt; &lt;span&gt;&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;sock&lt;/span&gt; *&lt;span&gt;sk&lt;/span&gt; = __&lt;span&gt;inet_lookup_established&lt;/span&gt;(&lt;span&gt;net&lt;/span&gt;, &lt;span&gt;hashinfo&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;saddr&lt;/span&gt;, &lt;span&gt;sport&lt;/span&gt;, &lt;span&gt;daddr&lt;/span&gt;, &lt;span&gt;hnum&lt;/span&gt;, &lt;span&gt;dif&lt;/span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;br/&gt; &lt;span&gt;return&lt;/span&gt; sk ? : __inet_lookup_listener(net, hashinfo, saddr, sport,&lt;br/&gt;          daddr, hnum, dif);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“先判断有没有连接状态的socket，这会走到__inet_lookup_established函数中”&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;sock&lt;/span&gt; *__&lt;span&gt;inet_lookup_established&lt;/span&gt;(&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;net&lt;/span&gt; *&lt;span&gt;net&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;struct&lt;/span&gt; &lt;span&gt;inet_hashinfo&lt;/span&gt; *&lt;span&gt;hashinfo&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be32&lt;/span&gt; &lt;span&gt;saddr&lt;/span&gt;, &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be16&lt;/span&gt; &lt;span&gt;sport&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; __&lt;span&gt;be32&lt;/span&gt; &lt;span&gt;daddr&lt;/span&gt;, &lt;span&gt;const&lt;/span&gt; &lt;span&gt;u16&lt;/span&gt; &lt;span&gt;hnum&lt;/span&gt;,&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;dif&lt;/span&gt;)&lt;br/&gt;{&lt;/span&gt;&lt;br/&gt; &lt;span&gt;//将源端口、目的端口拼成一个32位int整数&lt;/span&gt;&lt;br/&gt; &lt;span&gt;const&lt;/span&gt; __portpair ports = INET_COMBINED_PORTS(sport, hnum); &lt;br/&gt; ......&lt;br/&gt;&lt;br/&gt; &lt;span&gt;//内核用hash的方法加速socket的查找&lt;/span&gt;&lt;br/&gt; &lt;span&gt;unsigned&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; hash = inet_ehashfn(net, daddr, hnum, saddr, sport); &lt;br/&gt; &lt;span&gt;unsigned&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; slot = hash &amp;amp; hashinfo-&amp;gt;ehash_mask;&lt;br/&gt; &lt;span&gt;&lt;span&gt;struct&lt;/span&gt; &lt;span&gt;inet_ehash_bucket&lt;/span&gt; *&lt;span&gt;head&lt;/span&gt; = &amp;amp;&lt;span&gt;hashinfo&lt;/span&gt;-&amp;gt;&lt;span&gt;ehash&lt;/span&gt;[&lt;span&gt;slot&lt;/span&gt;];&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;begin:&lt;br/&gt; &lt;span&gt;//遍历链表，逐个对比直到找到&lt;/span&gt;&lt;br/&gt; sk_nulls_for_each_rcu(sk, node, &amp;amp;head-&amp;gt;chain) {&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt; (sk-&amp;gt;sk_hash != hash)&lt;br/&gt;   &lt;span&gt;continue&lt;/span&gt;;&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt; (likely(INET_MATCH(sk, net, acookie,&lt;br/&gt;          saddr, daddr, ports, dif))) {&lt;br/&gt;   &lt;span&gt;if&lt;/span&gt; (unlikely(!atomic_inc_not_zero(&amp;amp;sk-&amp;gt;sk_refcnt)))&lt;br/&gt;    &lt;span&gt;goto&lt;/span&gt; begintw;&lt;br/&gt;   &lt;span&gt;if&lt;/span&gt; (unlikely(!INET_MATCH(sk, net, acookie,&lt;br/&gt;       saddr, daddr, ports, dif))) {&lt;br/&gt;    sock_put(sk);&lt;br/&gt;    &lt;span&gt;goto&lt;/span&gt; begin;&lt;br/&gt;   }&lt;br/&gt;   &lt;span&gt;goto&lt;/span&gt; out;&lt;br/&gt;  }&lt;br/&gt; }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;487&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;241&quot; data-ratio=&quot;0.4948665297741273&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wqZJjg15BNOnAmV87cWCwOKuTnKibSpXicKuc49CZWj8gtcxVTM33Oib7A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;487&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// include/net/inet_hashtables.h&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#&lt;span&gt;define&lt;/span&gt; INET_MATCH(__sk, __net, __cookie, __saddr, __daddr, __ports, __dif) \&lt;br/&gt; ((inet_sk(__sk)-&amp;gt;inet_portpair == (__ports)) &amp;amp;&amp;amp;  \&lt;br/&gt;  (inet_sk(__sk)-&amp;gt;inet_daddr == (__saddr)) &amp;amp;&amp;amp;  \&lt;br/&gt;  (inet_sk(__sk)-&amp;gt;inet_rcv_saddr == (__daddr)) &amp;amp;&amp;amp;  \&lt;br/&gt;  (!(__sk)-&amp;gt;sk_bound_dev_if ||    \&lt;br/&gt;    ((__sk)-&amp;gt;sk_bound_dev_if == (__dif)))  &amp;amp;&amp;amp;  \&lt;br/&gt;  net_eq(sock_net(__sk), (__net)))&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;“在INET_MATCH中将网络包tcp header中的__saddr、__daddr、__ports和Linux中的socket中inet_portpair、inet_daddr、inet_rcv_saddr进行对比。如果匹配socket就找到了。当然除了ip和端口，INET_MATCH还比较了其它一些东东，所以TCP还有五元组、七元组之类的说法。”&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;2.83030303030303&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w3bE0aANmtUKfKxqsWqesnNssj239RYIRPOrH4XqEnTGgLRKsIgoqRg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;495&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;# cat /etc/redhat-release&lt;/span&gt;&lt;br/&gt;Red Hat Enterprise Linux Server release 6.2 (Santiago)&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# ss -ant | grep ESTAB |wc -l&lt;/span&gt;&lt;br/&gt;1000013&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# cat /proc/meminfo&lt;/span&gt;&lt;br/&gt;MemTotal:        3925408 kB&lt;br/&gt;MemFree:           97748 kB&lt;br/&gt;Buffers:           35412 kB&lt;br/&gt;Cached:           119600 kB&lt;br/&gt;......&lt;br/&gt;Slab:            3241528 kB&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-cropselx1=&quot;42&quot; data-cropselx2=&quot;537&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;1401&quot; data-ratio=&quot;0.4188679245283019&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4w2CJPquFrLD9t10ll5P3yb7cibjbra5WLZFDzgOFTdO9OyRJhcJZdTiaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;795&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.503030303030303&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BBjAFF4hcwo2tuK205q4P1oP54ibPcic4wcwJSevTl1BCk8S0th51z9hq8GeesiaaGYJWsdTzibYgWofRUkwH3X7PQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;495&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;总结&lt;/span&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;客户端每建立一个连接就要消耗一个端口，所以很多同学当看到客户端机器上连接数一旦超过3W、5W就紧张的不行，总觉得机器要出问题了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这篇文章的第一版也是很早就写出来了，不过飞哥又打磨了好长时间才算满意。在文中我们展示了一下 TCP socket的部分内核代码。通过源码来看：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;TCP连接就是在客户机、服务器上的一对儿的socket。它们都在各自内核对象上记录了双方的ip对儿、端口对儿（也就是我们常说的四元组），通过这个在通信时找到对方。&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;TCP连接发送方在发送网络包的时候，会把这份信息复制到IP Header上。网络包带着这份信物穿过互联网，到达目的服务器。目的服务器内核会按照 IP 包 header 中携带的信物（四元组）去匹配找到正确的socket(连接)。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在这个过程里我们可以看到，客户端的端口只是这个四元组里的一元而已。哪怕两条连接用的是同一个端口号，只要客户端ip不一样，或者是服务器不一样都不影响内核正确寻找到对应的连接，而不会串线！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以在客户端增加TCP最大并发能力有两个方法。第一个办法，为客户端配置多个ip。第二个办法，连接多个不同的server。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;不过这两个办法最好不要混用。因为使用多 IP 时，客户端需要bind。一旦bind之后，内核建立连接的时候就不会选择用过的端口了。bind函数会改变内核选择端口的策略~~&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后我们亲手实验证明了客户端也可以突破百万的并发量级。相信读过此文的你，以后再也不用再惧怕65535这个数字了。&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__0&quot;&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2934&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2935&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2936&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2937&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2938&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2939&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2940&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2941&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2942&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2943&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;伟&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2944&quot;&gt;伟&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2945&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2946&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;分&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2947&quot;&gt;分&lt;/span&gt;&lt;span data-raw-text=&quot;割&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2948&quot;&gt;割&lt;/span&gt;&lt;span data-raw-text=&quot;线&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2949&quot;&gt;线&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2950&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2951&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2952&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2953&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2954&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2955&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2956&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2957&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2958&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2959&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2960&quot;&gt;-&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__1&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__2&quot;&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2961&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2962&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2963&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2964&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2965&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2966&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;(&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2967&quot;&gt;(&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2968&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2969&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2970&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;f&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2971&quot;&gt;f&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2972&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2973&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2974&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2975&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;y&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2976&quot;&gt;y&lt;/span&gt;&lt;span data-raw-text=&quot;)&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2977&quot;&gt;)&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;98&quot; data-index=&quot;2978&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2979&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2980&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;群&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2981&quot;&gt;群&lt;/span&gt;&lt;span data-raw-text=&quot;靠&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2982&quot;&gt;靠&lt;/span&gt;&lt;span data-raw-text=&quot;谱&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2983&quot;&gt;谱&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2984&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;人&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2985&quot;&gt;人&lt;/span&gt;&lt;span data-raw-text=&quot;建&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2986&quot;&gt;建&lt;/span&gt;&lt;span data-raw-text=&quot;立&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2987&quot;&gt;立&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2988&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;愿&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2989&quot;&gt;愿&lt;/span&gt;&lt;span data-raw-text=&quot;为&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2990&quot;&gt;为&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2991&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2992&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2993&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2994&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;r&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2995&quot;&gt;r&lt;/span&gt;&lt;span data-raw-text=&quot;带&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2996&quot;&gt;带&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2997&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2998&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;些&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2999&quot;&gt;些&lt;/span&gt;&lt;span data-raw-text=&quot;值&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3000&quot;&gt;值&lt;/span&gt;&lt;span data-raw-text=&quot;得&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3001&quot;&gt;得&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3002&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3003&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;品&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3004&quot;&gt;品&lt;/span&gt;&lt;span data-raw-text=&quot;味&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3005&quot;&gt;味&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3006&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;精&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3007&quot;&gt;精&lt;/span&gt;&lt;span data-raw-text=&quot;神&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3008&quot;&gt;神&lt;/span&gt;&lt;span data-raw-text=&quot;食&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3009&quot;&gt;食&lt;/span&gt;&lt;span data-raw-text=&quot;粮&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3010&quot;&gt;粮&lt;/span&gt;&lt;span data-raw-text=&quot;！&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3011&quot;&gt;！&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__3&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__4&quot;&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3012&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3013&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3014&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;只&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3015&quot;&gt;只&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3016&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3017&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;创&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3018&quot;&gt;创&lt;/span&gt;&lt;span data-raw-text=&quot;或&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3019&quot;&gt;或&lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3020&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3021&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3022&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;表&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3023&quot;&gt;表&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3024&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3025&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3026&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3027&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;不&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3028&quot;&gt;不&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3029&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3030&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;网&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3031&quot;&gt;网&lt;/span&gt;&lt;span data-raw-text=&quot;上&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3032&quot;&gt;上&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3033&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3034&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3035&quot;&gt;章&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__5&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__6&quot;&gt;&lt;span data-raw-text=&quot;所&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3036&quot;&gt;所&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3037&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3038&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3039&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3040&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3041&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;均&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3042&quot;&gt;均&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3043&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;找&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3044&quot;&gt;找&lt;/span&gt;&lt;span data-raw-text=&quot;到&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3045&quot;&gt;到&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3046&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3047&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3048&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;进&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3049&quot;&gt;进&lt;/span&gt;&lt;span data-raw-text=&quot;行&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3050&quot;&gt;行&lt;/span&gt;&lt;span data-raw-text=&quot;沟&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3051&quot;&gt;沟&lt;/span&gt;&lt;span data-raw-text=&quot;通&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3052&quot;&gt;通&lt;/span&gt;&lt;span data-raw-text=&quot;。&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3053&quot;&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__7&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__8&quot;&gt;&lt;span&gt;&lt;span data-raw-text=&quot;也&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3054&quot;&gt;也&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3055&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3056&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;各&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3057&quot;&gt;各&lt;/span&gt;&lt;span data-raw-text=&quot;位&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3058&quot;&gt;位&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3059&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3060&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;打&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3061&quot;&gt;打&lt;/span&gt;&lt;span data-raw-text=&quot;赏&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3062&quot;&gt;赏&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3063&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;算&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3064&quot;&gt;算&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3065&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3066&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;费&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3067&quot;&gt;费&lt;/span&gt;&lt;span data-raw-text=&quot;给&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3068&quot;&gt;给&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3069&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3070&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3071&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3072&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3073&quot;&gt;）&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3074&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;更&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3075&quot;&gt;更&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3076&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3077&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3078&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;家&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3079&quot;&gt;家&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3080&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3081&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3082&quot;&gt;投&lt;/span&gt;&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;102&quot; data-index=&quot;3083&quot;&gt;稿&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__9&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__10&quot;&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3085&quot;&gt;投&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3086&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3087&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;联&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3088&quot;&gt;联&lt;/span&gt;&lt;span data-raw-text=&quot;系&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3089&quot;&gt;系&lt;/span&gt;&lt;span data-raw-text=&quot;：&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3090&quot;&gt;：&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__11&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__12&quot;&gt;&lt;span data-raw-text=&quot;s&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3091&quot;&gt;s&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3092&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3093&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;n&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3094&quot;&gt;n&lt;/span&gt;&lt;span data-raw-text=&quot;z&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3095&quot;&gt;z&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3096&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3097&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;1&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3098&quot;&gt;1&lt;/span&gt;&lt;span data-raw-text=&quot;6&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3099&quot;&gt;6&lt;/span&gt;&lt;span data-raw-text=&quot;3&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3100&quot;&gt;3&lt;/span&gt;&lt;span data-raw-text=&quot;@&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3101&quot;&gt;@&lt;/span&gt;&lt;span data-raw-text=&quot;g&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3102&quot;&gt;g&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3103&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3104&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3105&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3106&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;.&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3107&quot;&gt;.&lt;/span&gt;&lt;span data-raw-text=&quot;c&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3108&quot;&gt;c&lt;/span&gt;&lt;span data-raw-text=&quot;o&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3109&quot;&gt;o&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3110&quot;&gt;m&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__13&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__14&quot;&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3111&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3112&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3113&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3114&quot;&gt;  &lt;span&gt;张彦飞allen&lt;/span&gt; &lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3118&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3119&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3120&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3121&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3122&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3123&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3124&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3125&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3126&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;布&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3127&quot;&gt;布&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3128&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3129&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3130&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3131&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3132&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;明&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3133&quot;&gt;明&lt;/span&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3134&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3135&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;源&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3136&quot;&gt;源&lt;/span&gt;&lt;span data-raw-text=&quot;信&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3137&quot;&gt;信&lt;/span&gt;&lt;span data-raw-text=&quot;息&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3138&quot;&gt;息&lt;/span&gt;&lt;span data-raw-text=&quot;和&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3139&quot;&gt;和&lt;/span&gt;&lt;span data-raw-text=&quot;以&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3140&quot;&gt;以&lt;/span&gt;&lt;span data-raw-text=&quot;下&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3141&quot;&gt;下&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3142&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3143&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3144&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3145&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3146&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;长&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3147&quot;&gt;长&lt;/span&gt;&lt;span data-raw-text=&quot;按&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3148&quot;&gt;按&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3149&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;识&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3150&quot;&gt;识&lt;/span&gt;&lt;span data-raw-text=&quot;别&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3151&quot;&gt;别&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3152&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3153&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3154&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;关&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3155&quot;&gt;关&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3156&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3157&quot;&gt;）&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__15&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;1&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/LHDiahSVnXhunbEtuowcI7kF5kmUaeTrszibibQ3st6OU8hy2CoIotHHLxicicibyF1qkNI7HibXYHXGN6hRby4ZyjR6A/640?wx_fmt=jpeg&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>