<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>aa8d6b08ad046d44ada475f7afc83b0c</guid>
<title>GitHub 访问加速指南</title>
<link>https://toutiao.io/k/5mauvie</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不知道什么时候开始，&lt;code&gt;GitHub&lt;/code&gt;里面的图片也无法加载出来，本来页面也加载缓慢，这下更是雪上加霜，好在还是有简单的方式加速&lt;code&gt;GitHub&lt;/code&gt;的访问。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过设置&lt;code&gt;hosts&lt;/code&gt;就是一个低成本的方案， &lt;code&gt;GitHub&lt;/code&gt;里面图片都在&lt;code&gt;githubusercontent.com&lt;/code&gt;域名下，我们只需要在&lt;code&gt;hosts&lt;/code&gt;里绑定域名和对应的&lt;code&gt;IP&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. hosts内容&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;hosts&lt;/code&gt;文件内容如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;# 2020年12月30日更新&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# GitHub Start&lt;/span&gt;&lt;br/&gt;52.74.223.119     github.com&lt;br/&gt;52.74.223.119   gist.github.com&lt;br/&gt;54.169.195.247   api.github.com&lt;br/&gt;185.199.111.153   assets-cdn.github.com&lt;br/&gt;199.232.96.133    raw.githubusercontent.com&lt;br/&gt;199.232.96.133    gist.githubusercontent.com&lt;br/&gt;199.232.96.133    cloud.githubusercontent.com&lt;br/&gt;199.232.96.133   camo.githubusercontent.com&lt;br/&gt;199.232.96.133   avatars0.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars1.githubusercontent.com&lt;br/&gt;199.232.96.133   avatars2.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars3.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars4.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars5.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars6.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars7.githubusercontent.com&lt;br/&gt;199.232.96.133    avatars8.githubusercontent.com&lt;br/&gt;199.232.96.133  user-images.githubusercontent.com&lt;br/&gt;185.199.109.154   github.githubassets.com&lt;br/&gt;&lt;span&gt;# GitHub End&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果发现没有作用，或者速度不理想，参考「&lt;strong&gt;查找IP&lt;/strong&gt;」内容更新下对应的&lt;code&gt;IP&lt;/code&gt;地址。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2. 如何修改 hosts&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.1 Windows&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;hosts文件位置：&lt;code&gt;C:/windows/system32/drivers/etc/hosts&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;将前文内容追加到&lt;code&gt;hosts&lt;/code&gt;，然后刷新&lt;code&gt;DNS&lt;/code&gt;缓存：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;ipconfig /flushdns&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.2 macOS&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;hosts文件位置：&lt;code&gt;/etc/hosts&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;macOS&lt;/code&gt;系统下修改需要按照如下方式：&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1：首先，打开（访达）Finder。&lt;span/&gt;&lt;/h5&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2：使用组合键&lt;code&gt;Shift+Command+G&lt;/code&gt;打开&quot;前往文件夹&quot;，输入框中输入&lt;code&gt;/etc/hosts&lt;/code&gt;。&lt;span/&gt;&lt;/h5&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3：然后就会跳转到&lt;code&gt;hosts&lt;/code&gt;文件位置。&lt;span/&gt;&lt;/h5&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意：如果你使用&lt;code&gt;VS Code&lt;/code&gt;，可以直接用&lt;code&gt;VS Code&lt;/code&gt;修改和保存。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;复制&lt;code&gt;hosts&lt;/code&gt;文件到桌面上，鼠标右键右击它，选择「打开方式」—「文本编辑」，打开这个&lt;code&gt;hosts&lt;/code&gt;文件，然后将你要修改的内容直接在里面修改就好了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后把你修改好的&lt;code&gt;hosts&lt;/code&gt;文件替换掉：&lt;code&gt;/etc/hosts&lt;/code&gt; 文件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意：如果弹出密码输入框，你需要输入你当前电脑登录账号的密码。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后刷新缓存：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;sudo killall -HUP mDNSResponder&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;3. 查找IP&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;http://tool.chinaz.com/dns&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://site.ip138.com&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://www.ipaddress.com&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注：2020年12月30日我实际使用&lt;code&gt;IPAddress&lt;/code&gt;才可以生效，前面两个查询站点获取的&lt;code&gt;IP&lt;/code&gt;均无法使用，各位可以都尝试下直到生效。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前面&lt;code&gt;hosts&lt;/code&gt;里面域名里分为两类：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;*.githubusercontent.com&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;*.github.com&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;*.githubusercontent.com&lt;/code&gt;可以使用同一个&lt;code&gt;IP&lt;/code&gt;，不需要每个单独查询。&lt;code&gt;*.github.com&lt;/code&gt;未经测试，目前看是需要单独查询对应的&lt;code&gt;IP&lt;/code&gt;。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;其他方案&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;镜像站点&lt;span/&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://github.com.cnpmjs.org&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://hub.fastgit.org&lt;/span&gt;&lt;sup&gt;[5]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这两个网站是整站访问的替代品，你可以浏览项目，也支持下载检出。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但是不建议登陆自己的账号，毕竟不是直接访问到原站。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;文件下载&lt;span/&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://ghproxy.com&lt;/span&gt;&lt;sup&gt;[6]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://gh.api.99988866.xyz&lt;/span&gt;&lt;sup&gt;[7]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该方案利用&lt;code&gt;Cloudflare Workers&lt;/code&gt;对 &lt;code&gt;release&lt;/code&gt; 、&lt;code&gt;archive&lt;/code&gt;以及项目文件进行加速，部署无需服务器。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果对自建感兴趣，可以访问&lt;span&gt;gh-proxy&lt;/span&gt;&lt;sup&gt;[8]&lt;/sup&gt;。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;Raw加速&lt;span/&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;https://7ed.net/gra&lt;/span&gt;&lt;sup&gt;[9]&lt;/sup&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;jsDelivr&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;jsDelivr&lt;/code&gt;不支持&lt;code&gt;exe&lt;/code&gt;文件下载，使用方法参考例子。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;地址格式如下，&lt;code&gt;version&lt;/code&gt;忽略则始终使用最新版本：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;https://cdn.jsdelivr.net/gh/user/repo@version/file&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;举个例子：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;# 原始url&lt;/span&gt;&lt;br/&gt;https://github.com/ineo6/homebrew-install/blob/master/install.sh&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 转换结果&lt;/span&gt;&lt;br/&gt;https://cdn.jsdelivr.net/gh/ineo6/homebrew-install/install.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;p&gt;文章内链接无法跳转，可以点击“阅读原文”获得更好的点击体验。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;span&gt;参考资料&lt;br/&gt;&lt;/span&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;http://tool.chinaz.com/dns: &lt;em&gt;http://tool.chinaz.com/dns/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;https://site.ip138.com: &lt;em&gt;https://site.ip138.com/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;https://www.ipaddress.com: &lt;em&gt;https://www.ipaddress.com/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;https://github.com.cnpmjs.org: &lt;em&gt;https://github.com.cnpmjs.org/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[5]&lt;/span&gt;&lt;p&gt;https://hub.fastgit.org: &lt;em&gt;https://hub.fastgit.org&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[6]&lt;/span&gt;&lt;p&gt;https://ghproxy.com: &lt;em&gt;https://ghproxy.com/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[7]&lt;/span&gt;&lt;p&gt;https://gh.api.99988866.xyz: &lt;em&gt;https://gh.api.99988866.xyz/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[8]&lt;/span&gt;&lt;p&gt;gh-proxy: &lt;em&gt;https://github.com/hunshcn/gh-proxy&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[9]&lt;/span&gt;&lt;p&gt;https://7ed.net/gra: &lt;em&gt;https://7ed.net/gra&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5555555555555556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/nrI8wQaX8Myib9xibDgNP4cia7SSXmQq4VYvvXSlyOWy1S55OlI7ku9lkjHFOOZNKJURia5hQbnGLWemvF0Olx3Xug/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.2777777777777778&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/nrI8wQaX8Myib9xibDgNP4cia7SSXmQq4VYYsfneoMsdVnKO4DicJiaiae3oLicLEvlicib2Sb7uCBkAXTJibqNnGzlM5n6A/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;/&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>f1b62063f2681d2b9c3c312b193c85c9</guid>
<title>面试：Redis 为什么快呢？查询为何会变慢？</title>
<link>https://toutiao.io/k/uktnxye</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;h1 cid=&quot;n0&quot; mdtype=&quot;heading&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;欢迎关注公众号【&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;Ccww技术博客&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;】，原创技术文章第一时间推出&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/h1&gt;&lt;hr/&gt;&lt;blockquote cid=&quot;n234&quot; mdtype=&quot;blockquote&quot;&gt;&lt;p cid=&quot;n238&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;越努力，越幸运，&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n239&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;本文已收藏在GitHub中JavaCommunity, 里面有面试分享、源码分析系列文章，欢迎收藏，点赞&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n241&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;https://github.com/Ccww-lx/JavaCommunity&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p cid=&quot;n245&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;在实际开发，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;使用会频繁，那么在使用过程中我们该如何正确抉择数据类型呢？哪些场景下适用哪些数据类型。而且在面试中也很常会被面试官问到Redis数据结构方面的问题：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n3&quot; mdtype=&quot;list&quot; data-mark=&quot;+&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n5&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;Redis为什么快呢？&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n7&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;为什么查询操作会变慢？&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n9&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;Redis Hash rehash过程&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n11&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;为什么使用哈希表作为Redis的索引&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p cid=&quot;n12&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;当我们分析理解了&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;数据结构，可以为了我们在使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的时候，正确抉择数据类型使用，提升系统性能。&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n13&quot; mdtype=&quot;heading&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;底层数据结构&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n14&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 是一个&lt;strong&gt;内存&lt;/strong&gt;键值&lt;/span&gt;&lt;code&gt;&lt;span&gt;key-value&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 数据库，且键值对数据保存在&lt;strong&gt;内存&lt;/strong&gt;中，因此&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;基于内存的数据操作，其效率高，速度快；&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n15&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;其中，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Key&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是&lt;/span&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt;类型，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 支持的 &lt;/span&gt;&lt;code&gt;&lt;span&gt;value&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 类型包括了 &lt;/span&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 、 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 、 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 、 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 、&lt;/span&gt;&lt;code&gt;&lt;span&gt;BitMap&lt;/span&gt;&lt;/code&gt;&lt;span&gt;等。&lt;strong&gt;&lt;code&gt;Redis&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt; 能够之所以能够广泛地适用众多的业务场景，基于其多样化类型的&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;value&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n16&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;而&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的&lt;/span&gt;&lt;code&gt;&lt;span&gt;Value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的数据类型是基于为&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;自定义的对象系统&lt;/span&gt;&lt;code&gt;&lt;span&gt;redisObject&lt;/span&gt;&lt;/code&gt;&lt;span&gt;实现的，&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;typedef struct redisObject{&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;//类型&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;unsigned type:4;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;//编码&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;unsigned encoding:4;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;//指向底层实现数据结构的指针&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;void *ptr;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;    ….. &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n18&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;redisObject&lt;/span&gt;&lt;/code&gt;&lt;span&gt;除了记录实际数据，还需要额外的内存空间记录数据长度、空间使用等元数据信息，其中包含了 8 字节的元数据和一个 8 字节指针，指针指向具体数据类型的实际数据所在位置：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.9388185654008439&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtSDNQwylk3gCp38thMsxAh40nSg3ia81kI6QBo3ucrCbx8BmSgHAnvBQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;474&quot;/&gt;&lt;span&gt;            &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n20&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;其中，&lt;strong&gt;指针指向的就是基于&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;Redis&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;的底层数据结构存储数据的位置，&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;Redis&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;的底层数据结构：&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;SDS&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;，双向链表、跳表，哈希表，压缩列表、整数集合实现的。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n21&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;那么Redis底层数据结构是怎么实现的呢？&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n22&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;Redis底层数据结构实现&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n23&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;我们先来看看&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;比较简单的&lt;strong&gt;&lt;code&gt;SDS&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;,双向链表，整数集合&lt;/strong&gt;。&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n24&quot; mdtype=&quot;heading&quot;&gt;&lt;code&gt;&lt;span&gt;SDS&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、双向链表和整数集合&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n25&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;SDS&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;len&lt;/span&gt;&lt;/code&gt;&lt;span&gt;字段记录已使用的字节数，将获取字符串长度复杂度降低为O(1)，而且&lt;/span&gt;&lt;code&gt;&lt;span&gt;SDS&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是&lt;strong&gt;惰性释放空间&lt;/strong&gt;的，你&lt;/span&gt;&lt;code&gt;&lt;span&gt;free&lt;/span&gt;&lt;/code&gt;&lt;span&gt;了空间，系统把数据记录下来下次想用时候可直接使用。不用新申请空间。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.68&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtVLsRjnowLfMk1lY2CbMmjJ4jQ1pBergSETqGy7zmUF2UPPjQjM2ZyQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;450&quot;/&gt;&lt;span&gt;                                   &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n27&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;整数集合&lt;/strong&gt;，在内存中分配一块地址连续的空间，数据元素会挨着存放，不需要额外指针带来空间开销，其特点为&lt;strong&gt;内存紧凑节省内存空间，查询复杂度为O(1)效率高，其他操作复杂度为O(N)；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n28&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;双向链表&lt;/strong&gt;， 在内存上可以为非连续、非顺序空间，通过额外的指针开销前驱/后驱指针串联元素之间的顺序。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n29&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;其特点为节插入/更新数据复杂度为O(1)效率高，查询复杂度为O(N)；&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n30&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;code&gt;Hash&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;哈希表&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n31&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;哈希表，其实类似是一个数组，数组的每个元素称为一个哈希桶，每个哈希桶中保存了键值对数据，且哈希桶中的元素使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;dictEntry&lt;/span&gt;&lt;/code&gt;&lt;span&gt;结构，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.433862433862434&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtxZPcrKQr3zCsFn7o1ungB0YuVDjibXCcovTh2VuzQ7QIHV1TdX3e6lw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;189&quot;/&gt;&lt;span&gt;    &lt;span&gt;                                           &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n33&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;因此，哈希桶元素保存的并不是键值对值本身，而是指向具体值的指针，&lt;strong&gt;所以在保存每个键值对的时候会额外空间开销，至少有增加24个字节，&lt;/strong&gt;特别是&lt;/span&gt;&lt;code&gt;&lt;span&gt;Value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;为&lt;/span&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的键值对，每一个键值对就需要额外开销24个字节空间。当保存数据小，额外开销比数据还大时，这时为了节省空间，考虑换数据结构。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n34&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;那来看看全局哈希表全图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6112600536193029&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtiapzhbjQhQicmpAwjamVjooSMT1MIIcichHmTBcjNtO7TxlibzbVzHww5A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;746&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n36&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;虽然哈希表操作很快，但&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;数据变大后，就会出现一个潜在的风险：&lt;strong&gt;哈希表的冲突问题和 &lt;/strong&gt;&lt;strong&gt;&lt;code&gt;rehash&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;开销问题&lt;/strong&gt;，&lt;strong&gt;这可以解释为什么哈希表操作变慢了？&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n37&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;当往哈希表中写入更多数据时，哈希冲突是不可避免的问题 ， Redis 解决哈希冲突的方式，就是&lt;strong&gt;链式哈希&lt;/strong&gt;，同一个哈希桶中的多个元素用一个链表来保存，它们之间依次用指针连接，如图所示：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.8324125230202578&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAt0yaW2S7GHY46xZgDQwib3qlvtvJiaFwXomsS53OHTrssCBibfEWRg5reA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;543&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n39&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;当哈希冲突也会越来越多，这就会导致某些哈希冲突链过长，进而导致这个链上的元素查找耗时长，效率降低。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n40&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;为了解决哈希冲突带了的链过长的问题，进行&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;rehash&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;操作&lt;/strong&gt;，增加现有的哈希桶数量，分散单桶元素数量。那么&lt;/span&gt;&lt;code&gt;&lt;span&gt;rehash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;过程怎么样执行的呢？&lt;/span&gt;&lt;/p&gt;&lt;h5 cid=&quot;n41&quot; mdtype=&quot;heading&quot;&gt;&lt;code&gt;&lt;span&gt;Rehash&lt;/span&gt;&lt;/code&gt;&lt;/h5&gt;&lt;p cid=&quot;n42&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;为了使&lt;/span&gt;&lt;code&gt;&lt;span&gt;rehash&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 操作更高效，使用两个全局哈希表：哈希表 1 和哈希表 2，具体如下：&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n50&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;但由于表1和表2在重新映射复制时数据大，如果一次性把哈希表 1 中的数据都迁移完，会造成 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 线程阻塞，无法服务其他请求。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n51&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt; 为了避免这个问题，保证&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redi&lt;/span&gt;&lt;/code&gt;&lt;span&gt;s能正常处理客户端请求，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;采用了&lt;strong&gt;渐进式&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;rehash&lt;/code&gt;&lt;/strong&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n52&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;每处理一个请求时，从哈希表 1 中依次将索引位置上的所有 entries 拷贝到哈希表 2 中，把一次性大量拷贝的开销，分摊到了多次处理请求的过程中，避免了耗时操作，保证了数据的快速访问。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n53&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.6096045197740113&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtViaAeiczuZW7WaceXEaFburhlXicHxFVDaTxicu07SvT1UyibdKbdInSAYw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1770&quot;/&gt;&lt;/span&gt; &lt;/p&gt;&lt;p cid=&quot;n54&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;在理解完&lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;哈希表相关知识点后，看看不常见的压缩列表和跳表。&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n55&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;压缩列表与跳表&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n56&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;压缩列表&lt;/strong&gt;，在数组基础上，在压缩列表在表头有三个字段 zlbytes、zltail 和 zllen，分别表示列表长度、列表尾的偏移量和列表中的 entry 个数；压缩列表在表尾还有一个 zlend，表示列表结束。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.19761499148211242&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAtSp24keRoqNMclG1yicbEGmOql6Qdo8ajWyvIGJ51ZkRLWribfQwxaSSA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;587&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n58&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;优点：&lt;strong&gt;内存紧凑节省内存空间，内存中分配一块地址连续的空间，数据元素会挨着存放，不需要额外指针带来空间开销；查找定位第一个元素和最后一个元素，可以通过表头三个字段的长度直接定位，复杂度是 O(1)。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n59&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;跳表&lt;/strong&gt; ，在链表的基础上，增加了多级索引，通过索引位置的几个跳转，实现数据的快速定位，如下图所示：&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n60&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;比如查询33&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n61&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.5995740149094781&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAt6S8EtRcW22qQzRPBBLqJQwouBsYXMvZY9gEOwlibOt5b1MlPLnk9Qsg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1878&quot;/&gt;&lt;/span&gt; &lt;/p&gt;&lt;p cid=&quot;n62&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;特点：当数据量很大时，跳表的查找复杂度为O(logN)。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n63&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;综上所述，可以得知底层数据结构的时间复杂度：&lt;/span&gt;&lt;/p&gt;&lt;figure cid=&quot;n64&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n65&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;span&gt;数据结构类型&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;时间复杂度&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n68&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;哈希表&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;O(1)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n71&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;整数数组&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;O(N)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n74&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;双向链表&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;O(N)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n77&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;压缩列表&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;O(N)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n80&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;跳表&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;O(logN)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p cid=&quot;n83&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;自定义的对象系统类型即为&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的&lt;/span&gt;&lt;code&gt;&lt;span&gt;Value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的数据类型，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的数据类型是基于底层数据结构实现的，那数据类型有哪些呢？&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n84&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;Redis数据类型&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n85&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;比较常见的类型，其与底层数据结构对应关系如下：&lt;/span&gt;&lt;/p&gt;&lt;figure cid=&quot;n86&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n87&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;span&gt;数据类型&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;数据结构&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n90&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;String&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;SDS(简单动态字符串)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n93&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;List&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;双向链表压缩列表&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n96&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;压缩列表哈希表&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n99&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;压缩列表跳表&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n102&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;哈希表整数数组&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p cid=&quot;n105&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;数据类型对应特点跟其实现的底层数据结构差不多，性质也是一样的,且&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n106&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，基于SDS实现，适用于简单&lt;/span&gt;&lt;code&gt;&lt;span&gt;key-value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;存储、&lt;/span&gt;&lt;code&gt;&lt;span&gt;setnx key value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;实现分布式锁、计数器(原子性)、分布式全局唯一ID。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n107&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt;， 按照元素进入&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的顺序进行排序的，遵循FIFO(先进先出)规则，一般使用在 排序统计以及简单的消息队列。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n108&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;， 是字符串&lt;/span&gt;&lt;code&gt;&lt;span&gt;key&lt;/span&gt;&lt;/code&gt;&lt;span&gt;和字符串&lt;/span&gt;&lt;code&gt;&lt;span&gt;value&lt;/span&gt;&lt;/code&gt;&lt;span&gt;之间的映射，十分适合用来表示一个对象信息 ，特点添加和删除操作复杂度都是O(1)。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n109&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，是&lt;/span&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 类型元素的无序集合，集合成员是唯一的，这就意味着集合中不能出现重复的数据。基于哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n110&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，  是&lt;/span&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的类型的升级， 不同的是每个元素都会关联一个 double 类型的分数，通过分数排序，可以范围查询。 &lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n111&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;那我们再来看看这些数据类型，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis Geo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;HyperLogLog&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;BitMap&lt;/span&gt;&lt;/code&gt;&lt;span&gt;？&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n112&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis Geo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;， 将地球看作为近似为球体，基于GeoHash 将二维的经纬度转换成字符串，来实现位置的划分跟指定距离的查询。特点一般使用在跟位置有关的应用。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n113&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;HyperLogLog&lt;/span&gt;&lt;/code&gt;&lt;span&gt;， 是一种&lt;strong&gt;概率&lt;/strong&gt;数据结构，它使用概率算法来统计集合的近似基数 ， 错误率大概在0.81%。当集合元素数量非常多时，它计算基数所需的空间总是固定的，而且还很小，适合使用做 UV 统计。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n114&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;BitMap&lt;/span&gt;&lt;/code&gt;&lt;span&gt; ，用一个比特位来映射某个元素的状态， 只有 0 和 1 两种状态，非常典型的二值状态，且其本身是用 String 类型作为底层数据结构实现的一种统计二值状态的数据类型  ，优势大量节省内存空间，可是使用在二值统计场景。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n115&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;在理解上述知识后，我们接下来讨论一下根据哪些策略选择相对应的应用场景下的&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;数据类型？&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n116&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;选择合适的&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;数据类型策略&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n117&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;在实际开发应用中，Redis可以适用于众多的业务场景，但我们需要怎么选择数据类型存储呢？&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n118&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;主要依据就是时间/空间复杂度，在实际的开发中可以考虑以下几个点：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n119&quot; mdtype=&quot;list&quot; data-mark=&quot;+&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n121&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;数据量，数据本身大小&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n123&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;集合类型统计模式&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n125&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;支持单点查询/范围查询&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n127&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;特殊使用场景&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 cid=&quot;n128&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;数据量，数据本身大小&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n129&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;当数据量比较大，数据本身比较小，使用&lt;strong&gt;&lt;code&gt;String&lt;/code&gt;&lt;/strong&gt;就会使用额外的空间大大增加，因为使用哈希表保存键值对，使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;dictEntry&lt;/span&gt;&lt;/code&gt;&lt;span&gt;结构保存，会导致保存每个键值对时额外保存&lt;/span&gt;&lt;code&gt;&lt;span&gt;dictEntry&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的三个指针的开销，这样就会导致数据本身小于额外空间开销，最终会导致存储空间数据大小远大于原本数据存储大小。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n130&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;可以使用基于&lt;strong&gt;整数数组&lt;/strong&gt;和&lt;strong&gt;压缩列表&lt;/strong&gt;实现了 &lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt;、&lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 和 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt; ，因为&lt;strong&gt;整数数组&lt;/strong&gt;和&lt;strong&gt;压缩列表&lt;/strong&gt;在内存中都是分配一块地址连续的空间，然后把集合中的元素一个接一个地放在这块空间内，非常紧凑，不用再通过额外的指针把元素串接起来，这就避免了额外指针带来的空间开销。而且采用集合类型时，一个 key 就对应一个集合的数据，能保存的数据多了很多，但也只用了一个 &lt;/span&gt;&lt;code&gt;&lt;span&gt;dictEntry&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，这样就节省了内存。&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n131&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;集合类型统计模式&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n132&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;集合类型统计模式常见的有：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n133&quot; mdtype=&quot;list&quot; data-mark=&quot;+&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n135&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;聚合统计（ 交集、差集、并集统计 ）： 对多个集合进行聚合计算时，可以选择&lt;/span&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;；&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n137&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;排序统计（要求集合类型能对元素保序）：&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;中&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 和 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是有序集合，&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是按照元素进入 &lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 的顺序进行排序的，&lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 可以根据元素的权重来排序；&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n139&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;二值状态统计（ 集合元素的取值就只有 0 和 1 两种 ）：&lt;/span&gt;&lt;code&gt;&lt;span&gt;Bitmap&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 本身是用 &lt;/span&gt;&lt;code&gt;&lt;span&gt;String&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 类型作为底层数据结构实现的一种统计二值状态的数据类型 ， Bitmap通过 BITOP 按位 与、或、异或的操作后使用 BITCOUNT 统计 1 的个数。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n141&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;基数统计（ 统计一个集合中不重复的元素的个数 ）：&lt;/span&gt;&lt;code&gt;&lt;span&gt;HyperLogLog&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 是一种用于统计基数的数据集合类型 ，统计结果是有一定误差的，标准误算率是 0.81% 。需要精确统计结果的话，用 Set 或 Hash 类型。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p cid=&quot;n142&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.6067690160502442&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/EvicK4z5ZDrgwpjewfjv5u9YDm2U1kXAt8L7bCkc4K9lSGia3D7c40V1G4ovPurutrV9mLe8gvCG1k5CyXFmgfyA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2866&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n143&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;类型，适用统计用户/好友/关注/粉丝/感兴趣的人集合聚合操作，比如&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n149&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;中&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 和 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是有序集合，使用应对集合元素排序需求 ，比如&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n155&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Bitmap&lt;/span&gt;&lt;/code&gt;&lt;span&gt;二值状态统计，适用数据量大，且可以使用二值状态表示的统计，比如：&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n163&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;HyperLogLog&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 是一种用于统计基数的数据集合类型， 统计一个集合中不重复的元素个数 ，比如&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n167&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;支持单点查询/范围查询&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n168&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;   &lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;中&lt;/span&gt;&lt;code&gt;&lt;span&gt;List&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 和 &lt;/span&gt;&lt;code&gt;&lt;span&gt;Sorted Set&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是有序集合支持范围查询，但是&lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;是不支持范围查询的&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n169&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;特殊使用场景&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n170&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;消息队列&lt;/strong&gt;，使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;作为消息队列的实现，要消息的基本要求&lt;strong&gt;消息保序&lt;/strong&gt;、&lt;strong&gt;处理重复的消息&lt;/strong&gt;和&lt;strong&gt;保证消息可靠性&lt;/strong&gt;，方案有如下：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n171&quot; mdtype=&quot;list&quot; data-mark=&quot;+&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n173&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;基于 List 的消息队列解决方案&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n175&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;基于 Streams 的消息队列解决方案&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure cid=&quot;n176&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n177&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;br/&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;基于List&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;基于Strems&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n181&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;消息保序&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;LPUSH/RPOP&lt;/code&gt;&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;XADD/XREAD&lt;/code&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n185&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;阻塞读取&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;BRPOP&lt;/code&gt;&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;XREAD block&lt;/code&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n189&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;重复消息处理&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;生产者自行实现全局唯一ID&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;Streams自动生成全局唯一ID&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n193&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;消息可靠性&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;BRPOPLPUSH&lt;/code&gt;&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;使用&lt;code&gt;PENDING&lt;/code&gt; List自动留存消息&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n197&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;适用场景&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;消息总量小&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;消息总量大，需要消费组形式读取数据&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p cid=&quot;n201&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;strong&gt;基于位置 LBS 服务&lt;/strong&gt;，使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的特定&lt;/span&gt;&lt;code&gt;&lt;span&gt;GEO&lt;/span&gt;&lt;/code&gt;&lt;span&gt;数据类型实现，&lt;/span&gt;&lt;code&gt;&lt;span&gt;GEO&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 可以记录经纬度形式的地理位置信息，被广泛地应用在 LBS 服务中。 比如:打车软件是怎么基于位置提供服务的。&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n202&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;总结&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n224&quot; mdtype=&quot;paragraph&quot;&gt;&lt;code&gt;&lt;span&gt;Redis&lt;/span&gt;&lt;/code&gt;&lt;span&gt;之所以那么快，是因为其基于内存的数据操作和使用&lt;/span&gt;&lt;code&gt;&lt;span&gt;Hash&lt;/span&gt;&lt;/code&gt;&lt;span&gt;哈希表作为索引，其效率高，速度快，而且得益于其底层数据多样化使得其可以适用于众多场景，不同场景中选择合适的数据类型可以提升其查询性能。&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n247&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;blockquote cid=&quot;n251&quot; mdtype=&quot;blockquote&quot;&gt;&lt;p cid=&quot;n254&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;谢谢各位点赞，没点赞的点个赞支持支持&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n255&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;最后，微信搜《Ccww技术博客》观看更多文章，也欢迎关注一波。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p cid=&quot;n204&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n205&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n206&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n207&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n208&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n209&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n210&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p cid=&quot;n211&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>7d8f7bc1cf20d9989643dac55763dd32</guid>
<title>聊聊机器如何理解人类的语言</title>
<link>https://toutiao.io/k/k301gb6</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;h2&gt;&lt;span&gt;人类语言复杂性&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;自然语言对于人类发展进程是至关重要的，可以说如果没有自然语言就不会有人类的文明，它也是人类独有的能力。想象一下，如果没有自然语言我们该如何进行思想交流，该如何进行人与人之间的协作？。&lt;/p&gt;&lt;p&gt;人类的自然语言发展到如今已经是高度成熟了，同时这也是一个相当复杂的系统，从字到单词到短语再到句子和段落，加上各种不同的表达形式和语境，真真算得上是“皇冠上的明珠”。&lt;/p&gt;&lt;p&gt;如果要去形容自然语言有多复杂好像也很难说清楚，那我们就以数学组合的角度来看自然语言的复杂度，当然用该例子也并不完全正确，重点是体会下自然语言爆炸式的复杂度。经典的用小麦来填国际象棋棋盘格子的故事大家都听过，第一格放一粒，第二格放两粒，第三格放四粒，第四格放八粒，以此类推。每一个格子放的麦粒都是前面的两倍，一直放到64格。然而这些麦子总数量需要全世界生产两千年，这就是爆炸式的组合空间。可以想象一下，假如中文汉字一共有10000个，一句话长度为20字，那么这样的组合空间会是多大呢？10000的20次方，这数字已经大到在整个宇宙中都无法形容。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.6905901116427432&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQ9tXCNnLPUliadEpOicgBPHmNP0nZ1BRg7ibmqmJdUgqqjOvZK3w8EQlqg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1254&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;span&gt;语言的表示&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;我们知道机器处理的是数字信号，那么在机器里面所有的信息都是数字化的，所以任何信息如果要被机器处理就需要先被编码成01二进制信号。比如“你好”这个单词使用UTF-8进行编码后的二进制为“111001001011110110100000 111001011010010110111101”，如果机器不对“你好”进行编码则无法处理，而对于人类则很难读懂这一串1和0是什么意思。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.75&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQROSyHYZ9ABBMkvQIaELtbW6yibU3ibUCyIPpZNkkJH4EZIPF4mUIDQfw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;240&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;机器在对自然语言处理时一般不会直接使用UTF-8之类的编码，而是使用词向量。词向量一般有两种形式：one-hot形式和分布式形式。最简单的向量方式是one-hot形式，它的处理方式简单粗暴，一般就是统计词库包含的所有V个词，然后将这V个词固定好顺序，然后每个词就可以用一个V维的稀疏向量来表示，向量中只有在该词出现的位置的元素才为1，其它元素全为0。比如下面这几个词，第一个元素为1的表示中国，第六个元素为1的表示美国，第五个元素为1的表示日本。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;中国 &lt;span&gt;[1,0,0,0,0,0,0,0,0,……，0,0,0,0,0,0,0]&lt;/span&gt;&lt;br/&gt;美国 &lt;span&gt;[0,0,0,0,0,1,0,0,0,……，0,0,0,0,0,0,0]&lt;/span&gt;&lt;br/&gt;日本 &lt;span&gt;[0,0,0,0,1,0,0,0,0,……，0,0,0,0,0,0,0]&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从中可以看到one-hot形式的维数通常会很大，因为词数量一般在10W级别，可能会造成维数灾难。另外这种形式只通过顺序和01来表示单词，非常浪费空间。再一个是这种方式的任意两个词都是孤立的，没法看出两个词之间的关联性。&lt;/p&gt;&lt;p&gt;鉴于one-hot形式词向量的缺点，出现了另外一种词向量表示方式——分布式词向量(distributed word representation)。分布式词向量则干脆直接用普通的向量来表示词向量，向量元素的值为任意实数，向量的维数在事前确定，比如可以为50维或100维。这时的词向量类似如下（这里假设用5维来表示）：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;中国 &lt;span&gt;[1.25, 0.2, 0.3, 0.5, 0.6]&lt;/span&gt;&lt;br/&gt;美国 &lt;span&gt;[0.1, 0.3, 0.5, 0.1, 1.5]&lt;/span&gt;&lt;br/&gt;日本 &lt;span&gt;[2.2, 0.2, 0.4, 0.6, 1.0]&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中每个元素的具体数值由训练算法来确定，这样一来就克服了可能的维度灾难，而且充分利用了空间，如果使用适当的训练方法训练出来的词向量还可以直接根据两个词之间的向量距离来计算相似性。&lt;/p&gt;&lt;h2&gt;&lt;span&gt;机器与人类交流&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;我们先看人与人之间的交流过程，人类的耳朵负责接收外界声音，然后交由大脑进行解码理解并采取对应行为，最后通过嘴巴回复。类似地，机器如果要与人类进行交流也必须经过三个步骤，首先是要能接收人类说话的信号并将其转成文本，然后使用自然语言处理技术理解该文本所表达的语义，最后是根据所理解的语义采取对应操作并回答人类。&lt;/p&gt;&lt;h2&gt;&lt;span&gt;从声音到文本&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;初中物理告诉我们声音是一种波，耳朵里面的器官在接收声波后负责将波动转换成电信号，然后传入大脑进行处理。机器通过传感器(比如麦克风)接收的声音也是波，不过这些波是由很多离散的点来描述。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;1.0564784053156147&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQ1fLazW0r74iaoXo3pqy2YIgv9u71Adc5m2RcAI5ddVcljTDV99zwK8A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;301&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;成功接收声波后就开始对声波信号进行处理，一般会将其拆分成毫秒级别的帧，而若干个帧形成一个状态，每三个状态又形成一个音素，最终的单词则由若干个音素组合而成。可以看到单位大小顺序为帧-&amp;gt;状态-&amp;gt;音素-&amp;gt;单词，根据帧找到对应的状态就可以得到对应的文本单词了，帧和状态的概率表则由大量语音样本统计而得到。以上便完成从语音到文本的转换。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;1.0609951845906902&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQWRmrsibPiawVUiaD1ia4bkYrFSMwVwfYT7gQWlTDpNsP3ib78W4dTRCgeTg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;623&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;span&gt;机器理解语言&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;将语音转换成文本后开始最核心的部分——理解语义，也就是这段文本表示什么意思。几乎涉及到自然语言处理（NLP）的所有知识模块，其相关内容也非常多且复杂，后面会展开深入讲解。分析语义时一般需要将一句话拆分成更小的单元，同时也要识别句子中关键词和结构等等。举一个简单的例子，比如“附近有什么好吃的？”，该句子将被分词为“附近/有/什么/好吃/的”，那么“附近”、“什么”和“好吃”就是该句子的关键词，可以简单地通过它们去匹配意图。当然，理解语义并非如此简单，特别是开放性领域场景。一般还会涉及到NLP中的命名实体识别、意图识别、文本分类、句法分析、文本相似度、情感分析等等。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.4734133790737564&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQSzuq3JsD0p9E73Y1ThtFdcEIxYWjLtbdm63QV4CrImV489z2Uwbqhw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1166&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;h2&gt;&lt;span&gt;机器生成语音&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;对语言进行理解后我们将需要回答的语音先以文本的形式组成，最后才将文本转成语音，这个步骤称为语音合成。比如非常传统的合成方法就是拼接方法，即直接从语音数据库中获取语音片段来合成完整的语音。&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.3354350567465322&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/caNYYfYLhoHshmZVyic4YWxHxCrOE3XBQztTnlEBCoxEVgSIEgVl3QDsibhf7U8WHVjsZnsfQW6x4IV1HNc7ic0mQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;793&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>70c5d9dc596abe3bb840edef67218570</guid>
<title>解决 90% 的浏览器扩展需求，看这篇就够了</title>
<link>https://toutiao.io/k/k6uqh1v</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;342&quot; data-backw=&quot;546&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;546&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;342&quot; data-ratio=&quot;0.6255555555555555&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gVypOOnh9N5Oc34TicW8lFjMicfmxHdRyOhnCv056wY9Iib6Xw86757qRA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;span&gt;&lt;span&gt;1、阅读本文预计需要 &lt;/span&gt;&lt;span&gt;&lt;strong&gt;6&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; 分钟，并提供了资源下载。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;2、本文是&lt;strong&gt;「&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;网上冲浪指南&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;」&lt;/strong&gt;专题&lt;/span&gt;&lt;span&gt;&lt;strong&gt;i03&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;篇&lt;span&gt;的&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;3.0版本&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;3、第一时间获取更新，欢迎关注「&lt;/span&gt;&lt;span&gt;&lt;strong&gt;奔跑中的奶酪&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;」。&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;导读&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;strong&gt;扩展之于浏览器，就像 APP 之于智能手机。&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;浏览器扩展的数量成千上万，但真正好用的并不多。能被用户选择使用的其实也就 50个 左右，而&lt;strong&gt;真正安装到浏览器上的也不会超过 20 个&lt;/strong&gt;。&lt;br/&gt;&lt;br/&gt;此外，网上推荐扩展的文章也很多，但大多&quot;&lt;strong&gt;没什么卵用&lt;/strong&gt;&quot;。&lt;br/&gt;&lt;br/&gt;这类文章通常会&lt;strong&gt;喜欢标题党&lt;/strong&gt;，动不动就是这个神器，那个黑科技，又或者&lt;strong&gt;喜欢推荐 Adblock Plus&lt;/strong&gt; 这种入门拓展。&lt;br/&gt;&lt;br/&gt;还有就是错误地&lt;strong&gt;把扩展（或拓展）说成是插件&lt;/strong&gt;，这就像给你推荐电脑的人，他总是把硬盘说成是内存。&lt;br/&gt;&lt;br/&gt;下面是我总结的 &lt;strong&gt;2020 年度最喜欢浏览器扩展&lt;/strong&gt;，支持 Chrome、Firefox、Edge，预计能帮你解决 &lt;strong&gt;90%&lt;/strong&gt; 的浏览器扩展需求。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img data-ratio=&quot;0.5625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/5VykXMQgTjZyffSFAD4UMNk2QjO98MicsXichLA9aibaX5ib1iaAicajUOmFyNZanicMppqquOGdUJ2vESgwRXKyZa5SA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1920&quot; data-backw=&quot;546&quot; data-backh=&quot;307&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;01&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;我们需要什么样的扩展？&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;作为一个有 6 年开发经验，试用超过 2000 多款扩展&lt;span&gt;的用户&lt;/span&gt;，我经常在想，我们到底需要什么样的扩展？下面是我的两个理解：&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;1、用合&lt;/strong&gt;&lt;strong&gt;适的工具做事&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;由于浏览器应用层面的限制，扩展的功能是带着“&lt;strong&gt;镣铐&lt;/strong&gt;”的，即便是玩出花来，拓展也没有办法穿透浏览器。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;如果某些功能，用软件来完成更好，别犹豫，直接用软件吧。&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;比如截图扩展 &lt;strong&gt;Nimbus Screen Capture&lt;/strong&gt;、文字识别 &lt;strong&gt;Copyfish&lt;/strong&gt;、视频下载 &lt;strong&gt;Video  DownloadHelper&lt;/strong&gt;，它们都已经是同类扩展中的佼佼者了，但还是没办法像软件那样的强大而全面。&lt;br/&gt;&lt;br/&gt;比如截图软件可以用 &lt;strong&gt;FastStone  Capture&lt;/strong&gt;，文字识别软件用 &lt;strong&gt;天若ORC&lt;/strong&gt;，视频下载软件用 &lt;strong&gt;IDM&lt;/strong&gt;。（详细回复关键字 &lt;/span&gt;&lt;span&gt;&lt;strong&gt;C07&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;）&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;同样，如果某些功能用“&lt;strong&gt;油猴脚本&lt;/strong&gt;”就能完成，那就没必要安装扩展了，用脚本的方法要来得更加轻便。&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;2、扩展在精不在多，一个拓展做好一件事&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;我们总是喜欢试用各式各样的扩展，但大多数扩展其实都是伪需求，有没有其实区别不大。&lt;br/&gt;&lt;br/&gt;真正有需求的是那些&lt;strong&gt;基础的、使用率高的、大多数人都适用&lt;/strong&gt;的扩展，所以在扩展选择上，我们可以换个思路：&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;从需要出发，倒推浏览器扩展，然后在同类扩展中选择最好的那一款。&lt;br/&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;下面是我总结的 &lt;strong&gt;2020&lt;/strong&gt; 年度最喜欢浏览器扩展，支持 &lt;strong&gt;Chrome、Firefox、Edge &lt;/strong&gt;三款浏览器，带 &lt;span&gt;★&lt;/span&gt; 为推荐安装。&lt;br/&gt;&lt;br/&gt;PS：由于公众号不能插入链接，你也可以到我的博客查看有链接的版本。&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;https://www.runningcheese.com/extensions&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;02&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;常用扩展&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;528&quot; data-backw=&quot;546&quot; data-ratio=&quot;0.9667553191489362&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gW21t7JaQ1F1icn31e4MWy6QCocJzLEzWQwtSicmWswNGN2QrpnfJJSrA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1504&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;strong&gt;1、脚本管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Tampermonkey&lt;/span&gt;&lt;span&gt;，相比 油猴、暴力猴 更加稳定高效。★《详细回复 &lt;/span&gt;&lt;span&gt;i04&lt;/span&gt;&lt;span&gt;》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、样式管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;xStyle&lt;/span&gt;&lt;span&gt;，相比 Stylish、Stylus 更为简洁，管理也更加方便。★《&lt;span&gt;详细回复 &lt;/span&gt;i05》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、拨号页    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;InfinityTab&lt;/span&gt;&lt;span&gt;，可能是目前最好的新标签页，但自带的图标有返利尾巴。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、代理工具    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Proxy SwitchyOmega &lt;/span&gt;&lt;span&gt;，方便简单，可以轻松管理和切换多个代理设置。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、广告过滤    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Ublock&lt;/span&gt;&lt;span&gt;，简单好用，支持网页广告、视频广告的过滤。★《&lt;span&gt;详细回复 &lt;/span&gt;i09》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、密码管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;BitWarden&lt;/span&gt;&lt;span&gt;，免费、简单、多平台通用的密码管理工具。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;7、鼠标拖拽    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;GlitterDrag&lt;/span&gt;&lt;span&gt; 是 Firefox 首选，Chrome 用 &lt;/span&gt;&lt;span&gt;crxMouse&lt;/span&gt;&lt;span&gt;，Edge 用&lt;/span&gt;&lt;span&gt; SuperDrag&lt;/span&gt;&lt;span&gt;。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;8、鼠标手势    &lt;/strong&gt;&lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;Mouseinc&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;BetterAndBetter&lt;/span&gt;&lt;span&gt;。《&lt;span&gt;详细回复 &lt;/span&gt;C09》&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;strong&gt;9、视频下载  &lt;/strong&gt;  &lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;IDM&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;NDM&lt;/span&gt;&lt;span&gt;。★《&lt;span&gt;详细回复 &lt;/span&gt;i14》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;10、下载管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;下载管理&lt;/span&gt;&lt;span&gt;，接管自带的下载功能，简洁，没有多余功能。★（火狐自带）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;11、二维码    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;二维码&lt;/span&gt;&lt;span&gt;，将文本、链接、图片生成二维码，也可识别二维码图片。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;12、用户代理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;User-Agent Switcher and Manager&lt;/span&gt;&lt;span&gt;，目前 UA 最全的一款用户代理扩展。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;13、浏览器请求    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Header Editor&lt;/span&gt;&lt;span&gt;，拥有重定向、反盗链、用户代理修改等功能。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;14、RSS 阅读   &lt;/strong&gt; &lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;irreader&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;Reeder&lt;/span&gt;&lt;span&gt;。★&lt;span&gt;《&lt;span&gt;详细回复&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt; C08》&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;15、截图工具    &lt;/strong&gt;&lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;FastStone Capture&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;iShot&lt;/span&gt;&lt;span&gt;。《&lt;span&gt;详细回复 &lt;/span&gt;C08》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;16、OCR识别    &lt;/strong&gt;&lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;天若OCR&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;Text Scaner&lt;/span&gt;&lt;span&gt;。&lt;span&gt;《&lt;span&gt;详细回复 &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;C07》&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;17、电子书    &lt;/strong&gt;&lt;br/&gt;用软件更好，Windows 用 &lt;/span&gt;&lt;span&gt;京东读书&lt;/span&gt;&lt;span&gt;，Mac 用 &lt;/span&gt;&lt;span&gt;CleanView&lt;/span&gt;&lt;span&gt;。&lt;span&gt;《&lt;span&gt;详细回复 &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;C07》&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;03&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;标签管理&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;514&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.8896276595744681&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gKFic08XDWa7vj9UI1ricfj0DQthbviaN8RQZ66XzUyX5984XOEOTkMcPw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1504&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;1、稍候阅读    &lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;In My Pocket&lt;/span&gt;&lt;span&gt;，标记没来得急读完的网页，支持多平台同步。★&lt;span&gt;《&lt;span&gt;详细回复 &lt;/span&gt;&lt;/span&gt;&lt;span&gt;i10》&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、会话管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Tab Session Manager&lt;/span&gt;&lt;span&gt;，手动或者自动保存浏览会话。★&lt;span&gt;&lt;span&gt;《&lt;span&gt;详细回复 &lt;/span&gt;&lt;/span&gt;&lt;span&gt;i10》&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;strong&gt;3、快捷笔记    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Sidebar Note&lt;/span&gt;&lt;span&gt;，支持选中文字一键发送至笔记本，支持快捷键。（火狐特有）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、网页剪藏    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Evernote Web Clipper&lt;/span&gt;&lt;span&gt;，一键标注和保存完整的网页到 Evernote 上。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、小号管理    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;SessionBox&lt;/span&gt;&lt;span&gt;，用于同一网站登录多个账户。（火狐自带）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、标签页恢复    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Undo Close Tab&lt;/span&gt;&lt;span&gt;，简单且高效的标签页恢复扩展。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;7、标签页查看    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Tree Style Tab&lt;/span&gt;&lt;span&gt;，树状显示当前打开的网页，Chrome 用 Aerys。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;8、标签页位置   &lt;/strong&gt; &lt;br/&gt;&lt;/span&gt;&lt;span&gt;Tab Position Options&lt;/span&gt;&lt;span&gt;，调整标签页的打开位置。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;9、内存控制    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Auto Tab Discard&lt;/span&gt;&lt;span&gt;，自动冻结不活动的标签页来节省内存占用。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;10、新标签页覆盖    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;New Tab Override&lt;/span&gt;&lt;span&gt;，修改打开新标签页的内容。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;11、防止关闭    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;LiveOn&lt;/span&gt;&lt;span&gt;，关闭最后一个标签页时不关闭浏览器。★（火狐自带）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;12、打开多个链接    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Open Multiple URLs，&lt;/span&gt;&lt;span&gt;但推荐用网站 &lt;/span&gt;&lt;span&gt;openmultipleurl.com&lt;/span&gt;&lt;span&gt; 来打开。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;13、标签页复制    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Copy as Markdown&lt;/span&gt;&lt;span&gt;，复制标签页链接为 Markdown 格式，支持快捷键。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;14、浏览器调用    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Open With&lt;/span&gt;&lt;span&gt;，调用其他浏览器或者配置打开当前网页。&lt;br/&gt;&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;04&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;书签管理&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;205&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.35471204188481675&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gQvicvYIH9rJw5a9TUpic8nfDJolc1wUFibf6hvicx7HqEwQxBF6Hu6UYmg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1528&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;1、书签检测    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Bookmarks Organizer&lt;/span&gt;&lt;span&gt;，检测失效与重复的书签。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、书签图标刷新    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Checkmarks&lt;/span&gt;&lt;span&gt;，在侧边栏中打开，然后依次打开刷新图标。（火狐特有）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、快速添加书签    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Bookmark Tab Here&lt;/span&gt;&lt;span&gt;，书签右键菜单上添加“添加到此...”的选项。（火狐特有）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、书签更新    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Update Bookmark&lt;/span&gt;&lt;span&gt;，直接在书签的右键菜单中修改标题和地址。（火狐特有）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、书签搜索    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Holmes&lt;/span&gt;&lt;span&gt;，让 Chrome 像 Firefox 一样支持输入 * 后搜索书签。（火狐自带）&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;05&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;搜索增强&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;263&quot; data-backw=&quot;546&quot; data-ratio=&quot;0.4811320754716981&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gn5KkibhW9VNMEAsgL1Om37cMhFkxKB2ATJPMmIiaI83de1nIibibDOhsNw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1484&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;1、右键搜索    &lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;br/&gt;Selection Context Searc&lt;/span&gt;&lt;span&gt;h，功能最全的右键搜索扩展。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、站内搜索    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Selection Context Search&lt;/span&gt;&lt;span&gt;，在设置里增加“站内搜索”的选项。★ （同上）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、以图搜图    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Selection Context Search&lt;/span&gt;&lt;span&gt;，在设置里增加“以图搜图”选项。★（同上）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、粘贴并搜索    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Paste n&#x27; Go&lt;/span&gt;&lt;span&gt;，搜索框右键里增加“粘贴并搜索”的选项。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、右键限制    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;用脚本更好&lt;/span&gt;&lt;span&gt;，解除大部分网站禁止复制、选择、右键菜单的限制。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、搜索切换    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;用脚本更好&lt;/span&gt;&lt;span&gt;，在各个搜索引擎之间跳转，并有友好的自定义设置菜单。&lt;span&gt;《详细回复 i04》&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;7、多重搜索    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;用脚本更好&lt;/span&gt;&lt;span&gt;，通过“&lt;/span&gt;&lt;span&gt;小书签&lt;/span&gt;&lt;span&gt;”然后用“关键字”来实现。《详细回复 i06》&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;06&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;英语阅读&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;204&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.3537234042553192&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gjVlJicOOwgZcYzU50EtJN5Cfvsef1Z3EglYWSqJ7yGD7ibib3LaShPiaibQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1504&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;1、翻译工具    &lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;br/&gt;沙拉查词&lt;/span&gt;&lt;span&gt;，多功能强大的聚合翻译扩展。★《详细回复 i11》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、网页翻译    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;翻译网页&lt;/span&gt;&lt;span&gt;，Chrome、Edge 自带全文翻译，也可以用“彩云小译”。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、词汇发现    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;单词发现者&lt;/span&gt;&lt;span&gt;，高亮网页中的英语单词，可自定义单词难度，扩大您的词汇。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、语法检测    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Grammarly&lt;/span&gt;&lt;span&gt;，检测并自动纠正语法错误。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、文本校对    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;LanguageTool&lt;/span&gt;&lt;span&gt;，语法、文风和拼字校对工具。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;07&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;阅读辅助&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6320754716981132&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gFvoRazX9JqAJGvPicqDorVtKvVnxRE5nouAKKWd24iamTAeLaCxxsd3Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1484&quot; data-backw=&quot;546&quot; data-backh=&quot;345&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;1、字体渲染    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Font Rendering Enhancer&lt;/span&gt;&lt;span&gt;，解决 Chrome、Edge 字体发虚的问题。★（火狐自带）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、雅黑字体    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;替换中文字体为雅黑&lt;/span&gt;&lt;span&gt;，同时避免影响英文部分。★（Mac不必安装）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、手形工具    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;ScrollAnywhere&lt;/span&gt;&lt;span&gt;，按住鼠标左键，像手机屏幕一样地滑动网页。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、快速下一页    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;NextPage&lt;/span&gt;&lt;span&gt;，页尾处按空格自动翻页，按 N 键下一页，按 P 键上一页。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、阅读模式    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;简悦&lt;/span&gt;&lt;span&gt;，比自带模式模式更加优雅的阅读扩展。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、黑夜模式    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Dark Mode&lt;/span&gt;&lt;span&gt;，将网页变成黑夜阅读模式。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;7、亮度调整    &lt;/strong&gt;&lt;br/&gt;用脚本更好，通过“小书签”然后用“关键字”来实现。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;8、侧边栏浏览    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Side View&lt;/span&gt;&lt;span&gt;，在侧边栏中查看当前网页。（火狐特有）&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;9、访问限制    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Block Site&lt;/span&gt;&lt;span&gt;，限制访问一些网站，还有上网时间，适合工作的时使用。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;10、维基阅读    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Wikiwand&lt;/span&gt;&lt;span&gt;，让排版老旧的 Wikipedia 有一个全新的界面。&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;08&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;图片浏览&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;176&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.3046979865771812&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gYBnR8UHCcOdJjW006cQ7pg4hJlUbE7qBKZ0fYFAdXjQOY9KILkDqEw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1490&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;strong&gt;1、图片查看助手    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;浮图秀&lt;/span&gt;&lt;span&gt;，按 Alt 键显示高清大图，可配合脚本 PicViewer 一起使用。★&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、图片保存工具    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;SAVE IN...&lt;/span&gt;&lt;span&gt;，一键保存图片到指定位置，图片管理利器。★《详细回复 i13》&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、图片批量下载    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;ImageAssistant&lt;/span&gt;&lt;span&gt;，嗅探图片、图片筛选、批量下载等功能。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、图床工具    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;微博图床&lt;/span&gt;&lt;span&gt;，使用前需要登录微博网页版，还支持批量上传。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;09&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;音乐收听&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;181&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.31398416886543534&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gcdCoVlXuWuMR7Vt4VdicUTiaZPoQqoRxcgsnbpoicxAvE0ND8iar0T4EUA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1516&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;1、音乐收听    &lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;Listen 1&lt;/span&gt;&lt;span&gt;，聚合来自网易云音乐、QQ音乐、虾米等网站的歌曲。&lt;span&gt;★&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、歌词展示    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Lyrics Here&lt;/span&gt;&lt;span&gt;，在 Youtube，Spotify 等音乐网站上显示当前播放音乐的歌词。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、广播收听    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Search to Play the Song&lt;/span&gt;&lt;span&gt;，可以说是 Listen 1的简洁版，还能听广播。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、歌曲识别    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;AHA Music&lt;/span&gt;&lt;span&gt;，识别当前浏览器播放中的歌曲，还支持本地音乐。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;10&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;视频观看&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;277&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.4797297297297297&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gEXdhIUiaGgicFIgmf33RCmk21al8L08oicibFQ12koEA6ggmGKribxS6r4w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1480&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;1、视频放大    &lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;br/&gt;用脚本更好&lt;/span&gt;&lt;span&gt;，将视频放大填充到网页全屏。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、视频弹窗    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Popup Tool&lt;/span&gt;&lt;span&gt;，视频小窗播放，支持弹幕，Chrome 用 &lt;/span&gt;&lt;span&gt;Separate Window&lt;/span&gt;&lt;span&gt;。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、弹幕过滤器    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Pakku&lt;/span&gt;&lt;span&gt;，哔哩哔哩弹幕过滤器，屏蔽相似弹幕。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、U2B双语字幕    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;用脚本更好&lt;/span&gt;&lt;span&gt;，让 YouTube 显示双语字幕。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、U2B频道屏蔽    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;BlockTube&lt;/span&gt;&lt;span&gt;，屏蔽不想看的视频频道，包括首页用和搜索页面。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、刷抖音    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Web for TikTok&lt;/span&gt;&lt;span&gt;，在线刷 TikTok，就像用手机刷一样。&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;11&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;小众扩展&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;319&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.552317880794702&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gdg8jL1zVraxVicH7sXEE7AdpmuATjxIIwiaOP6fJ5GOE6XiczFB9dNicFQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1510&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;1、Cookie 编辑    &lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;br/&gt;EditThisCookie&lt;/span&gt;&lt;span&gt;，编辑 Cookie，比如可以设置帐号永不退出。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;2、Aria2 下载    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Aria2 manager&lt;/span&gt;&lt;span&gt;，用于导出和自动拦截下载到 Aria2 下载器。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;3、网页监测    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Distill Web Monitor&lt;/span&gt;&lt;span&gt;，用于跟踪监测网页更新。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;4、历史记录分析   &lt;/strong&gt; &lt;br/&gt;&lt;/span&gt;&lt;span&gt;History Master&lt;/span&gt;&lt;span&gt;，更加友好的可视化历史记录分析工具。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;5、反反广告    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Anti Adblock Detector&lt;/span&gt;&lt;span&gt;，去除 Adblock 的检测拦截。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;6、跳过验证码    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Buster&lt;/span&gt;&lt;span&gt;，跳过谷歌的验证码。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;7、谷歌访问助手    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;iGuge&lt;/span&gt;&lt;span&gt;，用于访问 Google 相关的网站，其他的则需要付费购买。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;8、网页全文索引    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;Falcon&lt;/span&gt;&lt;span&gt;，地址栏输入 f 查找历史浏览网页里的内容。&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;9、自选基金助手    &lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;自选基金助手&lt;/span&gt;&lt;span&gt;，小窗口展示“天天基金网”的数据。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;结尾&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;下载链接，还有后续更新，我做了一个长期更新的网页，欢迎关注和推荐。&lt;span&gt;&lt;br/&gt;&lt;span&gt;https://www.runningcheese.com/extensions&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;span&gt;回复关键字&lt;br/&gt;&lt;span&gt;&lt;strong&gt;i&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;查看本系列的所有文章，&lt;br/&gt;回复关键字&lt;br/&gt;&lt;span&gt;&lt;strong&gt; i03&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;获取本文提到的所有资源&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;最近文章：&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzAwMjUyNzYxMw==&amp;amp;mid=2247487355&amp;amp;idx=1&amp;amp;sn=2a0880622469b7f39669317ccf10af59&amp;amp;chksm=9ac85769adbfde7f6e7a58bda09ffa60198653155d77ad85b1723cd1ba8f40cfa5f9e919ff35&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img data-backh=&quot;96&quot; data-backw=&quot;546&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;546&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;96&quot; data-ratio=&quot;0.175&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gRaYpdCUZzIBP7aJjBH8jiabRqOYHLbh4yBT9kQgbsDgiaP6XzW884Lew/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzAwMjUyNzYxMw==&amp;amp;mid=2247487251&amp;amp;idx=1&amp;amp;sn=444fee34f34ca1fb504bca62219a37a1&amp;amp;chksm=9ac85701adbfde17e45925a24e509c8bcfe089284b56377475e9d3642ba6b3568164f0096c31&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img data-backh=&quot;96&quot; data-backw=&quot;546&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;546&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;96&quot; data-ratio=&quot;0.175&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gNdHbzbiaqxxRz0AK47pT7TK4834cI6z9UR48pJ5liaLJ9c8kAHU90r4Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzAwMjUyNzYxMw==&amp;amp;mid=2247487111&amp;amp;idx=1&amp;amp;sn=c1bc4ee6729903a579236c391f11903c&amp;amp;chksm=9ac85695adbfdf83f645f89a0601807d453cbe060f89ae23d1c46452c8ff5eeb275cbc63b2cd&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img data-backh=&quot;96&quot; data-backw=&quot;546&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;546&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;96&quot; data-ratio=&quot;0.175&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjYVUic1HUc52YvibAErtaw87gskVd2ry4UwBibKJUBmibWaYNe3bPbo1SictL9CT3WQuNFklxaJwAnCXkg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;看完文章：&lt;/strong&gt;&lt;strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;1、&lt;/span&gt;&lt;span&gt;&lt;strong&gt;点在看&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，帮助更多的人看到这篇文章。&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;2、&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;写留言&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，对文章进行评论，我会尽可能回复。&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;3、&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;点关注&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，关注我并星标，第一时间获取更新。&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.47&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5VykXMQgTjb9IjZa7tpqzzqKpIpXpS41526J4ZCxbmcyls9rrnbvAtDTaNZj8mibmYJ8vhchSed53h2BKN1OlKQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;&gt;下午14：00更新&lt;/p&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>36e056874c69beb25cb39826eedb05b0</guid>
<title>Spring 中这些能升华代码的技巧，可能会让你爱不释手</title>
<link>https://toutiao.io/k/d374mr5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;前言&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最近越来越多的读者认可我的文章，还是件挺让人高兴的事情。有些读者私信我说希望后面多分享spring方面的文章，这样能够在实际工作中派上用场。正好我对spring源码有过一定的研究，并结合我这几年实际的工作经验，把spring中我认为不错的知识点总结一下，希望对您有所帮助。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;一 如何获取spring容器对象&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;1.实现BeanFactoryAware接口&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;PersonService&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;BeanFactoryAware&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; BeanFactory beanFactory;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;setBeanFactory&lt;/span&gt;&lt;span&gt;(BeanFactory beanFactory)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; BeansException &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;this&lt;/span&gt;.beanFactory = beanFactory;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        Person person = (Person) beanFactory.getBean(&lt;span&gt;&quot;person&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现&lt;code&gt;BeanFactoryAware&lt;/code&gt;接口，然后重写&lt;code&gt;setBeanFactory&lt;/code&gt;方法，就能从该方法中获取到spring容器对象。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;2.实现ApplicationContextAware接口&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;PersonService2&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;ApplicationContextAware&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; ApplicationContext applicationContext;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;setApplicationContext&lt;/span&gt;&lt;span&gt;(ApplicationContext applicationContext)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; BeansException &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;this&lt;/span&gt;.applicationContext = applicationContext;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        Person person = (Person) applicationContext.getBean(&lt;span&gt;&quot;person&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现&lt;code&gt;ApplicationContextAware&lt;/code&gt;接口，然后重写&lt;code&gt;setApplicationContext&lt;/code&gt;方法，也能从该方法中获取到spring容器对象。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;3.实现ApplicationListener接口&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;PersonService3&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;ApplicationListener&lt;/span&gt;&amp;lt;&lt;span&gt;ContextRefreshedEvent&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; ApplicationContext applicationContext;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;onApplicationEvent&lt;/span&gt;&lt;span&gt;(ContextRefreshedEvent event)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        applicationContext = event.getApplicationContext();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        Person person = (Person) applicationContext.getBean(&lt;span&gt;&quot;person&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现&lt;code&gt;ApplicationListener&lt;/code&gt;接口，需要注意的是该接口接收的泛型是&lt;code&gt;ContextRefreshedEvent&lt;/code&gt;类，然后重写&lt;code&gt;onApplicationEvent&lt;/code&gt;方法，也能从该方法中获取到spring容器对象。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此外，不得不提一下&lt;code&gt;Aware&lt;/code&gt;接口，它其实是一个空接口，里面不包含任何方法。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;它表示已感知的意思，通过这类接口可以获取指定对象，比如：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;通过BeanFactoryAware获取BeanFactory&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;通过ApplicationContextAware获取ApplicationContext&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;通过BeanNameAware获取BeanName等&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Aware&lt;/span&gt;接口是很常用的功能，目前包含如下功能：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.4293628808864265&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDEUlz2dib4YZFUs4VdbFia35G0kuZ9UQR0ENVqxshRFbmAmkRBarpQibGtJxW17r0lewVIxVug8ub4CA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;722&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;二 如何初始化bean&lt;/span&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring中支持3种初始化bean的方法：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;xml中指定init-method方法&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;使用@PostConstruct注解&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;实现InitializingBean接口&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一种方法太古老了，现在用的人不多，具体用法就不介绍了。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;1.使用@PostConstruct注解&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;AService&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@PostConstruct&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;init&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===初始化===&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在需要初始化的方法上增加&lt;code&gt;@PostConstruct&lt;/code&gt;注解，这样就有初始化的能力。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;2.实现InitializingBean接口&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;BService&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;InitializingBean&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;afterPropertiesSet&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===初始化===&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现&lt;code&gt;InitializingBean&lt;/code&gt;接口，重写&lt;code&gt;afterPropertiesSet&lt;/code&gt;方法，该方法中可以完成初始化功能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里顺便抛出一个有趣的问题：&lt;code&gt;init-method&lt;/code&gt;、&lt;code&gt;PostConstruct&lt;/code&gt; 和 &lt;code&gt;InitializingBean&lt;/code&gt; 的执行顺序是什么样的？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;决定他们调用顺序的关键代码在&lt;code&gt;AbstractAutowireCapableBeanFactory&lt;/code&gt;类的&lt;code&gt;initializeBean&lt;/code&gt;方法中。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.38170347003154576&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7va6icTXPB2jvm3vqhYL3lia5u8Ef7Vv8aYUeXw6P3tGfD3E8kicicQqcDrw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1268&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这段代码中会先调用&lt;code&gt;BeanPostProcessor&lt;/code&gt;的&lt;code&gt;postProcessBeforeInitialization&lt;/code&gt;方法，而&lt;code&gt;PostConstruct&lt;/code&gt;是通过&lt;code&gt;InitDestroyAnnotationBeanPostProcessor&lt;/code&gt;实现的，它就是一个&lt;code&gt;BeanPostProcessor&lt;/code&gt;，所以&lt;code&gt;PostConstruct&lt;/code&gt;先执行。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;而&lt;code&gt;invokeInitMethods&lt;/code&gt;方法中的代码：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6951566951566952&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vrKtF1W5HmRXGyFA0vYzJ670YBd406aNiatdmWxLAAhfeDdo2iadtryKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1404&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;决定了先调用&lt;code&gt;InitializingBean&lt;/code&gt;，再调用&lt;code&gt;init-method&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以得出结论，他们的调用顺序是：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.1775362318840579&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vcSlRricX9ziagqZUUuFl6YrT4YyUFgOSxYEveRGLUyhuHuHoBeAVvFbA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;552&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;三 自定义自己的Scope&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们都知道&lt;code&gt;spring&lt;/code&gt;默认支持的&lt;code&gt;Scope&lt;/code&gt;只有两种：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;singleton 单例，每次从spring容器中获取到的bean都是同一个对象。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;prototype 多例，每次从spring容器中获取到的bean都是不同的对象。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;spring web&lt;/code&gt;又对&lt;code&gt;Scope&lt;/code&gt;进行了扩展，增加了：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;RequestScope 同一次请求从spring容器中获取到的bean都是同一个对象。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;SessionScope 同一个会话从spring容器中获取到的bean都是同一个对象。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;即便如此，有些场景还是无法满足我们的要求。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如，我们想在同一个线程中从spring容器获取到的bean都是同一个对象，该怎么办？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这就需要自定义&lt;code&gt;Scope&lt;/code&gt;了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步实现&lt;code&gt;Scope&lt;/code&gt;接口：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ThreadLocalScope&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Scope&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;static &lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ThreadLocal THREAD_LOCAL_SCOPE = &lt;span&gt;new&lt;/span&gt; ThreadLocal();&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;get&lt;/span&gt;&lt;span&gt;(String name, ObjectFactory&amp;lt;?&amp;gt; objectFactory)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        Object value = THREAD_LOCAL_SCOPE.get();&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (value != &lt;span&gt;null&lt;/span&gt;) {&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; value;&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;        Object object = objectFactory.getObject();&lt;br/&gt;        THREAD_LOCAL_SCOPE.set(object);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; object;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;remove&lt;/span&gt;&lt;span&gt;(String name)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        THREAD_LOCAL_SCOPE.remove();&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;registerDestructionCallback&lt;/span&gt;&lt;span&gt;(String name, Runnable callback)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;resolveContextualObject&lt;/span&gt;&lt;span&gt;(String key)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;getConversationId&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步将新定义的&lt;code&gt;Scope&lt;/code&gt;注入到spring容器中：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Component&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ThreadLocalBeanFactoryPostProcessor&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;BeanFactoryPostProcessor&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;postProcessBeanFactory&lt;/span&gt;&lt;span&gt;(ConfigurableListableBeanFactory beanFactory)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; BeansException &lt;/span&gt;{&lt;br/&gt;        beanFactory.registerScope(&lt;span&gt;&quot;threadLocalScope&quot;&lt;/span&gt;, &lt;span&gt;new&lt;/span&gt; ThreadLocalScope());&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第三步使用新定义的&lt;code&gt;Scope&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Scope&lt;/span&gt;(&lt;span&gt;&quot;threadLocalScope&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;CService&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;四 别说FactoryBean没用&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说起&lt;code&gt;FactoryBean&lt;/code&gt;就不得不提&lt;code&gt;BeanFactory&lt;/code&gt;，因为面试官老喜欢问它们的区别。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;BeanFactory：spring容器的顶级接口，管理bean的工厂。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;FactoryBean：并非普通的工厂bean，它隐藏了实例化一些复杂Bean的细节，给上层应用带来了便利。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果你看过spring源码，会发现它有70多个地方在用FactoryBean接口。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.0769230769230769&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vTVYWc3BZ64373MkUZRhVDe8w0uA6s9k7RSwl5siabkvMVRVa4ycpKMg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1014&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面这张图足以说明该接口的重要性，请勿忽略它好吗？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;特别提一句：&lt;code&gt;mybatis&lt;/code&gt;的&lt;code&gt;SqlSessionFactory&lt;/code&gt;对象就是通过&lt;code&gt;SqlSessionFactoryBean&lt;/code&gt;类创建的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们一起定义自己的&lt;code&gt;FactoryBean&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Component&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MyFactoryBean&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;FactoryBean&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;getObject&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        String data1 = buildData1();&lt;br/&gt;        String data2 = buildData2();&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; buildData3(data1, data2);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;private&lt;/span&gt; String &lt;span&gt;buildData1&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;data1&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;private&lt;/span&gt; String &lt;span&gt;buildData2&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;data2&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;private&lt;/span&gt; String &lt;span&gt;buildData3&lt;/span&gt;&lt;span&gt;(String data1, String data2)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; data1 + data2;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;public&lt;/span&gt; Class&amp;lt;?&amp;gt; getObjectType() {&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;获取&lt;code&gt;FactoryBean&lt;/code&gt;实例对象：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MyFactoryBeanService&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;BeanFactoryAware&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; BeanFactory beanFactory;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;setBeanFactory&lt;/span&gt;&lt;span&gt;(BeanFactory beanFactory)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; BeansException &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;this&lt;/span&gt;.beanFactory = beanFactory;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;test&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        Object myFactoryBean = beanFactory.getBean(&lt;span&gt;&quot;myFactoryBean&quot;&lt;/span&gt;);&lt;br/&gt;        System.out.println(myFactoryBean);&lt;br/&gt;        Object myFactoryBean1 = beanFactory.getBean(&lt;span&gt;&quot;&amp;amp;myFactoryBean&quot;&lt;/span&gt;);&lt;br/&gt;        System.out.println(myFactoryBean1);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;getBean(&quot;myFactoryBean&quot;);&lt;/code&gt;获取的是MyFactoryBeanService类中getObject方法返回的对象，&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;getBean(&quot;&amp;amp;myFactoryBean&quot;);&lt;/code&gt;获取的才是MyFactoryBean对象。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;五 轻松自定义类型转换&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring目前支持3中类型转换器：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;Converter&amp;lt;S,T&amp;gt;：将 S 类型对象转为 T 类型对象&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ConverterFactory&amp;lt;S, R&amp;gt;：将 S 类型对象转为 R 类型及子类对象&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;GenericConverter：它支持多个source和目标类型的转化，同时还提供了source和目标类型的上下文，这个上下文能让你实现基于属性上的注解或信息来进行类型转换。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这3种类型转换器使用的场景不一样，我们以&lt;code&gt;Converter&amp;lt;S,T&amp;gt;&lt;/code&gt;为例。假如：接口中接收参数的实体对象中，有个字段的类型是Date，但是实际传参的是字符串类型：2021-01-03 10:20:15，要如何处理呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，定义一个实体&lt;code&gt;User&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Data&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;User&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; Long id;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; String name;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; Date registerDate;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，实现&lt;code&gt;Converter&lt;/code&gt;接口：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;DateConverter&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Converter&lt;/span&gt;&amp;lt;&lt;span&gt;String&lt;/span&gt;, &lt;span&gt;Date&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; SimpleDateFormat simpleDateFormat = &lt;span&gt;new&lt;/span&gt; SimpleDateFormat(&lt;span&gt;&quot;yyyy-MM-dd HH:mm:ss&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Date &lt;span&gt;convert&lt;/span&gt;&lt;span&gt;(String source)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (source != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !&lt;span&gt;&quot;&quot;&lt;/span&gt;.equals(source)) {&lt;br/&gt;            &lt;span&gt;try&lt;/span&gt; {&lt;br/&gt;                simpleDateFormat.parse(source);&lt;br/&gt;            } &lt;span&gt;catch&lt;/span&gt; (ParseException e) {&lt;br/&gt;                e.printStackTrace();&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第三步，将新定义的类型转换器注入到spring容器中：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;WebConfig&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;WebMvcConfigurerAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;addFormatters&lt;/span&gt;&lt;span&gt;(FormatterRegistry registry)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        registry.addConverter(&lt;span&gt;new&lt;/span&gt; DateConverter());&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第四步，调用接口&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RequestMapping&lt;/span&gt;(&lt;span&gt;&quot;/user&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;@RestController&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;UserController&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@RequestMapping&lt;/span&gt;(&lt;span&gt;&quot;/save&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;save&lt;/span&gt;&lt;span&gt;(@RequestBody User user)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;请求接口时&lt;code&gt;User&lt;/code&gt;对象中&lt;code&gt;registerDate&lt;/code&gt;字段会被自动转换成&lt;code&gt;Date&lt;/code&gt;类型。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;六 spring mvc拦截器，用过的都说好&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring mvc拦截器根spring拦截器相比，它里面能够获取&lt;code&gt;HttpServletRequest&lt;/code&gt;和&lt;code&gt;HttpServletResponse&lt;/code&gt; 等web对象实例。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring mvc拦截器的顶层接口是：&lt;code&gt;HandlerInterceptor&lt;/code&gt;，包含三个方法：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;preHandle 目标方法执行前执行&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;postHandle 目标方法执行后执行&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;afterCompletion 请求完成时执行&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了方便我们一般情况会用&lt;span&gt;HandlerInterceptor&lt;/span&gt;接口的实现类&lt;code&gt;HandlerInterceptorAdapter&lt;/code&gt;类。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假如有权限认证、日志、统计的场景，可以使用该拦截器。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，继承&lt;code&gt;HandlerInterceptorAdapter&lt;/code&gt;类定义拦截器：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;AuthInterceptor&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;HandlerInterceptorAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;preHandle&lt;/span&gt;&lt;span&gt;(HttpServletRequest request, HttpServletResponse response, Object handler)&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;        String requestUrl = request.getRequestURI();&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (checkAuth(requestUrl)) {&lt;br/&gt;            &lt;span&gt;return &lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;checkAuth&lt;/span&gt;&lt;span&gt;(String requestUrl)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===权限校验===&quot;&lt;/span&gt;);&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，将该拦截器注册到spring容器：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;WebAuthConfig&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;WebMvcConfigurerAdapter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt; &lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; AuthInterceptor &lt;span&gt;getAuthInterceptor&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;new&lt;/span&gt; AuthInterceptor();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;addInterceptors&lt;/span&gt;&lt;span&gt;(InterceptorRegistry registry)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        registry.addInterceptor(&lt;span&gt;new&lt;/span&gt; AuthInterceptor());&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第三步，在请求接口时spring mvc通过该拦截器，能够自动拦截该接口，并且校验权限。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该拦截器其实相对来说，比较简单，可以在&lt;code&gt;DispatcherServlet&lt;/code&gt;类的&lt;code&gt;doDispatch&lt;/code&gt;方法中看到调用过程：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7720994475138122&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDEUlz2dib4YZFUs4VdbFia35GBcWdl3e9YiaIxTMibCxQGGTbZLE9xsiadddF5QyicxH8ic8dXsMUiaYcJm2w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1448&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;顺便说一句，这里只讲了spring mvc的拦截器，并&lt;span&gt;没有讲spring的拦截器&lt;/span&gt;，是因为我有点小私心，后面就会知道。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;七 Enable开关真香&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不知道你有没有用过&lt;code&gt;Enable&lt;/code&gt;开头的注解，比如：&lt;code&gt;EnableAsync&lt;/code&gt;、&lt;code&gt;EnableCaching&lt;/code&gt;、&lt;code&gt;EnableAspectJAutoProxy&lt;/code&gt;等，这类注解就像开关一样，只要在&lt;code&gt;@Configuration&lt;/code&gt;定义的配置类上加上这类注解，就能开启相关的功能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是不是很酷？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;让我们一起实现一个自己的开关：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，定义一个LogFilter：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;LogFilter&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Filter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;init&lt;/span&gt;&lt;span&gt;(FilterConfig filterConfig)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; ServletException &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;doFilter&lt;/span&gt;&lt;span&gt;(ServletRequest request, ServletResponse response, FilterChain chain)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; IOException, ServletException &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;记录请求日志&quot;&lt;/span&gt;);&lt;br/&gt;        chain.doFilter(request, response);&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;记录响应日志&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;destroy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，注册LogFilter：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@ConditionalOnWebApplication&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;LogFilterWebConfig&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; LogFilter &lt;span&gt;timeFilter&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;new&lt;/span&gt; LogFilter();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意，这里用了&lt;code&gt;@ConditionalOnWebApplication&lt;/code&gt;注解，没有直接使用&lt;code&gt;@Configuration&lt;/code&gt;注解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第三步，定义开关&lt;code&gt;@EnableLog&lt;/code&gt;注解：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Target&lt;/span&gt;(ElementType.TYPE)&lt;br/&gt;&lt;span&gt;@Retention&lt;/span&gt;(RetentionPolicy.RUNTIME)&lt;br/&gt;&lt;span&gt;@Documented&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Import&lt;/span&gt;(LogFilterWebConfig&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; @&lt;span&gt;interface&lt;/span&gt; &lt;span&gt;EnableLog&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第四步，只需在&lt;code&gt;springboot&lt;/code&gt;启动类加上&lt;code&gt;@EnableLog&lt;/code&gt;注解即可开启LogFilter记录请求和响应日志的功能。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;八 RestTemplate拦截器的春天&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们使用&lt;code&gt;RestTemplate&lt;/code&gt;调用远程接口时，有时需要在&lt;code&gt;header&lt;/code&gt;中传递信息，比如：traceId，source等，便于在查询日志时能够串联一次完整的请求链路，快速定位问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种业务场景就能通过&lt;code&gt;ClientHttpRequestInterceptor&lt;/code&gt;接口实现，具体做法如下：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，实现&lt;code&gt;ClientHttpRequestInterceptor&lt;/code&gt;接口：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;RestTemplateInterceptor&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;ClientHttpRequestInterceptor&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; ClientHttpResponse &lt;span&gt;intercept&lt;/span&gt;&lt;span&gt;(HttpRequest request, &lt;span&gt;byte&lt;/span&gt;[] body, ClientHttpRequestExecution execution)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;        request.getHeaders().set(&lt;span&gt;&quot;traceId&quot;&lt;/span&gt;, MdcUtil.get());&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; execution.execute(request, body);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，定义配置类：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;RestTemplateConfiguration&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; RestTemplate &lt;span&gt;restTemplate&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        RestTemplate restTemplate = &lt;span&gt;new&lt;/span&gt; RestTemplate();&lt;br/&gt;        restTemplate.setInterceptors(Collections.singletonList(restTemplateInterceptor()));&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; restTemplate;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; RestTemplateInterceptor &lt;span&gt;restTemplateInterceptor&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RestTemplateInterceptor();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其中MdcUtil其实是利用&lt;code&gt;MDC&lt;/code&gt;工具在&lt;code&gt;ThreadLocal&lt;/code&gt;中存储和获取traceId&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MdcUtil&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;static &lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String TRACE_ID = &lt;span&gt;&quot;TRACE_ID&quot;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String &lt;span&gt;get&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; MDC.get(TRACE_ID);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;(String value)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        MDC.put(TRACE_ID, value);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，这个例子中没有演示MdcUtil类的add方法具体调的地方，我们可以在filter中执行接口方法之前，生成traceId，调用MdcUtil类的add方法添加到&lt;code&gt;MDC&lt;/code&gt;中，然后在同一个请求的其他地方就能通过MdcUtil类的get方法获取到该traceId。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;九 统一异常处理&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以前我们在开发接口时，如果出现异常，为了给用户一个更友好的提示，例如：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RequestMapping&lt;/span&gt;(&lt;span&gt;&quot;/test&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;@RestController&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;TestController&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/add&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;int&lt;/span&gt; a = &lt;span&gt;10&lt;/span&gt; / &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;成功&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果不做任何处理请求add接口结果直接报错：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.28355957767722473&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vyDdyWt359lfLvZNlJpxdPpHggibXhVFWQwtwRCUUmxA75U8Y2j5Lhrw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1326&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;what？用户能直接看到错误信息？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种交互方式给用户的体验非常差，为了解决这个问题，我们通常会在接口中捕获异常：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/add&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;add&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        String result = &lt;span&gt;&quot;成功&quot;&lt;/span&gt;;&lt;br/&gt;        &lt;span&gt;try&lt;/span&gt; {&lt;br/&gt;            &lt;span&gt;int&lt;/span&gt; a = &lt;span&gt;10&lt;/span&gt; / &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;        } &lt;span&gt;catch&lt;/span&gt; (Exception e) {&lt;br/&gt;            result = &lt;span&gt;&quot;数据异常&quot;&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接口改造后，出现异常时会提示：“数据异常”，对用户来说更友好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;看起来挺不错的，但是有问题。。。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果只是一个接口还好，但是如果项目中有成百上千个接口，都要加上异常捕获代码吗？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答案是否定的，这时全局异常处理就派上用场了：&lt;code&gt;RestControllerAdvice&lt;/code&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RestControllerAdvice&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;GlobalExceptionHandler&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@ExceptionHandler&lt;/span&gt;(Exception&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;String&lt;/span&gt; &lt;span&gt;handleException&lt;/span&gt;(&lt;span&gt;Exception&lt;/span&gt; &lt;span&gt;e&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (e &lt;span&gt;instanceof&lt;/span&gt; ArithmeticException) {&lt;br/&gt;            &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;数据异常&quot;&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (e &lt;span&gt;instanceof&lt;/span&gt; Exception) {&lt;br/&gt;            &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;服务器内部异常&quot;&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;retur n&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;只需在&lt;code&gt;handleException&lt;/code&gt;方法中处理异常情况，业务接口中可以放心使用，不再需要捕获异常（有人统一处理了）。真是爽歪歪。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;十 异步也可以这么优雅&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以前我们在使用异步功能时，通常情况下有三种方式：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;继承Thread类&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;实现Runable接口&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;使用线程池&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;让我们一起回顾一下：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;继承Thread类&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MyThread&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;Thread&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;run&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===call MyThread===&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;&lt;span&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;new&lt;/span&gt; MyThread().start();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;实现Runable接口&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MyWork&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Runnable&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;run&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===call MyWork===&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;&lt;span&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;new&lt;/span&gt; Thread(&lt;span&gt;new&lt;/span&gt; MyWork()).start();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;使用线程池&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MyThreadPool&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;static&lt;/span&gt; ExecutorService executorService = &lt;span&gt;new&lt;/span&gt; ThreadPoolExecutor(&lt;span&gt;1&lt;/span&gt;, &lt;span&gt;5&lt;/span&gt;, &lt;span&gt;60&lt;/span&gt;, TimeUnit.SECONDS, &lt;span&gt;new&lt;/span&gt; ArrayBlockingQueue&amp;lt;&amp;gt;(&lt;span&gt;200&lt;/span&gt;));&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;static &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Work&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Runnable&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;run&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            System.out.println(&lt;span&gt;&quot;===call work===&quot;&lt;/span&gt;);&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;&lt;span&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;try&lt;/span&gt; {&lt;br/&gt;            executorService.submit(&lt;span&gt;new&lt;/span&gt; MyThreadPool.Work());&lt;br/&gt;        } &lt;span&gt;finally&lt;/span&gt; {&lt;br/&gt;            executorService.shutdown();&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这三种实现异步的方法不能说不好，但是spring已经帮我们抽取了一些公共的地方，我们无需再继承&lt;code&gt;Thread&lt;/code&gt;类或实现&lt;code&gt;Runable&lt;/code&gt;接口，它都搞定了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如何spring异步功能呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，springboot项目启动类上加&lt;code&gt;@EnableAsync&lt;/code&gt;注解。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@EnableAsync&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@SpringBootApplication&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Application&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;&lt;span&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;new&lt;/span&gt; SpringApplicationBuilder(Application&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;).&lt;span&gt;web&lt;/span&gt;(&lt;span&gt;WebApplicationType&lt;/span&gt;.&lt;span&gt;SERVLET&lt;/span&gt;).&lt;span&gt;run&lt;/span&gt;(&lt;span&gt;args&lt;/span&gt;)&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，在需要使用异步的方法上加上&lt;code&gt;@Async&lt;/code&gt;注解：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;PersonService&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Async&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;get&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        System.out.println(&lt;span&gt;&quot;===add==&quot;&lt;/span&gt;);&lt;br/&gt;        &lt;span&gt;return &lt;/span&gt; &lt;span&gt;&quot;data&quot;&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后在使用的地方调用一下：personService.get();就拥有了异步功能，是不是很神奇。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;默认情况下，spring会为我们的异步方法创建一个线程去执行，如果该方法被调用次数非常多的话，需要创建大量的线程，会导致资源浪费。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这时，我们可以定义一个线程池，异步方法将会被自动提交到线程池中执行。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ThreadPoolConfig&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${thread.pool.corePoolSize:5}&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;int&lt;/span&gt; corePoolSize;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${thread.pool.maxPoolSize:10}&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;int&lt;/span&gt; maxPoolSize;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${thread.pool.queueCapacity:200}&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;int&lt;/span&gt; queueCapacity;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${thread.pool.keepAliveSeconds:30}&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;private &lt;/span&gt; &lt;span&gt;int&lt;/span&gt; keepAliveSeconds;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${thread.pool.threadNamePrefix:ASYNC_}&quot;&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; String threadNamePrefix;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Executor &lt;span&gt;MessageExecutor&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        ThreadPoolTaskExecutor executor = &lt;span&gt;new&lt;/span&gt; ThreadPoolTaskExecutor();&lt;br/&gt;        executor.setCorePoolSize(corePoolSize);&lt;br/&gt;        executor.setMaxPoolSize(maxPoolSize);&lt;br/&gt;        executor.setQueueCapacity(queueCapacity);&lt;br/&gt;        executor.setKeepAliveSeconds(keepAliveSeconds);&lt;br/&gt;        executor.setThreadNamePrefix(threadNamePrefix);&lt;br/&gt;        executor.setRejectedExecutionHandler(&lt;span&gt;new&lt;/span&gt; ThreadPoolExecutor.CallerRunsPolicy());&lt;br/&gt;        executor.initialize();&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; executor;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring异步的核心方法：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5619047619047619&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vI9zxV1qWZZu91ls2pflUSwaNmOUckkqDogaAEEKU8IMMqvHjH92phg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1470&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据返回值不同，处理情况也不太一样，具体分为如下情况：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.34124629080118696&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7veNnUBO858MkbFZIFrlicTVvHyv9eQVP3mRPBNeswWNr9eMEWqmPHoEw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1348&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;十一 听说缓存好用，没想到这么好用&lt;/span&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring cache架构图：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7011494252873564&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vdmj5ViapicuZVXEMicNXwCo2tYL38As3kgjg6YibpibhUocY4BZVOIdm9lg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;870&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;它目前支持多种缓存：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.31690140845070425&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDELdgnZC2EVRmh8HYBrPD7vYvgErCXEn63wnQDSYgm9YEBbqK0Y2VB0JuvJDJtVab7icibQX0MSic1Vw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1420&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们在这里以&lt;code&gt;caffeine&lt;/code&gt;为例，它是&lt;code&gt;spring&lt;/code&gt;官方推荐的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一步，引入&lt;code&gt;caffeine&lt;/code&gt;的相关jar包&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;&lt;br/&gt;    &amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;&lt;br/&gt;    &amp;lt;artifactId&amp;gt;spring-boot-starter-cache&amp;lt;/artifactId&amp;gt;&lt;br/&gt;&amp;lt;/dependency&amp;gt;&lt;br/&gt;&amp;lt;dependency&amp;gt;&lt;br/&gt;    &amp;lt;groupId&amp;gt;com.github.ben-manes.caffeine&amp;lt;/groupId&amp;gt;&lt;br/&gt;    &amp;lt;artifactId&amp;gt;caffeine&amp;lt;/artifactId&amp;gt;&lt;br/&gt;    &amp;lt;version&amp;gt;&lt;span&gt;2.6&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&amp;lt;/version&amp;gt;&lt;br/&gt;&amp;lt;/dependency&amp;gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第二步，配置&lt;code&gt;CacheManager&lt;/code&gt;，开启&lt;code&gt;EnableCaching&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@EnableCaching&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;CacheConfig&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; CacheManager &lt;span&gt;cacheManager&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;        CaffeineCacheManager cacheManager = &lt;span&gt;new&lt;/span&gt; CaffeineCacheManager();&lt;br/&gt;        &lt;span&gt;//Caffeine配置&lt;/span&gt;&lt;br/&gt;        Caffeine&amp;lt;Object, Object&amp;gt; caffeine = Caffeine.newBuilder()&lt;br/&gt;                &lt;span&gt;//最后一次写入后经过固定时间过期&lt;/span&gt;&lt;br/&gt;                .expireAfterWrite(&lt;span&gt;10&lt;/span&gt;, TimeUnit.SECONDS)&lt;br/&gt;                &lt;span&gt;//缓存的最大条数&lt;/span&gt;&lt;br/&gt;                .maximumSize(&lt;span&gt;1000&lt;/span&gt;);&lt;br/&gt;        cacheManager.setCaffeine(caffeine);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; cacheManager;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第三步，使用&lt;code&gt;Cacheable&lt;/code&gt;注解获取数据&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public &lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;CategoryService&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;   &lt;br/&gt;   &lt;span&gt;//category是缓存名称,#type是具体的key，可支持el表达式&lt;/span&gt;&lt;br/&gt;   &lt;span&gt;@Cacheable&lt;/span&gt;(value = &lt;span&gt;&quot;category&quot;&lt;/span&gt;, key = &lt;span&gt;&quot;#type&quot;&lt;/span&gt;)&lt;br/&gt;   &lt;span&gt;&lt;span&gt;public&lt;/span&gt; CategoryModel &lt;span&gt;getCategory&lt;/span&gt;&lt;span&gt;(Integer type)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;       &lt;span&gt;return&lt;/span&gt; getCategoryByType(type);&lt;br/&gt;   }&lt;br/&gt;&lt;br/&gt;   &lt;span&gt;&lt;span&gt;private&lt;/span&gt; CategoryModel &lt;span&gt;getCategoryByType&lt;/span&gt;&lt;span&gt;(Integer type)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;       System.out.println(&lt;span&gt;&quot;根据不同的type:&quot;&lt;/span&gt; + type + &lt;span&gt;&quot;获取不同的分类数据&quot;&lt;/span&gt;);&lt;br/&gt;       CategoryModel categoryModel = &lt;span&gt;new&lt;/span&gt; CategoryModel();&lt;br/&gt;       categoryModel.setId(&lt;span&gt;1L&lt;/span&gt;);&lt;br/&gt;       categoryModel.setParentId(&lt;span&gt;0L&lt;/span&gt;);&lt;br/&gt;       categoryModel.setName(&lt;span&gt;&quot;电器&quot;&lt;/span&gt;);&lt;br/&gt;       categoryModel.setLevel(&lt;span&gt;3&lt;/span&gt;);&lt;br/&gt;       &lt;span&gt;return&lt;/span&gt; categoryModel;&lt;br/&gt;   }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;调用categoryService.getCategory()方法时，先从&lt;code&gt;caffine&lt;/code&gt;缓存中获取数据，如果能够获取到数据则直接返回该数据，不会进入方法体。如果不能获取到数据，则直接方法体中的代码获取到数据，然后放到&lt;code&gt;caffine&lt;/code&gt;缓存中。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;唠唠家常&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;spring中不错的功能其实还有很多，比如：BeanPostProcessor,BeanFactoryPostProcessor,AOP,动态数据源，ImportSelector等等。我原本打算一篇文章写全的，但是有两件事情改变了我的注意：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;有个大佬原本打算转载我文章的，却因为篇幅太长一直没有保存成功。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;最近经常加班，真的没多少时间写文章，晚上还要带娃，喂奶，换尿布，其实挺累的。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果大家喜欢这类文章的话，我打算把spring这些有用的知识点拆分一下，写成一个系列，敬请期待。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;最后说一句(求关注，别白嫖我)&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果这篇文章对您有所帮助，或者有所启发的话，帮忙扫描下发二维码关注一下，您的支持是我坚持写作最大的动力。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;求一键三连：点赞、转发、在看。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关注公众号：【苏三说技术】，在公众号中回复：面试、代码神器、开发手册、时间管理有超赞的粉丝福利，另外回复：加群，可以跟很多BAT大厂的前辈交流和学习。&lt;/p&gt;&lt;p&gt; 个人公众号&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/uL371281oDHUdzOhPCwBUOUgBJ8TrNhn8g5OiaO1C12Y71FPVcyqFkOzz4FnwsLyvZic0dNSYw8hfSjQOeJhDnWw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot;/&gt;&lt;/p&gt;&lt;p&gt; 个人微信&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.0048309178743962&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHUdzOhPCwBUOUgBJ8TrNhnfLeme2LIF0wf8xJX3Oich2efGXhGJic7ibdIDhY9icZiaPAyAFSvVn8AM6w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;414&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>