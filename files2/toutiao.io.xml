<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>93977ec95cdbfc64bf4d6bd4a2aa971c</guid>
<title>互联网架构演进之路</title>
<link>https://toutiao.io/k/6w82jhc</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;前言&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;本文介绍下 互联网架构演进的4个阶段&lt;br/&gt;&lt;br/&gt;1、单体架构&lt;br/&gt;2、水平分层和面向服务架构（SOA）&lt;br/&gt;3、微服务架构&lt;br/&gt;4、服务网格架构(Service Mesh)&lt;br/&gt;&lt;br/&gt;在此之前先简单介绍一个小知识点&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;redis做分布式锁弊端&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;redis实现分布式锁 哨兵模式下 会导致 一个锁同时被多个线程持有&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8517887563884157&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc5mBW4ictvgNshibWZ4AyIiaNtagmaXnWaThnTWVIbHuTj0I0kMbWyNxhA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1174&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;分布式锁是CP模型 Redis是AP模型 用AP实现CP完全错误的&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;用ZK实现分布式锁 有性能问题&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;推荐使用etcd来实现分布式锁&lt;/strong&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;互联网发展&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;静态 广播式&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;动态 互动 比如微博关注&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;万物连接 &lt;br/&gt;比如微信群组 将一对一变成一对多 形成了网络&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;架构演进&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;单体&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4987980769230769&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccglm2JjmNiadchyYSxhMBm7jia0bhUahYzkDcWe73kqkmkcY7ianLPp1WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1664&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;优点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;开发、测试、部署、扩展 都很方便&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;扩展&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.9783783783783784&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccbgrBOUiaNFwLJr8ygEr1m76V9aBw60Eeb6SfM4szXcRFtr5sibMaia5Bg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1110&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;应用场景&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;性能： 吞吐量、平均响应延迟&lt;br/&gt;&lt;br/&gt;这里主要指平均响应延迟 &lt;br/&gt;比如股票、高频交易 需要及时捕捉到股票市场一些波动&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;缺点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如开发语言单一&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;水平分层&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;要解决这些问题 咱们先看看数据库是如何破局的 然后再类比到架构上&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据库如何解决单体瓶颈&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;拆分&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如 用户库 商户库&lt;br/&gt;&lt;br/&gt;但还是单表&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如 模1024 分1024表&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;db做了拆分 所以要考虑分布式事务&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;架构同理&lt;/strong&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;水平分层架构设计&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;按业务维度&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;物理分成多个独立进程&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;按功能纬度：网关层、业务逻辑层、数据访问层、数据存储层&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;每层逻辑解耦&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;数据访问层必须拆分出来 可以屏蔽掉分库分表逻辑和兼容不同的数据库（比如关系型、非关系型、NewSql）&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.28647014361300077&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccPnxp9ibKvyiajgVZoPvicFd6RGXPjlt7FvwoHgKszHyfGrbDhkFXUUMDw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2646&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;分层设计原则&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7345679012345679&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc1lwCicrCz5L9nh1J9xkW0nB45icne1YsEca8yibBUVxVbHRw7hn0I7oSA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1296&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;展示服务和网关服务分离举例&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;网关返回的发布时间是时间戳格式&lt;br/&gt;展示层（APP）将时间戳转换成具体的日期格式&lt;br/&gt;而非网关返回具体的日期格式&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;网关层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0788253477588872&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccLHB83rRcdwmY5GMicWpZWML48QOwImpwbadFjvTXXtc1EfEjkw4WrUw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1294&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;app 通过https/http协议 以json字符串的格式&lt;br/&gt;&lt;br/&gt;请求包：&lt;br/&gt;&lt;br/&gt;1 定长header(uid、sessionId(请求唯一标识、cmd(请求命令号)、body length)) &lt;br/&gt;&lt;br/&gt;2 变长body&lt;br/&gt;&lt;br/&gt;原则：&lt;br/&gt;&lt;br/&gt;不会对价格字段做检查（不会处理具体业务语意）&lt;br/&gt;&lt;br/&gt;但要做非空检查（通用逻辑）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;请求鉴权&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;粗粒度：ip白名单&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;细粒度：请求参数中有token，基于过滤器做token验证&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、登陆鉴权是属于具体业务 不属于请求鉴权 放在业务逻辑层&lt;br/&gt;&lt;br/&gt;2、鉴权规则配置到配置中心 可视化方式获取&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;请求进入网关之后 不用短连接&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;传输协议&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;rpc oven tcp&lt;br/&gt;可以提升传输效率&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据协议&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;protobuf google&lt;br/&gt;（用json传输量大 pb二进制且压缩）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5144454799627214&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccZiaajR44GLicdxXfIPK9zmuEoctD9zJCMBLxZn1EndfaWCnWGwwCsmNQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1073&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;网关不需要理解具体的业务语意&lt;br/&gt;&lt;br/&gt;1、json{k1,v1}转hashmap(string,object)&lt;br/&gt;&lt;br/&gt;2、hashmap序列化pb&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;路由转发&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;负载均衡&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;网关开源组件&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5760598503740648&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccE4BX9VxIEVOv0DMgczkeIs74WbLWqicgltg9xJbcyAsR92PtZHuw2ibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2406&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;简单解释：&lt;br/&gt;&lt;br/&gt;1、Kong基于nginx(Lua) 写了扩展性脚本&lt;br/&gt;&lt;br/&gt;2、BIO是阻塞IO模型&lt;br/&gt;&lt;br/&gt;3、Netty 用的NIO（N是New IO:IO复用）&lt;br/&gt;&lt;br/&gt;4、epoll （linux具体网络实现,实现NIO）&lt;br/&gt;&lt;br/&gt;5、AIO 异步IO模型 （用的不多 业务复杂度很高 性能最好）&lt;br/&gt;&lt;br/&gt;6、Zuul 已贡献给 Spring Cloud 推荐Zuul&lt;br/&gt;&lt;br/&gt;简单扩展：&lt;br/&gt;&lt;br/&gt;1、国际化 在APP启动层做&lt;br/&gt;&lt;br/&gt;2、第三方调用的场景用oauth授权  app用oauth意义不大&lt;br/&gt;&lt;br/&gt;3、多版本号场景 业务逻辑根据不同版本号做差异&lt;br/&gt;&lt;br/&gt;4、不同业务团队用一个网关 &lt;br/&gt;&lt;br/&gt;5、网关层是无状态的 每一个部署的模块是对等的 不存储数据&lt;br/&gt;&lt;br/&gt;6、selct和poll不用 性能较差 epoll用的更多&lt;br/&gt;&lt;br/&gt;7、springcloud大公司用的很少&lt;br/&gt;   中小型公司用的多 &lt;br/&gt;   用的是http协议 没有用rpc&lt;br/&gt;   &lt;br/&gt;8、服务治理每层都要做&lt;br/&gt;&lt;br/&gt;9、Zuul尽量少启动 一启动连接就丢了 &lt;br/&gt;&lt;br/&gt;10、app(混合式： 经常变的页面做成h5(不需要发版本) native)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;业务逻辑层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0504885993485342&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccibGib09SYrAt2btW1dCYV9aRQibHMOuCFof9pkjDWcp6hCicO4HpDA8z3Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1228&quot;/&gt;&lt;/figure&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;数据访问层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.1595330739299612&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccVvuQ6PdAuYlnYpQ03Hc7zMviaDqca0m3ocSM8FibjWQ6ib7FEfOXdpMgw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1028&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;orm映射 : pb-&amp;gt;mysql协议&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;最难的是Sharding&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1 原因：&lt;br/&gt;&lt;br/&gt;很多情况 sharding不了&lt;br/&gt;&lt;br/&gt;对商品留言功能 几十个亿 分片不了&lt;br/&gt;&lt;br/&gt;留言id 留言商品id 留言人 留言时间 留言状态（有没有删除）&lt;br/&gt;&lt;br/&gt;未分表 只需要建立index就可以&lt;br/&gt;&lt;br/&gt;分表 parditing key只有一个&lt;br/&gt;&lt;br/&gt;其他的查询字段要遍历所有表 &lt;br/&gt;&lt;br/&gt;2 解决方式：&lt;br/&gt;&lt;br/&gt;通过映射表 基因法&lt;br/&gt;&lt;br/&gt;3、分库分表查询的业务逻辑在业务逻辑层实现&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;最好的方式是不分片&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;将分表逻辑下推到db层&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;数据库进化史&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、单机关系型数据库 &lt;br/&gt;2、08年之前&lt;br/&gt;3、比如mysql oracle&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、数据量大 互联网事务要求不高 (acid) 分布式非关系型数据库 &lt;br/&gt;&lt;br/&gt;2、解决了分库分表&lt;br/&gt;&lt;br/&gt;3、一致性解决不好 比如mongodb redis hive hbase&lt;br/&gt;&lt;br/&gt;4、mongodb 3.0之前事务性不好 4.0及以后支持事务&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;newsql&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、金融电信银行 数据量大 事务要求很高 &lt;br/&gt;&lt;br/&gt;2、分布式关系型数据库&lt;br/&gt;&lt;br/&gt;3、比如国内tidb&lt;br/&gt;&lt;br/&gt;a、tidb是强一致性的 支持事务acid&lt;br/&gt;&lt;br/&gt;对一致性要求不高的 不用关系型数据库也可以 比如用redis&lt;br/&gt;&lt;br/&gt;b、tidb用的是mysql协议 业务不需要升级&lt;br/&gt;&lt;br/&gt;c、单机mysql数据存储的下的话 tidb比mysql慢 因为tidb是分布式的&lt;br/&gt;&lt;br/&gt;d、异构存储 一致性很难保证&lt;br/&gt;&lt;br/&gt;4、用newsql 线上单表 1200多亿 查询只需要4毫秒&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;同步架构&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2528830313014827&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc9ml0KVq3X1wvGf1OXCepeKfYtyU4QJJr4LIjweMFPCjARdS2yIzfKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2428&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;异步架构&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2350265352539803&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccNeoycySzWBWt4BVQGlovxgXyvj3KA2Y0pAobmZJc1lyJFYyLvufUpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2638&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;1、为什么用mq做异步&lt;br/&gt;&lt;br/&gt;mq顺序写入磁盘 append 追加 效率高&lt;br/&gt;db随机写写磁盘&lt;br/&gt;&lt;br/&gt;2、mq要放在网关和业务逻辑层之间变成异步&lt;br/&gt;&lt;br/&gt;3、异步目的提升吞吐量&lt;br/&gt;&lt;br/&gt;4、推荐使用rocketmq&lt;br/&gt;&lt;br/&gt;5、读请求不能用mq &lt;br/&gt;   写请求可以用mq&lt;br/&gt;   &lt;br/&gt;   &lt;br/&gt;数据一致性要求强:充值 不能用异步 吞吐量不高 低并发&lt;br/&gt;&lt;br/&gt;数据一致性要求弱:发朋友圈 社交 可以用异步 吞吐量高 高并发&lt;br/&gt;&lt;br/&gt;写场景是异步&lt;br/&gt;读场景不是异步&lt;br/&gt;&lt;br/&gt;发朋友圈 缓存到本地 读从本地读 不是从网关-&amp;gt;业务逻辑层-&amp;gt;数据存储层-&amp;gt;db&lt;br/&gt;&lt;br/&gt;发好了直接看 解决自己看问题就好了 好多秒之后再看 就已经入DB了&lt;br/&gt;&lt;br/&gt;但异步也不定写成功到db&lt;br/&gt;&lt;br/&gt;微信怎么办的 有未发送成功的消息&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;层次划分个数&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、请求路径变长&lt;br/&gt;&lt;br/&gt;2、平均响应延迟变高&lt;br/&gt;&lt;br/&gt;3、定位问题复杂 分布式请求跟踪系统&lt;br/&gt;&lt;br/&gt;4、运维成本增加&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;单体&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.3596730245231607&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc1ZJ3kb6JE07BSBRyqErTFzIv2GPY6icpEMXfAicibF75Kn6r2XApDNnhw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;734&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;缺点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;每层粒度过粗&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;扩展&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、reacter 模型 本质是异步架构 是一个实现手段&lt;br/&gt;&lt;br/&gt;2、app和网关长连接 失败了会推给app&lt;br/&gt;若http必须长轮询&lt;br/&gt;&lt;br/&gt;3、使用nginx\f5\lvs意义会使请求更加健壮 因为网关会频繁重启 &lt;br/&gt;&lt;br/&gt;4、nginx反向代理 ip限流&lt;br/&gt;&lt;br/&gt;5、mq不适合用udp协议（高性能udp） mq要保证数据可靠性&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;同步水平分层架构&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;dns解析 -&amp;gt;静态资源获取-&amp;gt;动态资源获取&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.47806354009077157&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccys0PVicZFxKbX6As1iaSDkFnkhm7mW69LLom4r0dlBkicfW08Pakniboug/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2644&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、路由器虚拟化 NetGW&lt;br/&gt;&lt;br/&gt;2、对象存储 &lt;br/&gt;&lt;br/&gt;   a、fastdfs(规模小) &lt;br/&gt;   b、ceph(规模大 运维压力大 快存储、挂硬盘)&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;面向服务SOA&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;垂直拆分&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.39969604863221886&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccFHBTsBUtveg8UENsvZpNSqxczibcujJyF0qmZR1NLibcZhn2VibC9gv4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2632&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、多个独立服务（每个服务都是单体）&lt;br/&gt;&lt;br/&gt;2、通过ESB交互 对ESB依赖严重&lt;br/&gt;&lt;br/&gt;3、SOA不是微服务架构&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;微服务架构&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;垂直和水平都拆分&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、独立进程&lt;br/&gt;&lt;br/&gt;2、围绕业务建模能力&lt;br/&gt;&lt;br/&gt;3、独立部署&lt;br/&gt;&lt;br/&gt;4、去中心化管理 （网关、业务逻辑&lt;br/&gt;数据访问、存储层 都可以用各种语言写 但会带来很多问题）&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6682600382409177&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccV82NLXo5th4NPWUTg0mqXhf5HSXfQyG6bPBibPXmNlwGz4UttURQYLw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2092&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.41874527588813304&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicczGWsz9PsHamiaOicia7PLnfUHhmSChDL79s5H71f6DZoQBG8ddCgXE67A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2646&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、用zk、consul做注册中心不行 eurka 可以&lt;br/&gt;&lt;br/&gt;2、配置中心推荐 appllo 携程开源；不要用disconf(springcloud的生态)&lt;br/&gt;&lt;br/&gt;3、交易系统是同步分层架构&lt;br/&gt;&lt;br/&gt;4、注册中心不知道哪个服务挂掉 通过熔断可以知道&lt;br/&gt;&lt;br/&gt;5、forupdate并发锁 粒度大 量大不行&lt;br/&gt;&lt;br/&gt;6、同层之间不调用&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本质&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;两个拆分&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;垂直（业务）拆分比较难&lt;br/&gt;&lt;br/&gt;继续拆分 读、写微服务（按功能拆分 （api））&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;业务架构&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;微服务架构是业务架构 不是系统架构&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;组织架构&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;事业部制  公司-&amp;gt;房产(产品、研发、销售) 招聘(产品、研发、销售) 二手车(产品、研发、销售) 效率高&lt;br/&gt;&lt;br/&gt;公司-&amp;gt;产品、研发、销售 效率低&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;应用场景&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;需求层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;变化频繁 比如内部OA系统 ERP系统 不频繁 微服务意义不大&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;性能层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、吞吐量变高 平均响应延迟变高&lt;br/&gt;&lt;br/&gt;2、高频交易 量化交易 不合适微服务&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据一致性层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;一致性分为：&lt;br/&gt;   强一致性&lt;br/&gt;   和最终一致性（用微服务其实解决这个问题）&lt;br/&gt;&lt;br/&gt;多个db 分布式事务解决强一致性问题 性能就没了&lt;br/&gt;&lt;br/&gt;往往最终一致性 （分为同步、异步场景）&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;目的&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;快速迭代、持续交付&lt;br/&gt;&lt;br/&gt;降本（人力、机器）提效（开发、运维、测试）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;后记&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;后续会介绍服务网格架构ServiceMesh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>cad871397fe3741d7bede5bab3d6cb1b</guid>
<title>看完这篇你一定能掌握 Linux</title>
<link>https://toutiao.io/k/ycdmy3y</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;174&quot; data-backw=&quot;365&quot; data-ratio=&quot;0.4767123287671233&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/cvQbJDZsKLp6wejHtKTRbqqQyt0wMk9K1wNtuwRqQTJAPOJ1KiaqSeSRbIJRTicVicKpDKRndBodY2DBNN20tvWwA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;365&quot;/&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;原创：小姐姐味道（微信公众号ID：xjjdog），欢迎分享，转载请保留出处。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有很多同学微信问我，Linux命令这么多，该怎么从入门到精通？其实，这个事情非常的simple，这篇文章将会带你飞。文章非常的长，要挑一个阳光明媚的sunshine weekend，耐心去搞定。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5551142005958292&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8UUIMdcty6J23T4mHVaM3keAia827VATQz3BM3w7rpJY9icya5Q2bxjiaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1007&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文将由一个Linux命令概览开始，说明Linux命令的方方面面。如果你读完这部分还是一头雾水，那么就证明需要按照下面的小白教程去学习了，内容涵盖了：如何挑选Linux发行版、如何安装Linux系统，按照主题学习Linux系统的命令等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;入门后的 **学习方式：多敲多打，用条件反射替代大脑记忆--如果你将来或者现在要用它来吃饭的话。**其中，也有一些难啃的骨头，关注小姐姐味道微信公众号，我们一起用锋利的牙齿，来把它嚼碎。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1. Linux命令概览&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这部分是给稍微有点Linux经验的同学准备的，如果你是初学者，请跳过此part直接进入第二部分。&lt;/p&gt;&lt;img data-ratio=&quot;0.7804208600182982&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8GGRwQxfB9fN5BOIy2mgJh34iaJtgCpPq2tRDwbq8PeAUibyl7MSurdkg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1093&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.1目录操作&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;工作中，最常打交道的就是对目录和文件的操作。linux提供了相应的命令去操作他，并将这些命令抽象、缩写。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.1.1 基本操作&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可能是这些命令太常用了，多打一个字符都是罪过。所以它们都很短，不用阿拉伯数字，一个剪刀手就能数过来。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4358974358974359&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ZEwCiczn0RaLRXKpXcgxvDgaU31WNWWKhCezyyaOO4VB5EzvwEFD9uw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;看命令。&lt;br/&gt;&lt;strong&gt;mkdir&lt;/strong&gt; 创建目录  make dir&lt;strong&gt;cp&lt;/strong&gt; 拷贝文件  copy&lt;strong&gt;mv&lt;/strong&gt; 移动文件   move&lt;strong&gt;rm&lt;/strong&gt;  删除文件 remove&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;例子：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 创建目录和父目录a,b,c,d&lt;/span&gt;&lt;br/&gt;mkdir -p a/b/c/d&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 拷贝文件夹a到/tmp目录&lt;/span&gt;&lt;br/&gt;cp -rvf a/ /tmp/&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 移动文件a到/tmp目录，并重命名为b&lt;/span&gt;&lt;br/&gt;mv -vf a /tmp/b&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 删除机器上的所有文件&lt;/span&gt;&lt;br/&gt;rm -rvf /&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.1.2 漫游&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;linux上是黑漆漆的命令行，依然要面临人生三问：我是谁？我在哪？我要去何方？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ls&lt;/code&gt;  命令能够看到当前目录的所有内容。&lt;code&gt;ls -l&lt;/code&gt;能够看到更多信息，判断你是谁。&lt;br/&gt;&lt;code&gt;pwd&lt;/code&gt;  命令能够看到当前终端所在的目录。告诉你你在哪。&lt;br/&gt;&lt;code&gt;cd&lt;/code&gt;  假如你去错了地方，cd命令能够切换到对的目录。&lt;br/&gt;&lt;code&gt;find&lt;/code&gt;  find命令通过筛选一些条件，能够找到已经被遗忘的文件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;至于要去何方，可能就是主宰者的意志了。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.2 文本处理&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这是是非常非常加分的技能。get到之后，也能节省更多时间来研究面向对象。小姐姐味道已经输出了“最常用的vim、sed、awk技巧系列”。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4509283819628647&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8b7O6yU62wk6ZfrB4qcrkmQ56YyIVSGp0TotostpRGICHIefN8GVyMw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.2.1 查看文件&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;cat&lt;/strong&gt;&lt;br/&gt;最常用的就是&lt;code&gt;cat&lt;/code&gt;命令了，注意，如果文件很大的话，cat命令的输出结果会疯狂在终端上输出，可以多次按&lt;code&gt;ctrl+c&lt;/code&gt;终止。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 查看文件大小&lt;/span&gt;&lt;br/&gt;du -h file&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 查看文件内容&lt;/span&gt;&lt;br/&gt;cat file&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;less&lt;/strong&gt;&lt;br/&gt;既然cat有这个问题，针对比较大的文件，我们就可以使用&lt;code&gt;less&lt;/code&gt;命令打开某个文件。类似vim，less可以在输入&lt;code&gt;/&lt;/code&gt;后进入查找模式，然后按&lt;code&gt;n&lt;/code&gt;(N)向下(上)查找。&lt;br/&gt;有许多操作，都和vim类似，你可以类比看下。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;tail&lt;/strong&gt;&lt;br/&gt;大多数做服务端开发的同学，都了解这么命令。比如，查看nginx的滚动日志。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;tail -f access.log&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;tail命令可以静态的查看某个文件的最后n行，与之对应的，head命令查看文件头n行。但head没有滚动功能，就像尾巴是往外长的，不会反着往里长。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;tail -n100 access.log&lt;br/&gt;head -n100 access.log&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.2.1 统计&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;sort和uniq经常配对使用。sort可以使用&lt;code&gt;-t&lt;/code&gt;指定分隔符，使用&lt;code&gt;-k&lt;/code&gt;指定要排序的列。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面这个命令输出nginx日志的ip和每个ip的pv，pv最高的前10&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 2019-06-26T10:01:57+08:00|nginx001.server.ops.pro.dc|100.116.222.80|10.31.150.232:41021|0.014|0.011|0.000|200|200|273|-|/visit|sign=91CD1988CE8B313B8A0454A4BBE930DF|-|-|http|POST|112.4.238.213&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;awk -F&lt;span&gt;&quot;|&quot;&lt;/span&gt; &lt;span&gt;&#x27;{print $3}&#x27;&lt;/span&gt; access.log | sort | uniq -c | sort -nk1 -r | head -n10&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.2.3 其他&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;grep&lt;/strong&gt;&lt;br/&gt;grep用来对内容进行过滤，带上&lt;code&gt;--color&lt;/code&gt;参数，可以在支持的终端可以打印彩色，参数&lt;code&gt;n&lt;/code&gt;则输出具体的行数，用来快速定位。&lt;br/&gt;比如：查看nginx日志中的POST请求。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;grep -rn --color POST access.log&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;推荐每次都使用这样的参数。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果我想要看某个异常前后相关的内容，就可以使用ABC参数。它们是几个单词的缩写，经常被使用。&lt;strong&gt;A&lt;/strong&gt;  after  内容后n行&lt;strong&gt;B&lt;/strong&gt;  before  内容前n行&lt;strong&gt;C&lt;/strong&gt;  count?  内容前后n行&lt;br/&gt;就像是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;grep -rn --color Exception -A10 -B2   error.log&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;diff&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;diff命令用来比较两个文件是否的差异。当然，在ide中都提供了这个功能，diff只是命令行下的原始折衷。对了，diff和patch还是一些平台源码的打补丁方式，你要是不用，就pass吧。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.3压缩&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了减小传输文件的大小，一般都开启压缩。linux下常见的压缩文件有tar、bzip2、zip、rar等，7z这种用的相对较少。&lt;/p&gt;&lt;img data-ratio=&quot;0.26436781609195403&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8TZUy8EHTlx1repHVsDCl4y88lIYdlT5t3CiaJ4U268rmhrpuADTRMBQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;.tar&lt;/strong&gt;  使用tar命令压缩或解压&lt;br/&gt;&lt;strong&gt;.bz2&lt;/strong&gt; 使用bzip2命令操作&lt;br/&gt;&lt;strong&gt;.gz&lt;/strong&gt; 使用gzip命令操作&lt;br/&gt;&lt;strong&gt;.zip&lt;/strong&gt; 使用unzip命令解压&lt;br/&gt;&lt;strong&gt;.rar&lt;/strong&gt; 使用unrar命令解压&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最常用的就是&lt;code&gt;.tar.gz&lt;/code&gt;文件格式了。其实是经过了tar打包后，再使用gzip压缩。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;创建压缩文件&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;tar cvfz  archive.tar.gz dir/&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;解压&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;tar xvfz. archive.tar.gz&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;快去弄清楚它们的关系吧。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.4 日常运维&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开机是按一下启动按钮，关机总不至于是长按启动按钮吧。对了，是shutdown命令，不过一般也没权限-.-!。passwd命令可以用来修改密码，这个权限还是可以有的。&lt;/p&gt;&lt;img data-ratio=&quot;0.6198054818744474&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8pCVa7NOpq9WV4Fvm6yRIATbMp2SksSckDxFjTXDA4jJ2vd3yx8aAMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;mount&lt;/strong&gt;&lt;br/&gt;mount命令可以挂在一些外接设备，比如u盘，比如iso，比如刚申请的ssd。可以放心的看小电影了。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;mount /dev/sdb1 /xiaodianying&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;chown&lt;/strong&gt;&lt;br/&gt;&lt;code&gt;chown&lt;/code&gt; 用来改变文件的所属用户和所属组。&lt;br/&gt;&lt;code&gt;chmod&lt;/code&gt; 用来改变文件的访问权限。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这两个命令，都和linux的文件权限777有关。&lt;br/&gt;示例：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 毁灭性的命令&lt;/span&gt;&lt;br/&gt;chmod 000 -R /&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 修改a目录的用户和组为 xjj&lt;/span&gt;&lt;br/&gt;chown -R xjj:xjj a&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 给a.sh文件增加执行权限（这个太常用了)&lt;/span&gt;&lt;br/&gt;chmod a+x a.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;yum&lt;/strong&gt;&lt;br/&gt;假定你用的是centos，则包管理工具就是yum。如果你的系统没有wget命令，就可以使用如下命令进行安装。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;yum install wget -y&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;systemctl&lt;/strong&gt;&lt;br/&gt;当然，centos管理后台服务也有一些套路。&lt;code&gt;service&lt;/code&gt;命令就是。&lt;code&gt;systemctl&lt;/code&gt;兼容了&lt;code&gt;service&lt;/code&gt;命令，我们看一下怎么重启mysql服务。 推荐用下面这个。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;service mysql restart&lt;br/&gt;systemctl restart  mysqld &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于普通的进程，就要使用kill命令进行更加详细的控制了。kill命令有很多信号，如果你在用&lt;code&gt;kill -9&lt;/code&gt;，你一定想要了解&lt;code&gt;kill -15&lt;/code&gt;以及&lt;code&gt;kill -3&lt;/code&gt;的区别和用途。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;su&lt;/strong&gt;&lt;br/&gt;su用来切换用户。比如你现在是root，想要用xjj用户做一些勾当，就可以使用su切换。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;su xjj&lt;br/&gt;su - xjj&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;-&lt;/code&gt;可以让你干净纯洁的降临另一个账号，不出意外，推荐。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.5 系统状态概览&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;登陆一台linux机器，有些命令能够帮助你快速找到问题。这些命令涵盖内存、cpu、网络、io、磁盘等。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4385499557913351&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8Cq0HibYqTsYYMdEicXj7p6eyaZMaZEn2y1TTcC1YibJyIqlwHGXN4D3HQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;uname&lt;/strong&gt;uname命令可以输出当前的内核信息，让你了解到用的是什么机器。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;uname -a&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;ps&lt;/strong&gt;&lt;br/&gt;ps命令能够看到进程/线程状态。和top有些内容重叠，常用。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 找到java进程&lt;/span&gt;&lt;br/&gt;ps -ef|grep java&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;top&lt;/strong&gt;系统状态一览，主要查看。cpu load负载、cpu占用率。使用内存或者cpu最高的一些进程。下面这个命令可以查看某个进程中的线程状态。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;top -H -p pid&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;free&lt;/strong&gt;&lt;br/&gt;top也能看内存，但不友好，free是专门用来查看内存的。包括物理内存和虚拟内存swap。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;df&lt;/strong&gt;&lt;br/&gt;df命令用来查看系统中磁盘的使用量，用来查看磁盘是否已经到达上限。参数&lt;code&gt;h&lt;/code&gt;可以以友好的方式进行展示。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;df -h&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;ifconfig&lt;/strong&gt;&lt;br/&gt;查看ip地址，不啰嗦，替代品是&lt;code&gt;ip addr&lt;/code&gt;命令。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;ping&lt;/strong&gt;&lt;br/&gt;至于网络通不通，可以使用ping来探测。（不包括那些禁ping的网站）&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;netstat&lt;/strong&gt;虽然ss命令可以替代netstat了，但现实中netstat仍然用的更广泛一些。比如，查看当前的所有tcp连接。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;netstat -ant&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此命令，在找一些&lt;code&gt;本地起了什么端口&lt;/code&gt;之类的问题上，作用很大。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.6 工作常用&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;还有一些在工作中经常会用到的命令，它们的出现频率是非常高的 ，都是些熟面孔。&lt;/p&gt;&lt;img data-ratio=&quot;0.6799292661361627&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8FguzHNFxx3HO46QfafNX36Az7v6QVTwQSZbVTknF7GYXHAINuicicDJA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;export&lt;/strong&gt;&lt;br/&gt;很多安装了jdk的同学找不到java命令，&lt;code&gt;export&lt;/code&gt;就可以帮你办到它。export用来设定一些环境变量，env命令能看到当前系统中所有的环境变量。比如，下面设置的就是jdk的。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;export&lt;/span&gt; PATH=&lt;span&gt;$PATH&lt;/span&gt;:/home/xjj/jdk/bin&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有时候，你想要知道所执行命令的具体路径。那么就可以使用whereis命令，我是假定了你装了多个版本的jdk。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;crontab&lt;/strong&gt;&lt;br/&gt;这就是linux本地的job工具。不是分布式的，你要不是运维，就不要用了。比如，每10分钟提醒喝茶上厕所。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;*/10 * * * * /home/xjj/wc10min&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;date&lt;/strong&gt;date命令用来输出当前的系统时间，可以使用-s参数指定输出格式。但设置时间涉及到设置硬件，所以有另外一个命令叫做&lt;code&gt;hwclock&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;xargs&lt;/strong&gt;xargs读取输入源，然后逐行处理。这个命令非常有用。举个栗子，删除目录中的所有class文件。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;find . | grep .class$ | xargs rm -rvf&lt;br/&gt;&lt;br/&gt;&lt;span&gt;#把所有的rmvb文件拷贝到目录&lt;/span&gt;&lt;br/&gt;ls *.rmvb | xargs -n1 -i cp {} /mount/xiaodianying&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.7 网络&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;linux是一个多作业的网络操作系统，所以网络命令有很多很多。工作中，最常和这些打交道。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;ssh&lt;/strong&gt;&lt;br/&gt;这个，就不啰嗦了。你一定希望了解&lt;code&gt;ssh隧道&lt;/code&gt;是什么。你要是想要详细的输出过程，记得加参数&lt;code&gt;-v&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;scp&lt;/strong&gt;&lt;br/&gt;scp用来进行文件传输。也可以用来传输目录。也有更高级的&lt;code&gt;sftp&lt;/code&gt;命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;scp a.txt 192.168.0.12:/tmp/a.txt&lt;br/&gt;scp -r a_dir 192.168.0.12:/tmp/&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;wget&lt;/strong&gt;&lt;br/&gt;你想要在服务器上安装jdk，不会先在本地下载下来，然后使用scp传到服务器上吧（有时候不得不这样）。wget命令可以让你直接使用命令行下载文件，并支持断点续传。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;wget -c http://oracle.fuck/jdk2019.bin&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;mysql&lt;/strong&gt;&lt;br/&gt;mysql应用广泛，并不是每个人都有条件用上&lt;code&gt;navicat&lt;/code&gt;的。你需要了解mysql的连接方式和基本的操作，在异常情况下才能游刃有余。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;mysql -u root -p -h 192.168.1.2&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不要觉得复杂，命令是有限的，但激情无限；都会也不要骄傲，一个vim就够折腾一辈子。捷径就是总结，深入只有探索。白马过隙，终会行云流水，手到擒来。&lt;br/&gt;物是人非，年华易老。唯有时光，不会辜负。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2. 挑选一个Linux发行版&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;和Linux比较像的还有Unix，但如果你是一个二三十岁的小青年，你接触到可能只有Linux的世界了。从手机，到服务器上广泛使用的&lt;code&gt;centos&lt;/code&gt;，到漂亮的桌面发行版&lt;code&gt;ubuntu&lt;/code&gt;，甚至是风靡全球的&lt;code&gt;树莓派&lt;/code&gt;，到处都是linux的身影。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.1 你需要知道这些linux历史&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;知道一点相关操作系统的历史，是能够陶冶情操的。&lt;code&gt;GNU/Linux&lt;/code&gt;是为了抵制一些商业公司的垄断行为而发展起来的，凝结了一代互联网人向往自由的心血。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;和其他Unix比起来，Linux其实很年轻。直到&lt;strong&gt;1991&lt;/strong&gt;年，一个叫&lt;code&gt;Linus Torvalds&lt;/code&gt;的芬兰年轻人才开始开发我们现在所知道的&lt;code&gt;Linux内核&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Linux&lt;/code&gt;的吉祥物是企鹅，这个吉祥物直到&lt;strong&gt;1996&lt;/strong&gt;年才确定，所以你会经常看到一些搞笑的图片。如果你是90后，那这只小企鹅几乎和你一般大，还是个年轻的小伙。&lt;/p&gt;&lt;img data-ratio=&quot;0.6919561243144424&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8NMibEgOj7NaO1OqoJCUv1AFqXavHk64QibIlYuePwQNUMic1d8WPuftgQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1094&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Linux的发展历程比较的复杂。经过一次次的过关斩将，Linux走到今天确属不易。关于其发展历史，你可以通过下面的链接，查看高清图片。20年的时间，对软件行业来说，是一段非常漫长的时光，有多少的风光已经物是人非。&lt;/p&gt;&lt;img data-ratio=&quot;0.664321608040201&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib898hDKp9e92nicCaNH3KpUTgcVYNxYqLTKlmic0OdLzTzmxuB6yWVKTQA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;995&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;高清见图片(http://1t.click/aUnx) 。可以看到，linux只占了那可怜的一小块。这就像人类的出现，在生命的长河中，微不足道，但却是一个质的飞跃。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可能注意到，在前面的描述中，说的是&lt;code&gt;GUN/Linux&lt;/code&gt;，而不仅仅是&lt;code&gt;Linux&lt;/code&gt;。Linux本身只是一个内核，作用有限，只有和&lt;code&gt;GNU&lt;/code&gt;联合起来，拥有完整的生态才会发挥它的作用。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;谈到上面区别的原因，是为了记住&lt;code&gt;Richard Stallman&lt;/code&gt;在1983年发起的&lt;code&gt;GNU&lt;/code&gt;计划。他同时是&lt;code&gt;smalltalk&lt;/code&gt;语言的发明者，被公认的第二个面向对象的语言。我在早些年，还研究过一段时间。哦，他还编写了一个巨无霸编辑器，&lt;code&gt;Emacs&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;只有一个人被捧成神，他才会有能量折磨你。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;针对于Linux历史，我们不做过多介绍。下面介绍几个经典的发行版本。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.2 精选版本介绍&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在的Linux发行版本，已经有上千个，你要是喜欢、而且多金，你也可以做一个。如何在这其中，找到最合适的版本，是需要经过一番折腾的。很多发行版本，其实是很小众的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这不像是哲学领域的某些东西，真理掌握在少数人手中。只有获得良好发展，并得到认可的Linux发行版，才有它的价值，可以说是彻头彻尾的实用主义。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但这东西又像女朋友，刚开始感觉风采迥异，各有千秋，到最后了解到是一样的庸俗不堪。但有人就是喜欢Linux相关的工作，一干就是一辈子...&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我可以先说一下自己的历程。刚开始，接触的是红帽&lt;code&gt;redhat&lt;/code&gt;，当时还没有分什么企业版。用了一段时间以后，又切换成更稳定的&lt;code&gt;slackware&lt;/code&gt;。但是slackware上的程序更新实在太慢了，于是又切换成readhat血统的&lt;code&gt;fedora&lt;/code&gt;，这个版本的软件保鲜度很高。其间，又尝试了其他几个linux版本，最终，在2013年前后，换成了滚动升级的&lt;code&gt;archlinux&lt;/code&gt;，直到现在。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要我个人做个推荐的话：&lt;br/&gt;1、个人用户（技术），桌面版用&lt;code&gt;ubuntu&lt;/code&gt;=&amp;gt;&lt;code&gt;archlinux&lt;/code&gt;。&lt;br/&gt;2、企业用户，服务器，使用&lt;code&gt;centos&lt;/code&gt;。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.3 主要起源&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这么多Linux版本，其实有两条主线。&lt;code&gt;debian&lt;/code&gt;系列和&lt;code&gt;redhat&lt;/code&gt;系列。很多发行版本，其实是二次翻新，很多就直接拿这两个基础系列进行改造。正所谓：&lt;strong&gt;操作系统千千万，都是帽子和大便。&lt;/strong&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;debian&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面这个屎一样的图表，就是debian。呃呃呃，和大便只差一个字母。&lt;/p&gt;&lt;img data-ratio=&quot;1.1570247933884297&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ibCqHcjJ6qaGbJsKqq35ZtgqtLiblGEbTFEKYTMERN70IGKYAW6wRucw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;121&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Debian计划&lt;/code&gt;是一个致力于创建一个自由操作系统的合作组织。它的特点是：稳定、安全，到现在为止，已经发展了20多年了。我们所熟悉的ubuntu，就是基于debian改进的。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;redhat&lt;span/&gt;&lt;/h3&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8z7oBkj3HCzqWfOE1bkHfkTWzMNyeZHnwf6OaIqibrIgwfDfCqiatXqGg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;红帽是一家商业公司，涉足Linux比较早，现在对个人提供一些&lt;code&gt;红帽认证&lt;/code&gt;之类的证书。现在云主机使用较多的centos，包括红帽公司的&lt;code&gt;RHEL&lt;/code&gt;，占据了大部分服务器市场。近期，&lt;code&gt;centos 8&lt;/code&gt;推出了&lt;code&gt;centos stream&lt;/code&gt;滚动版本，看起来更像是一个正常的操作系统。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4 典型版本&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们看一下处于不同层次的几个典型版本。从应用方面来说，linux有桌面、服务器、研究用等用途。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.1、ubuntu&lt;span/&gt;&lt;/h3&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8dbCbpOPia8iagu4tEDwD7IZL44RX46NKrhnzpt7U56GQcuMntJibhkIlQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ubuntu的出现，对Linux的推广有不可磨灭的贡献。它是一个易于安装的桌面版本（也有服务器版本），界面非常漂亮。ubuntu是基于debian系统的unstable分支修改的，包管理软件是&lt;code&gt;apt-get&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;它的创建者是&lt;code&gt;Mark Shuttleworth&lt;/code&gt;，南非企业家，世界上第二名自资的太空游客。我想，无论是太空还是ubuntu，这都是梦想吧。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.2、centos&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8zXnIOOu8JLLYVJMAfBkgmMVfa8FPbCvqmcpEWCdSxa95QoGAUuPiaIQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;centos是目前最流行的服务器版本。它是RHEL源代码再编译的产物，主要是为了绕开一些法律问题。在包管理，甚至稳定性上，与红帽企业版没什么差别。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.3、archlinux&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ux7qpfkOp3Qk5fH1tnWBsFUo12by3Mgf2lFUvpUNaFD8G06WP8KhRg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;archlinux采用&lt;code&gt;滚动升级&lt;/code&gt;的模式进行发行，尽全力提供最新的稳定版本。刚开始安装，arch只提供一个基本的系统，甚至连界面都没有，对初学者不是很友好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但是，archlinux是非常干净的系统。很多软件，只有你需要的时候才会安装。它的软件和理念通常都是最新的，定制化非常强，深得许多Linux爱好者的喜爱。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.4、gentoo&lt;span/&gt;&lt;/h3&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib80ITK1Ky8SSrrhQ6JjicpcrX8eB72KHZmeDfLET1EKpKKUfibMusznEUg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的archlinux，提供了编译后的软件包。用户在安装软件时，只需要下载、解压即可。gentoo将这个过程更近一步，可以说更加的变态。它下载的是软件的源代码，然后在本地进行编译，然后安装。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这通常非常的蛋疼，因为下载、编译会花费非常长的时间，但它有一个非常大的优点，就是稳定。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这个系统比较底层，对技能要求更多，不太推荐。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.5 、LFS&lt;span/&gt;&lt;/h3&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8gXiaibo6QjI2gzQ1WucDl5EvNyyaGQpxYeG0rRwIE4MENJc7ZibaVTkzg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;LFS的全拼是“linux from scratch”，意思是从零构建一个linux系统。它有一个非常详细的安装文档，教你怎样编译内核，编译引导程序，编译和配置必要的软件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这是一个疯狂而必要的过程。如果你想要自己的Linux之上更上层楼，跟着文档做一遍是受益无穷的。你需要经过多次交叉编译，最终使用chroot命令切换到新系统进行后续操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;想做一个自己的发行版么？从这开始吧。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.4.6、kali&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8Vns8AAKcujsq34ZacTvEj7BBuuGOfJsfZ6ia0W8BicgufQ6sOF0aZRHw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;500&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;kali linux是一个非常专业的发行版。如果你在做渗透方面的工作，将是一个非常好的选择。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;发行版的安装包非常大，包含了常见的破解工具，渗透工具，攻击工具。这非常的危险，我曾用它暴力破解了非常多的wifi密码，成功的窥视了邻居的隐私。还是非常好用的。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3. 安装一个清爽的Linux系统&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;工欲善其事，必先利其器。你可能会想到买一台云主机练练手，但那毕竟要花点银子，我们可以自己安装一个。我们在上面提到，目前使用最广泛的，就是&lt;code&gt;centos&lt;/code&gt;。不论你是自建机房，还是使用类似于阿里云这样的云端环境，大多数都会提供&lt;code&gt;centos&lt;/code&gt;的安装。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可能会找到多种安装虚拟机的方式。本小节，将使用&lt;code&gt;虚拟双网卡&lt;/code&gt;的方式，准备一个纯洁的环境。这一小节，图片很多。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以阿里云为例，默认第一位就是CentOS，提供了从7.6版本到旧版本的多个镜像。&lt;/p&gt;&lt;img data-ratio=&quot;0.39891304347826084&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8RseR8SzFCAdXxWJShzIDVVZFJDgFXUuxYo3t0A2XvtK5uVue0UvprQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;920&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.1 下载&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面的文章，我们就以&lt;code&gt;CentOS 7&lt;/code&gt;稳定版本为基础环境。centos很流行，所以镜像也有很多。国内，我们从上海交大下载，速度应该会快一些。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;http://ftp.sjtu.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1908.iso&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果交大哪天不维护了。可以从这里找：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;http://centos.mirror.ndchost.com/7/isos/x86_64/CentOS-7-x86_64-Minimal-1908.iso&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了让大家学到更多的知识，我们使用&lt;code&gt;最小化&lt;/code&gt;的系统ISO。最小化的iso不到&lt;code&gt;1GB&lt;/code&gt;，而预装了很多软件的dvd有&lt;code&gt;4.3GB&lt;/code&gt;的大小。我们就用这个减肥版。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.2 安装Linux&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要想快速学习、体验Linux，最便捷的方式，就是使用虚拟机进行安装。目前，最流行的虚拟机，一个是&lt;code&gt;VMware&lt;/code&gt;，一个是&lt;code&gt;VirtualBox&lt;/code&gt;。在MacOS上还有一个&lt;code&gt;Parallels Desktop&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其中，VirtualBox免费而且跨平台，能够满足我们的需求。接下来，将一步步引导你进行安装。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(1) 点击新建，开启安装旅程。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4977324263038549&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8H7kFTvGPrbm5W9JDC80XTqRD7tEchxyRWFGYeBtu3gEWpP4KQ4I0BA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;882&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(2) 填写名称，版本。然后点击继续。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4977324263038549&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ayePYgyQVpqo6ia9wdArNbxVricFJD8ibDu04n11QvrF14GViaSum9eWLg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;882&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(3)按照你的机器配置，选择内存&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我的机器是8GB内存的，就分配给虚拟机2GB，这个已经足够用了。&lt;/p&gt;&lt;img data-ratio=&quot;0.4977324263038549&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ZIiaA6WBJcGrGY4KZpbFR0iaJia0W5x7qriap2f4ROCd3eBt6Z8jbHzMbg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;882&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(4) 创建一个虚拟磁盘&lt;/strong&gt;&lt;/p&gt;&lt;img data-ratio=&quot;0.4977324263038549&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8OpExVOeH6pU82Emtw4oM0bxdHbMJ0XW3KuSoHlpd5LSRpwTiby4XhNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;882&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;点击继续后，将弹出一个对话框。我们不用多管，一直点继续，知道对话框消失。这非常的粗暴。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(5) 接下来，点击设置。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4824175824175824&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8FkwW8tRcutdzaics7P4ylBEndbCP6UPGZdmFP1eKwSmm7fYMTic5pj1g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;910&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(6) 切换到Storage选项，选择我们下载的iso&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.606359649122807&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8CNNgIuVJYuZdMKGKsn5vWp4VbUbxfagBGkiawP3Z8HylNwGPLxJdvzw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;912&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(7) 点击启动，开始安装。&lt;/strong&gt;&lt;/p&gt;&lt;img data-ratio=&quot;0.8174726989079563&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8WwTYAz4em8Q1k1kDoPAqqr053JNF3LK9ic9UZdIMGDxVKMJbCpribVIw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;641&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用方向键切换，使得高亮聚焦在&lt;code&gt;Install CentOS 7&lt;/code&gt;上。点击确定，开始安装。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(8) 弹出一个安装界面&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来的步骤有点多，如果我们没有特别的介绍，那么直接continue就ok了。&lt;/p&gt;&lt;img data-ratio=&quot;0.7921951219512195&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8g55HUibHgaooJNo3GGdOTsyNFUevPibN4aOnOrfvic20FBptR2n2N79uA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1025&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(9) 接下来，配置磁盘分区&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7921951219512195&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8vf9XXqdqmqE91lmYw3crn94icR4E6RJuibD8h8NJORpd7G82hZ26icb2Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1025&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;依然保持默认，并按按钮&lt;code&gt;Done&lt;/code&gt;退出。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(10) 配置用户&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;linux上默认的用户名为&lt;code&gt;root&lt;/code&gt;。接下来我们设置root用户的密码为&lt;code&gt;123456&lt;/code&gt;。由于这是一个弱密码，所以需要点击两次确定退出。&lt;/p&gt;&lt;img data-ratio=&quot;0.7921951219512195&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8FllZhHnd1GC1dkB0MkicEzjVbAGhOxicbMYS3ByUra7XaqZFkogVSibdQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1025&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(11) 等待安装完毕，进行重启&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7921951219512195&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8gfPP1obkm4FJnzicMxlicCjwIrdKcPg3KIyJRbAYMqNq0OCuOynmOq0A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1025&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;(12) 安装成功&lt;/strong&gt;&lt;/p&gt;&lt;img data-ratio=&quot;0.6158113730929264&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8iaBFPsyez5yGVvMcjrlofxf3y9HibM7oicbDRHI8s8U4sEj9zdsP1KjqA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;721&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.3 联网&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这个时候，我们安装的虚拟机，还不能联网，无法把自己的意念传达出去。由于我们没有对虚拟机进行任何设置，所以使用的是默认的&lt;code&gt;NAT&lt;/code&gt;模式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;将光标聚焦到命令行窗口，然后输入命令&lt;code&gt;dhclient&lt;/code&gt;。等待几秒钟，执行&lt;code&gt;ping baidu.com&lt;/code&gt;测试以下网络，可以看到能够正常访问网络了。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6158113730929264&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8tnqEC8VcFoLrjicTu0yoy2pjLsLQiahgJExu90kjYiaIGZYPw5R9HTExg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;721&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面黑漆漆的窗口，就是我们现在的Linux界面。有人觉得很丑，就像是在玩dos，但像我这种不可救药的人，却觉得格外的亲切。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来的命令，我们不会再截图，而使用高亮的代码块表示。为了不至于让人晕头转向，请先看下图。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4516574585635359&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8nC8lI6xHL18E0PXJIvh9lw0pZ7HrArG6Whhf7pqo07F5dX1Sqjo22g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;724&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.4 外部访问虚拟机&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由于&lt;code&gt;NAT&lt;/code&gt;模式的特点，我们的虚拟机能够访问外网，但无法被外部发现。酒香竟怕巷子深。为了解决这个问题，我们需要再添加一块网卡。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在做这些更改之前，需要首先关闭虚拟机。可以强制关闭机器，也可以在命令行中输入：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;shutdown -h now&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虚拟机关闭后，再次点击设置，切换到网络适配器选项卡。如图，添加一个新的网络适配器，适配器类型为&lt;code&gt;Host-only Adapter&lt;/code&gt;。通过这块网卡，我们的宿主机就能够访问它了。&lt;/p&gt;&lt;img data-ratio=&quot;0.4824175824175824&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8icdx9mvCy50lOXYfqoaRQtKaQMrOA1ZW7bzXOqbcx4G6ypY6RW3S8bQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;910&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再次启动虚拟机，执行&lt;code&gt;dhclient&lt;/code&gt;命令后，执行&lt;code&gt;ip addr&lt;/code&gt;查看主机的ip地址。可以看到，我们现在有两块网卡，两个ip地址。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;记录下192打头的网络地址，我们会使用外部的程序，比如&lt;code&gt;XShell&lt;/code&gt;、&lt;code&gt;SecureCRT&lt;/code&gt;等，进行连接。比如，我这里的ip地址是：&lt;code&gt;192.168.99.100&lt;/code&gt;。不废话，看图。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6158113730929264&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8VDice3p4uBSdicicts5VKdg5zpx5g2dgp6beTS0btVeK1LCwNbOovYJiaA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;721&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;小提示：关于虚拟网卡的网段，如果有差异。你可以在全局设置里，改成和我一样的。&lt;/p&gt;&lt;img data-ratio=&quot;0.5582417582417583&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8QsvrNnM8pIA1wvoZ2Hg5YL2dlU3Jpm7HqAf4Ssib9VZ3dFOSUIUH3fw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;910&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.5 远程连接&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可能已经体验到，通过虚拟机自带的命令行界面进行输入，局限性非常大。通过远程连接，可以把终端界面切换到我们熟悉的操作模式，如果能够显示彩色的终端，那再好不过了。下面介绍几个工具，一般的，使用xshell的居多。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;Windows&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;XShell&lt;/code&gt; 你可能在公司内，见过你的SRE同事，运指如飞，命令字符如流水一般撒过屏幕。即使非常繁杂，难以记忆的密码，也能瞬间输入。他可能用的就是xshell。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;SecureCRT&lt;/code&gt; 比较老的一款产品，使用也较多。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;MobaXterm&lt;/code&gt; MobaXterm就是一单文件纯绿色软件，下载过来exe包直接运行即可，不需要任何的安装过程。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;它们都有免费版和专业版之分。无力购买的话，就找找破解版。但是注意，盗版汉化的ssh客户端，有些别有用心的人会在软件中植入木马，窃取你的密码、证书，这种情况已经发生过很多次。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;MacOS&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于macos用户来说，简单的很。直接使用iTerm，输入命令行即可。比如使用下面的命令连接我们的机器。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ssh root@192.168.99.100&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-cropselx1=&quot;0&quot; data-cropselx2=&quot;558&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;293&quot; data-ratio=&quot;0.5242047026279392&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8Jw4aZibhcn4VrP3dyy7WvcJWLcXSky3Fuic4xkicGhF6TyiabaicqGLnM7w/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;723&quot;/&gt;&lt;strong/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;Linux&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;唔，你都已经是Linux环境了，还折腾个啥虚拟机呢？直接用吧。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;推荐使用XShell、SecureCRT、iTerm等工具，通过ssh进行远程连接。对于一些命令拷贝、验证来说，要方便快捷的多。&lt;/p&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8vJHZAMQZNHPibwSJyAxNJxa67ZvhGTBMZocibYkk5Zsq2Mkoc8vy64fg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-ratio=&quot;0.5882352941176471&quot; data-w=&quot;850&quot;/&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4. 对Linux命令行有个初步了解&lt;br/&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;万事开头难。面对黑漆漆的Linux窗口，要勇敢的走出第一步。不要怕输错了什么，系统健壮的很。命令行通常会拥有比图形界面更高的效率，更加重要的是它可以做自动化之类的小工具，这使得生产力产生质的飞跃。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在，你已经安装好了centos，并远程连接上了它。我们拥有了它，但并不能了解它的脾气。接下来，让我们进入Linux命令行的世界。和我签订契约吧，少年。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本小节会使用非常详细的演进方式，来看一下一个命令，是怎样生成和执行的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.1、简单尝试&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;好啦，我们现在就在终端里了。什么叫做终端呢？你在很多黑客电影里，看到的黑漆漆的界面就是，它提供了一个可以输入字符串的交互式界面，至于那些闪光的、扫描机一样的东西，是不存在的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;尝试输入些什么吧。 比如：&lt;code&gt;jdsjf&lt;/code&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# jdsjf&lt;/span&gt;&lt;br/&gt;-bash: jdsjf: &lt;span&gt;command&lt;/span&gt; not found&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.36856745479833103&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8l5B4qSaQAs1qS5do1pHGicicEBgUiau1m3ELz4gh4WT3SMF34PjSOV3JA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;719&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们再次把这张图贴一下。怎么回事？命令的输出翻译成中文，就是“找不到命令”的意思。什么叫命令？就是我们上面随便输入的字符串&lt;code&gt;jdsjf&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后，我们看下提示中其他一些有用的东西。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;↓↓↓↓↓↓&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;bash&lt;/strong&gt;  代表的是我们所使用的&lt;code&gt;shell&lt;/code&gt;，shell可以认为是一个解释器，将我们的输入解释成一系列可执行的指令。现在的linux发行版，最流行的就是bash解释器，几乎每个都预装了它。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;命令找不到，证明我们的字符串bash解释不了。但是，Linux上一些目录里的文件，是可以被默认找到的，这些目录的集合，就叫&lt;code&gt;PATH&lt;/code&gt; 。PATH还是一个环境变量，我们可以通过命令查看它的尊容。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# echo $PATH&lt;/span&gt;&lt;br/&gt;/usr/&lt;span&gt;local&lt;/span&gt;/sbin:/usr/&lt;span&gt;local&lt;/span&gt;/bin:/usr/sbin:/usr/bin:/root/bin&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;想要知道系统中有哪些命令，就可以看下上面这些文件夹中，都有哪些文件。文件非常非常之多，但是大部分我们不会接触。所以，xjjdog才会写这么个东西--聚焦那些最常用，最有用的命令，最常用的参数，最有用的场景。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;命令输出后，还有一些额外的东西，比如&lt;code&gt;[root@localhost ~]&lt;/code&gt;，这部分叫做提示符，光标会一直跳动，等待你的输入。这部分是可以定制的，甚至可以定制的十分漂亮。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.2、Hello World&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;到现在为止，我们什么都没得到。按照程序员的想法来说，就要实现一个&lt;code&gt;hello world&lt;/code&gt;的程序。在终端shell里，这个过程变得简单，远比写一个java程序简单。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# echo &quot;Hello World&quot;&lt;/span&gt;&lt;br/&gt;Hello World&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如上所示，&lt;code&gt;echo&lt;/code&gt;的意思就是输出一些内容。后面的&lt;code&gt;Hello World&lt;/code&gt;，就叫做参数，它们之间以空格分隔，可以接受多个参数。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# echo &quot;Hello World&quot; , &quot;Fuck 996&quot;&lt;/span&gt;&lt;br/&gt;Hello World , Fuck 996&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上命令能够正常运行，证明echo是我们的终端能够认识的一个命令。那到底这个命令是在什么地方呢？可以使用&lt;code&gt;whereis&lt;/code&gt;命令进行查找。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# whereis echo&lt;/span&gt;&lt;br/&gt;&lt;span&gt;echo&lt;/span&gt;: /usr/bin/&lt;span&gt;echo&lt;/span&gt; /usr/share/man/man1/echo.1.gz&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;命令显示。我们的echo命令全路径，是&lt;code&gt;/usr/bin/echo&lt;/code&gt;，由于它处于PATH目录中，所以能够被识别到。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.3、将命令加入PATH&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们把上面的命令，做成一个脚本。然后将这个脚本，放到PATH目录中。不过先等等，我们要先给命令起个名字。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首先需要创建一个文件。在Linux上，创建文件使用&lt;code&gt;touch&lt;/code&gt;命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# touch jdsjf&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;命令执行后，什么都没发生，它只是创建了一个空文件。接下来，我们向其中添加一些内容。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# echo &quot;echo &#x27;Hello World&#x27;&quot; &amp;gt; jdsjf&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意符号&lt;code&gt;&amp;gt;&lt;/code&gt;，它的意思是，将前面的输出，重定向到后面的文件中。执行完上面的命令，&lt;code&gt;jdsjf&lt;/code&gt; 中的内容，就变成了&lt;code&gt;echo &#x27;Hello World&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们尝试着去执行刚才生成的命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# ./jdsjf&lt;/span&gt;&lt;br/&gt;-bash: ./jdsjf : Permission denied&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们通过相对路径的方式，来执行刚刚生成的命令。结果，终端显示我们并没有这个命令的执行权限。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实，Linux在权限控制这一方面，非常的详细。一个文件，有可读、可写、可执行三种属性。如果想要一个文件能够执行，需要给它添加执行权限，这个过程是由命令&lt;code&gt;chmod&lt;/code&gt;完成的。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# chmod u+x jdsjf&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# ./jdsjf&lt;/span&gt;&lt;br/&gt;Hello World&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们将在后面的章节，来详细介绍权限方面的知识。如上所示，命令已经能正常输出，接下来，我们把命令&lt;code&gt;移动&lt;/code&gt;到PATH中的一个目录。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# mv jdsjf /usr/local/bin/&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# jdsjf&lt;/span&gt;&lt;br/&gt;Hello World&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不需要加任何的相对路径，现在，只需要输入jdsjf，就可以正常输出一串数字。我们成功的让一个没有任何意义的字符串，表达了它的想法。虽然我们依然是它的主宰。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可以想一下下面这三个问题：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、我可以自定义一个目录，比如&lt;code&gt;/root/mybin&lt;/code&gt;，把它加入到PATH么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、我可以省略上面的touch命令，直接使用重定向生成文件么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、除了放到PATH和相对路径，还有没有其他的命令执行方式？&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5882352941176471&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8X5B8mtm7cviaiaKkMSjsnlMZmauRIeOXNjUEMicXqGJcaPQ0nmFvMULDg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;850&quot;/&gt;&lt;/figure&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.  Linux漫游方式&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;想要了解linux的基本使用方法，就要了解一个基本的事实--linux系统中，一切皆文件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不管是命令，还是文档，甚至设备，目录，套接字，在linux上对它们的操作都是一致对待的。许多开发驱动程序的小伙伴，会发现使用的一些函数，和读写文件的没什么两样（open、close、read、write、ioctl）。今天我们所说的基本操作，针对的就是普通文件和目录，本小节将详细解释相关命令。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3008356545961003&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8Tu6z1eDsdoCCPrW15Dh8AT03PYtYDia6lzcNhJS2DHfkWbPhwjiaUu4w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.1、当前路径&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1671309192200557&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8mDibeEQM3BK6tlj626BNN4bfpJF0rzxVsSBreAAkg9EkbibZQJ983GwQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;到现在为止，我们还不知道自己在系统的什么地方。在浏览器上，我们能够通过导航栏上的url，了解到自己在互联网上的具体坐标。相似的功能，是由&lt;code&gt;pwd&lt;/code&gt;命令提供的，它能够输出当前的工作目录。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;pwd&lt;/code&gt;命令是非常非常常用的命令，尤其是在一些&lt;code&gt;命令提示符&lt;/code&gt;设置不太友好的机器上。另外，它也经常用在shell脚本中，用来判断当前的运行目录是否符合需求。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有很多线上事故，都是由于没有确认当前目录所引起的。比如&lt;code&gt;rm -rf *&lt;/code&gt;这种危险的命令。在执行一些高危命令时，随时确认当前目录，是个好的习惯。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们使用root用户默认登陆后，就停留在&lt;code&gt;/root&lt;/code&gt;目录中。Linux中的目录层次，是通过&lt;code&gt;/&lt;/code&gt;进行划分的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.2、文件系统用户标准&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Linux的文件系统，从一开始就有一个规范标准。它还有一个专有缩写名词，叫做&lt;code&gt;FHS&lt;/code&gt; (Filesystem Hierarchy Standard)。FHS经过多年的演进，目录结构也越来越清晰。除了一些标准的要求，还有一些使用者之间的约定。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们大体看一下linux上的默认目录，对其有一个基本的感觉。&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;第1层&lt;/th&gt;&lt;th&gt;第二层&lt;/th&gt;&lt;th&gt;介绍&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;/bin&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;目录/usr/bin的软链接&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/sbin&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;目录/usr/sbin的软链接&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/lib&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;目录/usr/lib的软链接&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/usr&lt;/td&gt;&lt;td&gt;/bin&lt;/td&gt;&lt;td&gt;存放一些常用的命令&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/usr&lt;/td&gt;&lt;td&gt;/sbin&lt;/td&gt;&lt;td&gt;存放一些管理员常用的命令&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/usr&lt;/td&gt;&lt;td&gt;/lib&lt;/td&gt;&lt;td&gt;用来存放动态库和一些模块文件&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/sys&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;内核中的数据结构的可视化接口&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/proc&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;内存映像&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/run&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;内存映像&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/boot&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;存放引导程序，内核相关文件&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/dev&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;存放一些&lt;code&gt;设备文件&lt;/code&gt;，比如光盘&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/etc&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;用于存储一些全局的、应用的配置文件&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/var&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;与/var/run一样，存放的是系统运行时需要的文件，比如mysql的pid等&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/tmp&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;非常特殊的临时文件夹，断电丢失&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/home&lt;/td&gt;&lt;td&gt;/**&lt;/td&gt;&lt;td&gt;用户目录，比如我的目录是/home/xjjdog&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/root&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;root用户的home目录&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;home&lt;/code&gt; 平常，我们打交道最多的目录，就集中在自己的用户目录，我们可以在里面做任何操作，比如我们现在root用户的&lt;code&gt;/root&lt;/code&gt;目录。一些自己的资料，比如视频、音频、下载的文件，或者做测试用的一些数据资料，就可以自行在这些目录下规划。root用户比较特殊，普通用户的私人目录都是在/home下的。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;/etc&lt;/code&gt; etc目录是经常要打交道的目录，存放了一些全局的系统配置文件和应用配置文件。比如你安装了php，或者nginx，它们的配置文件就躺在/etc目录下的某个文件夹里。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;/var&lt;/code&gt; var目录存放一些运行中的数据，有必须的，也有非必须的。一些黑客入侵之后，会在这里面的某些文件中留下痕迹，他们会着重进行清理。var目录还是一些应用程序的默认数据存放之地，比如mysql的数据文件。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;/tmp&lt;/code&gt; 目录是一个特殊的临时目录，文件在断电以后就消失了。但这个目录，所有的用户，都有写入权限，通常用来做文件交换用。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;/proc&lt;/code&gt;和&lt;code&gt;/sys&lt;/code&gt;目录，是两个神奇的目录。它们两个是一种伪文件系统，可以通过修改其中一些文件的状态和内容，来控制程序的行为（修改后会直接刷到内存上，太酷了）。刚开始的时候，只有proc目录，由于里面内容有多又乱，后面又规划出sys目录，用来控制内核的一些行为。如果你在调优一些系统参数，和这些文件打交道的时间比较多。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;还有几个空的目录，我们没有列在上面的表格上。比如&lt;code&gt;/srv&lt;/code&gt;目录，通常会把一些web服务的资料，比如nginx的，放在这里面。但是，这并不是强制要求的，所以我见过的&lt;code&gt;/srv&lt;/code&gt;目录，通常会一直是空的。同样的，&lt;code&gt;/opt&lt;/code&gt;目录也是这样一个存在，你就当它不存在就行。这都属于使用者规划的范畴，自定义性非常强。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;在使用Linux系统的时候，也可以创建自己的目录。比如，我就喜欢自己创建一个叫做&lt;code&gt;/data&lt;/code&gt;的目录，用来存放一些数据库相关的内容。举个例子，&lt;code&gt;/data/mysql&lt;/code&gt;存放mariadb的数据，而&lt;code&gt;/data/es/&lt;/code&gt;存放elasticsearch的索引内容。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;linux上的文件类型有很多，它们大部分都分门别类的存放在相应的目录中，比如/dev目录下，就是一些设备文件；/bin文件下，是一些可以执行命令。通常都好记的很。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.3、查看文件列表&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，上面的表格内容，我是怎么看到的呢，靠记忆么？&lt;code&gt;ls&lt;/code&gt;命令，能够列出相关目录的文件信息。可以被评为linux下最勤劳的命令标兵。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5485636114911081&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8XsxuibfWibib8szOBGricQysdIjn2XfHGb4h3BEhzrzbFMnEMJoibcLXuKg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;731&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;现在的终端，都能够输出彩色的信息，非常的直观。&lt;code&gt;oh-my-zsh&lt;/code&gt;和&lt;code&gt;oh-my-bash&lt;/code&gt;等项目，可以让你的终端更加的漂亮。把它加入到你的研究清单里吧。&lt;/p&gt;&lt;/blockquote&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost /]&lt;span&gt;# ls /&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 注意：ls可以接受路径参数，你不用先跳转，就可以输出相关信息&lt;/span&gt;&lt;br/&gt;bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var&lt;br/&gt;[root@localhost /]&lt;span&gt;# ls -l /&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 带上 -l参数，可以查看一些更加详细的信息。&lt;/span&gt;&lt;br/&gt;total 20&lt;br/&gt;lrwxrwxrwx.   1 root root    7 Nov  3 20:24 bin -&amp;gt; usr/bin&lt;br/&gt;dr-xr-xr-x.   5 root root 4096 Nov  3 20:34 boot&lt;br/&gt;drwxr-xr-x.  19 root root 3080 Nov  3 21:19 dev&lt;br/&gt;drwxr-xr-x.  74 root root 8192 Nov  3 20:34 etc&lt;br/&gt;drwxr-xr-x.   2 root root    6 Apr 11  2018 home&lt;br/&gt;lrwxrwxrwx.   1 root root    7 Nov  3 20:24 lib -&amp;gt; usr/lib&lt;br/&gt;lrwxrwxrwx.   1 root root    9 Nov  3 20:24 lib64 -&amp;gt; usr/lib64&lt;br/&gt;drwxr-xr-x.   2 root root    6 Apr 11  2018 media&lt;br/&gt;drwxr-xr-x.   2 root root    6 Apr 11  2018 mnt&lt;br/&gt;drwxr-xr-x.   2 root root    6 Apr 11  2018 opt&lt;br/&gt;dr-xr-xr-x. 108 root root    0 Nov  3 21:19 proc&lt;br/&gt;dr-xr-x---.   2 root root  135 Nov  4 07:53 root&lt;br/&gt;drwxr-xr-x.  24 root root  740 Nov  3 21:20 run&lt;br/&gt;lrwxrwxrwx.   1 root root    8 Nov  3 20:24 sbin -&amp;gt; usr/sbin&lt;br/&gt;drwxr-xr-x.   2 root root    6 Apr 11  2018 srv&lt;br/&gt;dr-xr-xr-x.  13 root root    0 Nov  3 21:19 sys&lt;br/&gt;drwxrwxrwt.   9 root root 4096 Nov  4 03:40 tmp&lt;br/&gt;drwxr-xr-x.  13 root root  155 Nov  3 20:24 usr&lt;br/&gt;drwxr-xr-x.  19 root root  267 Nov  3 20:34 var&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ls最常用的，就是加参数&lt;code&gt;l&lt;/code&gt;或者参数&lt;code&gt;a&lt;/code&gt;。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.3.1、详细信息&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5125348189415042&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8rLtTkknM495bnJ9UxicmhVeZMa3BkRbrsHGntDlCO3JNJ03OaH7sr1A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;加上参数&lt;code&gt;l&lt;/code&gt;，能够看到文件的一些权限信息已经更新日期等。但我们还看到了一些更有意思的东西。比如：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;lib -&amp;gt; usr/lib&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面表示的，是软链接信息。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;就如同我们上面表格所展示的一样，&lt;code&gt;lib&lt;/code&gt;目录，是&lt;code&gt;/usr/lib&lt;/code&gt;的快捷方式，它们之中的内容，没有什么两样。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于&lt;code&gt;ls -l&lt;/code&gt;展示的更加详细的内容，可以参照我下面的这张图。我们将在了解后面小节的内容后，再次对这张图进行回顾。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.36995827538247567&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8TCb9DcnVGpFeeZrYscFKG8ItD4jJm2xkJAE9nia8BuThgDWghHfw7aw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;719&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.3.2 隐藏文件&lt;span/&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;直接在你的/root目录里，执行&lt;code&gt;ls -al&lt;/code&gt;，你会看到更多东西。这些额外的隐藏文件，都是以&lt;code&gt;.&lt;/code&gt;开头，以配置文件居多。这就是参数&lt;code&gt;a&lt;/code&gt;的作用。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# ls -al&lt;/span&gt;&lt;br/&gt;total 28&lt;br/&gt;dr-xr-x---.  2 root root  135 Nov  4 07:53 .&lt;br/&gt;dr-xr-xr-x. 17 root root  224 Nov  3 20:28 ..&lt;br/&gt;-rw-------.  1 root root 1273 Nov  3 20:28 anaconda-ks.cfg&lt;br/&gt;-rw-------.  1 root root  246 Nov  4 11:41 .bash_history&lt;br/&gt;-rw-r--r--.  1 root root   18 Dec 28  2013 .bash_logout&lt;br/&gt;-rw-r--r--.  1 root root  176 Dec 28  2013 .bash_profile&lt;br/&gt;-rw-r--r--.  1 root root  176 Dec 28  2013 .bashrc&lt;br/&gt;-rw-r--r--.  1 root root  100 Dec 28  2013 .cshrc&lt;br/&gt;-rw-r--r--.  1 root root  129 Dec 28  2013 .tcshrc&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;细心的同学，应该会注意到两个特殊的目录。&lt;code&gt;.&lt;/code&gt;和&lt;code&gt;..&lt;/code&gt;。前者表示的是当前目录，而后者表示的是上层目录。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用&lt;code&gt;cd&lt;/code&gt;命令，将在这些目录中，自由穿梭。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;小技巧：如果你对英文日期阅读困难，可以使用&lt;code&gt;ls -al --full-time&lt;/code&gt;查看可读的日期。&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.4、切换目录&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1671309192200557&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8WWLROKVkp98ial3p8CPuibick3OT7Jq12fREM7CuOLU2s18sibhC80HAeA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行cd命令，可以将工作目录切换到目标文件夹。为了展示cd命令的效果。请在root用户下，执行下面的命令，这将创建一个7层的目录。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;cd&lt;/span&gt;&lt;br/&gt;mkdir -p a1/b2/c3/d4/e5/f6/{g7,g8,g9,g10}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们使用cd命令，切换到最后一层。然后，我们使用&lt;code&gt;..&lt;/code&gt;切换到上层目录。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# cd a1/b2/c3/d4/e5/f6/g7&lt;/span&gt;&lt;br/&gt;[root@localhost g7]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3/d4/e5/f6/g7&lt;br/&gt;&lt;br/&gt;[root@localhost g7]&lt;span&gt;# cd ..&lt;/span&gt;&lt;br/&gt;[root@localhost f6]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3/d4/e5/f6&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，切换到上面n层目录，只需使用多层级的&lt;code&gt;../&lt;/code&gt;即可。有几个特殊的变量，需要说明一下。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;../&lt;/code&gt; 指的是上层目录&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;../../&lt;/code&gt; 指的是上两层目录&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;./&lt;/code&gt; 指的是当前目录&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;~&lt;/code&gt; 指的是当前的用户目录，这是一个缩写符号&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;-&lt;/code&gt; 使用它，可以在最近两次的目录中来回切换&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们来使用命令把上面这些特殊变量验证一下。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 跳转到用户根目录&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# cd ~&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 进入到第三层目录&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cd a1/b2/c3/&lt;/span&gt;&lt;br/&gt;[root@localhost c3]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 跳回到前三层目录&lt;/span&gt;&lt;br/&gt;[root@localhost c3]&lt;span&gt;# cd ../../..&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 跳到上次访问的目录&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cd -&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3&lt;br/&gt;[root@localhost c3]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 进入当前目录：等于什么都没干&lt;/span&gt;&lt;br/&gt;[root@localhost c3]&lt;span&gt;# cd ./&lt;/span&gt;&lt;br/&gt;[root@localhost c3]&lt;span&gt;# pwd&lt;/span&gt;&lt;br/&gt;/root/a1/b2/c3&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上就是cd命令的常用用法。现在，我们返回头来看一下&lt;code&gt;mkdir&lt;/code&gt;。顾名思义，就是创建目录的意思，但一般在工作中，都会加上&lt;code&gt;-p&lt;/code&gt;参数，这样就可以一次性创建多层目录。注意mkdir后面的大括号&lt;code&gt;{}&lt;/code&gt;，可以一次性的指定多个目录进行创建，这通常能节省很多时间。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5.5、文件操作&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.45125348189415043&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8YI2vCl6cbJkn81IFmaaaawsPGCtzuiaplaON4oiazyXibEV7jicIwk2tNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用命令行操作文件，是非常方便的。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;touch&lt;/code&gt; 新建文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;cp&lt;/code&gt; 复制文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;mv&lt;/code&gt; 移动文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;rm&lt;/code&gt; 删除文件&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这四个风骚的命令，主宰着文件资料的去向。我们依然使用上面创建的目录，进行接下来的操作。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 创建三个文件&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# touch long-long-long.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# touch 996.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# touch icu.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# ls&lt;/span&gt;&lt;br/&gt;996.txt  a1  anaconda-ks.cfg  icu.txt  long-long-long.txt&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 复制一个文件&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cp 996.txt 007.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# mv long-long-long.txt short.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# ls&lt;/span&gt;&lt;br/&gt;007.txt  996.txt  a1  anaconda-ks.cfg  icu.txt  short.txt&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 移动996.txt到a1目录，icu.txt到a1/b2目录&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 删除short.txt&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# mv 996.txt a1/&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# mv icu.txt a1/b2/&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# rm short.txt&lt;/span&gt;&lt;br/&gt;rm: remove regular empty file ‘short.txt’? y&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 递归删除a1目录&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# rm -rvf a1/&lt;/span&gt;&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5/f6/g7’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5/f6/g8’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5/f6/g9’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5/f6/g10’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5/f6’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4/e5’&lt;br/&gt;removed directory: ‘a1/b2/c3/d4’&lt;br/&gt;removed directory: ‘a1/b2/c3’&lt;br/&gt;removed ‘a1/b2/icu.txt’&lt;br/&gt;removed directory: ‘a1/b2’&lt;br/&gt;removed ‘a1/996.txt’&lt;br/&gt;removed directory: ‘a1/’&lt;br/&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# ls&lt;/span&gt;&lt;br/&gt;007.txt   anaconda-ks.cfg&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5334261838440112&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8v60DNbrUt4AwxfzQicZwbdOw7EGTVnTL6oICZSYQ6M1QZbyMYlwcUzg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过一番操作以后，只剩下了007了。除了上面基本的操作，接下来我要介绍一些更加重要的功能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以看到在使用&lt;code&gt;rm&lt;/code&gt;删除文件的时候，进行了一次提示。这是为了避免误删除一些东西，但有时候，你需要不显示这种提示，就可以加&lt;code&gt;-f&lt;/code&gt;参数。&lt;code&gt;f&lt;/code&gt;参数对于cp、mv等命令来说，同样适用，它是&lt;code&gt;force&lt;/code&gt;的意思。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;rm -f file&lt;br/&gt;cp -f file1 file2&lt;br/&gt;mv -f file1 file2&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，还有一个参数&lt;code&gt;-r&lt;/code&gt;，这是递归的意思。我们的目录和文件，通常有多个层次，递归可以把操作全部作用于上面，比如上面的递归删除a1目录。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 警告：以下命令会造成严重后果&lt;/span&gt;&lt;br/&gt;rm -rf /&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的这个命令，你一定经常看到。这不是笑话，已经有很多用户因此丢失了数据，这就是传说中的&lt;code&gt;删根&lt;/code&gt;，最终你将一无所有。那参数&lt;code&gt;v&lt;/code&gt;又是干什么用的呢？加上它之后，可以看到命令详细的执行过程。在平常的操作中，我一般都加上。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.3286908077994429&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib87uuDakiceicDEy9f4UrW068icQPnohboJ1Of0YpZMsBteLqkcnTxE7jNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.开始操作文件&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5882352941176471&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8LqTKVn7k8cBnYN5WFmaG74TqAeES5jl7UcgM1Gd7vaLAR35jocughw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;850&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可能已经了解到，&lt;code&gt;ll -l&lt;/code&gt;命令的第一列，能够显示linux的文件类型。请对此有一个大体的印象，因为后面的很多命令，会用到这些知识。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;-&lt;/code&gt; 表示普通文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;d&lt;/code&gt; 表示目录文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;l&lt;/code&gt; 表示链接文件，比如快捷方式&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;s&lt;/code&gt; 套接字文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;c&lt;/code&gt; 字符设备文件，比如&lt;code&gt;/dev/&lt;/code&gt;中的很多文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;b&lt;/code&gt; 表示块设备文件，比如一些磁盘&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;p&lt;/code&gt; 管道文件&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Linux上的文件可以没有后缀，而且可以创建一些违背直觉的文件。比如后缀是png，但它却是一个压缩文件（通常不会这么做）。大学时，就有聪明的同学这样藏小电影，效果很好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查看文件的具体类型，可以使用&lt;code&gt;file&lt;/code&gt;命令，它很聪明，能够识别很多文件格式。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# file /etc&lt;/span&gt;&lt;br/&gt;/etc: directory&lt;br/&gt;[root@localhost ~]&lt;span&gt;# file /etc/group&lt;/span&gt;&lt;br/&gt;/etc/group: ASCII text&lt;br/&gt;[root@localhost ~]&lt;span&gt;# file /dev/log&lt;/span&gt;&lt;br/&gt;/dev/&lt;span&gt;log&lt;/span&gt;: socket&lt;br/&gt;[root@localhost ~]&lt;span&gt;# file /dev/log&lt;/span&gt;&lt;br/&gt;/dev/&lt;span&gt;log&lt;/span&gt;: socket&lt;br/&gt;[root@localhost ~]&lt;span&gt;# file /bin&lt;/span&gt;&lt;br/&gt;/bin: symbolic link to `usr/bin&lt;span&gt;&#x27;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本部分的操作，面向的就是&lt;code&gt;ASCII text&lt;/code&gt;类型的，普通文本文件。接下来，我们要创建一些文件。然后写入一些内容到文件里，以便进行后续的操作。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.1、创建一个文件&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.1.1、数字序列&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.16852367688022285&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8nFdib1Eq8m35QaMLZckZzfQFmn2R7ucmibXcqjciaAia86SEDnibHI1arvw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用重定向符，能够直接生成文件。下面，我要生成10到20的数字，每一个数字单独一行，写入一个叫做&lt;code&gt;spring&lt;/code&gt;的文件。巧的很，&lt;code&gt;seq&lt;/code&gt;命令可以完成这个过程。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;seq 10 20 &amp;gt;&amp;gt; spring&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们在前面提到过&lt;code&gt;&amp;gt;&lt;/code&gt;的意思，是将前面命令的输出，重定向到其他地方。在这里，我们用了两个&lt;code&gt;&amp;gt;&lt;/code&gt;，它依然是重定向的意思，但表示的是，在原来文件的基础上，&lt;code&gt;追加&lt;/code&gt;内容。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;也就是编程语言里的&lt;code&gt;w+&lt;/code&gt;和&lt;code&gt;a+&lt;/code&gt;的意思。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.1.2、查看内容&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.2116991643454039&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8yPIaDnXFoefZesbtM9K52Mg2Tyhx6FnMrBw2ECCicK7D8iagC7lsuYlA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了查看文件的生成效果，可以使用cat命令检测。cat命令将会把文件的内容，输出打印到终端上。如果加上参数&lt;code&gt;n&lt;/code&gt;，甚至可以打印行号。效果如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# cat spring&lt;/span&gt;&lt;br/&gt;10&lt;br/&gt;11&lt;br/&gt;12&lt;br/&gt;13&lt;br/&gt;14&lt;br/&gt;15&lt;br/&gt;16&lt;br/&gt;17&lt;br/&gt;18&lt;br/&gt;19&lt;br/&gt;20&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat -n spring&lt;/span&gt;&lt;br/&gt;1 10&lt;br/&gt;2 11&lt;br/&gt;3 12&lt;br/&gt;4 13&lt;br/&gt;5 14&lt;br/&gt;6 15&lt;br/&gt;7 16&lt;br/&gt;8 17&lt;br/&gt;9 18&lt;br/&gt;10 19&lt;br/&gt;11 20&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;除了查看文件内容，cat命令通常用在更多的地方。只有和其他命令联合起来，它才会觉得生活有意义。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 合并a文件和b文件到c文件&lt;/span&gt;&lt;br/&gt;cat a  b&amp;gt;&amp;gt; c&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 把a文件的内容作为输入，使用管道处理。我们在后面介绍&lt;/span&gt;&lt;br/&gt;cat a | cmd&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 写入内容到指定文件。在shell脚本中非常常用。我们在后面会多次用到这种写法&lt;/span&gt;&lt;br/&gt;cat &amp;gt; index.html &amp;lt;&amp;lt;EOF&lt;br/&gt;&amp;lt;html&amp;gt;&lt;br/&gt;    &amp;lt;head&amp;gt;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&lt;br/&gt;    &amp;lt;body&amp;gt;&amp;lt;/body&amp;gt;&lt;br/&gt;&amp;lt;/html&amp;gt;&lt;br/&gt;EOF&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由于我们的文件不大，cat命令没有什么危害。但假如文件有几个&lt;code&gt;GB&lt;/code&gt;，使用cat就危险的多，这只叫做&lt;code&gt;猫&lt;/code&gt;的小命令，会在终端上疯狂的进行输出，你可以通过多次按&lt;code&gt;ctrl+c&lt;/code&gt;来终止它。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.2、平和的查看文件&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4178272980501393&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib86jLia6Y1ficHb3fd2ib7VmdFDpDIbHJ18xNWmq66FaOibSeIZElbH98M9A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;既然cat命令不适合操作大文件，那一定有替换的方案。less和more就是。由于less的加载速度比more快一些，所以现在一般都使用&lt;code&gt;less&lt;/code&gt;。它最主要的用途，是用来分页浏览文件内容，并提供一些快速查找的方式。less是一个&lt;code&gt;交互式&lt;/code&gt;的命令，你需要使用一些快捷键来控制它。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这次我们使用seq生成&lt;code&gt;一千万&lt;/code&gt;行记录，足足有&lt;code&gt;76MB&lt;/code&gt;大小，然后用less打开它。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# seq 10000000 &amp;gt; spring&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# du -h spring&lt;/span&gt;&lt;br/&gt;76M spring&lt;br/&gt;[root@localhost ~]&lt;span&gt;# less spring&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于less，一般操作如下：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;空格&lt;/code&gt; 向下滚屏翻页&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;b&lt;/code&gt; 向上滚屏翻页&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;/&lt;/code&gt; 进入查找模式，比如&lt;code&gt;/1111&lt;/code&gt;将查找1111字样&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;q&lt;/code&gt; 退出less&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;g&lt;/code&gt; 到开头&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;G&lt;/code&gt; 去结尾&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;j&lt;/code&gt; 向下滚动&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;k&lt;/code&gt; 向上滚动，这两个按键和vim的作用非常像&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.3、文件头尾&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3816155988857939&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8GmYHoVmZrUa0aiav9BSnupmXBgC5X9C40IbpB6xEb14YkdQ9QszWJFw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;head可以显示文件头，tail可以显示文件尾。它们都可以通过参数&lt;code&gt;-n&lt;/code&gt;，来指定相应的行数。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# head -n 3 spring&lt;/span&gt;&lt;br/&gt;1&lt;br/&gt;2&lt;br/&gt;3&lt;br/&gt;[root@localhost ~]&lt;span&gt;# tail -n 3 spring&lt;/span&gt;&lt;br/&gt;9999998&lt;br/&gt;9999999&lt;br/&gt;10000000&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于部分程序员来说，&lt;code&gt;tail -f&lt;/code&gt;或许是最常用的命令之一。它可以在控制终端，实时监控文件的变化，来看一些滚动日志。比如查看nginx或者tomcat日志等等。通常情况下，日志滚动的过快，依然会造成一些困扰，需要配合grep命令达到过滤效果。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 滚动查看系统日志&lt;/span&gt;&lt;br/&gt;tail -f /var/&lt;span&gt;log&lt;/span&gt;/messages&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 滚动查看包含info字样的日志信息&lt;/span&gt;&lt;br/&gt;tail -f /var/&lt;span&gt;log&lt;/span&gt;/messages | grep info&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;对于tail命令来说，还有一个大写的参数&lt;code&gt;F&lt;/code&gt;。这个参数，能够监控到重新创建的文件。比如像一些log4j等日志是按天滚动的，&lt;code&gt;tail -f&lt;/code&gt;无法监控到这种变化。&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.4、查找文件&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.575208913649025&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8u6AFX9BeOuPLnk9djQlkPyBFJLicYfKtKWoHeXcHLPHDrA3JkTldNlg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;考虑下面这个场景。我们需要找一个叫做&lt;code&gt;decorator.py&lt;/code&gt;的文件，这个文件是个幽灵，可能存在于系统的任何地方。&lt;code&gt;find&lt;/code&gt;命令，能够胜任这次捉鬼行动。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们使用&lt;code&gt;find&lt;/code&gt;命令，从根目录找起，由于系统的文件过多，下面的命令可能会花费一段时间。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost site-packages]&lt;span&gt;# find / -name decorator.py  -type f&lt;/span&gt;&lt;br/&gt;/usr/lib/python2.7/site-packages/decorator.py&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用time命令，可以看到具体的执行时间。执行还是挺快的么！秒出！&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost site-packages]&lt;span&gt;# time find / -name decorator.py  -type f&lt;/span&gt;&lt;br/&gt;/usr/lib/python2.7/site-packages/decorator.py&lt;br/&gt;&lt;br/&gt;real 0m0.228s&lt;br/&gt;user 0m0.098s&lt;br/&gt;sys 0m0.111s&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;find命令会查出一个路径的集合。通常是查询出来之后，进行额外的处理操作，一般配合&lt;code&gt;xargs&lt;/code&gt;命令使用（xargs读取输入，然后逐行处理），至于find的&lt;code&gt;exec&lt;/code&gt;参数？忘了它吧，不好用！&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 删除当前目录中的所有class文件&lt;/span&gt;&lt;br/&gt;find . | grep .class$ | xargs rm -rvf&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 找到/root下一天前访问的文件，type后面的类型参见文章开头&lt;/span&gt;&lt;br/&gt;find /root  -atime 1 -&lt;span&gt;type&lt;/span&gt; f&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 查找10分钟内更新过的文件&lt;/span&gt;&lt;br/&gt;find /root  -cmin  -10&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 找到归属于root用户的文件&lt;/span&gt;&lt;br/&gt;find /root -user root&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 找到大于1MB的文件，进行清理&lt;/span&gt;&lt;br/&gt;find /root -size  +1024k  -&lt;span&gt;type&lt;/span&gt; f | xargs rm -f&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;find的参数非常非常多，记不住怎么办？除了常用的，其实都可以通过&lt;code&gt;man&lt;/code&gt;命令查看。man的操作也和vi非常的类似，输入&lt;code&gt;/EXAMPLES&lt;/code&gt;，会看到很多样例。不过我觉得还是上面列出的这些命令更加的适用。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.4.1、数据来源&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上图中，你会看到mtime,ctime,atime类似的字样，它们的数据来自于何处呢？接下来我们顺理成章的看一下&lt;code&gt;stat&lt;/code&gt;命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# stat spring&lt;/span&gt;&lt;br/&gt;  File: ‘spring’&lt;br/&gt;  Size: 78888897   Blocks: 154080     IO Block: 4096   regular file&lt;br/&gt;Device: fd00h/64768d Inode: 8409203     Links: 1&lt;br/&gt;Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)&lt;br/&gt;Context: unconfined_u:object_r:admin_home_t:s0&lt;br/&gt;Access: 2019-11-04 18:01:46.698635718 -0500&lt;br/&gt;Modify: 2019-11-04 17:59:38.823458157 -0500&lt;br/&gt;Change: 2019-11-04 17:59:38.823458157 -0500&lt;br/&gt; Birth: -&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这不就是文件属性么？从文件大小，到文件类型，甚至到最后修改、访问时间，都可以从这里获取。Linux文件系统以块为单位存储信息，为了找到某一个文件所在存储空间的位置，会用&lt;code&gt;i节点&lt;/code&gt;(inode) 对每个文件进行索引，你可以认为它是一个文件指针。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;文件的字节数&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;文件拥有者user&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;文件所属组group&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;文件的读、写、执行权限&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;文件的时间戳&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;ctime指inode上一次变动的时间&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;mtime指文件内容上一次变动的时间&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;atime指文件上一次打开的时间。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;section&gt;链接数，即有多少文件名指向这个inode （ln命令）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;文件数据block的位置（具体的数据位置）&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于inode是一个比较大的话题，也是比较重要的知识点，有兴趣的可以自行搜索。我们只需要知道这些信息是从这里来的就可以了。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.4.2、小练习&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果我只想获取&lt;code&gt;Modify&lt;/code&gt;这个数值，可以组合使用一下上面学到的命令。首先获取最后三行，然后获取首行。效果如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# stat spring | tail -n 3 | head -n 1&lt;/span&gt;&lt;br/&gt;Modify: 2019-11-04 17:59:38.823458157 -0500&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面几个命令，效果是与上面等价的，输出结果也是一模一样。正所谓条条大路通罗马，接下来，我们首先介绍一下出现频率较高的&lt;code&gt;grep&lt;/code&gt;。另外，我们在上面的这些命令中，多次使用了&lt;code&gt;|&lt;/code&gt;，这是Linux中非常重要的管道概念，下面也会着重介绍。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;stat&lt;/span&gt; spring | head -n 7 | tail -n 1&lt;br/&gt;&lt;span&gt;stat&lt;/span&gt; spring | grep Modify&lt;br/&gt;&lt;span&gt;stat&lt;/span&gt; spring | sed -n &lt;span&gt;&#x27;7p&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;stat&lt;/span&gt; spring | awk &lt;span&gt;&#x27;NR==7&#x27;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.5、字符串匹配&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5738161559888579&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8daldkdTk7xswrLXGCP1Cq1dYfXvh4snCNAwv7sPskfMZBG075T3zVw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;grep用来对内容进行过滤，带上&lt;code&gt;--color&lt;/code&gt;参数，可以在支持的终端可以打印彩色，参数&lt;code&gt;n&lt;/code&gt;则用来输出具体的行数，用来快速定位。这是一个必须要熟练使用的命令。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如：查看nginx日志中的POST请求。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;grep -rn --color POST access.log&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;推荐每次都使用这样的参数。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果我想要看某个异常前后相关的内容，就可以使用ABC参数。它们是几个单词的缩写，经常被使用。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;A  after  内容后n行&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;B  before  内容前n行&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;C  内容前后n行&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;就像是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 查看Exception关键字的前2行和后10行&lt;/span&gt;&lt;br/&gt;grep -rn --color Exception -A10 -B2   error.log&lt;br/&gt;&lt;br/&gt;&lt;span&gt;#查找/usr/下所有import关键字，已经它们所在的文件和行数&lt;/span&gt;&lt;br/&gt;grep -rn --color import /usr/&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5800273597811217&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8ib1bSQFFAnyjIaKgB83XHuVVaX9uxqaWrGKVL7dQjWK5SNt1Jjy3PkQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;731&quot;/&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.6、管道&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上面的命令中，我们多次用到了&lt;code&gt;|&lt;/code&gt;，这貌似可以完成一些神奇的事情。&lt;code&gt;|&lt;/code&gt;是&lt;code&gt;pipe&lt;/code&gt;的意思，它可以把多个命令联系起来。通常，命令有下面的关联方式：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;;&lt;/code&gt; 顺序执行，如&lt;code&gt;mkdir a;rmdir a&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; 条件执行，如&lt;code&gt;mkdir a &amp;amp;&amp;amp; rmdir a&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;||&lt;/code&gt; 条件执行，如&lt;code&gt;mkdir a || rmdir a&lt;/code&gt;，后面的命令将不执行&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;|&lt;/code&gt; 管道，前面命令的输出，将作为后面命令的输入&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前三种的命令关联，是非常简单有逻辑的，非常的好理解。而管道，却有自己的特点。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接触过编程语言的都知道&lt;code&gt;stdin&lt;/code&gt;、&lt;code&gt;stdout&lt;/code&gt;、&lt;code&gt;stderr&lt;/code&gt;的概念。让我们重新组织一下针对于管道的定义：前面命令的输出(stdin)，将作为后面命令的输入(stdout)。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们拿一行命令来说明。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;seq 20 100 | head -n 50 | tail -n 1&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面命令，将输出69。69是个神奇的数字，它是怎么办到的呢？我们来一张小图，一切就豁然开朗了。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5264623955431755&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8r1mOhBNW5dibAgkn9DZO2BLyTLpdrZk7VlC2ledM2FpNwoFljDPOJPg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于输入输出和错误，linux使用一个&lt;code&gt;数字&lt;/code&gt;进行缩写，这在一些脚本中，甚至在一些安装文件中，会经常用到。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;0 表示stdin标准输入&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;1 表示stdout标准输出&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;2 表示stderr标准错误&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过类似&lt;code&gt;2&amp;gt;&amp;amp;1&lt;/code&gt;的语法，可以把错误信息定向到标准输出。我们用命令来证明一下。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 错误信息无法输出到文件&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat aaaaaaaaa &amp;gt; b&lt;/span&gt;&lt;br/&gt;cat: aaaaaaaaa: No such file or directory&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat b&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 错误信息被重定向了&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat aaaaaaaaa &amp;gt; b 2&amp;gt;&amp;amp;1&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat b&lt;/span&gt;&lt;br/&gt;cat: aaaaaaaaa: No such file or directory&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.7、排序&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.520891364902507&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8NojnibN680tIDFKXMcBCrPRmtd4WorjzCFVsfsylUVmicYHFjkibBfO1Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在了解管道的工作原理之后，就可以介绍一下sort命令了。它通常可以和uniq（去重）命令联合，完成一些排序、去重的操作。首先使用cat命令，生成如下内容的文件。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cat &amp;gt; sort.txt &amp;lt;&amp;lt;EOF&lt;br/&gt;1 11&lt;br/&gt;3 22&lt;br/&gt;2 44&lt;br/&gt;4 33&lt;br/&gt;5 55&lt;br/&gt;6 66&lt;br/&gt;6 66&lt;br/&gt;EOF&lt;br/&gt;```bash&lt;br/&gt;接下来让这两个命令上台表演一下。sort可以使用-t指定分隔符，使用-k指定要排序的列。但是空格，是不需要做这些画蛇添足的指定的。&lt;br/&gt;```bash&lt;br/&gt;&lt;span&gt;# 根据第一列倒序排序&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat sort.txt | sort  -n -k1 -r&lt;/span&gt;&lt;br/&gt;6 66&lt;br/&gt;6 66&lt;br/&gt;5 55&lt;br/&gt;4 33&lt;br/&gt;3 22&lt;br/&gt;2 44&lt;br/&gt;1 11&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 统计每一行出现的次数，并根据出现次数倒序排序&lt;/span&gt;&lt;br/&gt;&lt;span&gt;# 此时，行数由7变成了6&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat sort.txt | sort  | uniq -c  | sort -n -k1 -r&lt;/span&gt;&lt;br/&gt;2 6 66&lt;br/&gt;1 5 55&lt;br/&gt;1 4 33&lt;br/&gt;1 3 22&lt;br/&gt;1 2 44&lt;br/&gt;1 1 11&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意：uniq命令，一般用在已经经过排序的结果集上。所以，很多情况需要首先使用sort命令进行排序后，再使用uniq命令。新手经常会忘记第一步，造成命令不能正常运行。&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.8、小练习&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本部分，我们从文件的属性开始说起，了解了几个对文件操作的常用命令。并顺便介绍了管道的概念。下面，我们来练习一下。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;找到系统中所有的&lt;code&gt;grub.cfg&lt;/code&gt;文件，并输出它的行数。&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分析：首先需要使用find命令，找到这些文件。然后使用xargs逐行处理。最后，使用wc命令，统计确切的行数。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost grub2]&lt;span&gt;# find / | grep grub.cfg | xargs wc -l&lt;/span&gt;&lt;br/&gt;141 /boot/grub2/grub.cfg&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;输出系统的group列表&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cat /etc/group | awk -F &lt;span&gt;&#x27;:&#x27;&lt;/span&gt; &lt;span&gt;&#x27;{print $1}&#x27;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;下面这个命令输出nginx日志的ip和每个ip的pv，pv最高的前10&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 2019-06-26T10:01:57+08:00|nginx001.server.ops.pro.dc|100.116.222.80|10.31.150.232:41021|0.014|0.011|0.000|200|200|273|-|/visit|sign=91CD1988CE8B313B8A0454A4BBE930DF|-|-|http|POST|112.4.238.213&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;awk -F&lt;span&gt;&quot;|&quot;&lt;/span&gt; &lt;span&gt;&#x27;{print $3}&#x27;&lt;/span&gt; access.log | sort | uniq -c | sort -nk1 -r | head -n10&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6.9、思考&amp;amp;扩展&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、Linux的终端，是如何实现彩色的文字的？我要如何输出一个绿色的&lt;code&gt;Hello World&lt;/code&gt;?&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、软链接与硬链接有什么区别？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、了解几个偏门但又不是非常偏的命令。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;cut&lt;/code&gt; 有了awk，几乎不怎么会用cut了&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;tr&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;col&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;paste&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;join&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;split&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7. 正则和高级用法&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你可能遇到一些棘手的问题，通过搜索得到想要的结果，但下次还是要通过搜索解决问题，这种低效的手段不是我们所想要的。典型的就是一个线上运维工程师，当问题来临时，不会给你留太多的&lt;code&gt;现场学习&lt;/code&gt;时间。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了达到更高效的训练，我们要做两件事情：第一，总结归纳；第二，触类旁通。Linux的命令也是如此，一个问题，通常会有多种解决方式，要通过变化找出其中的共性。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这涉及到一些设计者对于规范约定俗成的遵守。一般的，你只需要掌握一小部分命令，然后对大批命令达到了解的程度，就可以在命令行的世界里游刃有余。举个例子，你知道&lt;code&gt;ls&lt;/code&gt;是列出文件目录，你就会联想到&lt;code&gt;lscpu&lt;/code&gt;是列出cpu信息；&lt;code&gt;lsmem&lt;/code&gt;是列出内存信息;&lt;code&gt;lsblk&lt;/code&gt;是磁盘信息等。这种共性很多，比如&lt;code&gt;top&lt;/code&gt;系列，&lt;code&gt;stat&lt;/code&gt;系列。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5882352941176471&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8AgQHicvyfnaPwceO8ErqV7vuY6icdQ302kbdQcS0OfAoiajGdE7OlzCvw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;850&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7.1、辅助信息&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7.1.1、Linux文件格式&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在Linux上工作，是非常非常排斥二进制这种格式的，几乎什么都是可以读写的文本内容。大多数命令生成的结果，也都是文本文件。这些文件有一些特点，通常列与列都是通过空格或者&lt;code&gt;&amp;lt;TAB&amp;gt;&lt;/code&gt;键分隔的。比如下面&lt;code&gt;lsmem&lt;/code&gt;的结果，这种有规律的，有章可循的文件，是非常容易被处理的。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# lsmem  &lt;/span&gt;&lt;br/&gt;RANGE                                  SIZE  STATE REMOVABLE BLOCK&lt;br/&gt;0x0000000000000000-0x0000000007ffffff  128M online        no     0&lt;br/&gt;0x0000000008000000-0x000000000fffffff  128M online       yes     1&lt;br/&gt;0x0000000010000000-0x0000000017ffffff  128M online        no     2&lt;br/&gt;0x0000000018000000-0x0000000027ffffff  256M online       yes   3-4&lt;br/&gt;0x0000000028000000-0x000000004fffffff  640M online        no   5-9&lt;br/&gt;0x0000000050000000-0x000000005fffffff  256M online       yes 10-11&lt;br/&gt;0x0000000060000000-0x000000007fffffff  512M online        no 12-15&lt;br/&gt;&lt;br/&gt;Memory block size:       128M&lt;br/&gt;Total online memory:       2G&lt;br/&gt;Total offline memory:      0B&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有一大批针对于行操作的命令，同样有一批针对于列操作的命令。然后，有两个集大成者，叫做&lt;code&gt;sed&lt;/code&gt;、&lt;code&gt;awk&lt;/code&gt;。由于这两个命令的内容非常多，我们将其列为单独的章节。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7.1.2、命令记不住怎么办？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通常linux命令都十分简单，但是有些还是有些复杂度的。比如&lt;code&gt;find&lt;/code&gt;，&lt;code&gt;ps&lt;/code&gt;这种命令，如果要照顾到所有的场合，可能需要非常巨大的篇幅。但是，万一用到这种偏门的场合怎么办？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;全面了解一下是非常有必要的，以便在使用的时候能够唤起记忆中最浅显的印象。然后剩下的，就可以交给类似于&lt;code&gt;man&lt;/code&gt;的这种命令了。Linux上的每一个命令，都会有配套的帮助文件，这远比网络上那些转来转去的信息，正确的多。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;正式介绍一下下面的两个命令：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;man&lt;/code&gt; 用来显示某个命令的文档信息。比如：&lt;code&gt;man ls&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;info&lt;/code&gt; 你可以认为和man是一样的，虽然有一些能够互补的内容。它们会在内容中进行提示的&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;--help&lt;/code&gt; 很多命令通过参数&lt;code&gt;--help&lt;/code&gt;提供非常简短的帮助信息。这通常是最有用最快捷的用例展示。如果你根本就记不住一个非常拗口的单词，那就找找这些地方吧&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意：这些帮助信息，仅集中在命令的作用域本身。对于它的组合使用场景，并没有过多信息。也就是说，它教会了你怎么用，但并没有告诉你用它能够来做什么。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这些帮助命令，一般会通过高亮关键字，增加阅读的体验。但我们可以更近一步，把帮助文件变成彩色的。在root用户下，执行下面的命令。然后，&lt;strong&gt;重新登录虚拟机&lt;/strong&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cat &amp;gt;&amp;gt; ~/.bashrc &amp;lt;&amp;lt;EOF&lt;br/&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;&lt;span&gt;man&lt;/span&gt;&lt;/span&gt;()&lt;br/&gt;{&lt;br/&gt;    env \\&lt;br/&gt;    LESS_TERMCAP_mb=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[1;31m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_md=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[1;31m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_me=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[0m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_se=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[0m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_so=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[1;44;33m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_ue=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[0m&quot;&lt;/span&gt;) \\&lt;br/&gt;    LESS_TERMCAP_us=\$(&lt;span&gt;printf&lt;/span&gt; &lt;span&gt;&quot;\e[1;32m&quot;&lt;/span&gt;) \\&lt;br/&gt;    man &lt;span&gt;&quot;\$@&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;EOF&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再次执行man命令，就可以看到彩色的信息了。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.51775956284153&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8XLrSRTIRDR6bbiaysEnGl2gHRn7Xb0AFfMbLf49e8XZsxEbEDiaQ2Q7Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;732&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7.1.3、TAB补全&lt;span/&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在，在终端里，输入&lt;code&gt;ca&lt;/code&gt;，然后快速按2次&lt;code&gt;&amp;lt;TAB&amp;gt;&lt;/code&gt;键盘，命令行会进入补全模式，显示以ca打头的所有命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# ca&lt;/span&gt;&lt;br/&gt;cacertdir_rehash     cache_dump           cache_repair         cache_writeback      ca-legacy            capsh                &lt;span&gt;case&lt;/span&gt;                 catchsegv&lt;br/&gt;cache_check          cache_metadata_size  cache_restore        cal                  &lt;span&gt;caller&lt;/span&gt;               captoinfo            cat                  catman&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果你对某个命令，只有模糊的印象，只记得前面的几个字母，这个功能是极好的，命令范围会一步步缩减。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7.2、正则表达式&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了开始下面的内容，我们首先介绍一下正则表达式。在前面的一些命令中，也可以使用这些正则表达式，比如less、grep等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有些书籍，能够把正则表达式写成一本书，我们这里仅作简单的介绍，但足够用了。一般的，正则表达式能用在匹配上，还能够把匹配的内容拿来做二次利用。关于后者，我们在&lt;code&gt;sed&lt;/code&gt;命令中介绍。&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;标志&lt;/th&gt;&lt;th&gt;意义&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;^&lt;/code&gt;&lt;/td&gt;&lt;td&gt;行首&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;$&lt;/code&gt;&lt;/td&gt;&lt;td&gt;行尾&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;.&lt;/code&gt;&lt;/td&gt;&lt;td&gt;任意单个字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;*&lt;/code&gt;&lt;/td&gt;&lt;td&gt;匹配0个或者多个前面的字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;+&lt;/code&gt;&lt;/td&gt;&lt;td&gt;1个或者多个匹配&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;?&lt;/code&gt;&lt;/td&gt;&lt;td&gt;0个或者1个匹配&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;{m}&lt;/code&gt;&lt;/td&gt;&lt;td&gt;前面的匹配重复m次&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;{m,n}&lt;/code&gt;&lt;/td&gt;&lt;td&gt;前面的匹配重复m到n次&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;[]&lt;/code&gt;&lt;/td&gt;&lt;td&gt;匹配一个指定范围内的字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;[^]&lt;/code&gt;&lt;/td&gt;&lt;td&gt;匹配指定范围外的任意单个字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;\&lt;/code&gt;&lt;/td&gt;&lt;td&gt;转义字符&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;[0-9]&lt;/code&gt;&lt;/td&gt;&lt;td&gt;匹配括号中的任何一个字符,or的作用&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;|&lt;/code&gt;&lt;/td&gt;&lt;td&gt;or，或者&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;\b&lt;/code&gt;&lt;/td&gt;&lt;td&gt;匹配一个单词。比如&lt;code&gt;\blucky\b&lt;/code&gt; 只匹配单词lucky&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用下面的命令创建一个文件，我们练习一下grep命令加上&lt;code&gt;E&lt;/code&gt;参数后的正则表现。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cat &amp;gt; 996 &amp;lt;&amp;lt;EOF&lt;br/&gt;996: 996 is a funcking thing . &lt;span&gt;which&lt;/span&gt; make woman as man , man as ass .&lt;br/&gt;we all on the bus , bus bus on the way . 996&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;The greedy green boss rides on the pity programmer&lt;br/&gt;EOF&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在终端执行下面命令，注意高亮的部分即为匹配到的字符串。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 匹配996开头的行&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E ^996&lt;/span&gt;&lt;br/&gt;996: 996 is a funcking thing . &lt;span&gt;which&lt;/span&gt; make woman as man , man as ass .&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 匹配996结尾的行&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E 996$&lt;/span&gt;&lt;br/&gt;we all on the bus , bus bus on the way . 996&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 匹配到icu和icuuuuuu&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E icu+&lt;/span&gt;&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 再次匹配到996&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E [0-9]&lt;/span&gt;&lt;br/&gt;996: 996 is a funcking thing . &lt;span&gt;which&lt;/span&gt; make woman as man , man as ass .&lt;br/&gt;we all on the bus , bus bus on the way . 996&lt;br/&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E ^[\^0-9]&lt;/span&gt;&lt;br/&gt;we all on the bus , bus bus on the way . 996&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;The greedy green boss rides on the pity programmer&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 匹配所有不包含996的行，良心命令，泪奔&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E -v [0-9]{3}&lt;/span&gt;&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;The greedy green boss rides on the pity programmer&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 匹配boss和icu&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E boss\|icu&lt;/span&gt;&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;The greedy green boss rides on the pity programmer&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 匹配所有行&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat 996 | grep -E .&lt;/span&gt;&lt;br/&gt;996: 996 is a funcking thing . &lt;span&gt;which&lt;/span&gt; make woman as man , man as ass .&lt;br/&gt;we all on the bus , bus bus on the way . 996&lt;br/&gt;way to icu. icuuuuuu......&lt;br/&gt;The greedy green boss rides on the pity programmer&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;正则表达式非常的重要，在一些sed脚本中，awk脚本中，甚至是vim编辑器中，都会简化你的操作。以上内容应该熟记，达到不需要查找文档的地步。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面有6个小问题，可以思考一下。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、回过头去，执行一下&lt;code&gt;man cat&lt;/code&gt;，是否发现了一个叫做&lt;code&gt;tac&lt;/code&gt;的命令？它是干什么的？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、上面提到的&lt;code&gt;stat&lt;/code&gt;系列，你能想象&lt;code&gt;iostat&lt;/code&gt;大体是干什么用的么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、&lt;code&gt;grep -v&lt;/code&gt;是什么意思？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;4、了解一下和mv非常像的&lt;code&gt;rename&lt;/code&gt;命令来批量修改文件，看能否使用上面的正则。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;5、有些命令如果拼写错误，如何快速修正？靠搜索么？了解一下&lt;code&gt;fuck&lt;/code&gt;命令。我没有说错。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;6、下面哪种写法表示如果cmd1成功执行，则执行cmd2命令？&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;A. cmd1&amp;amp;&amp;amp;cmd2&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;B. cmd1|cmd2&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;C. cmd1;cmd2&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;D. cmd1||cmd2&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;8. Linux下的压缩&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;压缩，是一件非常神奇的事情。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;很久很久之前，就接触过一些&lt;strong&gt;64KB&lt;/strong&gt;大小的电影，你花&lt;strong&gt;半小时&lt;/strong&gt;都看不完。事实上，这些动画的真实容量是&lt;strong&gt;15GB&lt;/strong&gt;，Warez组织把它压缩了&lt;strong&gt;25万倍&lt;/strong&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你要是Windows系统，可以在这里下载体验一下。但我们现在讲的是Linux，很打脸是不是？&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;链接: https:&lt;span&gt;//pan.baidu.com/s/12YJQ4jsbtRr7RxoLpARTyQ &lt;/span&gt;&lt;br/&gt;提取码: r7sp&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;压缩是件神奇的事。它能大能小，能伸能缩，在现实中很难找到这样的东西。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5882352941176471&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib801s577MBu0ibGW0Z98osjDX57twXAm873y5c6jLgueCCqreVJ2AY4bg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;850&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了减小传输文件的大小，或者为了传输方便，一般都会开启压缩。linux下常见的压缩文件有tar、bzip2、zip、rar等，7z这种用的相对较少。压缩之后的文件，非常适合在网络环境上传输。甚至，你可以认为iso文件为一种特殊的压缩方式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;.tar&lt;/code&gt; 使用tar命令压缩或解压&lt;code&gt;.bz2&lt;/code&gt; 使用bzip2命令操作&lt;code&gt;.gz&lt;/code&gt; 使用gzip命令操作&lt;code&gt;.zip&lt;/code&gt; 使用unzip命令解压&lt;code&gt;.rar&lt;/code&gt; 使用unrar命令解压&lt;code&gt;.Z&lt;/code&gt;  使用compress,uncompress&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5181058495821727&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8PIT2NUEaianFiczlKCb7cNcLZsdNzAeUdWOc9dKYVvTcV2S1tNo4CvJg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;准备工作：使用下面的命令，复制1000个文件。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;cd&lt;/span&gt; ~&lt;br/&gt;mkdir files&lt;br/&gt;&lt;span&gt;cd&lt;/span&gt; files&lt;br/&gt;seq 1000 | xargs -I {} cp  /etc/group  {}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用ls，就可以看到我们刚才创建的1000个文件。接下来，我们使用压缩命令将它打包成一个。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 查看1000个文件的总大小&lt;/span&gt;&lt;br/&gt;[root@localhost files]&lt;span&gt;# du -h .&lt;/span&gt;&lt;br/&gt;4.0M .&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 切换到root目录&lt;/span&gt;&lt;br/&gt;&lt;span&gt;cd&lt;/span&gt; ~&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 使用tar进行压缩，压缩后的文件不到1MB&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# tar cvf files.tar files&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# du -h files.tar&lt;/span&gt;&lt;br/&gt;1012K files.tar&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 使用gizp提高压缩比，压缩后的文件只有12KB&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# gzip files.tar&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# du -h files.tar.gz&lt;/span&gt;&lt;br/&gt;12K files.tar.gz&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;tar和gzip一般是联合使用的。tar命令提供了一种特殊的功能，就是可以在打包解包的同时调用其他的压缩程序，比如：gzip，bzip2等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面的命令，与上面执行两次命令后是等同的。所以，一般使用下面的方式进行操作。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# tar cvfz files2.tar.gz files&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# du -h files2.tar.gz&lt;/span&gt;&lt;br/&gt;12K files2.tar.gz&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;与之对应的，就是解压操作。我们只需要改动命令行中的一个字母即可：&lt;code&gt;c&lt;/code&gt;-&amp;gt;&lt;code&gt;x&lt;/code&gt;。但其实，参数&lt;code&gt;v&lt;/code&gt;和&lt;code&gt;z&lt;/code&gt;也是可以省略的。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# tar xvfz files2.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们更加常用的方式，是加上参数&lt;code&gt;C&lt;/code&gt;，指定一个要解压的目录。比如下面的命令，把压缩内容解压到/opt目录中。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# tar xvfz files2.tar.gz -C /opt/&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那如果我仅仅想要看下压缩文件中包含哪些文件呢？这就要使用参数&lt;code&gt;t&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;安装其他的&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们来看一下常用的zip和rar解压程序有没有安装。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# which unzip&lt;/span&gt;&lt;br/&gt;/usr/bin/&lt;span&gt;which&lt;/span&gt;: no unzip &lt;span&gt;in&lt;/span&gt; (/usr/&lt;span&gt;local&lt;/span&gt;/sbin:/usr/&lt;span&gt;local&lt;/span&gt;/bin:/usr/sbin:/usr/bin:/root/bin)&lt;br/&gt;[root@localhost ~]&lt;span&gt;# which unrar&lt;/span&gt;&lt;br/&gt;/usr/bin/&lt;span&gt;which&lt;/span&gt;: no unrar &lt;span&gt;in&lt;/span&gt; (/usr/&lt;span&gt;local&lt;/span&gt;/sbin:/usr/&lt;span&gt;local&lt;/span&gt;/bin:/usr/sbin:/usr/bin:/root/bin)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，我们的系统并没有安装这两个应用。那我就使用centos的包管理工具&lt;code&gt;yum&lt;/code&gt;安装一下。java中的jar命令也是与zip类似的，可自行探索。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# yum install -y zip unzip rar unrar&lt;/span&gt;&lt;br/&gt;Loaded plugins: fastestmirror&lt;br/&gt;Loading mirror speeds from cached hostfile&lt;br/&gt; * base: mirrors.aliyun.com&lt;br/&gt; * extras: mirrors.tuna.tsinghua.edu.cn&lt;br/&gt; * updates: mirrors.aliyun.com&lt;br/&gt;...&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;rar不能安装成功，所以rar文件并不能被解压。没关系，我们在后面的章节把它安装上。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在，你会在Linux安装tomcat了么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们思考一下：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、 经过zip压缩的文件，再使用gzip压缩，容量还会减少么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了验证这个过程，可以使用&lt;code&gt;dd&lt;/code&gt;命令，生成一个&lt;code&gt;69MB&lt;/code&gt;大小的随机文件。&lt;code&gt;dd&lt;/code&gt;命令也是个神奇哦。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# dd if=/dev/urandom  of=test bs=1M count=69&lt;/span&gt;&lt;br/&gt;69+0 records &lt;span&gt;in&lt;/span&gt;&lt;br/&gt;69+0 records out&lt;br/&gt;72351744 bytes (72 MB) copied, 0.446161 s, 162 MB/s&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# du -h test&lt;/span&gt;&lt;br/&gt;69M &lt;span&gt;test&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，回到文章最上面，我们可以随机生成一批文件，让压缩效果更有意义一点。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;seq 1000 | xargs -i dd &lt;span&gt;if&lt;/span&gt;=/dev/zero of={}.xjj bs=1k count=256&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、如果已经有了文件，tar命令是如何做到强制覆盖的？&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9. Linux的权限体系&lt;/h1&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5882352941176471&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8icGibsIMctpIqNmTG0pwqdEIhhg1PZsWkWckvvyickI7yt8aFwFp0Ou5A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;850&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们在最最最上面，刚接触命令行的时候，就使用&lt;code&gt;chmod&lt;/code&gt;命令，给普通文本文件，赋予了执行权限。本小节将看一下&lt;code&gt;用户权限&lt;/code&gt;和&lt;code&gt;文件权限&lt;/code&gt;这两个息息相关的概念，&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9.1、添加用户&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;到现在为止，我们的系统中，还孤零零的只有这一个用户，是时候学学女娲，捏几个小泥人了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首先创建两个用户：张三（zhang3）、李四（li4）。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# useradd zhang3&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查看下面命令的三个输出结果。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 系统中多了一个叫做zhang3的组，group文件保存了系统的组信息&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# tail -n1 /etc/group&lt;/span&gt;&lt;br/&gt;zhang3:x:1000:&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 系统中多了一个叫做zhang3的用户，shadow文件保存了它们的密码。很多安全渗透就是为了拿到它进行暴力破解&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# tail -n1 /etc/shadow&lt;/span&gt;&lt;br/&gt;zhang3:!!:18207:0:99999:7:::&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# home目录中，多了一个叫做zhang3的目录&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# ll /home --full-time&lt;/span&gt;&lt;br/&gt;total 0&lt;br/&gt;drwx------. 2 zhang3 zhang3 83 2019-11-06 22:09:33.357165082 -0500 zhang3&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，给我们刚刚建立的用户，使用&lt;code&gt;passwd&lt;/code&gt;设置一个密码。密码需要输入两次进行确认。如果想要更改密码，可以使用&lt;code&gt;chpasswd&lt;/code&gt;命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# passwd zhang3&lt;/span&gt;&lt;br/&gt;Changing password &lt;span&gt;for&lt;/span&gt; user zhang3.&lt;br/&gt;New password:&lt;br/&gt;BAD PASSWORD: The password is shorter than 8 characters&lt;br/&gt;Retype new password:&lt;br/&gt;passwd: all authentication tokens updated successfully.&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么如何删除一个现有的用户呢？这是通过&lt;code&gt;userdel&lt;/code&gt;命令实现的。加上参数&lt;code&gt;f&lt;/code&gt;，会在其他用户使用系统的时候，强制退出。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;userdel -f zhang3&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9.2、文件权限说明&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上面的命令执行结果中，我们发现了有两件非常有意思的东西。添加用户后，除了在密码文件&lt;code&gt;shadow&lt;/code&gt;中增加了一些内容，同时还在&lt;code&gt;group&lt;/code&gt;文件中添加了信息。这涉及到用户的两个属性：用户名，组名。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个用户只有一个名称代号，但是可以有多个组。下面命令创建一个密码为123的用户&lt;code&gt;li4&lt;/code&gt;，并给它追加一个叫做&lt;code&gt;zhang3&lt;/code&gt;的组。可以看到&lt;code&gt;/etc/group&lt;/code&gt;文件中的信息变更。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# useradd  -G zhang3 -p 123 li4&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# tail -n 2 /etc/group&lt;/span&gt;&lt;br/&gt;zhang3:x:1000:li4&lt;br/&gt;li4:x:1001:&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;好啦，接下来切换到我们的文件权限上面。为了进行下面命令的验证，我们首先创建一个名字叫&lt;code&gt;confirm777.sh&lt;/code&gt;的脚本文件。为了让脚本对所有用户可见，我们把它创建在/tmp目录下。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cat &amp;gt; /tmp/confirm777.sh &amp;lt;&amp;lt;EOF&lt;br/&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;$USER&lt;/span&gt;&lt;br/&gt;id&lt;br/&gt;EOF&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用&lt;code&gt;ll&lt;/code&gt;命令查看文件信息。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# ll /tmp/confirm777.sh --full-time&lt;/span&gt;&lt;br/&gt;-rw-r--r--. 1 root root 13 2019-11-07 04:25:55.418254935 -0500 confirm777.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3983286908077994&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8zU8L6yIaItoFEc6p9TD60SVoqQBWrNwTibslPGfNNfuO3wcnzhK4v6A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;718&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从&lt;code&gt;ll&lt;/code&gt;的命令可以看出，文件的所有者是root用户，文件所属的组，也是root组，它的权限是&lt;code&gt;rw-r--r--&lt;/code&gt;。文件权限分为三部分。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;所有者权限&lt;/code&gt;，缩写为&lt;code&gt;u&lt;/code&gt;。文件的所有者所拥有的权限。也就是root用户的权限，是&lt;code&gt;rw-&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;组用户权限&lt;/code&gt;，缩写为&lt;code&gt;g&lt;/code&gt;。文件所属组内所有用户的权限。因为root组内只有root一个用户，所以组用户权限是&lt;code&gt;r--&lt;/code&gt;。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;其他用户权限&lt;/code&gt;，缩写为&lt;code&gt;o&lt;/code&gt;。其他不相关用户的权限，比如我们刚创建的zhang3、li4用户，对文件的权限就是&lt;code&gt;r--&lt;/code&gt;。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;全部&lt;/code&gt;，缩写为&lt;code&gt;a&lt;/code&gt;，表示对上面三类用户集体操作。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那rw-这些东西是什么意思呢？&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;r&lt;/code&gt;  表示可读权限。read。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;w&lt;/code&gt; 表示可写权限。write。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;x&lt;/code&gt; 表示可执行权限。execute。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;-&lt;/code&gt;  权限占位符，表示没有当前权限。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意：一个用户拥有文件的w权限，并不代表就可以删除文件。w仅仅针对于文件内容来说的。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个文件，有3类用户，每类用户，有3种权限。使用最简单的小学乘法，我们能够得出，一个文件的权限位，需要&lt;code&gt;3x3=9&lt;/code&gt;个标志位表示。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们的文件名称，叫做confirm777.sh，这个名字是随便起的么？当然不是，&lt;code&gt;777&lt;/code&gt;在linux代表特殊的含义，它代表文件对所有用户具有可读、可写、可执行的权限。可以想象，如果每个文件都有这样的权限，系统将无安全可言。那这一串数字是怎么来的呢？可以看下面的对照表。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对以上三个属性进行任意组合，可以得到：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;4&lt;/code&gt; &lt;code&gt;r--&lt;/code&gt; 4+0+0&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;6&lt;/code&gt; &lt;code&gt;rw-&lt;/code&gt; 4+2+0&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;5&lt;/code&gt; &lt;code&gt;r-x&lt;/code&gt;  4+0+1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;2&lt;/code&gt; &lt;code&gt;-w-&lt;/code&gt; 0+2+0&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;3&lt;/code&gt; &lt;code&gt;-wx&lt;/code&gt; 0+2+1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;1&lt;/code&gt; &lt;code&gt;--x&lt;/code&gt; 0+0+1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;7&lt;/code&gt; &lt;code&gt;rwx&lt;/code&gt; 4+2+1&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9.3、文件权限更改&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面介绍三个文件权限相关的命令。一般常用的，就是chown和chmod。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;chown&lt;/code&gt; 更改文件的所有者。&lt;code&gt;chgrp&lt;/code&gt; 更改文件的组。&lt;code&gt;chmod&lt;/code&gt; 更改文件权限。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们把&lt;code&gt;confirm777.sh&lt;/code&gt;的所有者和组，修改成刚刚创建的用户&lt;code&gt;zhang3&lt;/code&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;cd&lt;/span&gt; /tmp&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# chown zhang3:zhang3 confirm777.sh&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# ll confirm777.sh&lt;/span&gt;&lt;br/&gt;-rw-r--r--. 1 zhang3 zhang3 13 Nov  7 04:25 confirm777.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;给文件所有者增加执行权限。然后分别切换到&lt;code&gt;zhang3&lt;/code&gt;，&lt;code&gt;li4&lt;/code&gt;用户执行一下。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;通过&lt;code&gt;su&lt;/code&gt; 命令，可以切换到其他用户，一般使用&lt;code&gt;su -&lt;/code&gt;进行环境变量的清理；而命令&lt;code&gt;id&lt;/code&gt;，能够看到当前正在执行的用户信息。&lt;/p&gt;&lt;/blockquote&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost tmp]&lt;span&gt;# chmod u+x confirm777.sh&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# su li4&lt;/span&gt;&lt;br/&gt;[li4@localhost tmp]$ ./confirm777.sh&lt;br/&gt;bash: ./confirm777.sh: Permission denied&lt;br/&gt;[li4@localhost tmp]$ &lt;span&gt;exit&lt;/span&gt;&lt;br/&gt;&lt;span&gt;exit&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# su zhang3&lt;/span&gt;&lt;br/&gt;[zhang3@localhost tmp]$ ./confirm777.sh&lt;br/&gt;root&lt;br/&gt;uid=1000(zhang3) gid=1000(zhang3) groups=1000(zhang3) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以看到，文件所有者zhang3可以执行文件，但不相关的li4，提示没有权限。接下来，我们验证用户组相关的权限位。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 去掉zhang3的执行权限&lt;/span&gt;&lt;br/&gt;root@localhost tmp]&lt;span&gt;# chmod u-x confirm777.sh&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# ll confirm777.sh&lt;/span&gt;&lt;br/&gt;-rw-r--r--. 1 zhang3 zhang3 13 Nov  7 04:25 confirm777.sh&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 增加zhang3组的执行权限，由于li4在zhang3组里，它拥有权限&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# chmod g+x confirm777.sh&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# ll confirm777.sh&lt;/span&gt;&lt;br/&gt;-rw-r-xr--. 1 zhang3 zhang3 13 Nov  7 04:25 confirm777.sh&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 切换到zhang3进行执行&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# su - zhang3&lt;/span&gt;&lt;br/&gt;[zhang3@localhost tmp]$ ./confirm777.sh&lt;br/&gt;bash: ./confirm777.sh: Permission denied&lt;br/&gt;[zhang3@localhost tmp]$ &lt;span&gt;exit&lt;/span&gt;&lt;br/&gt;&lt;span&gt;exit&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 切换到li4进行执行&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# su - li4&lt;/span&gt;&lt;br/&gt;[li4@localhost tmp]$ ./confirm777.sh&lt;br/&gt;root&lt;br/&gt;uid=1001(li4) gid=1001(li4) groups=1001(li4),1000(zhang3) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从命令的执行结果可以看出。这次，li4能够执行文件，相反的，zhang3却不能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们使用chmod命令来修改文件权限，使用的是类似于&lt;code&gt;a+x&lt;/code&gt;这样的英文字母。拿第一个脚本来说，初始的权限是&lt;code&gt;rw-r--r--&lt;/code&gt;，也就是&lt;code&gt;644&lt;/code&gt;，在这种情况下，下面的两个脚本等效。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;chmod u+x confirm777.sh&lt;br/&gt;chmod 744 confirm777.sh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以看到，第二个命令，使用的是数字样式的权限位，多了一步人脑转换过程。这在日常的使用中，是非常不方便的。所以，使用符号法的表示方式，能够更加直观，非常推荐。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了更直观的表现这个过程，我专门制作了一张图。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5498614958448753&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8dLHjf33D7aPSa34g4icmcp8cU1CTBhgGnf2DVibW5ou0BvwcOFsV4XnA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;722&quot;/&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9.4、目录权限&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里有一个非常有意思的地方。把文件设置成可执行，可以把普通文件变成脚本，目录文件的可执行权限是什么鬼？有什么意义？对文件夹来说：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;r&lt;/code&gt; 表示允许读取目录中的文件名，但不能进入该目录&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;w&lt;/code&gt; 表示允许用户修改目录，可以创建、迁移、删除、更名目录下的文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;x&lt;/code&gt; 可以获得目录下文件的列表，以及进入目录，执行cd命令&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于r和x的区别，可以看下面的命令结果，仔细感受一下它们的区别。一般的，几乎所有的目录，都拥有&lt;code&gt;执行&lt;/code&gt;权限，不要随意对其进行设置。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost tmp]&lt;span&gt;# su - li4&lt;/span&gt;&lt;br/&gt;[li4@localhost ~]$ &lt;span&gt;cd&lt;/span&gt; /tmp&lt;br/&gt;&lt;br/&gt;[li4@localhost tmp]$ mkdir nox&lt;br/&gt;[li4@localhost tmp]$ touch nox/{a,b,c,d}&lt;br/&gt;[li4@localhost tmp]$ chmod a-x nox&lt;br/&gt;[li4@localhost tmp]$ ls nox&lt;br/&gt;ls: cannot access nox/a: Permission denied&lt;br/&gt;ls: cannot access nox/b: Permission denied&lt;br/&gt;ls: cannot access nox/c: Permission denied&lt;br/&gt;ls: cannot access nox/d: Permission denied&lt;br/&gt;a  b  c  d&lt;br/&gt;[li4@localhost tmp]$ cat nox/a&lt;br/&gt;cat: nox/a: Permission denied&lt;br/&gt;&lt;br/&gt;[li4@localhost tmp]$ chmod a+x nox&lt;br/&gt;[li4@localhost tmp]$ chmod a-r nox&lt;br/&gt;[li4@localhost tmp]$ ls nox&lt;br/&gt;ls: cannot open directory nox: Permission denied&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9.5、sticky bit&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们介绍一个比较烧脑的粘贴位。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假如你要删除一个文件，你可以没有这个文件的写权限，但是你必须要拥有这个文件上级目录的写权限。如何创建一个目录，可以让任何人些人文件，但是又不能删除其他用户的文件？这就是stick bit的作用。粘贴位一般只用于目录上，对文件来说并没有什么用处。粘贴位一般使用&lt;code&gt;t&lt;/code&gt;表示。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们可以看一个典型的目录&lt;code&gt;/tmp&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost tmp]&lt;span&gt;#  ls -dl /tmp&lt;/span&gt;&lt;br/&gt;drwxrwxrwt. 9 root root 4096 Nov  7 06:27 /tmp&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.3245492371705964&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8hiclJJicvcW5WhbgVVibCMLgyjRJzndEVsbY9HMYoWS9r9sTayqzI9hLw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;721&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以看到，最后一位，显示的是t，而不是x，意思是普通用户不能删除其他用户的文件。所有用户在/tmp目录中，都可以随意创建文件，但是却删除不了其他人的文件，即使文件的权限是&lt;code&gt;777&lt;/code&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost tmp]&lt;span&gt;# touch /tmp/stick&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# chown li4:li4 /tmp/stick&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# chmod 777 /tmp/stick&lt;/span&gt;&lt;br/&gt;[root@localhost tmp]&lt;span&gt;# su - zhang3&lt;/span&gt;&lt;br/&gt;[zhang3@localhost ~]$ rm /tmp/stick&lt;br/&gt;rm: cannot remove ‘/tmp/stick’: Operation not permitted&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;hr data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们在上面创建了两个用户zhang3和li4，并拿它们测试了chown和chmod命令，最后介绍了粘贴位。linux比较安全的原因，就是因为有比较详尽的权限划分。但权限是枚双刃剑，超权用户一个命令就可以搞垮系统，许多隐藏的木马，通过提权运行在不为人知的地方。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;权限相关的几个命令会经常被使用，下面举几个例子。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 设置/var/lib/mysql的用户和组为mysql&lt;/span&gt;&lt;br/&gt;chown -R mysql:mysql /var/lib/mysql&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 设置目录可读可写，能够上传文件&lt;/span&gt;&lt;br/&gt;chmod  777 /var/www/uploads&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 增加本目录下所有sh的执行权限&lt;/span&gt;&lt;br/&gt;chomd a+x *.sh&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 变更file为可读可写可执行&lt;/span&gt;&lt;br/&gt;chmod u=rwx,g=rwx,o=rwx file&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面依然是思考时间：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、下面这个命令，执行以后，会发生什么情况？警告：不要执行，哪怕把000改成其他数字。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# R遍历子目录的意思&lt;/span&gt;&lt;br/&gt;chmod -R 000 /&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、有一天，我看到一个命令&lt;code&gt;chmod u+s file&lt;/code&gt;，文中并没有介绍&lt;code&gt;s&lt;/code&gt;是什么意思，这是什么意思？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、如何删除一个用户的组？&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10. 如何对磁盘进行操作？&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面的场景非常的恐怖，对有些程序员来说可以是一场噩梦。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一大早刚刚去上班，煎饼果子刚啃了一半，几个全副武装的警察就闯进了公司。二话不说控制住了工作人员，并守株待兔的等着鱼儿来上班。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;原因就是：公司涉嫌存储和扩散非法文件，需要查封所有的服务器进行彻查。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这些文件，有的简单的放在磁盘上，有的放在文件存储服务器上，有的，被切成了多片放在了不同的廉价机器上。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来会发生什么，要看技术人员的水平，但估计结果并不会太好。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5500550055005501&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8a0skmvlfKa0Aee42OdGqYwzXPZ66glNEG50b8WRiacL8vwA4YhYibBdA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;909&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上一小节，我们创建了两个普通用户，这两个用户没什么本事，和默认的用户&lt;code&gt;root&lt;/code&gt;比起来，它们的权限就小得多。除了自己目录下的文件，其他的，它几乎都没有权限去修改。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这些文件，肯定是要存在磁盘上的。对磁盘的管理，有非常多的命令，这一小节的内容，对于系统管理员来说，经常使用；但对于开发来说，就要求比较低一些。因为开发只需要知道小电影存在什么地方了，不需要知道小电影是怎么存的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那定罪的时候，运维和程序员，到底是谁的锅更大一些？其实是个悖论。运维人员在发呆的时候，脑子里回忆起了下面的知识。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.1.添加新硬盘&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你要是一个系统管理员，甚至是一个上了云的系统管理员，现在买了一块&lt;code&gt;aws&lt;/code&gt;的扩展盘，它是不能被使用的。需要经过格式化挂载以后，才能投入生产。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;还记得在安装系统的时候么？其中有一步，需要对虚拟机的磁盘，进行划分，我们直接采用默认的方式。不过现在已经改不了了，它已经是过去式了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了模拟对磁盘的管理，我们需要首先给虚拟机新加一块虚拟磁盘。首先，使用&lt;code&gt;shutdown -h now&lt;/code&gt;命令关闭机器，进行下面的操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1、&lt;/strong&gt; 进入settings选项，然后切换到storage，添加磁盘&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8358895705521472&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8aEfzickFWpjMoW5M8Z4IrSgOu1UgiaHabTEjLfqXoZI71IfjYUtNLg6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;652&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2、&lt;/strong&gt; 点击创建一块磁盘&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8358895705521472&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8DDyB2rjr17gP0xIh8r9GO0aJAM0X3KA9K85APPvLazUWaamK8cVgAg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;652&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3、&lt;/strong&gt; 选择VDI&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8358895705521472&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8lvfWRWkQ60tVTqmsM3Tict0FgnEgtBaCAuDwPS0sBd2giaxfPGZ7SL3w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;652&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;4、&lt;/strong&gt; 动态扩容，用多少扩多少&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8358895705521472&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8lvfWRWkQ60tVTqmsM3Tict0FgnEgtBaCAuDwPS0sBd2giaxfPGZ7SL3w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;652&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;5、&lt;/strong&gt; 我们创建一块2GB大的，叫做disk2的磁盘&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.637906647807638&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8mJjexjzRRX9aEgJJ127ZsFXcBVnWC0ic1xnygSKLHE28WQfJibVyBic9g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;707&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;启动机器。远程连接192的ip，别忘了执行&lt;code&gt;dhclient&lt;/code&gt;命令。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首先使用&lt;code&gt;fdisk&lt;/code&gt;看一下目前的磁盘状况。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;root@localhost ~]&lt;span&gt;# fdisk -l&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;Disk /dev/sda: 8589 MB, 8589934592 bytes, 16777216 sectors&lt;br/&gt;Units = sectors of 1 * 512 = 512 bytes&lt;br/&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;br/&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;br/&gt;Disk label &lt;span&gt;type&lt;/span&gt;: dos&lt;br/&gt;Disk identifier: 0x000c2410&lt;br/&gt;&lt;br/&gt;   Device Boot      Start         End      Blocks   Id  System&lt;br/&gt;/dev/sda1   *        2048     2099199     1048576   83  Linux&lt;br/&gt;/dev/sda2         2099200    16777215     7339008   8e  Linux LVM&lt;br/&gt;&lt;br/&gt;Disk /dev/sdb: 2147 MB, 2147483648 bytes, 4194304 sectors&lt;br/&gt;Units = sectors of 1 * 512 = 512 bytes&lt;br/&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;br/&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;Disk /dev/mapper/centos-root: 6652 MB, 6652166144 bytes, 12992512 sectors&lt;br/&gt;Units = sectors of 1 * 512 = 512 bytes&lt;br/&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;br/&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;Disk /dev/mapper/centos-swap: 859 MB, 859832320 bytes, 1679360 sectors&lt;br/&gt;Units = sectors of 1 * 512 = 512 bytes&lt;br/&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;br/&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从命令的结果，我们看到了有两块磁盘。&lt;code&gt;/dev/sda&lt;/code&gt;和&lt;code&gt;/dev/sdb&lt;/code&gt;，其中&lt;code&gt;sda&lt;/code&gt;已经被分配，已经被我们的文件系统所占用。现在，回忆一下&lt;code&gt;/dev&lt;/code&gt;目录的用途，在这个目录下，存放了一些设备文件，假如我们再添加一块磁盘，它的句柄就应该是&lt;code&gt;sdc&lt;/code&gt; (sd*)。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在这整块磁盘能够被使用之前，我们需要对它进行三次操作。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;磁盘分区&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;磁盘格式化&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;磁盘挂载&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.2.分区&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对磁盘分区依然是&lt;code&gt;fdisk&lt;/code&gt;命令，以下命令，将进入交互模式。在交互模式中，输入&lt;code&gt;n&lt;/code&gt;新建分区。由于我们的磁盘只有2GB，所以只创建一个分区就好。根据向导，一路确定向下，最后，输入&lt;code&gt;w&lt;/code&gt;确定写入分区表，同时退出命令交互。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再次执行&lt;code&gt;fdisk -l&lt;/code&gt;，可以看到已经多了一块&lt;code&gt;2gb&lt;/code&gt;大小的分区。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# fdisk /dev/sdb&lt;/span&gt;&lt;br/&gt;...&lt;br/&gt;[root@localhost ~]&lt;span&gt;# fdisk -l&lt;/span&gt;&lt;br/&gt;...&lt;br/&gt;   Device Boot      Start         End      Blocks   Id  System&lt;br/&gt;/dev/sdb1            2048     4194303     2096128   83  Linux&lt;br/&gt;...&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.3.格式化&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在命令行，输入&lt;code&gt;mkfs&lt;/code&gt;，然后按&lt;code&gt;&amp;lt;TAB&amp;gt;&lt;/code&gt;进行补全，将会显示一批命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# mkfs.&lt;/span&gt;&lt;br/&gt;mkfs.btrfs   mkfs.cramfs  mkfs.ext2    mkfs.ext3    mkfs.ext4    mkfs.minix   mkfs.xfs&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这批命令，都可以对磁盘进行格式化。目前，最常用的磁盘格式是&lt;code&gt;ext4&lt;/code&gt;。但我们并没有找到windows操作系统的&lt;code&gt;FAT&lt;/code&gt;以及&lt;code&gt;NTFS&lt;/code&gt;等格式，但它们在概念上是等同的。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.8988919667590027&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLo8ZzT5QI3VAWgWvoYCrnib8IFueRfzqkyfYZFsRWZPLnnwC0YUqevdyPcyeKtMJqJgWWc7ftiaGX3A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;722&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面介绍一下Linux下常用的磁盘格式。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;btrfs&lt;/code&gt; GPL授权。是为了替换ext系统而发起的。不熟悉，不过多评价。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;cramfs&lt;/code&gt; 门针对闪存设计的只读压缩的文件系统，其容量上限为256M,采用zlib压缩，很少用&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;ext2&lt;/code&gt; ext的早先版本。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;ext3&lt;/code&gt; ext2的改进。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;ext4&lt;/code&gt; 使用最多。如果对其他的不熟悉，老老实实用ext4吧。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;minix&lt;/code&gt; 比较古老，也不常用。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;xfs&lt;/code&gt; XFS 文件系统是扩展文件系统的一个扩展，是 64 位高性能日志文件系统。centos7.0开始的默认文件系统。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们就录乡随俗，将磁盘给格式化成xfs。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# mkfs.xfs /dev/sdb1&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意：如果想要把磁盘格式化成&lt;code&gt;fat32&lt;/code&gt;的格式，需要安装一个软件。&lt;/p&gt;&lt;/blockquote&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt; yum install dosfstools -y&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.4.挂载&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后一步，是使用&lt;code&gt;mount&lt;/code&gt;命令挂载磁盘。我们把它挂载到&lt;code&gt;/data&lt;/code&gt;目录。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;df&lt;/code&gt;命令能够看到系统的磁盘使用状况，参数&lt;code&gt;h&lt;/code&gt;是&lt;code&gt;human&lt;/code&gt;的意思，以比较容易读的方式展现信息；&lt;code&gt;lsblk&lt;/code&gt;则以另一个角度查看系统磁盘挂载情况。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# mkdir /data&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# mount /dev/sdb1 /data&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# df -h&lt;/span&gt;&lt;br/&gt;Filesystem               Size  Used Avail Use% Mounted on&lt;br/&gt;devtmpfs                 908M     0  908M   0% /dev&lt;br/&gt;tmpfs                    920M     0  920M   0% /dev/shm&lt;br/&gt;tmpfs                    920M  8.6M  911M   1% /run&lt;br/&gt;tmpfs                    920M     0  920M   0% /sys/fs/cgroup&lt;br/&gt;/dev/mapper/centos-root  6.2G  1.4G  4.9G  22% /&lt;br/&gt;/dev/sda1               1014M  149M  866M  15% /boot&lt;br/&gt;tmpfs                    184M     0  184M   0% /run/user/0&lt;br/&gt;/dev/sdb1                2.0G   33M  2.0G   2% /data&lt;br/&gt;&lt;br/&gt;root@localhost ~]&lt;span&gt;# lsblk  -f&lt;/span&gt;&lt;br/&gt;NAME            FSTYPE      LABEL UUID                                   MOUNTPOINT&lt;br/&gt;sda&lt;br/&gt;├─sda1          xfs               ac3a3ce8-6ab1-4c0b-91c8-b4e617f0dfb4   /boot&lt;br/&gt;└─sda2          LVM2_member       3GzmOd-TUc1-p2ZN-wT5q-ttky-to9l-PF495o&lt;br/&gt;  ├─centos-root xfs               9f86f663-060a-4450-90f9-3005ad9c5d92   /&lt;br/&gt;  └─centos-swap swap              cf8709b0-b0ab-4d44-a23e-ad76f85efad6   [SWAP]&lt;br/&gt;sdb&lt;br/&gt;└─sdb1          xfs               0a7c861c-1a31-45b3-bf37-c72229f35704   /data&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了能够在开机的时候加载磁盘，我们需要修改&lt;code&gt;/etc/fstab&lt;/code&gt;文件。这种文件修改的时候一定要小心，否则会造成系统无法启动。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;[root@localhost ~]&lt;span&gt;# echo &quot;/dev/sdb1  xfs defaults 0 0&quot; &amp;gt;&amp;gt; /etc/fstab&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# cat /etc/fstab&lt;/span&gt;&lt;br/&gt;/dev/mapper/centos-root / xfs defaults        0 0&lt;br/&gt;UUID=ac3a3ce8-6ab1-4c0b-91c8-b4e617f0dfb4 /boot  xfs     defaults        0 0&lt;br/&gt;/dev/mapper/centos-swap swap    swap    defaults        0 0&lt;br/&gt;/dev/sdb1                       xfs     defaults        0 0&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.5.交换分区&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由于内存的容量有限，现在的操作系统，都会使用磁盘模拟一个&lt;code&gt;虚拟内存&lt;/code&gt;区域，用于缓冲一些数据。由于磁盘的速度和内存不可同日而语，通常会造成应用程序的卡顿。卡归卡，应用进程却可以因此苟延残喘，续命。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;swap&lt;/code&gt;分区，即交换区，系统在物理内存不够时，与&lt;code&gt;swap&lt;/code&gt;进行交换。即当系统的物理内存不够用时，把硬盘中一部分空间释放出来，以供当前运行的程序使用。当那些程序要运行时，再从&lt;code&gt;swap&lt;/code&gt;分区中恢复保存的数据到内存中。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现代互联网公司，一般对接口的响应时间有比较高的要求，&lt;code&gt;swap&lt;/code&gt;分区一般是禁用的。关于&lt;code&gt;swap&lt;/code&gt;，有下面几个相关的命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# 制作交换分区&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# mkswap /dev/sdb1&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 禁用所有交换分区&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# swapoff -a&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# 启用交换分区&lt;/span&gt;&lt;br/&gt;[root@localhost ~]&lt;span&gt;# swapon&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10.6 使用dd命令进行备份&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面的命令，将直接备份磁盘A到磁盘B。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# dd if=/dev/sda of=/dev/sdb&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上面的命令中，&lt;code&gt;if&lt;/code&gt;代表输入的文件，&lt;code&gt;of&lt;/code&gt;代表输出的文件。根据Linux下一切皆文件的原理，这里的文件指的就是设备。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;dd&lt;/code&gt;命令还可以将整个磁盘打包成一个镜像文件。比如下面的命令。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# dd if=/dev/hda of=~/hdadisk.img&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，恢复磁盘的时候，也是相当简单的，我们只需要逆向操作就可以了。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# dd if=hdadisk.img of=/dev/hda&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;End&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这篇文章有6万字，经历了多个版本的整理，有小伙伴已经拿着它作为了公司的培训资料。到现在为止，你已经对Linux的命令行有了比较客观的了解。但我这里还有很多可以让你更上一层楼的文章，比如vim、sed、awk的使用。下面是几个扩展阅读，同样采用xjjdog专用的命令行三段解析法，希望对你有所帮助。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;最常用&lt;/code&gt;系列，快速掌握三贱客↓&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650518612&amp;amp;idx=1&amp;amp;sn=125c2cb9ee6d76a6817fb0ebc5a3c5e4&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;最常用的一套“Vim“技巧&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519751&amp;amp;idx=1&amp;amp;sn=adef39cb108277731608069960692c77&amp;amp;chksm=8780bf03b0f73615adbb3da1fcbd342be465cc80ec6cb06a412714e474748003c3ff319e02e5&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;最常用的一套“Sed“技巧&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519843&amp;amp;idx=1&amp;amp;sn=fe4a5c405a35b42a850054eb4283ff40&amp;amp;chksm=8780bee7b0f737f194d356c155b67d19be574454adcb8ce0d16c84e6246a718c9cf29c223512&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;最常用的一套“AWK“技巧&lt;/a&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;荒岛余生系列&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;荒岛余生&lt;/code&gt;系列，快速掌握故障排查↓&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519137&amp;amp;idx=1&amp;amp;sn=8922471455cef842b1acbd24db405bca&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Linux之《荒岛余生》（一）准备篇&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519172&amp;amp;idx=1&amp;amp;sn=e8cade4652e257e8836f52e71d6d9a68&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Linux之《荒岛余生》（二）CPU篇&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519204&amp;amp;idx=1&amp;amp;sn=b367c1987fb8c985e83a6cb90f5436a6&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Linux之《荒岛余生》（三）内存篇&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519238&amp;amp;idx=1&amp;amp;sn=7a479485c3ea7b8d61f101ceefdab05b&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Linux之《荒岛余生》（四）I/O篇&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzA4MTc4NTUxNQ==&amp;amp;mid=2650519279&amp;amp;idx=1&amp;amp;sn=dcb57c5e7d303383280984f40d6dc356&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Linux之《荒岛余生》（五）网络篇&lt;/a&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;欢迎加我的好友xjjdog0，一块入群增加buff值。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;作者简介：&lt;strong&gt;小姐姐味道&lt;/strong&gt;  (xjjdog)，一个不允许程序员走弯路的公众号。聚焦基础架构和Linux。十年架构，日百亿流量，与你探讨高并发世界，给你不一样的味道。我的个人微信xjjdog0，欢迎添加好友，进一步交流。&lt;/p&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>ce24729d5a1bf75f60801ba6a9f016cc</guid>
<title>网络存储文件共享之 WebDAV</title>
<link>https://toutiao.io/k/zccejvk</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;entry-content&quot;&gt;&amp;#13;

&lt;p&gt;WebDAV 基于 HTTP 协议的通信协议，在GET、POST、HEAD等几个HTTP标准方法以外添加了一些新的方法，使应用程序可对Web Server直接读写，并支持写文件锁定(Locking)及解锁(Unlock)，还可以支持文件的版本控制。&lt;/p&gt;



&lt;p&gt;常用的文件共享有三种：FTP、Samba、WebDAV，它们各有优缺点，了解后才能更好地根据自己的需求选择方案。&lt;/p&gt;



&lt;span id=&quot;more-238&quot;/&gt;



&lt;ul&gt;&lt;li&gt;FTP属于古老的文件共享方式了，因为安全性，现代浏览器最新已默认不能打开FTP协议。SFTP在FTP基础上增加了加密，在Linux上安装OpenSSH后可以直接用SFTP协议传输。使用SFTP临时传送文件还可以，但做文件共享，性能不高，速度较慢。&lt;/li&gt;&lt;li&gt;Samba是Linux下CIFS协议的实现，优势在于对于小白使用简章，和Windows系统文件共享访问一样，不需要安装第三方软件，而且移动端也有大量APP支持。苹果手机文件APP中添加网络存储用的就是这种方式。Windows下文件共享使用445端口，且不能更改。445端口常常受黑客关照，在广域网上大多运营封掉了访端口，所以这种文件共享只适合在内网使用。&lt;/li&gt;&lt;li&gt;WebDAV 基于 HTTP 协议的通信协议，在广域网上共享文件有天然的优势，移动端文件管理APP也大多支持WebDAV协议。使用HTTPS还能保安全性。Apache和Nginx支持WebDAV，可作为WebDAV文件共享服务器软件。也可以使用专门的WebDAV软件部署。&lt;/li&gt;&lt;/ul&gt;



&lt;h2 id=&quot;webdav-server-推荐&quot;&gt;WebDAV Server (推荐)&lt;/h2&gt;



&lt;p&gt;WebDAV 是 GitHub 上开源的项目，基于 Go 语言实现，不仅跨平台，还支持 ARM 架构，可在㠌入式设备中部署 WebDAV 服务器。&lt;/p&gt;



&lt;p&gt;项目地址：&lt;a href=&quot;https://github.com/hacdias/webdav&quot; target=&quot;_blank&quot; rel=&quot;noreferrer noopener&quot;&gt;https://github.com/hacdias/webdav&lt;/a&gt;&lt;/p&gt;



&lt;p&gt;在 GitHub 下载对应的架构 WebDAV，如：windows-amd64-webdav.zip 。解压后获得 webdav.exe 。&lt;/p&gt;



&lt;p&gt;用文本编辑器新建 config.yaml 文件，内容如下：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;&lt;em&gt;# 监听任意网卡，多网卡可指定对应ip&lt;/em&gt;
address: 0.0.0.0
port: 8081
&lt;em&gt;# 如果无需验证填 false&lt;/em&gt;
auth: true
&lt;em&gt;# 如果不需要 https 则填 false&lt;/em&gt;
tls: true
&lt;em&gt;# https证书和密钥，如果 tls 为 false，cert 和 key 不需要&lt;/em&gt;
cert: /data/www/cert/szhome.xf1024.com_nginx/cert.pem
key: /data/www/cert/szhome.xf1024.com_nginx/cert.key
&lt;em&gt;# 访问前缀，建议默认&lt;/em&gt;
prefix: /

&lt;em&gt;# 如果 auth 为 false 生效，文件共享的路径&lt;/em&gt;
scope: /data/users/public
&lt;em&gt;# 是否允许修改&lt;/em&gt;
modify: true
rules: []

&lt;em&gt;# 跨域设置&lt;/em&gt;
cors:
  enabled: true
  credentials: true
  allowed_headers:
    - Depth
  allowed_hosts:
    - http://localhost:8081
  allowed_methods:
    - GET
  exposed_headers:
    - Content-Length
    - Content-Range

&lt;em&gt;# 用户信息，如果 auth 为 true 生效&lt;/em&gt;
users:
  - username: user1
    password: 123456
    scope: /data/users/2021
  - username: user2
    password: 654321
    scope: /data/users/2022&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;注意 yaml 文件格式的书写规则，users 下是需认证的用户名，密码，及用户共享文件。&lt;/p&gt;



&lt;p&gt;启动服务：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;webdav -c ./config.yaml&lt;/code&gt;&lt;/pre&gt;



&lt;h2 id=&quot;apache-开启-webdav&quot;&gt;Apache 开启 WebDAV&lt;/h2&gt;



&lt;p&gt;Apache 开启 WebDAV 需要打开以下模块：&lt;/p&gt;



&lt;p&gt;LoadModule dav_module modules/mod_dav.so&lt;br/&gt;LoadModule dav_fs_module modules/mod_dav_fs.so&lt;br/&gt;LoadModule dav_lock_module modules/mod_dav_lock.so&lt;/p&gt;



&lt;p&gt;配置如下：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;
    ServerName dav.engr-z.com
    DocumentRoot /data/webdav
    &amp;lt;Directory &quot;/data/webdav&quot;&amp;gt;
        Options Indexes FollowSymLinks
        AllowOverride None
        Dav on
        AuthType Basic
        AuthName &quot;WebDAV Upload&quot;
        AuthUserFile conf/.htpasswd
        AuthBasicProvider file
        Require user webdav
    &amp;lt;/Directory&amp;gt;
&amp;lt;/VirtualHost&amp;gt;

&amp;lt;VirtualHost *:443&amp;gt;
    ServerName dav.engr-z.com
    DocumentRoot /data/webdav
    &amp;lt;Directory &quot;/data/webdav&quot;&amp;gt;
        Options Indexes FollowSymLinks
        AllowOverride None
        Dav on
        AuthType Basic
        AuthName &quot;WebDAV Upload&quot;
        AuthUserFile conf/.htpasswd
        AuthBasicProvider file
        Require user webdav
    &amp;lt;/Directory&amp;gt;
&lt;em&gt;#Header always set Strict-Transport-Security &quot;max-age=63072000; includeSubdomains; preload&quot;&lt;/em&gt;
    &lt;em&gt;# 添加 SSL 协议支持协议，去掉不安全的协议&lt;/em&gt;
    SSLProtocol all -SSLv2 -SSLv3
    &lt;em&gt;# 修改加密套件如下&lt;/em&gt;
    SSLCipherSuite HIGH:!RC4:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!EXP:+MEDIUM
    SSLHonorCipherOrder on
    &lt;em&gt;# 证书公钥配置&lt;/em&gt;
    SSLCertificateFile cert/dav.engr-z.com_apache/public.crt
    &lt;em&gt;# 证书私钥配置&lt;/em&gt;
    SSLCertificateKeyFile cert/dav.wangzhengzhen.com_apache/cert.key
    &lt;em&gt;# 证书链配置，如果该属性开头有 &#x27;#&#x27;字符，请删除掉&lt;/em&gt;
    SSLCertificateChainFile cert/dav.engr-z.com_apache/chain.crt
&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;.htpasswd 文件是保存用户名密码的文件，使用 apache 工具 htpasswd 创建：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;htpasswd -c /etc/webdav/.htpasswd user1&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;如果需要创建多个用户，在第二次执行时注意去掉 -c 参数，防止生成文件覆盖。&lt;/p&gt;



&lt;h2 id=&quot;nginx-开启-webdav&quot;&gt;Nginx 开启 WebDAV&lt;/h2&gt;



&lt;p&gt;在Nginx中实现WebDAV需要安装 libnginx-mod-http-dav-ext 模块，以下是Nginx的配置：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;server {
        listen 80;
        listen [::]:80;

        server_name dav.engr-z.com;
        auth_basic &quot;Authorized Users Only&quot;;
        auth_basic_user_file /etc/.htpasswd;

        location / {
                root /data/webdav;
                client_body_temp_path /var/temp;
                dav_methods PUT DELETE MKCOL COPY MOVE;
                dav_ext_methods PROPFIND OPTIONS;
                create_full_put_path on;
                client_max_body_size 10G;
        }
}

server {
        listen 443;
        listen [::]:443;
        server_name dav.engr-z.com;

        ssl on;
        ssl_certificate /data/www/cert/dav.engr-z.com_nginx/cert.pem;
        ssl_certificate_key /data/www/cert/dav.engr-z.com_nginx/cert.key;
        ssl_session_timeout 5m;
        ssl_protocols SSLv2 SSLv3 TLSv1;
        ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
        ssl_prefer_server_ciphers on;

        location / {
                root /data/webdav;
                client_body_temp_path /var/temp;
                dav_methods PUT DELETE MKCOL COPY MOVE;
                dav_ext_methods PROPFIND OPTIONS;
                create_full_put_path on;
                client_max_body_size 10G;
        }

}&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;.htpasswd 用户密码文件的创建方式和 Apache 一样，htpasswd是apache的工具，如果使用nginx，可以单独安装该工具而不安装整个apache。在Ubuntu中使用 sudo apt install apache2-utils 安装。&lt;/p&gt;



&lt;p&gt;Nginx 对 WebDAV 支持不是太好，建议使用 Apache 或专用于 WebDAV 服务软件架设。&lt;/p&gt;



&lt;h2 id=&quot;webdav挂载映射&quot;&gt;WebDAV挂载/映射&lt;/h2&gt;







&lt;p&gt;打开 “计算机” ，点右键添加一个网络位置，按向导填入地址，用户名，密码。&lt;/p&gt;







&lt;p/&gt;







&lt;p&gt;挂载指定盘符：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;net use Y: https://dav.engr-z.com/ /user:engrz /persistent:YES 密码&lt;/code&gt;&lt;/pre&gt;



&lt;blockquote class=&quot;wp-block-quote&quot;&gt;&lt;p&gt;其中 qizheng 是我的用户名&lt;br/&gt;密码把 password 换成对应的密码。&lt;br/&gt;/persistent 表示保存映射，下次开机还在。&lt;br/&gt;执行完，打开资源管理器，可以看到磁盘映射了。&lt;br/&gt;如果下次开机，发现不能打开磁盘，访问失败，可以检查 WebClient 服务是否开启。&lt;/p&gt;&lt;/blockquote&gt;







&lt;p&gt;从Windows Vista起，微软就禁用了http形式的基本WebDAV验证形式（KB841215），必须使用https连接。我们可以修改注册表……&lt;/p&gt;



&lt;p&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters&lt;br/&gt;找到BasicAuthLevel把这个值从1改为2，然后进控制面板，服务，把WebClient服务重启（没有启动的就启动它）。&lt;/p&gt;







&lt;p&gt;在某些版本的 Windows 操作系统中，WebDAV 驱动器的最大文件大小被限制为 50MB。如果你试图复制超过 50MB 大小的文件，Windows 就会弹出错误提示框。当然，这个限制是可以通过修改注册表来消除的。&lt;/p&gt;



&lt;p&gt;将注册表中位于&lt;br/&gt;HKLM\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\FileSizeLimitInBytes&lt;br/&gt;处的键值由 50000000 (50MB) 修改为更大的数值。最大修改为：4294967295（0xffffffff）字节，即4G。&lt;/p&gt;







&lt;p&gt;这里推荐使用免费软件 RaiDrive ，通过 RaiDrive 映射的磁盘，没有 http 和 上传文件大小限制，无需修改注册表。&lt;/p&gt;



&lt;p&gt;RaiDrive 是一款能够将一些网盘映射为本地网络磁盘的工具，支持 Google Drive、Google Photos、Dropbox、OneDrive、FTP、SFTP、WebDAV。&lt;/p&gt;







&lt;p&gt;下载地址：&lt;a href=&quot;https://www.raidrive.com&quot; target=&quot;_blank&quot; rel=&quot;noreferrer noopener&quot;&gt;https://www.raidrive.com&lt;/a&gt;&lt;/p&gt;







&lt;p&gt;Linux 的文件管理工具大多都支持 WebDAV ，以 Ubuntu 为例：&lt;/p&gt;



&lt;figure class=&quot;wp-block-image size-large&quot;&gt;&lt;img loading=&quot;lazy&quot; src=&quot;https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图.png&quot; alt=&quot;&quot; class=&quot;wp-image-249&quot; srcset=&quot;https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图.png 882w, https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图-300x200.png 300w, https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图-768x511.png 768w&quot; sizes=&quot;(max-width: 882px) 100vw, 882px&quot;/&gt;&lt;/figure&gt;



&lt;p&gt;还可以使用命令挂载，需要安装 davfs2 ：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;apt install davfs2&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;执行命令后系统会自动安装，出现以下提示，选是。&lt;/p&gt;







&lt;p&gt;挂载：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;sudo mount -t davfs http://dav.engr-z/ ./webdav/&lt;/code&gt;&lt;/pre&gt;
&lt;hr/&gt;&lt;/div&gt;&amp;#13;
&amp;#13;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>d137a12bd3fa14f07123f98a2fc2376f</guid>
<title>10 个内存引发的大坑，你能躲开几个？（一）</title>
<link>https://toutiao.io/k/s1b0ao9</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;p&gt;&lt;span&gt;对程序员来说内存相关的 bug 排查难度几乎和多线程问题并驾齐驱，&lt;strong&gt;当程序出现运行异常时可能距离真正有 bug 的那行代码已经很远了&lt;/strong&gt;，这就导致问题定位排查非常困难，这篇文章将总结涉及内存的一些经典 bug ，快来看看你知道几个，或者你的程序中现在有几个。。。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;返回局部变量地址&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们来看这样一段代码：&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;int &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__title&quot;&gt;fun&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  int a = &lt;span class=&quot;code-snippet__number&quot;&gt;2&lt;/span&gt;;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &amp;amp;a;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;void main() {  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   int* p = &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__title&quot;&gt;fun&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   *p = &lt;span class=&quot;code-snippet__number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这段代码非常简单，func 函数返回一个指向局部变量的地址，main 函数中调用 fun 函数，获取到指针后将其设置为 20。&lt;/span&gt;&lt;br/&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;你能看出这段代码有什么问题吗？&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;问题在于局部变量 a 位于 func 的栈帧中，当 func 执行结束，其栈帧也不复存在，因此 main 函数中调用 func 函数后得到的指针&lt;strong&gt;指向一个不存在的变量&lt;/strong&gt;：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.19765625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NLuDDj1hjicp6SvV3TZlDbEN3H5Raf6Lg767Uu3mZvic5mK1cV0KSGh4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-backw=&quot;578&quot; data-backh=&quot;114&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;尽管上述代码仍然可以“正常”运行，但如果后续调用其它函数比如funcB，那么指针p指向的内容将被 funcB 函数的栈帧内容覆盖掉，又或者修改指针 p 实际上是在破坏 funcB 函数的栈帧，这将导致极其难以排查的 bug。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h5 cid=&quot;n15&quot; mdtype=&quot;heading&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;错误的理解指针运算&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/h5&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;sum&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt;* arr, &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; len&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; sum = &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      sum += *arr;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      arr += &lt;span class=&quot;code-snippet__keyword&quot;&gt;sizeof&lt;/span&gt;(&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; sum;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这段代码本意是想计算给定数组的和，但上述代码并没有理解指针运算的本意。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;指针运算中的加1并不是说移动一个字节而是移动一个单位，&lt;strong&gt;指针指向的数据结构大小就是一个单位&lt;/strong&gt;。因此，如果指针指向的数据类型是 int，那么指针加 1 则移动 4 个字节(32位)，如果指针指向的是结构体，该结构体的大小为 1024 字节，那么指针加 1 其实是移动 1024 字节。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.46953125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NcsFVMoKOPtpWNJtB3beLyDjRqyPxosmbDZEd9t3JOw1oFibalVG0jgg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;从这里我们可以看出，&lt;strong&gt;移动指针时我们根本不需要关心指针指向的数据类型的大小&lt;/strong&gt;，因此上述代码简单的将arr += sizeof(int)改为arr++即可。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h5 cid=&quot;n22&quot; mdtype=&quot;heading&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;解引用有问题的指针&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/h5&gt;&lt;section&gt;&lt;span&gt;C语言初学者常会犯一个经典错误，那就是从标准输入中获取键盘数据，代码是这样写的：&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; a;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;%d&quot;&lt;/span&gt;, a);&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;很多同学并不知道这样写会有什么问题，因为上述代码有时并不会出现运行时错误。&lt;/span&gt;&lt;br/&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;原来 scanf 会将a的值当做地址来对待，并将从标准输入中获取到的数据写到该地址中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这时接下来程序的表现就取决于a的值了，而上述代码中局部变量a的值是不确定的，那么这时：&lt;/span&gt;&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-2&quot; start=&quot;&quot; cid=&quot;n28&quot; mdtype=&quot;list&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向代码区或者其它不可写区域，操作系统将立刻kill掉该进程，这是最好的情况，这时发现问题还不算很难&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向栈区，那么此时恭喜你，其它函数的栈帧已经被破坏掉了，那么程序接下来的行为将脱离掌控，这样的 bug 极难定位&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向堆区，那么此时也恭喜你，代码中动态分配的内存已经被你破坏掉了，那么程序接下来的行为同样脱离掌控，这样的bug也极难定位&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7838137472283814&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NfpWRoPPLGXgiaGiciaxTuiczehCnAGCYFrB8Tj1luambYodsf2GEWhbbmg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;902&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__0&quot;&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2934&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2935&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2936&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2937&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2938&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2939&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2940&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2941&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2942&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2943&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;伟&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2944&quot;&gt;伟&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2945&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2946&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;分&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2947&quot;&gt;分&lt;/span&gt;&lt;span data-raw-text=&quot;割&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2948&quot;&gt;割&lt;/span&gt;&lt;span data-raw-text=&quot;线&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2949&quot;&gt;线&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2950&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2951&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2952&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2953&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2954&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2955&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2956&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2957&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2958&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2959&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2960&quot;&gt;-&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzI0MjEwMDMzNQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/LHDiahSVnXhuEIChmoDpeesYyxoiaDWYice5SX31nCmv2QA1TuYxxudVAvwAwTT3ia0mrjHuicxSwLMJZM7MZcA6P2Q/0?wx_fmt=png&quot; data-nickname=&quot;PHP饭米粒&quot; data-alias=&quot;phpfamily&quot; data-signature=&quot;一群靠谱的人，愿为PHPer带来一些值得细细品味的精神食粮！&quot;/&gt;&lt;/section&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__1&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__2&quot;&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2961&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2962&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2963&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2964&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2965&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2966&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;(&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2967&quot;&gt;(&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2968&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2969&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2970&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;f&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2971&quot;&gt;f&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2972&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2973&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2974&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2975&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;y&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2976&quot;&gt;y&lt;/span&gt;&lt;span data-raw-text=&quot;)&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2977&quot;&gt;)&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;98&quot; data-index=&quot;2978&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2979&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2980&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;群&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2981&quot;&gt;群&lt;/span&gt;&lt;span data-raw-text=&quot;靠&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2982&quot;&gt;靠&lt;/span&gt;&lt;span data-raw-text=&quot;谱&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2983&quot;&gt;谱&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2984&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;人&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2985&quot;&gt;人&lt;/span&gt;&lt;span data-raw-text=&quot;建&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2986&quot;&gt;建&lt;/span&gt;&lt;span data-raw-text=&quot;立&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2987&quot;&gt;立&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2988&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;愿&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2989&quot;&gt;愿&lt;/span&gt;&lt;span data-raw-text=&quot;为&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2990&quot;&gt;为&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2991&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2992&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2993&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2994&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;r&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2995&quot;&gt;r&lt;/span&gt;&lt;span data-raw-text=&quot;带&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2996&quot;&gt;带&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2997&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2998&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;些&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2999&quot;&gt;些&lt;/span&gt;&lt;span data-raw-text=&quot;值&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3000&quot;&gt;值&lt;/span&gt;&lt;span data-raw-text=&quot;得&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3001&quot;&gt;得&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3002&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3003&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;品&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3004&quot;&gt;品&lt;/span&gt;&lt;span data-raw-text=&quot;味&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3005&quot;&gt;味&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3006&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;精&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3007&quot;&gt;精&lt;/span&gt;&lt;span data-raw-text=&quot;神&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3008&quot;&gt;神&lt;/span&gt;&lt;span data-raw-text=&quot;食&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3009&quot;&gt;食&lt;/span&gt;&lt;span data-raw-text=&quot;粮&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3010&quot;&gt;粮&lt;/span&gt;&lt;span data-raw-text=&quot;！&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3011&quot;&gt;！&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__3&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__4&quot;&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3012&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3013&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3014&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;只&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3015&quot;&gt;只&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3016&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3017&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;创&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3018&quot;&gt;创&lt;/span&gt;&lt;span data-raw-text=&quot;或&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3019&quot;&gt;或&lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3020&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3021&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3022&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;表&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3023&quot;&gt;表&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3024&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3025&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3026&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3027&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;不&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3028&quot;&gt;不&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3029&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3030&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;网&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3031&quot;&gt;网&lt;/span&gt;&lt;span data-raw-text=&quot;上&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3032&quot;&gt;上&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3033&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3034&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3035&quot;&gt;章&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__5&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__6&quot;&gt;&lt;span data-raw-text=&quot;所&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3036&quot;&gt;所&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3037&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3038&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3039&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3040&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3041&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;均&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3042&quot;&gt;均&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3043&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;找&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3044&quot;&gt;找&lt;/span&gt;&lt;span data-raw-text=&quot;到&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3045&quot;&gt;到&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3046&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3047&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3048&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;进&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3049&quot;&gt;进&lt;/span&gt;&lt;span data-raw-text=&quot;行&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3050&quot;&gt;行&lt;/span&gt;&lt;span data-raw-text=&quot;沟&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3051&quot;&gt;沟&lt;/span&gt;&lt;span data-raw-text=&quot;通&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3052&quot;&gt;通&lt;/span&gt;&lt;span data-raw-text=&quot;。&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3053&quot;&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__7&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__8&quot;&gt;&lt;span&gt;&lt;span data-raw-text=&quot;也&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3054&quot;&gt;也&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3055&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3056&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;各&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3057&quot;&gt;各&lt;/span&gt;&lt;span data-raw-text=&quot;位&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3058&quot;&gt;位&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3059&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3060&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;打&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3061&quot;&gt;打&lt;/span&gt;&lt;span data-raw-text=&quot;赏&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3062&quot;&gt;赏&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3063&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;算&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3064&quot;&gt;算&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3065&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3066&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;费&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3067&quot;&gt;费&lt;/span&gt;&lt;span data-raw-text=&quot;给&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3068&quot;&gt;给&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3069&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3070&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3071&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3072&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3073&quot;&gt;）&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3074&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;更&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3075&quot;&gt;更&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3076&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3077&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3078&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;家&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3079&quot;&gt;家&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3080&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3081&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3082&quot;&gt;投&lt;/span&gt;&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;102&quot; data-index=&quot;3083&quot;&gt;稿&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__9&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__10&quot;&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3085&quot;&gt;投&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3086&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3087&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;联&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3088&quot;&gt;联&lt;/span&gt;&lt;span data-raw-text=&quot;系&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3089&quot;&gt;系&lt;/span&gt;&lt;span data-raw-text=&quot;：&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3090&quot;&gt;：&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__11&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__12&quot;&gt;&lt;span data-raw-text=&quot;s&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3091&quot;&gt;s&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3092&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3093&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;n&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3094&quot;&gt;n&lt;/span&gt;&lt;span data-raw-text=&quot;z&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3095&quot;&gt;z&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3096&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3097&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;1&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3098&quot;&gt;1&lt;/span&gt;&lt;span data-raw-text=&quot;6&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3099&quot;&gt;6&lt;/span&gt;&lt;span data-raw-text=&quot;3&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3100&quot;&gt;3&lt;/span&gt;&lt;span data-raw-text=&quot;@&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3101&quot;&gt;@&lt;/span&gt;&lt;span data-raw-text=&quot;g&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3102&quot;&gt;g&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3103&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3104&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3105&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3106&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;.&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3107&quot;&gt;.&lt;/span&gt;&lt;span data-raw-text=&quot;c&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3108&quot;&gt;c&lt;/span&gt;&lt;span data-raw-text=&quot;o&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3109&quot;&gt;o&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3110&quot;&gt;m&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__13&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__14&quot;&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3111&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3112&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3113&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3114&quot;&gt;&lt;span&gt;  &lt;/span&gt;&lt;span&gt;&lt;span&gt;码农的荒岛求生&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3118&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3119&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3120&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3121&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3122&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3123&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3124&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3125&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3126&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;布&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3127&quot;&gt;布&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3128&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3129&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3130&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3131&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3132&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;明&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3133&quot;&gt;明&lt;/span&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3134&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3135&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;源&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3136&quot;&gt;源&lt;/span&gt;&lt;span data-raw-text=&quot;信&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3137&quot;&gt;信&lt;/span&gt;&lt;span data-raw-text=&quot;息&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3138&quot;&gt;息&lt;/span&gt;&lt;span data-raw-text=&quot;和&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3139&quot;&gt;和&lt;/span&gt;&lt;span data-raw-text=&quot;以&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3140&quot;&gt;以&lt;/span&gt;&lt;span data-raw-text=&quot;下&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3141&quot;&gt;下&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3142&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3143&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3144&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3145&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3146&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;长&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3147&quot;&gt;长&lt;/span&gt;&lt;span data-raw-text=&quot;按&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3148&quot;&gt;按&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3149&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;识&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3150&quot;&gt;识&lt;/span&gt;&lt;span data-raw-text=&quot;别&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3151&quot;&gt;别&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3152&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3153&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3154&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;关&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3155&quot;&gt;关&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3156&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3157&quot;&gt;）&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__15&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;1&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/LHDiahSVnXhunbEtuowcI7kF5kmUaeTrszibibQ3st6OU8hy2CoIotHHLxicicibyF1qkNI7HibXYHXGN6hRby4ZyjR6A/640?wx_fmt=jpeg&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7272727272727273&quot; data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; data-w=&quot;198&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/dFZyR2JHA40ooBMYVEUxJCPXf4gibCfn7o9SibGwiaIsQFLIZj1fTCMntcXzojwibkvqgTMOiaw14icRwQkP7zNNO7Hw/640?wx_fmt=jpeg&quot;/&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;素质三连biubiubiu~&lt;img data-ratio=&quot;1&quot; data-type=&quot;png&quot; data-w=&quot;64&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/b96CibCt70iaajvl7fD4ZCicMcjhXMp1v6UibM134tIsO1j5yqHyNhh9arj090oAL7zGhRJRq6cFqFOlDZMleLl4pw/640?wx_fmt=png&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>da8010d4f3b8b6f285704ade7342ece6</guid>
<title>Java 实现大文件多线程下载，提速 30 倍！想学？我教你啊</title>
<link>https://toutiao.io/k/jvd3wnb</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;前言&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上一篇文章 《面试篇》Http协议 中，我们有提到大文件下载和断点续传，本篇我们就来开发一个多线程文件下载器，最后我们用这个多线程下载器来突破下载的限速。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;兄弟们看到这个标题可能会觉得是个标题党，为了解决疑虑，我们先来看下最终的测试结果：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试云盘下载的文件 46M，自己本地最大下载速度 2M&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1. 单线程下载，总耗时: 603s&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.40326633165829145&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYPqufy2ZRcMwicDCI8GmEvPXV3ibnh1m1y8DtzjKvNjMb6OWDAonoo4g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1592&quot;/&gt;&lt;/figure&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2. 多线程下载，50个线程，总耗时：13s&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.30311231393775373&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFZmndGed2WKA9ZZslhWGhS7jFMibKskmicqVRCEt3iaC2tGb5cLZo9WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1478&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试结果，&lt;strong&gt;「提速46倍」&lt;/strong&gt;，我还是太谦虚了，只说提速30倍，此处我们觉得应该有掌声（我听不到，还是点赞实在）&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQoZPHZKqHuUgj73VhdAQia6WG5ANwAMjFFD5ZAae0GjZuZdQicbG0029g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;255&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;❝&lt;/span&gt;&lt;p&gt;源码地址：https://gitee.com/silently9527/fast-download&lt;/p&gt;&lt;p&gt;喜欢请记得star哦&lt;/p&gt;&lt;span&gt;❞&lt;/span&gt;&lt;/blockquote&gt;&lt;hr data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;HTTP协议Range请求头&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Range主要是针对只需要获取部分资源的范围请求，通过指定Range即可告知服务器资源的指定范围。格式: &lt;code&gt;Range: bytes=start-end&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如：获取字节范围 5001-10000&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;Range: bytes=5001-10000&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;也可以指定开始位置不指定结束位置，表示获取开始位置之后的全部数据&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;Range: bytes=5001-&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;服务器接收到带有&lt;code&gt;Range&lt;/code&gt;的请求，会在处理请求之后返回状态码为&lt;code&gt;206 Partial Content&lt;/code&gt;的响应。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;基于Range的特性，我们就可以实现文件的多线程下载，文件的断点续传&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;准备工作&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文我们使用的SpringMVC中的&lt;code&gt;RestTemplate&lt;/code&gt;；由于云盘的链接是Https，所以我们需要设置&lt;code&gt;RestTemplate&lt;/code&gt;绕过证书验证&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;pom.xml&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5043859649122807&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQF1fkfGpQtt03eSGh1xMtH5pka7fC0D2FYnnS5tnvl2Jvv3Cwg9pjeA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;912&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;pom.xml&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;编写&lt;code&gt;RestTemplate&lt;/code&gt;的构造器，以及绕过https的证书验证&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.7910798122065728&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQcqKwWicEmibbegiaWibaBxkQqugm4jdia8CkrzdALLk4mKtzCIRTwFgVFDw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1704&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;RestTemplateBuilder&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;在下载的过程中，我们需要知道当前下载的速度是多少，所以需要定义一个显示下载速度的接口&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ5fUMV5ICxqkVzwdjA12Pf9ia4pYKiaYaawk4P7FK0ImXiaDc0E6AQy5Kw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1064&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;DisplayDownloadSpeed&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为计算下载速度，我们需要知道每秒传输的字节数是多少，为了监控传输数据的过程，我们需要了解SpringMVC中的接口&lt;code&gt;ResponseExtractor&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4767277856135402&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQLkxLMKv1NHuSHAPMwR0jQ9kBjUNe87XV8SuianhbqaXpwS5ON8Bibgpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1418&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;ResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该接口只有一个方法，当客户端和服务器端连接建立之后，会调用这个方法，我们可以在这个方法中监控下载的速度。&lt;/p&gt;&lt;ol start=&quot;4&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;DisplayDownloadSpeed&lt;/code&gt;接口的抽象实现 &lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.015625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQkfoic5voia3sJTbNAo9EdiagertfyWd8LWorOPNYfl5BtdTiaqnxm9luNQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2048&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;5&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;整个项目主要涉及到的类图&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6476014760147601&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ8alvn1Tv5Mur5g4XKuvc6Aj5nWmAnxbwNYTcib2Z9NaH3TZyrgnaQpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1084&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;简单的文件下载器&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里使用的是restTemplate调用&lt;code&gt;execute&lt;/code&gt;, 先文件获取到字节数组, 再将字节数组直接写到目标文件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里我们需要注意的点是: 这种方式会将文件的字节数组全部放入内存中, 及其消耗资源；我们来看看如何实现。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;创建&lt;code&gt;ByteArrayResponseExtractor&lt;/code&gt;类继承&lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5386934673366834&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQt0NUeNuxEHTO3MLibrerDJdZnmSu376tJAe8n0uwu0xb8auK8bdnibAw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1990&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;ByteArrayResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;调用&lt;code&gt;restTemplate.execute&lt;/code&gt;执行下载，保存字节数据到文件中&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.22433862433862434&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQnhV7RhYX8bGc6cib0upHF9E8j5Wvje9Oic80KTpyQPoza2ZiaVjANcVfA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1890&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1972534332084894&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQicpGkQ03NMyDbhAZcszJ8fqCPK04W7FgAhhrJChGBVtF6Vfhs7pxU6w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1602&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5071174377224199&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQovibbCAicGo3g2bafgmKmfSqNiaJ75ibRWpNZyibV2FSJSAaYIARunkciaaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1124&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行一段时间之后，我们可以看到内存已经使用了800M左右，所以这种方式只能使用于小文件的下载，如果我们下载几G的大文件，内存肯定是不够用的。至于下载时间，因为文件太大也没有等下载完成就结束了程序。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;单线程大文件下载&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的方式只能下载小的文件，那大文件的下载我们该用什么方式呢？我们可以把流输出到文件而不是内存中。接下来我们来实现我们大文件的下载。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;创建&lt;code&gt;FileResponseExtractor&lt;/code&gt;类继承&lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;，把流输出到文件中&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6082474226804123&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQTEaNYWwmj08h1YkHw5ev7qZCWea5iaLQfusibC6OibtemNDTFEFSsaLvw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1940&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;文件下载器，先把流输出到临时下载文件（xxxxx.download），下载完成后在重命名文件&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.31890179514255546&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQVZGLic8EY5x8chrK1a4NCjDEnn5QRBsHHyV22AJu8x6u0ibh5B5jjqoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1894&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20572916666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFkIPOZWOW7J2ypPdGVS81oHJGgD8icLGGicHnnfibOicK7Bxic8yqACbtg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1536&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行一段时间之后，我们再看看下内存的使用情况，发现这种方式内存消耗较少，效果比较理想，下载时间：199s&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4954954954954955&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ4c2icBrvwhibR1T6TsGIXZ3GVwj7do3dKnBYnZ0gIdu31Gl7BOiaT9btg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1110&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.21212121212121213&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYeJhTsDkLdmzezcNKDnppibk6GWcD52YjKeWNeoH2ia8sx4Q1ZFRoLbg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1452&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;多线程文件下载&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果服务器不限速的话，通常能够把自己本地的带宽给跑满，那么使用单线程下载就够了，但是如果遇到服务器限速，下载速度远小于自己本地的带宽，那么可以考虑使用多线程下载。多线程我们使用&lt;code&gt;CompletableFuture&lt;/code&gt;（可以参考之前的文章 《CompletableFuture让你的代码免受阻塞之苦》）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现多线程文件下载的基本流程：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;首先我们通过Http协议的Head方法获取到文件的总大小&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;然后根据设置的线程数均分文件的大小，计算每个线程的下载的字节数据开始位置和结束位置&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;开启线程，设置HTTP请求头Range信息，开始下载数据到临时文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;下载完成后把每个线程下载完成的临时文件合并成一个文件&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;完成代码如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0714985308521057&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ0YiaqOUMYt63dubaia7jdPDbYrWuia0zqfbuCySKFTkJEKkK9okibRSITw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2042&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;开启30个线程测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20441347270615565&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQOJ57WRO47iaAyPgNsnRnuaicY7WpicLqXLnyxZ24gcLv5MG7cN3OKojrQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1722&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4865350089766607&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQcwpIfrZQzicVNuTBIK9sprabz05XZejSlqbPTzadcyyf1Ee31zgd9cA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1114&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2981651376146789&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQfWicrJww3VUibsg2nxo306EV3ZsBNQhJCCbgTr66wl5ZsKDSEa9qbDRg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1308&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从执行的结果上来看，因为开启了30个线程同时在下载，内存的占用要比单线程消耗的多，但是也在接受范围内，下载时间：81s，速度提升2.5倍，这是因为idea的下载服务器没有限速，本次多线程速度的提升仅仅是在充分的压榨本地的带宽，所以提示的幅度不大。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;单线程下载和对线程下载对比测试&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为云盘对单个线程的下载速度做了限制，大概是在100kb，所以我们使用云盘的下载链接，来测试多线程和单线程的下载速度。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;测试云盘中 46M 的文件的下载速度，自己本地最大下载速度 2M&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;获取文件的下载地址&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.27808988764044945&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQtppmZFbB45LYtFnhVA7xlubiaQBqic8c7NqeXY0JOolJiawEpvt4uiaUJQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1424&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;❝&lt;/span&gt;&lt;p&gt;注意：从浏览器中获取的链接需要先使用URLDecode解码，否则下载会失败，并且云盘文件的下载链接是有时效性的，过期后就不能在下载，需要重新生成下载链接&lt;/p&gt;&lt;span&gt;❞&lt;/span&gt;&lt;/blockquote&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;测试单线程下载文件&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.40326633165829145&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYPqufy2ZRcMwicDCI8GmEvPXV3ibnh1m1y8DtzjKvNjMb6OWDAonoo4g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1592&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行的结果可以看出，云盘对单线程的下载限速真的是丧心病狂， 46M的文件下载需要耗时：600s&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;测试多线程下载文件&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了充分的压榨网速，找出最合适的线程数，所以测试了不同线程数的下载速度&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;线程数&lt;/th&gt;&lt;th&gt;下载总耗时&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;60s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;20&lt;/td&gt;&lt;td&gt;30s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;30&lt;/td&gt;&lt;td&gt;21s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;40&lt;/td&gt;&lt;td&gt;15s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;13s&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从测试的结果上来看，对于自己的运行环境把线程数设置在30个左右比较合适&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.30311231393775373&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFZmndGed2WKA9ZZslhWGhS7jFMibKskmicqVRCEt3iaC2tGb5cLZo9WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1478&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;最后（点关注，不迷路）&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;文中或许会存在或多或少的不足、错误之处，有建议或者意见也非常欢迎大家在评论交流。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后，&lt;strong&gt;「创作不易，请不要白嫖」&lt;/strong&gt;，希望朋友们可以&lt;strong&gt;「点赞」&lt;/strong&gt;，因为这些就是我分享的全部动力来源🙏&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>