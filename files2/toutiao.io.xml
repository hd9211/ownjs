<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>29933b397fc6852d6515c6824f94755c</guid>
<title>又一个大数据相关项目成为顶级项目</title>
<link>https://toutiao.io/k/pcnig17</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;2021年01月21日，Apache 官方博客宣布 项目 Apache® Superset™ 成为顶级项目。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.6006066734074823&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZHSPoS2VNICT4xTGMFRBYaGxfJkVlEulcZkOMoXYPLpO5Aiczvk6PKPA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;989&quot;/&gt;&lt;/p&gt;&lt;p&gt;Apache® Superset™ 是一个现代化的大数据探索和可视化平台，它允许用户使用简单的无代码可视化构建器和最先进的 SQL 编辑器轻松快速地构建仪表盘（dashboards）。该项目于2015年在 Airbnb 启动，并于2017年5月进入 Apache 孵化器。说白了，其实 Apache Superset 算是一个大数据相关的 BI 可视化工具。&lt;/p&gt;&lt;p&gt;Apache Superset 主要有以下功能：&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;开箱即用的丰富数据可视化工具；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;一个易于使用的界面，用于探索和可视化数据；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;创建和共享仪表盘；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;与主要身份验证提供商集成的企业级身份验证；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;一个可扩展的、高粒度的安全/权限模型，允许对任何人进行访问单个特性和数据集制定复杂的控制；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;一个简单的语义层，允许用户通过定义哪些字段应该显示在哪个下拉列表中，以及向用户提供聚合和功能度量等功能；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;通过 SQLAlchemy 与绝大多数 RDBMS 集成；&lt;/span&gt;&lt;span&gt;&lt;span&gt;•&lt;/span&gt;和 Druid.io 进行深度整合。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Superset 是云原生的，具有高可用性。它被设计成可扩展到大型的分布式环境中，并且支持在容器中工作。Apache Superset 支持以下多种数据库：&lt;/p&gt;&lt;p&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZaHxl6nibHksK5RfDz8FWfU4sKIdmxAM0C307VBIcMUdY75odvibRjuhQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-ratio=&quot;0.3563777994157741&quot; data-w=&quot;1027&quot;/&gt;&lt;/p&gt;&lt;p&gt;Apache Superset 目前在 Airbnb、Netflix、Twitter、Yahoo! 以及国内的去哪儿网、bilibili、快手、豆瓣、VIPKID。完整列表可以参见 &lt;span&gt;Superset Users in the Wild&lt;sup&gt;[2]&lt;/sup&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p&gt;下面是 &lt;span&gt;Apache Superset&lt;/span&gt; 的几张界面图。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.6125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZjISYian3icMOTZm4hia17zDpuQTUfWIkDWCIIdP8ZYEMknsvhBkjxk5eg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.659375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZaxGIMVqVNG8HJtWVPzjv9lC3mkTictzxaVVpPicLooW6drH04DANX5VQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.66953125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZkGIFiaVlkIaD2icJ7Mc3dZWBC8qQmZ8pYtNUZjwkOQMSpTgWPnPsaNTg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.63046875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0yBD9iarX0nsaDiaibul7jeGlAdyGmqkUTZewgiceIAJTMLln0TdfnuQzOtWAYTwOCVkRb9FLVMSIw7EJSQ9WiaJxUQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;更多关于 Apache Superset 可以参见其官方博客：https://superset.apache.org/&lt;/p&gt;&lt;h4&gt;引用链接&lt;/h4&gt;&lt;p&gt;&lt;code&gt;[1]&lt;/code&gt; Apache® Superset™ 成为顶级项目: &lt;em&gt;https://blogs.apache.org/foundation/entry/the-apache-software-foundation-announces70&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[2]&lt;/code&gt; Superset Users in the Wild: &lt;em&gt;https://github.com/apache/superset/blob/master/INTHEWILD.md&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;br/&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Java与大数据架构&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;    7年老码农，10W+关注者。【Java与大数据架构】全面分享Java编程、Spark、Flink、Kafka、Elasticsearch、数据湖等干货。欢迎扫码关注！&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-backh=&quot;53&quot; data-backw=&quot;53&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;261&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;261&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/DicvpKIBbiaxdvguk5d6BgaNvk9mvMnmtickzXEXDx2LanlKMT1GKtSM3PXGXFGBjanYt4pGFT4OF9aQC35ok7nOQ/640?wx_fmt=jpeg&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;/&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>949c124a65531f129955049f09614032</guid>
<title>阿里面试官：接口的幂等性怎么设计？</title>
<link>https://toutiao.io/k/411ns26</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;点上面👆 &lt;/span&gt;&lt;span&gt;蓝色字体&lt;/span&gt;&lt;span&gt; 关注我呀&lt;/span&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大家好，我是狂聊。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;自己最近负责的几个接口，都涉及到了幂等性的操作，抽空总结了一下，这也是面试官比较爱问的问题。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;一、什么是幂等？&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;看一下维基百科怎么说的：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.17543859649122806&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/RM9eAwLoEFDPRfcekR0DyibxR5rvibL7EEpicqEjz7IQTLteKVtXEbQtFfrTsW6AD2Vh5btetREMWu2CPYibKBj6IA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1596&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;幂等性：&lt;/strong&gt;多次调用方法或者接口不会改变业务状态，可以保证重复调用的结果和单次调用的结果一致。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;二、使用幂等的场景&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;1、前端重复提交&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用户注册，用户创建商品等操作，前端都会提交一些数据给后台服务，后台需要根据用户提交的数据在数据库中创建记录。如果用户不小心多点了几次，后端收到了好几次提交，这时就会在数据库中重复创建了多条记录。这就是接口没有幂等性带来的 bug。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;2、接口超时重试&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于给第三方调用的接口，有可能会因为网络原因而调用失败，这时，一般在设计的时候会对接口调用加上失败重试的机制。如果第一次调用已经执行了一半时，发生了网络异常。这时再次调用时就会因为脏数据的存在而出现调用异常。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;3、消息重复消费&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在使用消息中间件来处理消息队列，且手动 ack 确认消息被正常消费时。如果消费者突然断开连接，那么已经执行了一半的消息会重新放回队列。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当消息被其他消费者重新消费时，如果没有幂等性，就会导致消息重复消费时结果异常，如数据库重复数据，数据库数据冲突，资源重复等。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;三、解决方案&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;1、token 机制实现&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过token 机制实现接口的幂等性,这是一种比较通用性的实现方法。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;示意图如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7366946778711485&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/RM9eAwLoEFDPRfcekR0DyibxR5rvibL7EEA2lOicfdKOGZdjYBPBmkbIoWoictibiavaALJrn6jCu0LzCibSibgTicBqe0w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1428&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体流程步骤：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;客户端会先发送一个请求去获取 token，服务端会生成一个全局唯一的 ID 作为 token 保存在 redis 中，同时把这个 ID 返回给客户端&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;客户端第二次调用业务请求的时候必须携带这个 token&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;服务端会校验这个 token，如果校验成功，则执行业务，并删除 redis 中的 token&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果校验失败，说明 redis 中已经没有对应的 token，则表示重复操作，直接返回指定的结果给客户端&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;对 redis 中是否存在 token 以及删除的代码逻辑建议用 Lua 脚本实现，保证原子性&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;全局唯一 ID 可以用百度的 uid-generator、美团的 Leaf 去生成&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;2、基于 mysql 实现&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种实现方式是利用 mysql 唯一索引的特性。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;示意图如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.45917001338688085&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/RM9eAwLoEFDPRfcekR0DyibxR5rvibL7EEG0ia0ukcWXHbKX7gVScGVibawJXgFh9FWjJWg89jFgYjCbrwy8An9OTw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1494&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体流程步骤：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;建立一张去重表，其中某个字段需要建立唯一索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;客户端去请求服务端，服务端会将这次请求的一些信息插入这张去重表中&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;因为表中某个字段带有唯一索引，如果插入成功，证明表中没有这次请求的信息，则执行后续的业务逻辑&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果插入失败，则代表已经执行过当前请求，直接返回&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;3、基于 redis 实现&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种实现方式是基于 SETNX 命令实现的&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;SETNX key value：将 key 的值设为 value ，当且仅当 key 不存在。若给定的 key 已经存在，则 SETNX 不做任何动作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该命令在设置成功时返回 1，设置失败时返回 0。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;示意图如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4375821287779238&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/RM9eAwLoEFDPRfcekR0DyibxR5rvibL7EEPVHpU4KoEBYul9O6CiaUsb3KASGW5SdiaaPebibuygTOBYo03ha5GCxgA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1522&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体流程步骤：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;客户端先请求服务端，会拿到一个能代表这次请求业务的唯一字段&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;将该字段以 SETNX 的方式存入 redis 中，并根据业务设置相应的超时时间&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果设置成功，证明这是第一次请求，则执行后续的业务逻辑&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果设置失败，则代表已经执行过当前请求，直接返回&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;总结&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这几种实现幂等的方式其实都是大同小异的，类似的还有使用状态机、悲观锁、乐观锁的方式来实现，都是比较简单的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;总之，当你去设计一个接口的时候，幂等都是首要考虑的问题，特别是当你负责设计转账、支付这种涉及到 money 的接口，你要格外注意喽！&lt;/p&gt;&lt;hr data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;关注公众号回复 &lt;strong&gt;666&lt;/strong&gt;,领取最新面试资料&lt;/p&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;section data-support=&quot;96编辑器&quot; data-style-id=&quot;457&quot;&gt;&lt;section data-support=&quot;96编辑器&quot; data-style-id=&quot;24243&quot;&gt;&lt;section&gt;&lt;p data-width=&quot;30%&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-support=&quot;96编辑器&quot; data-style-id=&quot;13029&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;95%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;往期精选&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;18%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;围观&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;67.86%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/cZkI8M0nbCkKcYoKu5U7GymlsRG3pCttlxO2OZ8v8ze2O1jndGXs7xqBHQwc2Y30uibqtvnCd28f91XCNEUhKew/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;100&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2NjU1NjE2Ng==&amp;amp;mid=2247484354&amp;amp;idx=1&amp;amp;sn=a0f44d030e29c3ab379d9b08478812dd&amp;amp;chksm=ce4843abf93fcabd2b1ed2234d2d1c3805adc95811196814b69893d0f5806dec68e53a5c3a5c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;我的舍友去面试字节跳动啦&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;我的舍友去面试字节跳动啦！&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;16%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;18%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;热文&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;67.86%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2NjU1NjE2Ng==&amp;amp;mid=2247484268&amp;amp;idx=1&amp;amp;sn=b8611f83292077654938b34ae6ee4ebc&amp;amp;chksm=ce484305f93fca13a4ab32362bd6d2e1f64c9268d5961a990ef0103ea3b18380ee9f9b2c3edf&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;万字的java垃圾回收，看完必会&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;万字的java垃圾回收，看完必会！&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;14.14%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;18%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;热文&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;67.86%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2NjU1NjE2Ng==&amp;amp;mid=2247484286&amp;amp;idx=1&amp;amp;sn=af59f6573a750b6bae3fb2900bfb8d74&amp;amp;chksm=ce484317f93fca01a6606ba119dab9b25c8e1f5e24ee8686c12c7ef54b58d302fd447ebe8284&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Mysql缓存池原理&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;面试官：说一说Mysql缓存池原理！&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;14.14%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;18%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;热文&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;67.86%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2NjU1NjE2Ng==&amp;amp;mid=2247483936&amp;amp;idx=1&amp;amp;sn=b4bb5e73e0b97c85453adf0aa93bdcab&amp;amp;chksm=ce484249f93fcb5f6d7de36c8f10569481f3bcc26c000e931800a5eb47123d4f2d01e5f9624c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;jvm基础、类加载机制&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;jvm基础、类加载机，还记得吗？&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;14.14%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-support=&quot;96编辑器&quot; data-style-id=&quot;25026&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;30%&quot;&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/RM9eAwLoEFB3DlhpNEm66dUvKr2bNXUrCYvXH9eaF93RF84ZMLvh7L8g2Sndlbywg3aVtlK3XoxfRgHe1Nd0VA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;60%&quot;&gt;&lt;p&gt;&lt;span&gt;长按二维码关注我&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;有趣的灵魂在等你&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;一个爱看球的程序员&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>a0efd08c78a9f18ab144deab98644739</guid>
<title>Go：基于 GORM 获取当前请求所执行的 SQL 信息</title>
<link>https://toutiao.io/k/a5tn1ue</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;前言&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了便于精准排查问题，需要将当前的请求信息与当前执行的 SQL 信息设置对应关系记录下来，记录的 SQL 信息包括：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;执行 SQL 的当前时间；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行 SQL 的文件地址和行号；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行 SQL 的花费时长；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行 SQL 的影响行数；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;执行的 SQL 语句；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据库组件使用的是 &lt;code&gt;GORM&lt;/code&gt;。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;思路&lt;/span&gt;&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;1、在执行 SQL 前，设置开始执行时间（计算执行时长会用到）；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;2、在执行 SQL 后，第一，获取当前请求的上下文，为什么获取上下文，因为需要从上下文中获取本次请求信息，第二，获取 SQL 执行前的时间，用来计算执行时长，第三，获取执行的 SQL 信息，然后将数据设置到 &lt;code&gt;Trace&lt;/code&gt; 中，&lt;code&gt;Trace&lt;/code&gt; 是项目中链路包，后面文章会对其介绍；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面需要用到 &lt;code&gt;GORM&lt;/code&gt; 两个 知识点  &lt;code&gt;Callbacks&lt;/code&gt; 和 &lt;code&gt;Context&lt;/code&gt;，这两个是在 &lt;code&gt;GORM V2&lt;/code&gt; 才有的，需要 import 的包为 &lt;code&gt;gorm.io/gorm&lt;/code&gt;。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;演示代码&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Context&lt;/code&gt; 的传递需要使用 &lt;code&gt;GORM V2&lt;/code&gt; 提供的 &lt;code&gt;WithContext()&lt;/code&gt; 方法。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;func (u *userRepo) getUserByID(ctx core.Context, id uint) (*user_model.UserDemo, error) {&lt;br/&gt; data := new(user_model.UserDemo)&lt;br/&gt; err := u.db.GetDbR().WithContext(ctx).First(data, id).Error&lt;br/&gt; &lt;span&gt;if&lt;/span&gt; err != nil {&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; nil, errors.Wrap(err, &lt;span&gt;&quot;[user_demo] get user data err&quot;&lt;/span&gt;)&lt;br/&gt; }&lt;br/&gt; &lt;span&gt;return&lt;/span&gt; data, nil&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;编写 &lt;code&gt;CallBacks&lt;/code&gt; 插件代码，GORM 的 Plugin 接口的编写非常简单，只需要实现两个方法即可。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;// Plugin GORM plugin interface&lt;br/&gt;&lt;span&gt;type&lt;/span&gt; Plugin interface {&lt;br/&gt; Name() string&lt;br/&gt; Initialize(*DB) error&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面是我写的插件代码：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;type&lt;/span&gt; TracePlugin struct{}&lt;br/&gt;&lt;br/&gt;func (op *TracePlugin) Name() string {&lt;br/&gt; &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;tracePlugin&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;func (op *TracePlugin) Initialize(db *gorm.DB) (err error) {&lt;br/&gt; // 开始前&lt;br/&gt; _ = db.Callback().Create().Before(&lt;span&gt;&quot;gorm:before_create&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt; _ = db.Callback().Query().Before(&lt;span&gt;&quot;gorm:query&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt; _ = db.Callback().Delete().Before(&lt;span&gt;&quot;gorm:before_delete&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt; _ = db.Callback().Update().Before(&lt;span&gt;&quot;gorm:setup_reflect_value&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt; _ = db.Callback().Row().Before(&lt;span&gt;&quot;gorm:row&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt; _ = db.Callback().Raw().Before(&lt;span&gt;&quot;gorm:raw&quot;&lt;/span&gt;).Register(callBackBeforeName, before)&lt;br/&gt;&lt;br/&gt; // 结束后&lt;br/&gt; _ = db.Callback().Create().After(&lt;span&gt;&quot;gorm:after_create&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; _ = db.Callback().Query().After(&lt;span&gt;&quot;gorm:after_query&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; _ = db.Callback().Delete().After(&lt;span&gt;&quot;gorm:after_delete&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; _ = db.Callback().Update().After(&lt;span&gt;&quot;gorm:after_update&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; _ = db.Callback().Row().After(&lt;span&gt;&quot;gorm:row&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; _ = db.Callback().Raw().After(&lt;span&gt;&quot;gorm:raw&quot;&lt;/span&gt;).Register(callBackAfterName, after)&lt;br/&gt; &lt;span&gt;return&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;var _ gorm.Plugin = &amp;amp;TracePlugin{}&lt;br/&gt;&lt;br/&gt;func before(db *gorm.DB) {&lt;br/&gt; db.InstanceSet(startTime, time.Now())&lt;br/&gt; &lt;span&gt;return&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;func after(db *gorm.DB) {&lt;br/&gt; _ctx := db.Statement.Context&lt;br/&gt; ctx, ok := _ctx.(core.Context)&lt;br/&gt; &lt;span&gt;if&lt;/span&gt; !ok {&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt;&lt;br/&gt; }&lt;br/&gt;&lt;br/&gt; _ts, isExist := db.InstanceGet(startTime)&lt;br/&gt; &lt;span&gt;if&lt;/span&gt; !isExist {&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt;&lt;br/&gt; }&lt;br/&gt;&lt;br/&gt; ts, ok := _ts.(time.Time)&lt;br/&gt; &lt;span&gt;if&lt;/span&gt; !ok {&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt;&lt;br/&gt; }&lt;br/&gt;&lt;br/&gt; sql := db.Dialector.Explain(db.Statement.SQL.String(), db.Statement.Vars...)&lt;br/&gt;&lt;br/&gt; sqlInfo := new(trace.SQL)&lt;br/&gt; sqlInfo.Timestamp = time_parse.CSTLayoutString()&lt;br/&gt; sqlInfo.SQL = sql&lt;br/&gt; sqlInfo.Stack = utils.FileWithLineNum()&lt;br/&gt; sqlInfo.Rows = db.Statement.RowsAffected&lt;br/&gt; sqlInfo.CostSeconds = time.Since(ts).Seconds()&lt;br/&gt; ctx.Trace().AppendSQL(sqlInfo)&lt;br/&gt;&lt;br/&gt; &lt;span&gt;return&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后，在 db 连接的时候使用这个插件：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;// 使用插件&lt;br/&gt;db.Use(&amp;amp;TracePlugin{})&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;效果&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.73671875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/go9jpG3BuhRAwFPhA4o0tzpH6A8B1qwAJqhgWJSzrxeToB4VmibhGvwaqnG8jm32sKDVCYVAhgiclOysXdePZRlw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;小结&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这是编写的 &lt;code&gt;trace&lt;/code&gt; 包的一部分，这个包可以记录这些信息（JSON 格式）：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;支持设置 trace_id&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;支持设置 request 信息&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;支持设置 response 信息&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;支持设置 third_party_requests 三方请求信息&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;支持设置 debugs 打印调试信息&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;支持设置 sqls 执行 SQL 信息&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;可记录 cost_seconds 执行时长&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上代码在 go-gin-api 项目中，地址：&lt;/p&gt;&lt;section&gt;github.com/xinliangnote/go-gin-api&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.3649122807017544&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/go9jpG3BuhSgPWaHKyJBicNNsuF8w3M8icxO4FapeT1fHQIicegugNFQeaXIn78Sld4zmbvbWHCK0DmqXj1rS5LibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1710&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;/&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>bc85388dff36af7c9386638e9c947ac3</guid>
<title>一个 20 年技术老兵的 2020 的年度总结</title>
<link>https://toutiao.io/k/bs9ak6c</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;preview&quot;&gt;&lt;p&gt;大家好！我是 go-zero 作者 Kevin。充满惊吓的 2020 快要过去了，看到掘金上的技术人年度征文，忍不住文字记录一下艰辛而又充满收获的 2020 ✍️&lt;/p&gt;

&lt;h2&gt;疫情开始&lt;/h2&gt;

&lt;p&gt;春节假期疫情突然升级，我们面临着自身平台的转型升级。作为 CTO，有两个重点工作：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;保证大规模使用平台稳定&lt;/li&gt;
&lt;li&gt;保证转型所需的新业务能够快速交付&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;团队压力巨大的同时也感受到了前所未有的战斗热情，养兵千日用兵一时，不经历战与火的洗礼，怎么知道团队的技术能力是否能够经受得住流量洪峰的考验。&lt;/p&gt;

&lt;p&gt;战斗开始，迅速落实业务团队进行急需功能的开发，并行安排架构团队进行技术隐患排查、演练、攻关。&lt;/p&gt;

&lt;p&gt;在大概两个月的时间里，我们基本一日三餐都在电脑桌前，困了就睡觉，醒来写代码（当然还有必要的开会），这真是人生一段非常难忘的特殊经历。。。&lt;/p&gt;

&lt;h2&gt;开始踩坑&lt;/h2&gt;

&lt;p&gt;随着所需功能的极速上线，我们马上开始了大规模压测，大坑如下：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;大量请求失败，然而服务端压力一切正常，一顿排查，发现原来是进到内网的请求被 nginx 转发时又打到外网了，而外网我们是启动了 WAF(Web Access Firewall)，WAF 会认为所有用户都来自我们内网的那些 IP，这“明显”是攻击嘛，于是 drop 了大量请求，由此，我们指定了规则：进到内网的请求不允许转发到外网。&lt;/li&gt;
&lt;li&gt;为了快速实现功能，有同学用 nodejs 实现了部分功能，部署到 k8s 集群里，流量一起来，nodejs pod 立马扛不住，再加上难以控制的内存泄露，让我们迅速决定不再允许使用 nodejs 做后端，使用 nodejs 纯属“意外”。&lt;/li&gt;
&lt;li&gt;某云厂商 oss 存储用的 LSM Tree 方式实现，在小文件突发增加时无法及时分裂，导致我们访问量大时出现两次 oss 访问故障。后来我们自己多申请了几个 bucket 来从代码层分散文件存储请求。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;实战效果&lt;/h2&gt;

&lt;p&gt;经过前后一个月开发、压测和开学前演练，我们的系统基本满足开学需求了，接下来就是接受实战检验了。&lt;/p&gt;

&lt;p&gt;开学第一天，我们遇到的第一个问题部分服务供应商无法承载流量压力，虽然我们之前盘算过，也充分交流过，但还是未能预料到洪峰流量的凶猛，服务商紧急增加资源得以解决。&lt;/p&gt;

&lt;p&gt;然后我们消息分类服务的 ElasticSearch 集群压力过大，扩容的同时，发现调用代码未加熔断保护，直接把 ElasticSearch 集群压死了，里面加上熔断保护，几行代码就好了，自适应熔断保护工具包见 &lt;strong&gt;&lt;a href=&quot;https://github.com/tal-tech/go-zero/blob/master/core/breaker/breakers.go&quot;&gt;这里&lt;/a&gt;&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;经过第一周的密集爆发式流量的考验，我们总体很稳定。为此还得到了有关部门的感谢信，相比友商，我们的服务稳定性还是相当不错的。后续服务稳定性上基本可以用波澜不惊来形容。至此，&lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; （虽然此时还不叫 go-zero）算是经受了充分的实战检验 💪&lt;/p&gt;

&lt;h2&gt;走向开源&lt;/h2&gt;

&lt;p&gt;7月份在跟集团技术通道老师的交流过程中得到了充分的肯定，集团开源通道推动和帮助我把底层微服务支撑框架对外开源。&lt;/p&gt;

&lt;p&gt;在8.7日深夜，我完成了 github 代码的第一次提交，此时文档仅有我临时写出来的一页 readme，为啥只有一页 readme 就选择开源了呢？我觉得万事开头难，如果决定把文档都写完再开源出来的话，可能这事就搁置了，所以还是先让球滚起来吧！&lt;/p&gt;

&lt;p&gt;一经开源，社区立马给了我们比较热烈的反馈，更推动了我们去快速完成文档。我们在一个周末就补充了大量的使用文档，提供了比较完整的示例 &lt;strong&gt;&lt;a href=&quot;https://github.com/tal-tech/zero-doc/blob/main/doc/shorturl.md&quot;&gt;shorturl&lt;/a&gt;&lt;/strong&gt; 和 &lt;strong&gt;&lt;a href=&quot;https://github.com/tal-tech/zero-doc/blob/main/docs/zero/bookstore.md&quot;&gt;bookstore&lt;/a&gt;&lt;/strong&gt;。后面大部分开发者都通过这两个例子感受到了 &lt;strong&gt;&lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt;&lt;/strong&gt; 的便捷和工程效率。感谢大家给了我们很多对示例的改进意见。&lt;/p&gt;

&lt;p&gt;8月16日，&lt;a href=&quot;https://www.bilibili.com/video/BV1rD4y127PD/&quot;&gt;go夜读的分享&lt;/a&gt; 系统的讲述了 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 背后的故事和设计思考，获得了很多观众的留言认可。至今依然有不少人针对这个视频给我积极的反馈。感谢大家的认可！&lt;/p&gt;

&lt;p&gt;8月24日，&lt;a href=&quot;https://gocn.vip&quot;&gt;gocn&lt;/a&gt; 的&lt;a href=&quot;https://mp.weixin.qq.com/s/7XYOizCKj8esIKDzJg6AdQ&quot;&gt;报道&lt;/a&gt;，让 gopherchina 社区第一次大规模的了解了 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt;。社区开始有大量gopher的加入，微信群人数迅速增长。&lt;/p&gt;

&lt;p&gt;9月开始，&lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 多次出现在 github Go 语言日榜月榜顶部，如图：&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;日榜&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;月榜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a26d2681b164097b1b57e69eaa1e911%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;day&quot;/&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/701e1f0d49424d3ab010d3db9031aebb%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;month&quot;/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;同时不少家公司将  &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 用于生产，并跟我反馈上线后一直平稳运行，其中不乏日活过百万的平台。&lt;/p&gt;

&lt;p&gt;10月获得了 gitee &lt;a href=&quot;https://gitee.com/gvp&quot;&gt;最有价值项目（GVP）&lt;/a&gt;，并接着获得了开源中国年度 &lt;a href=&quot;https://www.oschina.net/question/2918182_2320117&quot;&gt;最佳人气项目奖项&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;11月22日，我在 gopherchina 大会做了『云原生go-zero微服务框架的设计思考』的主题分享，现场气氛非常热烈，据说门口堵满了进不来了，获得了很多资深开发者的认可，知乎评论见 &lt;a href=&quot;https://www.zhihu.com/question/431489191/answer/1589640633&quot;&gt;这里&lt;/a&gt;，其中提到的我的年龄不对哈👀，部分现场图如下：&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;分享&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;观众&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32b54f429d7a445d96795d46d2d78d94%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;talking&quot;/&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/794a1a0f3d3249fc8d518f6b2fb93494%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;audience&quot;/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;12月20日，应邀参加腾讯云开发者大会，做了『转型之后 - 面对流量洪峰，微服务架构如何进行弹性设计？』的分享，如下：&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;开始&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;大纲&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc4a06aff0c647a493cc321dd6482f32%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;talking&quot;/&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f6247b7bb584cdc959da0e90bd6589a%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;audience&quot;/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;在掘金发了 20+ 篇 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 系列文章，跟用户详细分享了微服务框架设计的原理和实现，详见 &lt;a href=&quot;https://juejin.cn/user/2348212566892574/posts&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;

&lt;h2&gt;社区的认可&lt;/h2&gt;

&lt;p&gt;近 3000 人的微信社区，每天热烈的技术讨论和用户之间的相互帮助，已经形成了良好的社区氛围。我们也从中获得很多的用户反馈，为我们进一步加强 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 指明了方向！👏&lt;/p&gt;

&lt;p&gt;github star 正常每月增长 1000 左右，平均每天 33+ stars，现在 5300+，增长曲线如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21f6ff2edb344fd691d1cc5b5c188a2b%7Etplv-k3u1fbpfcp-watermark.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;h2&gt;2021年技术展望&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;期望进一步加强  &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 的工程效率提升，让开发者编写更少的代码（业务代码）就能拥有稳定的微服务系统&lt;/li&gt;
&lt;li&gt;一个小目标：一年一万星💪&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;项目地址&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;https://github.com/tal-tech/go-zero&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;欢迎大家使用 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 并 &lt;strong&gt;star&lt;/strong&gt; 支持我们！👏&lt;/p&gt;

&lt;h2&gt;致谢&lt;/h2&gt;

&lt;p&gt;真心感谢一直支持我们的大佬们，以及众多使用 &lt;a href=&quot;https://github.com/tal-tech/go-zero&quot;&gt;go-zero&lt;/a&gt; 的 gopher 们，之所以不列名单，实在是帮助过我们的人太多了，生怕一不小心就遗漏了某位大佬 🤝&lt;/p&gt;
&lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>15e4d92a1faea6f9b2562d7757209405</guid>
<title>来，一起品品 Google 的 Code Review 规范</title>
<link>https://toutiao.io/k/tz4h6d7</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-backh=&quot;385&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.66640625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/la8s6uvJibdShT7XZDibHsNBQyEp3cVcmp7icgqImlNBbP9ya28E2YBEQeY4wicVtk9ZXI4KyEZichkzt9ggjnzRumA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;Photo by &lt;/span&gt;&lt;span&gt;Charles Deluvio &lt;/span&gt;&lt;span&gt;on &lt;/span&gt;&lt;span&gt;Unsplash&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;说起&lt;/span&gt;&lt;span&gt; Code Review&lt;/span&gt;&lt;span&gt;，即代码评审，从事开发的同学应该不会陌生。我们希望通过代码审查，&lt;span&gt;尽可能在上线前发现潜在的 &lt;/span&gt;&lt;span&gt;bug&lt;/span&gt;&lt;span&gt;，同时让代码更优雅，让项目更易维护。&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;但要做好 &lt;/span&gt;&lt;span&gt;Code Review&lt;/span&gt;&lt;span&gt; 这件事情，是很不容易的。大公司可能会好一些，但其实内部各个团队执行得也是各有千秋。而对于小创业公司，进行 &lt;/span&gt;&lt;span&gt;Code Review&lt;/span&gt;&lt;span&gt;，虽然初衷也是好的，但执行起来往往会心有余而力不足。原因有很多：项目时间赶，团队整体技术实力不够，开发流程不规范，怕 &lt;/span&gt;&lt;span&gt;review &lt;/span&gt;&lt;span&gt;过的代码上线后出 &lt;/span&gt;&lt;span&gt;bug &lt;/span&gt;&lt;span&gt;后&lt;/span&gt;&lt;span&gt;背锅，等等。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;在做 &lt;/span&gt;&lt;span&gt;Code Review &lt;/span&gt;&lt;span&gt;这件事情上，我踩过的坑一个也没有少。后来，不断矫正后，我们也慢慢有了一些规范，如：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;1. &lt;/span&gt;&lt;span&gt;建立 &lt;/span&gt;&lt;span&gt;master&lt;/span&gt;&lt;span&gt; 分支和 &lt;/span&gt;&lt;span&gt;dev&lt;/span&gt;&lt;span&gt; 分支：&lt;/span&gt;&lt;span&gt;master&lt;/span&gt;&lt;span&gt; 用来上线，&lt;/span&gt;&lt;span&gt;dev&lt;/span&gt;&lt;span&gt; 用来做稳定的测试分支；&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span&gt;做&lt;/span&gt;&lt;span&gt;新功能，&lt;/span&gt;&lt;span&gt;要新&lt;/span&gt;&lt;span&gt;开 &lt;/span&gt;&lt;span&gt;feature&lt;/span&gt;&lt;span&gt; 分支&lt;/span&gt;&lt;span&gt;；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;. &lt;/span&gt;&lt;span&gt;提交 &lt;/span&gt;&lt;span&gt;PR&lt;/span&gt;&lt;span&gt; 前，先通过代码规范的静态检查和功能点的单元测试；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;4. &lt;/span&gt;&lt;span&gt;每次提交 &lt;/span&gt;&lt;span&gt;PR &lt;/span&gt;&lt;span&gt;涉及改动的&lt;/span&gt;&lt;span&gt;代码行数要尽量少；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;5.&lt;/span&gt;&lt;span&gt; 如果 &lt;/span&gt;&lt;span&gt;review &lt;/span&gt;&lt;span&gt;后的代码上线后有 &lt;/span&gt;&lt;span&gt;bug&lt;/span&gt;&lt;span&gt;，责任由团队承担；&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;6. &lt;/span&gt;&lt;span&gt;周报中各写一段自己认为项目中的好代码和烂代码。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;但这些远算不上好的规范。权当抛砖引玉。&lt;/span&gt;&lt;span&gt;我们来看看 &lt;/span&gt;&lt;span&gt;Google&lt;/span&gt;&lt;span&gt; 的 &lt;/span&gt;&lt;span&gt;Code Review&lt;/span&gt;&lt;span&gt; 规范。全文较多，我概括了主要的 &lt;/span&gt;&lt;span&gt;10&lt;/span&gt;&lt;span&gt; 点。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;以下， &lt;/span&gt;&lt;span&gt;Enjoy&lt;/span&gt;&lt;span&gt; ~&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-backh=&quot;36&quot; data-backw=&quot;258&quot; data-ratio=&quot;0.13953488372093023&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lYDNMgmFjur6mfkPywZNgKZYXia5C4lA8Kd6CUYOibay3HbIfxBnNXH3v6jQZf6QquSL5dt6qYMrtQGh7go67FZg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;516&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在 &lt;/span&gt;&lt;span&gt;Google&lt;/span&gt;&lt;span&gt;，“&lt;/span&gt;&lt;span&gt;&lt;span&gt;代码审查的主要目的是确保 &lt;/span&gt;&lt;span&gt;Google &lt;/span&gt;&lt;span&gt;代码库的整体代码健康状况随着时间的推移而不断改善。&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;The primary purpose of code review is to make sure that the overall code health of Google’s code base is improving over time.&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;. 快&lt;/span&gt;&lt;span&gt;速评&lt;/span&gt;&lt;span&gt;审，快速&lt;/span&gt;&lt;span&gt;反馈&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;不要期待完美的代码，只有更好的代码。只要改动的地方&lt;span&gt;确实能够改善&lt;/span&gt;&lt;span&gt;现有系统&lt;/span&gt;，就允许通过。快速响应 &lt;/span&gt;&lt;span&gt;PR&lt;/span&gt;&lt;span&gt;，最迟不要超过 &lt;/span&gt;&lt;span&gt;1 &lt;/span&gt;&lt;span&gt;天。&lt;/span&gt;&lt;/section&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;2. 遵循代码规范&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;span&gt;变量的命名，注释的格式，制表符和空格的使用等，要满足特定的语言规范。比如 &lt;/span&gt;&lt;span&gt;Java&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;可以参考 &lt;/span&gt;&lt;span&gt;Google&lt;/span&gt;&lt;span&gt; 的 “&lt;/span&gt;&lt;span&gt;Java&lt;/span&gt;&lt;span&gt; 编码最佳实践简要”。国内的可以参考 &lt;/span&gt;&lt;span&gt;Alibaba&lt;/span&gt;&lt;span&gt; 的 “&lt;/span&gt;&lt;span&gt;Java &lt;/span&gt;&lt;span&gt;开发手册”。&lt;/span&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;3. 合理解决评审中的冲突&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;span&gt;因为技术背景和认知的差异，代码提交者和评审者难免会对一些改动点产生分歧。这时候就更需要来一次面对面的讨论或视频会议，而不是仅仅通过代码评审注释来解决冲突。&lt;/span&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;span&gt;如果还不能解决问题，最常见的解决方法就是升级。在一个更大的范围中讨论，让技术主管或更资深的人士参与进来，以寻求决策。&lt;/span&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;span&gt;原则是：不要因为&lt;span&gt;代码提交者和评审者&lt;/span&gt;不能达成一致，而让一个 &lt;/span&gt;&lt;span&gt;PR &lt;/span&gt;&lt;span&gt;闲坐着。&lt;/span&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;4.  涉及 &lt;/span&gt;&lt;span&gt;UI&lt;/span&gt;&lt;span&gt; 的改动，要有演示&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;span&gt;如果提交的改动涉及前端 &lt;/span&gt;&lt;span&gt;UI , &lt;/span&gt;&lt;span&gt; 除了进行代码评审之外，还必须进行演示，&lt;/span&gt;&lt;span&gt;以确保所有的视觉效果都符合预期。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;5. 确保每次改动都伴有单元测试&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;每次 &lt;span&gt;PR&lt;/span&gt; 都应该伴随单元测试，测试用例要设计合理，覆盖周全。&lt;span/&gt;&lt;/section&gt;&lt;section&gt;没有单元测试的代码，无疑是很危险的。如下图所示，一个简单的判断写成了赋值语句，如果没有测试出来，那就出人命了。&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-backh=&quot;415&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.7185714285714285&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/la8s6uvJibdQMxaMccfyAiaSc9quFvfjf5UoF63SpR2xibCcQHqhEgNo7uh5VxagdYZs6mc7bJrk9enbABuxuu27A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;700&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Test saves lives, From: &lt;/span&gt;&lt;span&gt;Ethan Vincent&lt;/span&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;6.  当你专注做其他事情的时候，不要打断自己去做代码评审&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;如果你正在专注于做某一项任务，不要打断自己。因为被打断后可能需要很长时间才能想起被打断前的细节，有时甚至需要重新开始思考。&lt;/p&gt;&lt;p&gt;所以对于评审者而言，专注于在做的事情，可以在某一个 “番茄钟” 后去做代码评审。&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-backh=&quot;618&quot; data-backw=&quot;578&quot; data-ratio=&quot;1.0685714285714285&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/la8s6uvJibdQMxaMccfyAiaSc9quFvfjf5iaDnfLGn2mr0VicreKPULj6vjgfRqu8nPsyOZ8QEicw8dnajiaDhxEib1Eg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;700&quot;/&gt;&lt;/section&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;7.  R&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;eview&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt; 每一行代码，不做假设&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;检查改动的每一行代码。不要对人工编写的类和方法做任何假设，确保理解每一行代码的作用。&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-backh=&quot;373&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.6457142857142857&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/la8s6uvJibdQMxaMccfyAiaSc9quFvfjf5v3etwqrVGO2L2g4uGmXfu4hoAr0Quey1epe8ticDTGkq4fcmHcy438g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;700&quot;/&gt;&lt;/p&gt;&lt;section&gt; &lt;span&gt;Don’t make assumptions. From：&lt;/span&gt;&lt;span&gt;MANU&lt;/span&gt;&lt;/section&gt;&lt;section&gt;如果你没有完全理解，那就需要向提交者问清楚。&lt;/section&gt;&lt;section&gt;如果你理解代码，但你觉得不够格做某些部分的评审，确保有合格的评审人员进行评审，特别是对于复杂的问题，如安全性、并发性、可访问性、国际化等。&lt;/section&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;8.  考虑对整体架构的影响&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;通常，代码审查工具只会显示被更改部分的几行代码。有时，评审者必须查看整个文件，以确保更改确实有意义。比如，你可能只看到添加了 &lt;span&gt;4&lt;/span&gt; 个新行，但当你查看整个文件时，你会看到这 &lt;span&gt;4&lt;/span&gt; 行位于一个 &lt;span&gt;50 &lt;/span&gt;行的方法中，现在确实需要将其分解为更小的方法。&lt;/section&gt;&lt;section&gt;同时还需要考虑提交的改动对整体架构的影响。这个改动是改善了系统的代码健康状况，还是使其更加复杂？不要接受会降低系统代码运行状况的改动。&lt;/section&gt;&lt;section&gt;&lt;span&gt;每一次好的改动，&lt;/span&gt;一点点累积起来，就会产生一个具有最少 &lt;span&gt;bug &lt;/span&gt;数量的优秀产品。同样，随着时间的推移，每次轻微的代码退化，终将导致难以&lt;span&gt;维&lt;/span&gt;&lt;span&gt;护&lt;/span&gt;和难以扩展的代码。&lt;/section&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;9.  遇到好的代码，请不吝赞美&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;通常，代码评审只关注错误。但是，&lt;span&gt;代&lt;/span&gt;&lt;span&gt;码评审&lt;/span&gt;的目的不仅仅是发现错误，还应该鼓励和指导开发人员所做的出色工作。&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;就指导而言，有时候告诉开发人员他们做对了什么，比告诉他们做错了什么更有价值。&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;&lt;strong&gt;&lt;span&gt;10. 保持谦逊，客观&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;在代码评审过程中，要清晰、礼貌、尊重他人，同时也要对提交者有帮助。&lt;/p&gt;&lt;p data-selectable-paragraph=&quot;&quot;&gt;在审查代码时，确保是对代码而不是开发人员进行审查，不要用一些攻击性的词。&lt;/p&gt;&lt;p&gt;永远不要说“你”。注释总是可以用 “我们” 作为主题，或者以一种中立的方式用代码作为主题。例如：&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-backh=&quot;37&quot; data-backw=&quot;39&quot; data-ratio=&quot;0.9487179487179487&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/TgbFLsELTg9VsY5UyL1tpibPYFCGk06KlL0FYt2yJVEwTtTpTYgicyWUKicbhBVhBbomcwoBa1icbbaKpD6fIhtQ4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;78&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;参考文献：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://google.github.io/eng-practices/review/reviewer/looking-for.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://google.github.io/eng-practices/review/reviewer/standard.html&lt;/span&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>