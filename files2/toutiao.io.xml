<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>8aecdae9cd3684e611bd58d54f28fa57</guid>
<title>3 年 3 款产品百万级增长方法论</title>
<link>https://toutiao.io/k/ajioit9</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.1575&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/j3gficicyOvasIjZpiaTNIPReJVWEJf7UGpmokI3LL4NbQDb8fO48fYROmYPXUhXFN8IdDqPcI1gA6OfSLsQHxB4w/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;400&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;作者：xingtan，腾讯 PCG 产品策划&lt;/p&gt;&lt;blockquote class=&quot;js_blockquote_wrap&quot; data-type=&quot;2&quot; data-url=&quot;&quot; data-author-name=&quot;&quot; data-content-utf8-length=&quot;141&quot; data-source-title=&quot;&quot;&gt;&lt;section class=&quot;js_blockquote_digest&quot;&gt;&lt;section&gt;做增长工作数年，从工具产品、内容产品再到社交产品，最终都收获了百万级的增长。这个过程中我深感增长方法之可拓展性：无论是做什么产品，都离不开做留存、做规模、做营收；通过增长这套科学的方法，我们可以快速抓住关键点，并且高容错地落地。本文会通过实战案例剖析相关方法论，希望和大家一起探讨。&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本文内容主要分为三部分：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、我的增长通用方法论 — 如何确认核心增长点？如何输出关键增长策略？如何进行规模化增长？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、我的增长实验案例 — 如何进行 AB 实验验证？以随手记、哔哩哔哩漫画、水印相机等产品为案例进行分享&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、我对产品增长的一些思考&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;一、我的增长通用方法论&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过我的增长工作经历，我会提出：&lt;strong&gt;一种视角两个模型渠道三步&lt;/strong&gt; 的方法论，能够快速对一个产品进行拆解分析，提出策略方案，完成增长。在陈述方法论时，我也会结合相关产品案例背景，方便大家理解。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;strong&gt;1、如何确认核心增长点：透过定性结合定量的视角，精准界定核心增长点&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以随手记为案例：随手记是一款个人记账理财的 APP，通过对日常支出、收入的记录，完成对自己财物状态的了解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;随手记当时状态：&lt;/strong&gt;1、早期独角兽，但随着记账理财类应用新进者如雨后春笋般冒&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;出，流失快速加大；2、产品问题：反人性的工具产品，用户无法坚持，难以养成习惯，留存、活跃低。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;随手记的增长目标：&lt;/strong&gt;如何提升记账用户的留存和活跃&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1）绘制用户旅程图 + 结合数据分析 = 洞察关键问题&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3463855421686747&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyFHAYwrakhicMsnHxzNKiaLVicg6oAa54dN2OeDlHG5C6rgoV2aLibnNpfQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2656&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2）梳理流量漏斗模型，量化关键增长参数和增长问题&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4325581395348837&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyEDyv5g8bBBPdce7O3qC5XWC5ExUOhibUhn5WbLc00Nd68cBfExxadtQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1290&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;（因随手记流量漏斗模型时间久远未找到，用美颜相机的案例替代）&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过定性结合定量的分析可以发现随手记当前核心问题是：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1、新用户不能马上感知到记账价值，导致激活率低；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2、新用户不能马上熟悉操作，导致长期留存低；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3、新用户熟悉操作后，不能使用户养成记账习惯，导致快速流失；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;4、量化产品目标后，梳理流量漏斗模型有明显低于预期的指标；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;值得注意的是，我们需要把定性和定量结合为一种视角来看，当下用户的心理状态，在数据表现是什么？我需要做什么事情改变用户的心理状态，才能得到数据提升，该方法后续我还应用在了多款产品的分析中，比如 QQ 自习室：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.358220502901354&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDy69diah86J9vJqb6sI11ARibjAiaOSdatV8Hia8BGUD6S1z4SA2y5UCaS5A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2585&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在完成核心增长点定位后，下一步重点是以什么方法输出对应增长策略？&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;2、如何输出关键增长策略：活用模型建立策略假说，滚动实验验证假设&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1）新用户模型的应用案例 — &lt;strong&gt;以随手记为案例&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在建立新用户分群时，有一个前提条件：当用户下载/打开产品，我们默认用户是有记账需求的，只是根据当前用户状态，可以拆分成不同类型的用户群体；而新用户的大策略方向是重转化-aha 时刻，根据&lt;strong&gt;新用户体验模型：转化 = 欲望 - 摩擦&lt;/strong&gt;；我们可以把新用户可以分为四类象限用户以及输出对应策略：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7627118644067796&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyg1j97GTrlnSloQyOiacGcOwuBibsbU68eL5wZJicfrKlmdd29ibGyWv19g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1416&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2）老用户模型的应用案例 — 以&lt;strong&gt;QQ 自习室为案例&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;针对老用户，关键是如何让用户更高频更长期的使用产品，所以我常使用的模型是：&lt;strong&gt;B（行为）= M（动机）* A（能力）* T（触发）&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以下是针对 QQ 自习室，结合模型提出的策略假说：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6936416184971098&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyGx9ib4Ma57rw6icYPserTuyYNcKFicMW5nPgtahVh6LY8WU4vYOHzWbpA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1557&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过上瘾模型，可以梳理清楚自习室用户的留存增长链路：首先针对自习室的自习目标用户通过红点、服务号、运营活动触发，让用户产生首次/再次自习的意愿；当用户进入自习室产品页面后，通过房间分发策略（好友/学伴/学习小组...）找到合适的自习室进行转化；在用户进入自习房间后，通过自习工具（氛围/陪伴/安全...）促使用户开始自习；最后在用户自习结束后有成就、有沉淀；通过上瘾模型的闭环让用户在下次自习需求产生时，自动想到 QQ 自习室。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4254545454545455&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyTibMref6CibyTBsHRftjIycH6AhX3bgKGecHNtBrmIVJiacrh5Pk4Jjxg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1650&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在进行增长策略输出时，通过新老用户模型拆解和假说，可以让我们在设计增长策略时候，考虑问题链路更加全面和完整，最终通过成本和收益预估进行上线的优先级排序。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在产品优化到一定程度之后，可以考虑通过渠道对增长效果进行放大，并形成规模化的增长。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;3、如何进行规模化增长：建设渠道放大能力，衡量 ROI 进行科学投放&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第一步：&lt;/strong&gt; 建立渠道打分模型，进行渠道质量监控；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1）现存渠道打分模型&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1757631822386679&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyGr8tmWPFfu1JBtvrC47I9IV2Bl2iaET392ZvPE2zzxZk1ZLClE4Wy9A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1081&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实际评分维度、指标权重设计、以及评分细则，需要结合自己负责产品的目标和市场现状来制定。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2）渠道质量异动监控，方便调整渠道策略&amp;amp;预算比例；&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.42977291841883936&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDy1kGeEB2JM01CKzwrWwK8NPN5gGyQU9TPs9Z8mew2uYZGAGEctGBlgw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1189&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第二步&lt;/strong&gt;：建立投放链路数据监控——以广点通 API 接入为案例&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5431034482758621&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDy4IlSvhHxlic4pHMQTwAicviad0mODoq9P45apE2bPibBias53NM10icBDQUQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1856&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第三步：衡量渠道 ROI 投放，端内重点提升用户 LT&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.25474254742547425&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyk2YJxtJzmzsiao7IloImTCE9QjgmWQcibnJMMibO4OS4dfo8Qlt3Fvx9g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2214&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如何提升 LT（生命周期）：不用渠道新用户的端内承接策略&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如何提升 ARPU：延长用户生命周期、新的付费场景、新的商业模式&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如何降低 CAC：广告素材、出价/调价策略、人群&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;二、我的增长实验案例&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我拿典型的增长模型 AARRR 中的部分实验案例展开，这块内容主要是怎么通过分析数据进行实验验证，分享做实验的思路和经验。实际的增长模型和实验上线节奏需要考虑当前市场的情况、产品的阶段、产品的最终目标来确定。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）AA 获取+激活实验：重点找影响用户完成关键行为的因素，比如从什么渠道来、以什么玩法承接等。核心关注关键路径转化率及留存成本衡量&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验名称：&lt;/strong&gt; 产品&amp;lt;随手记&amp;gt; - 某渠道用户的链路优化实验&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验背景：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当时负责随手一个比较有效的拉动激活的渠道，因合作费用较高，需要拉平成本，找到 ROI 最大化的方案。数据现状：此渠道用户激活率低、留存率低。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;提出假设：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;a. 通过新人礼包引导新用户完成产品功能使用，通过产品价值可以使新用户转化留存；在留存的前提下，增加各变现业务的曝光，预期能提升导流效果；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;b. 通过记账挑战赛，有助于把新用户转化为激活用户，最终提升此渠道用户质量，拉平获客成本；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;c. 通过社交渠道进行裂变活动，继续产生新增用户，降低此渠道的获客成本；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;d. 此渠道用户特征为空闲、无聊、爱薅羊毛，通过每日任务玩法型活动更有利于承接和变现流量。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验指标：&lt;/strong&gt; 记账转化率、次日/7 日/30 日留存率、各项导流转化率。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验验证&lt;/strong&gt;：通过新用户随机分配到 abcd 四组实验组的下载落地页，进行实验验证。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5462776659959758&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyt0s6Vk5fB7ALgenDj13Fax4f5xuvXrJyo3CYAuLh6d21l4ibUstp1qA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;994&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验结果：&lt;/strong&gt; D 方案变现效果最佳，99%显著性提升，ROI 最高，D 方案全量。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6097328244274809&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDy4ObVFEEAraacvHjbAO3vYzcLOY3YnMnqlJhnDvBSRVa14ibOREibHYcA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1048&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2）&lt;strong&gt;R 营收实验：关键点在这个⽤户值得我补多少钱，以完成对我有利的操作或转化。具体手段：RMF 用户分层、⽤户关键⾏为界定（判断依据）、特定补贴⼒度（经营效率）。&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验名称：&lt;/strong&gt; 产品&amp;lt;哔哩哔哩漫画&amp;gt; — 未充值用户破冰实验&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验背景：&lt;/strong&gt; B 漫用户的付费用户占比 x%较低，希望针对未付费用户进行充值返现活动，达到增长首次充值用户的目的，并通过实验实现充值与消费金额最大化。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;提出假设：&lt;/strong&gt; 设置 X 元充值返 X 活动，可提升用户破冰率、充值 ARPU 值、复购率，且 ROI 可控；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实验想法：对用户进行分群实验：高、中、低频用户，针对 A 组（高、中、低）用户可见活动，B 组（高、中、低）用户不可见活动；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验分析：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;a. 破冰活动 A 组对于破冰人数提升在 36%，但对于充值 ARPU 没有提升，ROI 极低。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;b.破冰活动复购率较低，低于常规充值用户。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;c. 分人群看，破冰活动仅对于近期登陆天数在 8 ～ 30 天的中频用户有效果；对于高频用户，虽然破冰率提升，但 arpu 未上涨；对于低频用户，虽然破冰率提升，但 arpu 下降幅度较大，且消费金额未提升。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.39888682745825604&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j3gficicyOvavKARAUdtFNYIFM1icS3dlDyEibnY9O0gujJBElKVic2neqbn8N4K9LulS4VCZxiagvdictXcg8ic0s1NRA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1078&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验结论&lt;/strong&gt;：针对中频用户进行破冰补贴。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3）&lt;strong&gt;R 自传播实验：核心是什么场景什么人，传播什么内容，用户愿意回来；并同步关注负向影响，建立负向指标预警机制。&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验名称：&lt;/strong&gt; 产品&amp;lt;水印相机&amp;gt; — 保存照片默认带品牌 LOGO 水印实验&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;数据发现&lt;/strong&gt;：水印相机用户在照片拍摄完成后，80%以上用户的分享场景在社交软件的工作群；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;提出假设：&lt;/strong&gt; 在用户拍摄完成后默认增加水印相机的品牌 LOGO 水印，可提升用户的留存率和自传播系数；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验指标：&lt;/strong&gt; 用户拍摄保存率、次日/7 日/30 日留存率、品牌 LOGO 水印关闭率；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验想法：&lt;/strong&gt; A 组实验组默认不带品牌 LOGO 水印、B 组实验组默认带品牌 LOGO 水印；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;实验结果：&lt;/strong&gt; 保存无负向影响，次日留存率+0.8pp，三留+1pp，99%显著性提升；实验组全量。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;小结，在实验结束后，我们收获的不仅仅是 AB 实验的结果，还可以通过更多维度的实验结果分析加深对产品和用户的认知，才可以在不断实验滚动中对我们自己负责的产品和用户有更深刻的理解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;三、我对产品增长的一些思考&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）价值感知是用户留存的核心&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用户如果难以感受到产品的价值，既导致用户在初期缺乏使用动力，也使得用户在后期很容易放弃使用转向竞品，因此强化产品价值的体现和沟通，是提升新用户留存的关键机会点，也是增强产品在同类软件中差异化竞争力的核心。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;a. 美颜相机新用户激活率 x% — 价值感知 — 最快让用户拍出变美的自拍&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;b. 水印相机新用户激活率 x% — 价值感知 — 最快拍出最准确的工作照片&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;c.随手记新用户激活率 X%— 价值感知 — 最快理清财务账单&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2）易用性是留存的前提&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但仅有价值是不够的，酒香也怕巷子深，让产品更加顺应人性，让即使是零基础的用户也能自然地上手，比如随手记新人引导、账本推荐，比如自习室的自习房间推荐 - 解决用户选择合适房间的问题，才能转化更多的用户。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）额外激励是留存的助推器&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;转载自：【非常之观】公众号&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;腾讯极客挑战赛来了！&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;964&quot; data-backw=&quot;542&quot; data-ratio=&quot;1.7777777777777777&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/j3gficicyOvatiahqjozMAiciaEXTbKlQAYAU5EC6dbFU7YrmcDKRaibibBfexQ9sGlOGmBCHIhzh6tvQeiaXDScp3Bv6w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;腾讯程序员视频号最新视频&lt;/strong&gt;&lt;/p&gt;&lt;section class=&quot;channels_iframe_wrp&quot;&gt;&lt;mpvideosnap class=&quot;js_uneditable custom_select_card channels_iframe&quot; data-pluginname=&quot;videosnap&quot; data-id=&quot;export/UzFfAgtgekIEAQAAAAAALTEXdzN7XAAAAAstQy6ubaLX4KHWvLEZgBPEk6NwNQJFVN7-zNPgMIuvlCWZ6PmGM3t8sZhNHh6N&quot; data-url=&quot;https://findermp.video.qq.com/251/20304/stodownload?encfilekey=RBfjicXSHKCOONJnTbRmmlD8cOQPXE48ibQjUmnf9jJHvfXtMK93ama3LhT6lYTMcdgfeC7zsibLG2mWvicPqxZZicqQiapB1Ij9LTIs4tMStZ2h9To7oMg2nibJ2ichicWClgfSYYiaGMfY3pyxXtfQ7GfeMXvlyHUIfibUyEaibcfF66p0ibC0&amp;amp;adaptivelytrans=0&amp;amp;bizid=1023&amp;amp;dotrans=0&amp;amp;hy=SH&amp;amp;idx=1&amp;amp;m=4642d9b79714e1786f86ab96b280c301&amp;amp;token=cztXnd9GyrFic3jndkicLXILbV6Btn24fPVep5Y4GLXjZy9D0HPxdqjJ7IjbPjSPPic&quot; data-headimgurl=&quot;http://wx.qlogo.cn/finderhead/I7awtksbibjQe7RZAy84xEecUymmic8cw4v7Y2zbnVDuo/0&quot; data-username=&quot;v2_060000231003b20faec8c6e08e1ac1d4cf06ea31b07760a16cba92d83444bd9a5d9d55ffaede@finder&quot; data-nickname=&quot;腾讯程序员&quot; data-desc=&quot;你的手机空间为什么总是不够用 ？存储空间缩水的真正原因 #手机 #科普&quot; data-nonceid=&quot;8553719956918053279&quot; data-type=&quot;video&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;  &lt;br/&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>be1857dda2d84160a4fbab8351bbfff8</guid>
<title>高效线上问题排查：套路化和工具化</title>
<link>https://toutiao.io/k/qgqrokh</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;span title=&quot;&quot; opera-tn-ra-cell=&quot;_$.pages:0.layers:0.comps:0.title1&quot;&gt;&lt;p&gt;&lt;strong&gt;作者简介&lt;/strong&gt;&lt;/p&gt;&lt;/span&gt; &lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;丰富，携程高级技术专家，在性能优化、问题排查方面有较多的研究。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h1&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;一、前言&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;线上问题排查相比于coding，是一个低频的工作，很多人不会经常遇到。一旦需要进行问题排查的时候，往往是重要且紧急的，因此问题排查的效率，就显得尤为重要。有些线上问题，比较直观，比如磁盘使用率高、网络流量高这种，借助合适的工具很快能定位到原因；但对于一些复杂的问题，如系统Load高、RSS占用高、内存溢出等，需要结合多方面的数据才能定位到原因。这时候，需要有正确的解题思路，并辅以合适的工具，才能高效地解决问题。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;目前业界排查问题的优秀工具还是挺多的，比如国内阿里开源的Arthas、PerfMa开源的为终结性能问题而生的xPocket，Java官方的JMC（JDK Mission Control）、Eclipse的MAT（Memory Analyzer Tooling），以及我一直很推崇的神器Async-Profiler。&lt;/span&gt;&lt;span&gt;上述只是列举了一些比较流行的开源工具，商业工具如jProfiler、YourKit等也都建立了稳定的用户群体&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;这些工具功能各&lt;/span&gt;&lt;span&gt;有差异。&lt;/span&gt;&lt;span&gt;当然这不是本文描述的重点，就不详细展开了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在对这些工具进行横向对比时我们发现，他们的目标都是为了解决一些特定的问题，如果我们有清晰的问题排查思路，结合这些工具，可以很快解决问题。而对于一些复杂场景，尤其是一些陌生的复杂问题，在没有头绪的情况下，纵然有各种神兵利器，也无计可施。线上问题排查犹如开车，老司机驾轻就熟，新手则手忙脚乱。当然如果新手有老司机加以指点，也可能很快地解决问题。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;但问题是，这种老司机并不常见，也不可能时刻都能帮你。我们可以去网上查阅其他人总结的问题排查套路，再结合我们自己的场景，去尝试解决问题，我也是经常这么干的。但这种方式效率依然不高，原因有三个：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1）信息检索的成本：我们需要花时间去翻阅资料，去跟自己的场景匹配以判断是否适合自己；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2）试错的成本：有些资料不适合我们的场景，我们按照资料去尝试，有可能被带沟里去，浪费时间；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3）问题排查需要借助于一些第三方工具，而这些工具在生产环境需要安装、配置和使用，也需要花较多的时间成本。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;针对线上问题排查的特点和现状，我们是否可以构建一个系统，这个系统会针对各种线上问题的排查形成一个知识（套路）库，针对每一种问题，都有对应的套路和自动化工具帮助我们去定位问题。本文将结合一个比较有代表性的线上问题的排查过程，来探讨这种方式的可行性。&lt;/span&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h1&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;二、问题排查的套路化&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本章将以RSS占用高为例来对问题排查的套路化进行说明。RSS占用高是很多人遇到过的问题，这个问题涉及的因素比较多，比较有代表性。当然在开启了Swap的运行环境中，Swap高也是RSS高的一种表象，殊途同归。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;RSS是Resident Set Size（常驻内存大小）的缩写，用于表示进程使用了多少内存（RAM中的物理内存）。如果我们遇到进程RSS接近服务器的物理内存，那就意味着你需要关注应用的健康程度了，这意味着应用后面很有可能出现OOM的问题，比如进程被OOM killer杀死，或者容器重启，或者因使用Swap而速度变慢。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;针对RSS高的问题，首先我们需要知道的是，Java进程消耗的内存绝不仅仅是你设置的Xmx或堆内存的用量这么简单，Java进程占用的内存主要分为2大部分：on-heap（堆内内存）和off-heap（堆外内存）。而堆外内存又包含JVM自身消耗的内存、JVM外的内存。所以，后续的排查思路我们也是按照堆内内存、JVM内存、JVM外内存3个方向来顺序展开。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;2.1  堆内存是否太大&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;首先要确认一下Java应用的堆内存是否太大，因为JVM自身也会消耗一些内存，所以你至少需要预留出部分内存存给JVM使用。如果应用涉及较多的网络通信，那还需要预留一些内存给堆外使用，所以一般来说你的堆内存最多为服务器物理内存的75%（经验值，需依据应用自身特点调整），如4G内存服务器，那么堆内存最大为3G。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;堆内存用量的查看手段非常多，相信各个公司的基础架构团队都提供了可视化的监控手段，当然也可以通过原生命令jcmd &amp;lt;pid&amp;gt; GC.heap_info查看，如图1所示：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.13125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1AyaOzJFkdWHyuP2EUaNd8UuSJv9LPpWIIwlFZrPTtqzHp0icp1MS2QQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图1&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;    &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果Java进程的堆内存用量已接近或超过物理内存的75%，那么基本可以确定堆内存用量过大。这时可以调小Xmx来控制堆内存用量。如果Xmx不能减小，可以通过dump堆内存+MAT或JFR（Java Flight Recorder）+ JMC（JDK Mission Control）来分析内存占用/分配情况，通过程序调优来减少堆内存用量。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;    &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果到此RSS占用呈稳定趋势，我们就可以告一段落了，否则要继续后面的步骤。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;2.2  是否存在大量ARENA区&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果堆内存不大，那么继续排查非堆内存。首先去看一下ARENA区，在高并发的应用中，往往ARENA区占用的内存会比较多。为什么先看ARENA区的内存占用呢？是因为这个步骤是不需要重启JVM进程就可以完成的。至于ARENA是什么以及作用是什么，可以读一下这篇文章：&lt;/span&gt;&lt;a href=&quot;https://blog.csdn.net/maokelong95/article/details/51989081&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;https://blog.csdn.net/maokelong95/article/details/51989081&lt;/span&gt;&lt;/a&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这里我们直接进入排查问题环节。执行如下命令：&lt;/span&gt;&lt;span&gt;sudo -u &amp;lt;user&amp;gt; pmap -x &amp;lt;pid&amp;gt;|sort -gr -k2 |less，&lt;/span&gt;&lt;span&gt;如果存在大量大小为65536或60000左右的内存区域，则很大可能是ARENA区域占用了太多的内存，如图2所示：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.35703125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1M0WrSopupDjnGiaicJBuiaXgrzQjia7Zj6kpuRBvVmibJNc4iamy7Zh8CPicQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;span&gt;图2&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这种情况下，最简单粗暴的办法是在JVM启动参数中增加配置：export MALLOC_ARENA_MAX=1。&lt;/span&gt;&lt;span&gt;需要注意的是，上述的数值只能是1，其他大于1的数值经实践证明是无法控制ARENA数量的。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;2.3  非堆内存是否开销过大&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果前面2个步骤过后都没有发现问题，还有很多内存你不知道消耗在哪里了，那么我们开始第3步：开启Native Memory Tracking。前面说过，Java应用的执行，JVM自身也需要消耗一些内存的，通过开启Native Memory Tracking，我们就能知道JVM自身消耗了多少内存。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;书归正传，通过修改JVM参数并重启Java进程开启NativeMemory Tracking：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;-XX:NativeMemoryTracking=detail。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;进程重启后，可以通过NMT的一些子命令（summary/detail/baseline/diff）查看Native Memory的占用情况：&lt;/span&gt;&lt;span&gt;sudo -u &amp;lt;user&amp;gt;jcmd &amp;lt;pid&amp;gt; VM.native_memory detail。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图3是在使用baseline建立了基线的情况下用detail.diff看到的各内存区的变化情况：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.89140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1iaqFRIcafu19dRVcicO7l6wjBWSmhzNraXib4Yc1aH9ujkTX9cUtvapMg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;span&gt;图3 &lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;通过上图，可以看到JVM各个区域所使用的内存大小，主要包含了Java Heap、Class、Thread、Code、GC、Compiler、Internal、Other、Symbol等，各部分作用如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1）Class：加载的类与方法信息，其实就是 metaspace，包含两部分：一是 metadata，被-XX:MaxMetaspaceSize限制最大大小，另外是 class space，被-XX:CompressedClassSpaceSize限制最大大小；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2）Thread：线程与线程栈占用内存，每个线程栈占用大小受-Xss限制，但是总大小没有限制。在x64的JVM中，Xss默认为1024K，所以如果你的应用开启了1000个线程，那么这个Thread区占用将是1024M，所以一般我们会把Xss设置为256K即满足要求；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3）Code：JIT 即时编译后（C1C2 编译器优化）的代码占用内存，受-XX:ReservedCodeCacheSize限制；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;4）GC：垃圾回收占用内存，例如垃圾回收需要的 CardTable，标记数，区域划分记录，还有标记 GC Root 等等，都需要内存。这个不受限制，一般不会很大，但也有例外，图3是27G的堆内存，使用G1垃圾回收器，你能看到GC区居然占用了3.8G的内存；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;5）Compiler：C1 C2 编译器本身的代码和标记占用的内存，这个不受限制，一般不会很大；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;6）Internal：命令行解析，JVMTI 使用的内存，这个不受限制，一般不会很大；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;7）Symbol: 常量池占用的大小，字符串常量池受-XX:StringTableSize个数限制，总内存大小不受限制；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们需要需要注意的是Class、Thread、GC几个区域的大小。&lt;/span&gt;&lt;span&gt;图4是各种JVM垃圾回收器消耗内存的比例，注意这部分内存是堆内存之外的：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.5786290322580645&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1xE9ibJshUPwNFibjDyrLYt8aEqyLKgJEX0aoJIjPyPTehhF7tDaOQ2ibQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;992&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图4&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;实践证明，G1的内存开销甚至能占到堆内存的20%，当然这不是本文要讨论的内容，感兴趣的读者可以去阅读《JVM G1源码分析和调优》一书查看相关内容。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;针对上面的各个区域大小做加法，看一下是否接近于RSS的大小，如果是，恭喜你可以到此结束了。后续你需要做的就是针对内存占用比较大的JVM区去做优化，这里就不详细介绍了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果不是，很遗憾，你进入到了最难啃的环节，继续往下看吧。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;注：开启NativeMemoryTracking会造成5%的性能下降，用完记得修改JVM参数并重启永久关闭，或者可以通过以下命令临时关闭：&lt;/span&gt;&lt;span&gt;jcmd vm.native_memory stop &amp;lt;pid&amp;gt;。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;2.4  堆外内存是否用量太多&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;堆外内存也是比较容易被忽略的一个区域，尤其是网络通信非常频繁的应用，这种应用往往大量使用Java NIO，而NIO为了提高效率，往往会申请很多的堆外内存。确认这个区域用量是否过大，最直接的方法是先查看是否是DirectByteBuffer或者MappedByteBuffer使用了较多的堆外内存。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你的服务器已经开启了远程JMX，你可以通过ops提供的jmx查询工具去查询，也可以通过jdk自带的工具（比如jconsole、jvisualvm）查询，&lt;/span&gt;&lt;span&gt;如图5所示：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.5577211394302849&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1yXC8tnPic0JcGb0veiaNCzyNO6vicMXc9KSiaC6e7XzvSa4H1bXVhesblA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;667&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图5&lt;/span&gt;&lt;span&gt;  &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果未开启远程JMX，可以通过jmxterm（https://docs.cyclopsgroup.org/jmxterm）工具在本地模式下查询“java.nio:name=direct,type=BufferPool”和“java.nio:name=mapped,type=BufferPool”两项内容确认用量。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果确认上述堆外内存使用过多，那么可以通过在jvm参数中设置-XX:MaxDirectMemorySize这个参数控制一下，因为通过DirectByteBuffer分配的堆外内存，默认是不会控制这个区域的内存用量的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果上述内存用量不大，那我们就需要祭出终极杀器jemalloc来做进一步分析了。这里涉及的内容比较多，受限于文章篇幅限制，就不展开描述了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;通过jemalloc的收集到的数据，我们基本能够定位到堆外内存问题的原因。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;2.5  总结&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;上述的4个步骤，基本能够解决大多数的RSS占用高的问题了。当然事无绝对，没有一种药是包治百病的。我们追求的基本目标是，通过问题排查的套路化，帮助工程师理清思路，少走弯路，以提高问题排查的效率。&lt;/span&gt;&lt;/p&gt;&lt;h1&gt;&lt;br/&gt;&lt;/h1&gt;&lt;h1&gt;&lt;strong&gt;&lt;span&gt;三、问题排查的工具化&lt;/span&gt;&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;复盘一下上述的问题排查过程，我们用到了很多的命令和第三方工具，整个过程还是工程师驱动命令行和工具。如果对命令参数不熟悉，或本地没有安装相应的工具，那这种套路化的教程也只能在一定程度上提高效率。在这个套路的基础上，我们是否可以转变思路，以工具为主，工程师辅助，来提高排查问题的效率呢？让我们来尝试一下。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;3.1 流程梳理&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;先来梳理工具的执行流程以及每个步骤需要做的事情，与第二节保持一致性，本节也划分成4个子步骤。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.1.1 确认堆内存是否太大&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;第一步要做的事情比较多，梳理如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;Java进程pid：使用jps -v列出java进程列表，由用户选择具体的进程；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;获取运行环境的物理内存和剩余内存（free -m）&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;Java进程的堆内存用量（jcmd GC.heap_info）&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;Java进程GC情况（jstat-gcutil）；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;获取到上述信息后，判断堆内存是否太大。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;br/&gt;&lt;/h3&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.1.2 是否存在大量ARENA区&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;通过pmap命令获取内存分配列表，辅以awk命令提取内存信息，据此判断是否存在大量ARENA区。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h3&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.1.3 非堆内存是否开销过大&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;此步骤需要在JVM启动脚本中增加启动参数并重新启动进程，对于标准化的运行环境来说，在知道了启动脚本位置和启动命令的情况下，是可以通过工具来完成参数的修改和进程启动。如果不能知道启动脚本所在位置，我们可以复制当前进程的JVM参数来完成进程的启动。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;当JVM进程启动完成，再次进入工具，我们就能借助于Native Memory Tracking的结果来判断当前环节是否存在问题。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;br/&gt;&lt;/h3&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.1.4 堆外内存是否用量太多&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;此步骤的自动执行，需要安装第三方工具如jxmterm、jemalloc。在生产环境访问外网受限的情况下，可以通过搭建内网资源服务器的方式来解决这个问题。通过一键安装脚本，我们能快速完成所依赖工具的安装和配置，剩下的就是让工具来收集和分析数据定位问题了。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br/&gt;&lt;/h2&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;3.2  工具实现&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;目前公司内部很多运维工具，都是采用C+B/S的方式实现，这种方式工程师不需要申请目标服务器权限就能够实现很多运维操作。但这种实现方式比较复杂，而我们的工具是带有实验性质，所以暂时使用shell+工具包的方式实现，即使用shell脚本将主流程串起来，各节点使用的工具如果有缺失，yum能安装使用yum安装，yum不能安装的则提前下载内置到工具包中。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;所有的准备工作完成后，编写脚本的工作就相对简单了，当然这需要用到很多的shell和linux、java命令，此处就不赘述了。脚本的最终运行效果如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.78719723183391&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1OxJ7NCYIWYeSszWNxOVdlbl3mgkvBoVFJhJjvIbfEKNBFocFosD8JQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1156&quot;/&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h1&gt;&lt;h1&gt;&lt;strong&gt;&lt;span&gt;四、总结&lt;/span&gt;&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;通过针对RSS占用高问题的排查套路和排查工具的梳理，我们实现了一个简单的问题快速排查脚本。当然在这个过程中可以发现，很多问题的排查，都可以使用类似的思路来工具化，日积月累，就形成了一个问题排查的工具包。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;以内存问题排查举例，我们积累了以下的快速工具，如图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.5678571428571428&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1jZayJtvmM4f92X5icby9WGUE7SfZLQfL2plvmURI5aNoIrnQu7axvBw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;560&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这只是工具包的一部分，针对CPU、磁盘、网络、GC等问题，借助于Arthas、Async-Profiler等优秀的开源工具，我们都积累了很多快速工具，期望能帮工程师提高问题排查的效率。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如前面所讲，这种完全基于shell的方式，由于需要登录到目标服务器上操作，多数功能还需要有sudo权限，这有些许的不方便。另外，某些公司生产环境严格受限，那shell的方式就无法使用了。所以在此基础上，可以扩展成Client+Server+Browser的模式，让工程师在不登录到服务器的情况下，就能完成问题的排查。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;到此，本文的内容就结束了，但我们的工具还在不断地积累中，在此也欢迎感兴趣的同学帮我们提供场景，我们不断丰富这个工具库。同时，受限于作者水平，文中内容难免有不当之处，也欢迎提出意见和建议。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;团队招聘信息&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们是携程机票研发团队，负责携程APP/PC端机票业务开发及创新。机票研发在搜索引擎、数据库、深度学习、高并发等方向持续不断地深入探索，持续优化用户体验，提高效率。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在机票研发，你可以和众多技术顶尖大牛一起，真实的让亿万用户享受你的产品和代码，提升全球旅行者的出行体验和幸福指数。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你热爱技术，并渴望不断成长，携程机票研发团队期待与你一起腾飞。目前我们前端/后台/数据/测试开发等领域均有开放职位。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;简历投递邮箱：&lt;/span&gt;&lt;strong&gt;&lt;span&gt;tech@trip.com&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;，邮件标题：【姓名】-【携程机票】-【投递职位】。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;【推荐阅读】&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/kEeDgfCVf1eOuEMhibeI5do3APF7pUibf1p7qZgP1nbtmhthIPcjgTgsHeOZ5vxl0f4J8rYZSMibOuu5hhQH9TdVQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt; “携程技术”公众号&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;  分享，交流，成长&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>2504b19b692014bf6d97a1acaaa83fef</guid>
<title>数据地图？地图数据？傻傻分不清楚</title>
<link>https://toutiao.io/k/w332r73</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;数据地图在中台的位置&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;既然郭同学问的是数据中台中的数据地图，那就先得看看数据地图在数据中台处于什么位置。这里借用一下数澜的数据中台全景图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4567049808429119&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjlWf2ibW0ky9M5QPicLf1BKhL1tArD9mPOmfmiaAeFAkYwWpfuQKuOcoKFVU0ZBvThqbwuBQ6ltJFjog/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1305&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;注意看上图中间标红的位置，在数澜的数据中台架构中，数据地图处于数据资产治理部分。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5601895734597157&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjlWf2ibW0ky9M5QPicLf1BKhLeMLibyUb9KKXCHCnHdzgfiaticRSLFIkDrkphsxyATNhI2sLVZvuaaNGg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1055&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;资产管理具体负责什么呢？我们再看看数澜的这张图：数据资产化的具体内容是：数据规范定义、可视化数据建模、数据质量保障、全链路血缘分析、掌握资产现状和数据安全合规。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;其中全链路血缘分析的作用是：“&lt;/span&gt;&lt;span&gt;支持通过血缘分析、影响性分析，找出上下游表及若一张表更改之后对下游表的影响。&lt;/span&gt;&lt;span&gt;通过数据链路图，&lt;/span&gt;&lt;span&gt;用户能够清晰查看数据从哪里来，被用到哪里去。&lt;/span&gt;&lt;span&gt;”&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那能不能再具体一些？&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;数据地图是干啥的？&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;我们再看看京东的数据平台门户，其中也有数据地图，其位置是在元数据应用层，同级别的应用有：元数据体检、关联分析、影响分析、数据浏览、血缘分析和数据检索。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.4851598173515982&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApMYozq5ficehm8ItT4CjroSpvFWuvKYYN5c2uiaGCGN7WRokZull32Oceg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;876&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;很明显，数据地图是给使用数据的同学使用的，甚至是只给数据开发的同学使用的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;其核心功能是用来找数据的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们再翻到亚信科技的数据事业部总经理高伟写的《数据资产管理》一书中，第三章“治理管控：数据资产管理的基础所在”，第六节“建立数据地图，盘活数据资产”，里面写的很清楚：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;数据地图是一种图形化的数据资产管理工具，它提供了多层次的图形化展示，并具备各种力度控制能力，满足业务使用、数据管理、开发运维不同应用场景的图形查询和辅助分析需求。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;主要解答几个问题：&lt;/span&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;数据是什么？数据在哪里？数据如何取？数据怎么用？&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;span&gt;还能做好各种数据管理工作：&lt;/span&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;数据体检、运维监控、安全评估。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;span&gt;提供的数据服务主要有：&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;list&quot;&gt;&lt;blockquote&gt;&lt;section data-role=&quot;list&quot;&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;支付快速搜索定位，找到企业各种数据资产，形成有效的数据交汇；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;提供各种数据资产快速展现的个性化形式，方便使用者获取所需要的关键信息；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;积累过去所有进行过的数据加工知识，在相似场景下可以更好的推送或复用数据；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;在数据搜寻结果之上，直接配备方便的分析工具，使得数据使用更加得心应手；&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;建立数据资产分布及综合评估的入口，更好地了解数据资产使用的各方面信息。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;为什么要有数据地图？&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;我们大致已经知道了数据地图到底是个什么玩意，&lt;/span&gt;但是为什么要有数据地图呢？&lt;/p&gt;&lt;p&gt;其实，如果公司的数据库里只有百十来张表，那基本上不需要啥数据地图，因为靠脑子就能全记住了。&lt;/p&gt;&lt;p&gt;但是，如果有好几个系统、几百张表，而且在数仓里还分了好多层，之间的关系错综复杂，谁能全部记得住啊？&lt;/p&gt;&lt;p&gt;比如这位小姐姐的烦恼，相必你也能体会的到：&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.5229357798165137&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApMAuIXNDIWSibuGeqOfKhok9vL0WCsIYT9WTfrYLyzbjRoREtibUicCfoyw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;327&quot;/&gt;&lt;/p&gt;&lt;p&gt;不仅是个人有这个烦恼，作为一个组织，保障知识的传承、减少沟通成本也是非常必要的。&lt;/p&gt;&lt;p&gt;既然有需求，有问题，人脑又不能完全记住，那肯定得借助系统的力量，做个产品啊。&lt;/p&gt;&lt;p&gt;至于为啥叫“数据地图”，其实就是借用了地图“找信息”的功能，意思是在“数据地图”功能中，能找到所有的数据。&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;数据地图长啥样？&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;数据地图不是跟百度地图、高德地图一样，而是跟ETL流程DAG一样的，或者直接是表格展示。这是atlas的例子：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.2679658952496955&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApMokr26kBXlYiaI3kqP0B8ibQf9J5kgImKu1ibGmvj9hyVYzT9J8e7AKs7A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;821&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;更简单的表格基本上就是库名、表名、元数据代码、字段名、数仓位置、上游 、下游、管辖单位、负责人等。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.16395348837209303&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApM4icFB3xxq4n6K3Q5zNEjB5tZHzu1Vdt0HNJ0H3ibiccOsicQryuialwRgZw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;860&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;血缘分析和影响分析&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;数据地图其实还能衍生出三个非常重要的应用：全链路分析、血缘分析和影响分析。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这是某数据治理公司的产品，全链路分析。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.43673012318029114&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApM6aAIO3eSNyobPqhyPuQpl7T4HdDvyefLEdByYSibImpYo07xDicOI9BA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;893&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;中间黄色的块就是查询对象，整张图就是查询对象上下所有数据链路的关系，所以叫“全链路”数据分析，看数据是怎么来的，再往哪里去。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;全链路理解了，血缘分析和影响分析就很容易理解了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;血缘分析就是做亲子鉴定一样，不断找“爸爸”。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们看到一张报表，想找到数据根源在哪里，就得一层一层的向上追溯，直到找到ODS甚至业务库。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这就是“血缘分析”：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.24115334207077327&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApMPIrcnXibFzLPQu28u5kf9ict4qLnuQGicaxydnGAFbVezsPFwWGcLEcgQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;763&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那么对应的，影响分析就是不断的找儿子了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;业务库想改一张基础表，怕对下游的数据报表造成影响，那就得向下找到这张表涉及的所有下游表。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这就是“影响分析”：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.20239680426098536&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApMl4Mo68Vo282yH0DK47iaNLclKqJEic9NhAAjVm0RniaExtO6kgmvhDMicw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;751&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;技术架构&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;早期的数据地图都是直接存在数据库中，也不太智能，大多数时候都得靠人工录入信息，&lt;span&gt;非常不好用。&lt;/span&gt;&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;现在基本都存在图数据库中，而且还能自动读取和更新元数据，非常人性。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img data-ratio=&quot;0.675776397515528&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/7VHriaQOsnjkK5ic1fh24yRXcIYZHo7ApM87pj7TicagonkKATSSxDq6BTOZl9efiaBrB6a7pLaY5Bl8OFEnc7vOtA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;805&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这是Atlas架构图，所有数据都存在JanusGraph图数据库中，用图数据库的天然“关系”处理能力，做各种血缘、影响分析再合适不过了。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); min-height: 1em; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__0&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;strong data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;#关于大数据私房菜&lt;/strong&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); min-height: 1em; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__3&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;strong data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;大数据私房菜，有过多年Java及大数据开发经验，目前在一家互联网公司从事数据开发工作;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;&lt;strong data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;主要方向有基础数据架构，企业级数仓建设，数据建模及模型优化，数据治理(数据质量管理平台，元数据管理及应用，数据成本治理等)，用户画像工程化实践，流量域数据模型及实时数仓建设等&lt;br/&gt;建立公众号的初衷是希望更多的初学者或者数据开发从业者能通过我的文章分享，有所收获和成长.&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); min-height: 1em; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__4&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;br data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;/&gt;&lt;/p&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;93709&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__5&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;section data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;section data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;section data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;span data-role=&quot;width&quot; data-width=&quot;80%&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;img border=&quot;0&quot; class=&quot;__bg_gif&quot; data-ratio=&quot;0.08658008658008658&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/dXCnejTRMLcGyNcDm7GntqV7fh5IIF4rOSmRy8ZXM9zqiaYy3hoAvFAdPahNibnZ5Bvwg5IrnQiaJmR1y6m1olxRw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;462&quot; data-width=&quot;80%&quot; height=&quot;&quot; title=&quot;&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247487775&amp;amp;idx=1&amp;amp;sn=32e90ad3274db5ff404060ac35379596&amp;amp;chksm=ea68fbd3dd1f72c583c92d24ba424b680eb6e8290c2d4af60356c12a3dc62a13f88e07ea3971&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;2021大数据面试真题&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot;&gt;2021大数据面试真题&lt;/a&gt;&lt;/p&gt;&lt;p hm_fix=&quot;307:568&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485691&amp;amp;idx=1&amp;amp;sn=d6cb1353031e07e4b02cd903d8b57911&amp;amp;chksm=ea68e237dd1f6b210f65f25ef42dabf4453d3bfa36fe8f33b149c0ff5329f77b9b792eef7882&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;数据仓库体系&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot;&gt;数据仓库体系&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485039&amp;amp;idx=1&amp;amp;sn=140c3bc720da51765292fe3f5082fe38&amp;amp;chksm=ea68eca3dd1f65b5aef4d6f7ab0c33d3d3033bcc0eead1650be079687e0b4e898562bfe4d25b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;数据质量管理&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)|rgb(136, 136, 136)&quot;&gt;数据质量管理&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485186&amp;amp;idx=1&amp;amp;sn=85fbe5703c56aa2dcfd2980fccbab4f6&amp;amp;chksm=ea68edcedd1f64d8e2d8c3da6b456fcaa4b105f2216a2bddb2393a7380498166225de5e855b4&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;元数据管理&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;元数据管理&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247487977&amp;amp;idx=1&amp;amp;sn=ba5f0b10595e485aef9a8722538c507f&amp;amp;chksm=ea68fb25dd1f72336f6e4588071544acf94aae073df3b62f02170281e267a14e3be7a47e6f3c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;模型优化&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;模型优化&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486497&amp;amp;idx=1&amp;amp;sn=4498d46a2d7e3a1b3eecd5bda171d3f5&amp;amp;chksm=ea68e6eddd1f6ffb7cb6b19263178fc0e5d1f564dd11eaf6f932c119904d65cb99b2dc613a90&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Hadoop&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Hadoop&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485965&amp;amp;idx=1&amp;amp;sn=2fc0899c82dffe7721c55ad717cd2678&amp;amp;chksm=ea68e0c1dd1f69d70689408d9e9f66f00a638d851b9ffb50484d697ecf05f9b0f2989a10b80d&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Hive&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Hive&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485048&amp;amp;idx=1&amp;amp;sn=5fc1219f4947bea9743cd938cec510c7&amp;amp;chksm=ea68ecb4dd1f65a2df364d79272e0e472a394c5b13b5d55d848c89d9498ccb7ea78a933fbdea&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Hive调优&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Hive调优&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486303&amp;amp;idx=1&amp;amp;sn=c1f58c14372ae9ba22dc9c464ae04143&amp;amp;chksm=ea68e193dd1f6885c3fa1903114ea62aa9f6ee4ee78384c667306fd815c37de9cf1fb300212a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Flink&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Flink&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247487158&amp;amp;idx=1&amp;amp;sn=01bec273b27ea954bc53a1b3188b2289&amp;amp;chksm=ea68e47add1f6d6cb29ca44b2edc5cb5a2e26ff8064a3360f7b78dfd70a791cbfdb50acf4dcd&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Clickhouse&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Clickhouse&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485858&amp;amp;idx=1&amp;amp;sn=75a3a3dd71a612b5ac4412c423554787&amp;amp;chksm=ea68e36edd1f6a785b739bd2ec2f0cc94f5d3679ac40f631fbd61abad96e9652bea14cc705f5&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Hbase&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Hbase&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247485999&amp;amp;idx=1&amp;amp;sn=b7e6e0aabb77504e920ff4342f44d26f&amp;amp;chksm=ea68e0e3dd1f69f56ac2c97839cf8d043d9b503b5461fe006fa14a9974375a386cd66000aadd&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Kafka&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;Kafka&lt;/a&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;● &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2MDQzOTk3MQ==&amp;amp;mid=2247486107&amp;amp;idx=1&amp;amp;sn=b1fb84db241e15defd91eb3a6a3699c9&amp;amp;chksm=ea68e057dd1f69411f72e646bdffd28d0ac1682ede5d613c698d5fff18f1b861de39627d86ea&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;DolphinScheduler海豚调度&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;&gt;DolphinScheduler海豚调度&lt;/a&gt;&lt;br data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16223837951525=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16223837951525=&quot;#fff|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)|rgb(136, 136, 136)&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); min-height: 1em; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__6&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;br data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;/&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16223837951525=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16223837951525=&quot;#fff|rgb(255, 255, 255)&quot; data-style=&quot;max-width: 100%; background-color: rgb(255, 255, 255); min-height: 1em; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; text-align: center; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgb(163, 163, 163) !important;&quot; class=&quot;js_darkmode__7&quot; data-darkmode-bgcolor-16231641560631=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16231641560631=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16231641560631=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16231641560631=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16238530599471=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16238530599471=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16238530599471=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16238530599471=&quot;#fff|rgb(163, 163, 163)&quot; data-darkmode-bgcolor-16241831705064=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16241831705064=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16241831705064=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16241831705064=&quot;#fff|rgb(163, 163, 163)&quot;&gt;&lt;img data-backh=&quot;237&quot; data-backw=&quot;559&quot; data-ratio=&quot;0.4259501965923984&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dXCnejTRMLeibmoxSpRXUevnVIz4RyV0AUrglXsIgLOkFMNuffPAh5lZbwOnSoRHbZqT12VyKibm0EmnTicXBSRTg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;763&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>adf8d34f2d9e1dcf22478eef199074f1</guid>
<title>美团 App 页面视图可测性改造实践</title>
<link>https://toutiao.io/k/x6lik53</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;美团App的页面特点&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;自动化测试实施中的技术挑战&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;页面视图可测性改造-XraySDK&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;定位方案对比&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;视图信息的获取和存储-XrayDumper&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;视图信息的输出-XrayServer&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;SDK整体功能结构&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;视图信息的增强&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;动态布局自动化的收益&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;未来展望&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;使用视图解析原理解决WebView元素定位&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;视图可测性改造更多的应用场景&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;美团App的页面特点&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;对于不同的用户，美团App页面的呈现方式其实多种多样，这就是所谓的“千人千面”。以美团首页的“猜你喜欢”模块为例，针对与不同的用户有单列、Tab、双列等多种不同形式。这么多不同的页面样式需求，如果要在1天内时间内完成开发、测试、上线流程，研发团队也面临着很大的挑战。所以测试工程师就需要重度依赖自动化测试来形成快速的验收机制。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.821656050955414&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6ChlynFFibDASAdicbyIhxse93DcsCgGjj41a7FuUrMfq9SCgjGUPsq6w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;785&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图1 美团App首页多种页面布局样式&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;自动化测试实施中的技术挑战&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;接下来，本文将会从页面元素无法定位、Appium元素定位的原理、AccessibilityNodeInfo和Drawable等三个维度进行阐述。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;页面元素无法定位&lt;/span&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.3778801843317972&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6jzObq9cTtMbVicBiaDZI3tWFIDGTzgcDFJ6BKfDbrGcf8wEpXSxlsJRQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;217&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图2 页面元素审查情况&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;目前，美团App客户端自动化主要依托于Appium（&lt;/span&gt;&lt;span&gt;一个开源、跨平台的测试框架，可以用来测试原生及混合的移动端应用&lt;/span&gt;&lt;span&gt;）来实现页面元素的定位和操作，当我们通过Appium Inspector进行页面元素审查时，能通过元素审查找到的信息只有外面的边框和下方的两个按钮，其他信息均无法识别（&lt;/span&gt;&lt;span&gt;如上图2所示&lt;/span&gt;&lt;span&gt;）。中央位置的图片、左上角的文本信息都无法通过现有的UI自动化方案进行定位和解析。不能定位元素，也就无法进行页面的操作和断言，这就严重影响了自动化的实施工作。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;经过进一步的调研，我们发现这些页面卡片中大量使用Drawable对象来绘制页面的信息，从而导致元素无法进行定位。为什么Drawable对象无法定位呢？下面我们一起研究一下UI自动化元素定位的原理。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Appium元素定位的原理&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;目前的UI自动化测试，使用Appium进行页面元素的定位和操作。如下图所示，AppiumServer和UiAutomator2的手机端进行通信后完成元素的操作。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.32956152758132956&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6zfkKDxsv6nfq9x0mqROaBZKK5Ox0P4YK0mLEHJlLj46fEnm9h30ygQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1414&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图3 Appium的通信原理&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;通过阅读Appium源码发现完成一次定位的流程如下图所示：&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20802139037433154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6eYbJJmgNZerM5VBksptvttfgSIuXENhjrGTcttL5xDFib4gYT5ibcICg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1870&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图4 Appium定位元素的实现流程&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;首先，Appium通过调用&lt;/span&gt;&lt;code&gt;&lt;span&gt;findElement&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的方式进行元素定位。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;然后，调用Android提供&lt;/span&gt;&lt;code&gt;&lt;span&gt;UIDevice&lt;/span&gt;&lt;/code&gt;&lt;span&gt;对象的&lt;/span&gt;&lt;code&gt;&lt;span&gt;findObject&lt;/span&gt;&lt;/code&gt;&lt;span&gt;方法。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;最终，通过&lt;/span&gt;&lt;code&gt;&lt;span&gt;PartialMatch.accept&lt;/span&gt;&lt;/code&gt;&lt;span&gt;完成元素的查找。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;接下来我们看一下，这个&lt;/span&gt;&lt;code&gt;&lt;span&gt;PartialMatch.accept&lt;/span&gt;&lt;/code&gt;&lt;span&gt;到底是如何完成元素定位的。通过对于&lt;/span&gt;&lt;a href=&quot;https://android.googlesource.com/platform/frameworks/uiautomator/+/android-support-test/src/main/java/android/support/test/uiautomator/ByMatcher.java&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;源码&lt;/span&gt;&lt;/a&gt;&lt;span&gt;的研究，我们发现元素的信息都是存储在一个叫做&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的对象里面。源码中使用大量&lt;/span&gt;&lt;code&gt;&lt;span&gt;node.getXXX&lt;/span&gt;&lt;/code&gt;&lt;span&gt;方法中的信息，大家是否眼熟呢？这些信息其实就是我们日常自动化测试中可以获取UI元素的属性。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.1573033707865168&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6EraW747X9stv07LHIoG8xiapbQlWIHSAqKjpNznI8cIrlIGsWAQIPTw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;356&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图5 AppiumInspector审查元素获取信息示意&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;Drawable&lt;/span&gt;&lt;/code&gt;&lt;span&gt;无法获取元素信息，是否和&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;相关？我们进一步探究&lt;/span&gt;&lt;code&gt;&lt;span&gt;Drawable&lt;/span&gt;&lt;/code&gt;&lt;span&gt;和&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的关系。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;AccessibilityNodeInfo和Drawable&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;通过对于源码的研究，我们绘制了如下类图来解释&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;和&lt;/span&gt;&lt;code&gt;&lt;span&gt;Drawable&lt;/span&gt;&lt;/code&gt;&lt;span&gt;之间的关系。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.482886216466235&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6noWxcaKibydD7ibfsHJG0dXZJ7S3laOUv4h6zhrPz2picS5BVE19gTxqg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1081&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图6 类关系示意图&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;View&lt;/span&gt;&lt;/code&gt;&lt;span&gt;实现了&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityEventSource&lt;/span&gt;&lt;/code&gt;&lt;span&gt;接口并实现了一个叫做&lt;/span&gt;&lt;code&gt;&lt;span&gt;onInitializeAccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;的方法来填充信息。我们也在&lt;/span&gt;&lt;a href=&quot;https://developer.android.com/guide/topics/ui/accessibility/custom-views?hl=zh-cn&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;Android官方文档&lt;/span&gt;&lt;/a&gt;&lt;span&gt;中找到了对于此信息的说明：&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;&lt;span&gt;onInitializeAccessibilityNodeInfo() ：此方法为无障碍服务提供有关视图状态的信息。默认的&lt;/span&gt;&lt;code&gt;&lt;span&gt;View&lt;/span&gt;&lt;/code&gt;&lt;span&gt;实现具有一组标准的视图属性，但如果您的自定义视图提供除了简单的 &lt;/span&gt;&lt;code&gt;&lt;span&gt;TextView&lt;/span&gt;&lt;/code&gt;&lt;span&gt;或&lt;/span&gt;&lt;code&gt;&lt;span&gt;Button&lt;/span&gt;&lt;/code&gt;&lt;span&gt;之外的其他互动控件，则您应替换此方法并将有关视图的其他信息设置到由此方法处理的&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;对象中。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;而&lt;/span&gt;&lt;code&gt;&lt;span&gt;Drawable&lt;/span&gt;&lt;/code&gt;&lt;span&gt;并没有实现对应的方法，所以也就无法被自动化测试找到。探究了元素查找原理之后，我们就要开始着手解决问题了。&lt;/span&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;页面视图可测性改造-XraySDK&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;定位方案对比&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;既然知道了&lt;/span&gt;&lt;code&gt;&lt;span&gt;Drawable&lt;/span&gt;&lt;/code&gt;&lt;span&gt;没有填充&lt;/span&gt;&lt;code&gt;&lt;span&gt;AccessibilityNodeInfo&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，也就说明我无法接入目前的自动化测试方案来完成页面内容的获取。那我们可以想到如下三种方案来解决问题：&lt;/span&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;span&gt;实现方案&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;影响范围&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;改造Appium定位方式，让Drawable可以被识别&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;需要改动底层的AccessibilityNodeInfo obtain(View,int)方法和为Drawable添加AccessibilityNodeInfo这样就需要对于所有的Android系统做兼容，影响范围过大&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;使用View替代Drawable&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;动态布局卡片使用Drawable进行绘制就是因为Drawable比View使用资源更少，绘制性能更好，放弃使用Drawable就等于放弃了性能的改进&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;使用图像识别进行定位&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;动态卡片中有很多图像中包含文字，还有多行文本都会对图像识别的准确性带来很大的影响&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;上面的三种方案，目前看来都无法有效地解决动态卡片元素定位的问题。如何在影响范围较小的前提下，达成获取视图信息的目标呢？接下来，我们将进一步研究动态布局的实现方案。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;视图信息的获取和存储-XrayDumper&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;我们的应用场景非常明确，自动化测试通过集成Client来获得和客户端交互能力，通过Client向App发送指令来页面信息的获取。那我们可以考虑内嵌一个SDK（&lt;/span&gt;&lt;span&gt;XraySDK&lt;/span&gt;&lt;span&gt;）来完成视图的获取，然后再向自动化提供一个客户端（&lt;/span&gt;&lt;span&gt;XrayClient&lt;/span&gt;&lt;span&gt;）来完成这部分功能。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.18814814814814815&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6tX3HTMtzIpgAmUEmVicZ7pfV4SBESzxbXq0dz5ZSpaU1EFSSicyyHY8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;675&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图7 XraySDK的工作流程示意图&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;对于XraySDK的功能划分，如下表所示：&lt;/span&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;span&gt;模块名&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;功能划分&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;运行环境&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;产品形态&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Xray-Client&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;1.和Xray-Server进行交互进行指令发送和数据的接收&lt;br/&gt;2.暴露对外的Api给自动化或者其他系统&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;App内部&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;客户端SDK（AAR和Pod-Library）&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Xray-SDK&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;1.进行页面信息的获取以及结构化(Xray-Dumper)&lt;br/&gt;2.接收用户指令来进行结构化数据输出(Xray-Server)&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;自动化内部或者三方系统内部&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;JAR包或基于其他语言的依赖包&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;XraySDK如何才能获取到我们需要的Drawable信息呢？我们先来研究一下动态布局的实现方案。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.17444364680545585&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6Z97jzWPHnzicsj6WOd9zPDTFC1kVkDVuw98GkYVOdlJMIFA4PeNTEAw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1393&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图8 动态卡片的页面绘制流程&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;动态布局的视图呈现过程分为：解析模板-&amp;gt;绑定数据-&amp;gt;计算布局-&amp;gt;页面绘制，计算布局结束后，元素在页面上的位置就已经确定了，那么只要拦截这个阶段信息就可以实现视图信息的获取。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;通过对于代码的研究，我们发现在&lt;/span&gt;&lt;code&gt;&lt;span&gt;com.sankuai.litho.recycler.AdapterCompat&lt;/span&gt;&lt;/code&gt;&lt;span&gt;这个类中控制着视图布局行为，在&lt;/span&gt;&lt;code&gt;&lt;span&gt;bindViewHolder&lt;/span&gt;&lt;/code&gt;&lt;span&gt;中完成视图的最终的布局和计算。首先，我们通过在此处插入一个自定义的监听器来拦截布局信息。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public final void bindViewHolder(BaseViewHolder&amp;lt;Data&amp;gt; viewHolder, int position) {&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (viewHolder != null) {&lt;br/&gt;            viewHolder.bindView(context, getData(position), position);&lt;br/&gt;&lt;br/&gt;            //自动化测试回调&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (componentTreeCreateListeners != null) {&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (viewHolder instanceof LithoViewHolder) {&lt;br/&gt;                    DataHolder holder = getData(position);&lt;br/&gt;                    //获取视图布局信息&lt;br/&gt;                    LithoView view = ((LithoViewHolder&amp;lt;Data&amp;gt;) viewHolder).lithoView;&lt;br/&gt;                    LayoutController layoutController = ((LithoDynamicDataHolder) holder).getLayoutController(null);&lt;br/&gt;                    VirtualNodeBase node = layoutController.viewNodeRoot;&lt;br/&gt;                    //通过监听器将视图信息向外传递给可测性SDK&lt;br/&gt;                    componentTreeCreateListeners.onComponentTreeCreated(node, view.getRootView(), view.getComponentTree());&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;然后，通过暴露一个静态方法给可测性SDK，完成监听器的初始化。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public static void setComponentTreeCreateListener(ComponentTreeCreateListener l) {&lt;br/&gt;        AdapterCompat.componentTreeCreateListeners = l;&lt;br/&gt;        try {&lt;br/&gt;            // 兼容mbc的动态布局自动化测试，为避免循环依赖，采用反射调用&lt;br/&gt;            Class&amp;lt;?&amp;gt; mbcDynamicClass = Class.forName(&lt;span&gt;&quot;com.sankuai.meituan.mbc.business.item.dynamic.DynamicLithoItem&quot;&lt;/span&gt;);&lt;br/&gt;            Method setComponentTreeCreateListener = mbcDynamicClass.getMethod(&lt;span&gt;&quot;setComponentTreeCreateListener&quot;&lt;/span&gt;, ComponentTreeCreateListener.class);&lt;br/&gt;            setComponentTreeCreateListener.invoke(null, l);&lt;br/&gt;&lt;br/&gt;        } catch (Exception e) {&lt;br/&gt;            e.printStackTrace();&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;        try {&lt;br/&gt;            // 搜索新框架动态布局自动化测试&lt;br/&gt;            Class&amp;lt;?&amp;gt; searchDynamicClass = Class.forName(&lt;span&gt;&quot;com.sankuai.meituan.search.result2.model.DynamicItem&quot;&lt;/span&gt;);&lt;br/&gt;            Method setSearchComponentTreeCreateListener = searchDynamicClass.getMethod(&lt;span&gt;&quot;setComponentTreeCreateListener&quot;&lt;/span&gt;, ComponentTreeCreateListener.class);&lt;br/&gt;            setSearchComponentTreeCreateListener.invoke(null, l);&lt;br/&gt;        } catch (Exception e) {&lt;br/&gt;            e.printStackTrace();&lt;br/&gt;        }&lt;br/&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;最后，自动化通过设置自定义的监听器来完成视图信息的获取和存储。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;//通过静态方法设置一个ComponentTreeCreateListener来监听布局事件&lt;br/&gt;AdapterCompat.setComponentTreeCreateListener(new AdapterCompat.&lt;span&gt;ComponentTreeCreateListener&lt;/span&gt;() {&lt;br/&gt;            @Override&lt;br/&gt;            public void onComponentTreeCreated(VirtualNodeBase node, View rootView, ComponentTree tree) {&lt;br/&gt;                //将信息存储到一个自定义的ViewInfoObserver对象中&lt;br/&gt;                ViewInfoObserver vif = new ViewInfoObserver();&lt;br/&gt;                vif.update(node, rootView, tree);&lt;br/&gt;            }&lt;br/&gt;        });&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;我们将视图信息存储在ViewInfoObserver这样一个对象中。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public class ViewInfoObserver implements AutoTestObserver{&lt;br/&gt;    public static HashMap&amp;lt;String, View&amp;gt; VIEW_MAP = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;    public static HashMap&amp;lt;VirtualNodeBase, View&amp;gt; VIEW = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;    public static HashMap&amp;lt;String, ComponentTree&amp;gt; COMPTREE_MAP = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;    public static String uri = &lt;span&gt;&quot;http://dashboard.ep.dev.sankuai.com/outter/dynamicTemplateKeyFromJson&quot;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    @Override&lt;br/&gt;    public void update(VirtualNodeBase vn, View view,ComponentTree tree) {&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (null != vn &amp;amp;&amp;amp; null != vn.jsonObject) {&lt;br/&gt;            try {&lt;br/&gt;                String string = vn.jsonObject.toString();&lt;br/&gt;                Gson g = new GsonBuilder().setPrettyPrinting().create();&lt;br/&gt;                JsonParser p = new JsonParser();&lt;br/&gt;                JsonElement e = p.parse(string);&lt;br/&gt;&lt;br/&gt;                String templateName = null;&lt;br/&gt;                String name1 = getObject(e,&lt;span&gt;&quot;templateName&quot;&lt;/span&gt;);&lt;br/&gt;                String name2 = getObject(e,&lt;span&gt;&quot;template_name&quot;&lt;/span&gt;);&lt;br/&gt;                String name3 = getObject(e,&lt;span&gt;&quot;template&quot;&lt;/span&gt;);&lt;br/&gt;                templateName = null != name1 ? name1 : (null != name2 ? name2 : (null != name3 ? name3 : null));&lt;br/&gt;&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (null != templateName) {&lt;br/&gt;                //如果已经存储则更新视图信息&lt;br/&gt;                    &lt;span&gt;if&lt;/span&gt; (VIEW_MAP.containsKey(templateName)) {&lt;br/&gt;                        VIEW_MAP.remove(templateName);&lt;br/&gt;                    }&lt;br/&gt;                    //存储视图编号&lt;br/&gt;                    VIEW_MAP.put(templateName, view);&lt;br/&gt;                    &lt;span&gt;if&lt;/span&gt; (VIEW.containsKey(templateName)) {&lt;br/&gt;                        VIEW.remove(templateName);&lt;br/&gt;                    }&lt;br/&gt;                    //存储视图信息&lt;br/&gt;                    VIEW.put(vn, view);&lt;br/&gt;                    &lt;span&gt;if&lt;/span&gt; (COMPTREE_MAP.containsKey(templateName)) {&lt;br/&gt;                        COMPTREE_MAP.remove(templateName);&lt;br/&gt;                    }&lt;br/&gt;                    COMPTREE_MAP.put(templateName, tree);&lt;br/&gt;                    System.out.println(&lt;span&gt;&quot;autotestDyn：update success&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;                } &lt;br/&gt;&lt;br/&gt;            } catch (Exception e) {&lt;br/&gt;                System.out.println(e.toString());&lt;br/&gt;                System.out.println(&lt;span&gt;&quot;autotestDyn：templateName not exist!&quot;&lt;/span&gt;);&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;当需要查询这些信息的时候，就可以通过XrayDumper来完成信息的输出。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public class SubViewInfo {&lt;br/&gt;    public JSONObject getOutData(String template) throws JSONException {&lt;br/&gt;        JSONObject outData = new JSONObject();&lt;br/&gt;        JSONObject componentTouchables = new JSONObject();&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (!COMPTREE_MAP.isEmpty() &amp;amp;&amp;amp; COMPTREE_MAP.containsKey(template) &amp;amp;&amp;amp; null != COMPTREE_MAP.get(template)) {&lt;br/&gt;            ComponentTree cpt = COMPTREE_MAP.get(template);&lt;br/&gt;            JSONArray componentArray = new JSONArray();&lt;br/&gt;&lt;br/&gt;            ArrayList&amp;lt;View&amp;gt; touchables = cpt.getLithoView().getTouchables();&lt;br/&gt;            LithoView lithoView = cpt.getLithoView();&lt;br/&gt;            int[] ls = new int[2];&lt;br/&gt;            lithoView.getLocationOnScreen(ls);&lt;br/&gt;            int pointX = ls[0];&lt;br/&gt;            int pointY = ls[1];&lt;br/&gt;&lt;br/&gt;            &lt;span&gt;for&lt;/span&gt; (int i = 0; i &amp;lt; touchables.size(); i++) {&lt;br/&gt;                JSONObject temp = new JSONObject();&lt;br/&gt;                int height = touchables.get(i).getHeight();&lt;br/&gt;                int width = touchables.get(i).getWidth();&lt;br/&gt;                int[] tl = new int[2];&lt;br/&gt;                touchables.get(i).getLocationOnScreen(tl);&lt;br/&gt;                temp.put(&lt;span&gt;&quot;height&quot;&lt;/span&gt;,height);&lt;br/&gt;                temp.put(&lt;span&gt;&quot;width&quot;&lt;/span&gt;,width);&lt;br/&gt;                temp.put(&lt;span&gt;&quot;pointX&quot;&lt;/span&gt;,tl[0]);&lt;br/&gt;                temp.put(&lt;span&gt;&quot;pointY&quot;&lt;/span&gt;,tl[1]);&lt;br/&gt;&lt;br/&gt;                String url = &lt;span&gt;&quot;&quot;&lt;/span&gt;;&lt;br/&gt;                try {&lt;br/&gt;                    EventHandler eh = (EventHandler) getValue(getValue(touchables.get(i), &lt;span&gt;&quot;mOnClickListener&quot;&lt;/span&gt;), &lt;span&gt;&quot;mEventHandler&quot;&lt;/span&gt;);&lt;br/&gt;                    DynamicClickListener listener = (DynamicClickListener) getValue(getValue(eh, &lt;span&gt;&quot;mHasEventDispatcher&quot;&lt;/span&gt;), &lt;span&gt;&quot;listener&quot;&lt;/span&gt;);&lt;br/&gt;                    Uri clickUri = (Uri) getValue(listener, &lt;span&gt;&quot;uri&quot;&lt;/span&gt;);&lt;br/&gt;                    &lt;span&gt;if&lt;/span&gt; (null != clickUri) {&lt;br/&gt;                        url = clickUri.toString();&lt;br/&gt;                    }&lt;br/&gt;                } catch (Exception e) {&lt;br/&gt;                    Log.d(&lt;span&gt;&quot;autotest&quot;&lt;/span&gt;, &lt;span&gt;&quot;get click url error!&quot;&lt;/span&gt;);&lt;br/&gt;                }&lt;br/&gt;&lt;br/&gt;                temp.put(&lt;span&gt;&quot;url&quot;&lt;/span&gt;,url);&lt;br/&gt;                componentArray.put(temp);&lt;br/&gt;            }&lt;br/&gt;            componentTouchables.put(&lt;span&gt;&quot;componentTouchables&quot;&lt;/span&gt;,componentArray);&lt;br/&gt;            componentTouchables.put(&lt;span&gt;&quot;componentTouchablesCount&quot;&lt;/span&gt;, cpt.getLithoView().getTouchables().size());&lt;br/&gt;&lt;br/&gt;            View[] root = (View[])getValue(cpt.getLithoView(),&lt;span&gt;&quot;mChildren&quot;&lt;/span&gt;);&lt;br/&gt;            JSONArray allComponentArray = new JSONArray();&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (root.length &amp;gt; 0) {&lt;br/&gt;                &lt;span&gt;for&lt;/span&gt; (int i = 0; i &amp;lt; root.length; i++) {&lt;br/&gt;                    try {&lt;br/&gt;                        &lt;span&gt;if&lt;/span&gt; (null != root[i]) {&lt;br/&gt;                            Object items[] = (Object[]) getValue(getValue(root[i], &lt;span&gt;&quot;mMountItems&quot;&lt;/span&gt;), &lt;span&gt;&quot;mValues&quot;&lt;/span&gt;);&lt;br/&gt;                            componentTouchables.put(&lt;span&gt;&quot;componentCount&quot;&lt;/span&gt;, items.length);&lt;br/&gt;                            &lt;span&gt;for&lt;/span&gt; (int itemIndex = 0; itemIndex &amp;lt; items.length; itemIndex++) {&lt;br/&gt;                                getMountItems(allComponentArray, items[itemIndex], pointX, pointY);&lt;br/&gt;                            }&lt;br/&gt;                        }&lt;br/&gt;                    } catch (Exception e) {&lt;br/&gt;&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;            componentTouchables.put(&lt;span&gt;&quot;componentUntouchables&quot;&lt;/span&gt;,allComponentArray);&lt;br/&gt;        } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;            Log.d(&lt;span&gt;&quot;autotest&quot;&lt;/span&gt;,&lt;span&gt;&quot;COMPTREE_MAP is null!&quot;&lt;/span&gt;);&lt;br/&gt;        }&lt;br/&gt;        outData.put(template,componentTouchables);&lt;br/&gt;        System.out.println(outData);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; outData;&lt;br/&gt;    }&lt;br/&gt;    }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;视图信息的输出-XrayServer&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;我们获取到了信息，接下来就要考虑如何将视图信息传递给自动化测试脚本，我们参考了Appium的设计。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Appium通过在手机上安装的InstrumentsClient启动了一个SocketServer通过HTTP协议来完成自动化和底层测试框架的数据通信。我们也可以借鉴上述思路，在美团App中启动一个WebServer来完成信息的输出。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第一步，我们实现了一个继承了Service组件，这样就可以方便的通过命令行的方式的启动和停止可测性的功能。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public class AutoTestServer extends Service  {&lt;br/&gt;    @Override&lt;br/&gt;    public IBinder onBind(Intent intent) {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; null;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    @Override&lt;br/&gt;    public int onStartCommand(Intent intent, int flags, int startId) {&lt;br/&gt;    ....&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; super.onStartCommand(intent, flags, startId);&lt;br/&gt;    }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第二步，通过HttpServer的方式对外暴露通信的接口。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public class AutoTestServer extends Service  {&lt;br/&gt;    @Override&lt;br/&gt;    public IBinder onBind(Intent intent) {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; null;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    @Override&lt;br/&gt;    public int onStartCommand(Intent intent, int flags, int startId) {&lt;br/&gt;        // 创建对象，端口通过参数传入&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (intent != null) {&lt;br/&gt;            int randNum = intent.getIntExtra(&lt;span&gt;&quot;autoTestPort&quot;&lt;/span&gt;,8999);&lt;br/&gt;            HttpServer myServer = new HttpServer(randNum);&lt;br/&gt;            try {&lt;br/&gt;                // 开启HTTP服务&lt;br/&gt;                myServer.start();&lt;br/&gt;                System.out.println(&lt;span&gt;&quot;AutoTestPort:&quot;&lt;/span&gt; + randNum);&lt;br/&gt;            } catch (IOException e) {&lt;br/&gt;                System.err.println(&lt;span&gt;&quot;AutoTestPort:&quot;&lt;/span&gt; + e.getMessage());&lt;br/&gt;                myServer = new HttpServer(8999);&lt;br/&gt;                try {&lt;br/&gt;                    myServer.start();&lt;br/&gt;                    System.out.println(&lt;span&gt;&quot;AutoTestPort:8999&quot;&lt;/span&gt;);&lt;br/&gt;                } catch (IOException e1) {&lt;br/&gt;                    System.err.println(&lt;span&gt;&quot;Default:&quot;&lt;/span&gt; + e.getMessage());&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; super.onStartCommand(intent, flags, startId);&lt;br/&gt;    }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第三步，将之前设置好的监听器进行注册。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;public class AutoTestServer extends Service  {&lt;br/&gt;    @Override&lt;br/&gt;    public IBinder onBind(Intent intent) {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; null;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    @Override&lt;br/&gt;    public int onStartCommand(Intent intent, int flags, int startId) {&lt;br/&gt;    //注册监听器&lt;br/&gt;        AdapterCompat.setComponentTreeCreateListener(new AdapterCompat.&lt;span&gt;ComponentTreeCreateListener&lt;/span&gt;() {&lt;br/&gt;            @Override&lt;br/&gt;            public void onComponentTreeCreated(VirtualNodeBase node, View rootView, ComponentTree tree) {&lt;br/&gt;                ViewInfoObserver vif = new ViewInfoObserver();&lt;br/&gt;                vif.update(node, rootView, tree);&lt;br/&gt;            }&lt;br/&gt;        });&lt;br/&gt;&lt;br/&gt;        // 创建对象，端口通过参数传入&lt;br/&gt;        .....&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; super.onStartCommand(intent, flags, startId);&lt;br/&gt;    }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;最后，在HttpServer中通过不同的路径来实现接收不同的指令。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;private JSONObject getResponseByUri(@Nonnull IHTTPSession session) throws JSONException {&lt;br/&gt;        String uri = session.getUri();&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (isFindCommand(uri)) {&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; getResponseByFindUri(uri);&lt;br/&gt;        }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;@Nonnull&lt;br/&gt;private JSONObject getResponseByFindUri(@Nonnull String uri) throws JSONException {&lt;br/&gt;    String template = uri.split(&lt;span&gt;&quot;/&quot;&lt;/span&gt;)[2];&lt;br/&gt;    String protocol = uri.split(&lt;span&gt;&quot;/&quot;&lt;/span&gt;)[3];&lt;br/&gt;    switch (protocol) {&lt;br/&gt;        &lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;frame&quot;&lt;/span&gt;:&lt;br/&gt;            TemplateLayoutFrame tlf = new TemplateLayoutFrame();&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; tlf.getOutData(template);&lt;br/&gt;        &lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;subview&quot;&lt;/span&gt;:&lt;br/&gt;            SubViewInfo svi = new SubViewInfo();&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; svi.getOutData(template);&lt;br/&gt;        //省略了部分的代码处理逻辑    &lt;br/&gt;        ....&lt;br/&gt;        default:&lt;br/&gt;            JSONObject errorJson = new JSONObject();&lt;br/&gt;            errorJson.put(&lt;span&gt;&quot;success&quot;&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;);&lt;br/&gt;            errorJson.put(&lt;span&gt;&quot;message&quot;&lt;/span&gt;, &lt;span&gt;&quot;输入find链接地址有误&quot;&lt;/span&gt;);&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; errorJson;&lt;br/&gt;    }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;SDK整体功能结构&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;自动化脚本通过访问设备的特定端口（&lt;/span&gt;&lt;span&gt;例如：http://localhost:8899/find/subview&lt;/span&gt;&lt;span&gt;），经由XrayServer，通过访问路径将请求转发至XrayDumper进行信息的提取和输出。然后布局解析器将布局信息序列化成JSON数据，再经由XrayServer，通过网络以HTTP响应的方式传到给自动化测试脚本。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.38200692041522494&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6UEQpDsBHYSq4SDznicS8zKCBXhqBRjOpCqrcjqVSn7r6S4ZHKiarfd9A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1445&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图9 XraySDK功能结构示意图&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;视图信息的增强&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;除了常规的位置、内容、类型等信息，我们还通过检查时间监听器的方式，进一步判断视图元素是否可以进行交互，进一步增强了页面视图结构的有效信息。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;// setGestures&lt;br/&gt;ArrayList&amp;lt;String&amp;gt; gestures = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; (view.isClickable()){&lt;br/&gt;   gestures.add(&lt;span&gt;&quot;isClickable&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; (view.isLongClickable()){&lt;br/&gt;   gestures.add(&lt;span&gt;&quot;isLongClickable&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;//省略部分代码&lt;br/&gt;.....&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;动态布局自动化的收益&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;基于视图可测性的提升，美团动态化卡片的自动化测试覆盖度有了大幅的提升，从原来无法做自动化测试，到目前80%以上的动态化卡片都实现了自动化测试，而且效率也得到了明显的提升。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3373333333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6ROZtHxsDDcPVjVq1pR1xyJnYicrxl56qZTUjLD3gSq8TzicndbTqqpPA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1500&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图10 自动化效率提升收益&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;未来展望&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;页面视图信息作为客户端测试最基础且重要的属性之一，是对用户视觉信息的一种代码级的表示。它对于机器识别页面元素信息有着非常重要的作用，对于它的可测性改造将会给技术团队带来很大的收益。我们会列举了几个视图可测性改造的探索方向，仅供大家参考。&lt;/span&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用视图解析原理解决WebView元素定位&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;应用同样的思想，我们还可以用来解决WebView元素定位的问题。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6958211856171039&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX6rgazlrx3yb1dzxyH3c5rv73fnlgypBPVtaC6Qz72icTZX7UeWQnJxYA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1029&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图11 WebView页面示例&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;通过运行在App内部的SDK，可以获取到对应的WebView实例。通过获取到根节点，从根节点开始进行循环遍历，同时把每个节点的信息存储下来就可以得到所有的视图信息了。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;在WebView是否也有同样合适的根节点呢？&lt;/span&gt;&lt;span&gt;基于对于HTML的理解，我们可以想到HTML中所有的标签都是挂在BODY标签下面的，BODY标签就是我们需要选取的根节点。&lt;/span&gt;&lt;span&gt;我们可以通过WebElement[&quot;attrName&quot;]的方式来进行属性的获取。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.779467680608365&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsWFvqZw6AfrY7Ne08wJ9cX67ypSMxU9Ldodb5pXAW6IfAdo1YZJeaRmd4mv6pwJPdvKxxrGcic9cWA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1052&quot;/&gt;&lt;figcaption&gt;&lt;span&gt;图12 遍历WebView节点的代码示例&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;视图可测性改造更多的应用场景&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;提升功能测试可靠性&lt;/strong&gt;：在功能测试自动化中，通过内部更加稳定和迅速的视图信息输出，可以有效提升自动化测试的稳定性。避免由于元素无法获取或者元素获取缓慢导致的自动化测试失败。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;提升可靠性测试效率&lt;/strong&gt;：对于依靠随机或者按照视图信息进行页面随机操作的可靠性测试，依赖对于视图信息的过滤，也可以只操作可以交互的元素（&lt;/span&gt;&lt;span&gt;通过过滤元素事件监听器是否为空&lt;/span&gt;&lt;span&gt;）。这样就可以有效提升可靠性测试的效率，在单位时间内可以完成更多页面的检测。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;增加兼容性测试检测手段&lt;/strong&gt;：在页面兼容性方面，通过对页面组件位置信息和属性来扫描页面内是否存在不合理的堆叠、空白区域、形状异常等UI呈现异常。也可以获取内容信息，例如图片、文本，来检查是否存在不适宜内容呈现。可以作为图像对比方案的有效补充。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9dc94051fba472b1740be717bdf565ef</guid>
<title>通俗易懂的 ReentrantLock，不懂你来砍我</title>
<link>https://toutiao.io/k/lhvmoos</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;前言&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;自己开的坑，跪着也要填完，欢迎来到Java并发编程系列第五篇&lt;code&gt;ReentrantLock&lt;/code&gt;，文章风格依然是图文并茂，通俗易懂，本文带读者们深入理解&lt;code&gt;ReentrantLock&lt;/code&gt;设计思想。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果读过阿星写的前篇&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzAwMDg2OTAxNg==&amp;amp;mid=2652048892&amp;amp;idx=1&amp;amp;sn=1b12dc819ec677a2af67875d7fbbe4a0&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;万字长文 | 16张图解开AbstractQueuedSynchronizer&lt;/a&gt;，本篇的效果拉满，未读过也没关系，依然能get到&lt;code&gt;ReentrantLock&lt;/code&gt;原理。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;认识下ReentrantLock&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿星先带读者们和&lt;code&gt;ReentrantLock&lt;/code&gt;见个面，简单的认识下什么是&lt;code&gt;ReentrantLock&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;是可重入的互斥锁，虽然具有与&lt;code&gt;synchronized&lt;/code&gt;相同功能，但是会比&lt;code&gt;synchronized&lt;/code&gt;更加灵活（&lt;strong&gt;具有更多的方法&lt;/strong&gt;）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;底层基于&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;实现，&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;在前一篇已经详细解剖过了，本文不做过多描述，但是会简单的介绍下，照顾小白。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.2&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWU1OH2cQibXc0ReOQFyp0zOF3eWev5VmJKtUsibGFFWzsHCicQBCibJ13lg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;300&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;抽象类定义了一套多线程访问共享资源的同步模板，解决了实现同步器时涉及的大量细节问题，能够极大地减少实现工作，用大白话来说，&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;为加锁和解锁过程提供了统一的模板函数，只有少量细节由子类自己决定。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过上述介绍，相信读者们对&lt;code&gt;ReentrantLock&lt;/code&gt;有了初步的影响，下面开始发车了~&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;ReentrantLock结构组成&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿星觉得，学任何知识的第一件事，就是看清它的全貌，梳理出整体结构与主流程，之后逐个击破，所以阿星带读者们先看下&lt;code&gt;ReentrantLock&lt;/code&gt;整体结构组成，对它的实现有个大致的了解。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWuicJjfHhg3jbfwXqRFc17M1PYnXowCbV3Niak9ofBkAULd6rTF3IJrOA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1440&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图可以看出来，&lt;code&gt;ReentrantLock&lt;/code&gt;整体结构还是非常简单，阿星给读者们分析一波，为什么&lt;code&gt;ReentrantLock&lt;/code&gt;结构是这样设计的，首先&lt;code&gt;ReentrantLock&lt;/code&gt;实现了&lt;code&gt;Lock&lt;/code&gt;接口，&lt;code&gt;Lock&lt;/code&gt;接口是&lt;code&gt;Java&lt;/code&gt;中对锁操作行为的统一规范，遵守规则规范是守法公民的基本素养，合情合理，&lt;code&gt;Lock&lt;/code&gt;接口的定义如下&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;interface&lt;/span&gt; &lt;span&gt;Lock&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取锁&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;void&lt;/span&gt; &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取锁-响应中断 &lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;void&lt;/span&gt; &lt;span&gt;lockInterruptibly&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; InterruptedException&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 返回获取锁是否成功状态&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 返回获取锁是否成功状态-响应中断 &lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt; time, TimeUnit unit)&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; InterruptedException&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 释放锁&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;void&lt;/span&gt; &lt;span&gt;unlock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 创建条件变量&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;Condition &lt;span&gt;newCondition&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Lock&lt;/code&gt;接口定义的函数不多，接下来&lt;code&gt;ReentrantLock&lt;/code&gt;要去实现这些函数，遵循着解耦可扩展设计，&lt;code&gt;ReentrantLock&lt;/code&gt;内部定义了专门的组件&lt;code&gt;Sync&lt;/code&gt;， &lt;code&gt;Sync&lt;/code&gt;继承&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;提供释放资源的实现，&lt;code&gt;NonfairSync&lt;/code&gt;和&lt;code&gt;FairSync&lt;/code&gt;是基于&lt;code&gt;Sync&lt;/code&gt;扩展的子类，即&lt;code&gt;ReentrantLock&lt;/code&gt;的非公平模式与公平模式，它们作为&lt;code&gt;Lock&lt;/code&gt;接口功能的基本实现。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.44229149115417016&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWOZUE8ZWvWFZ5yelAqggc1ZBhWtyjlQzMhpjpCTpvGUPy9xvYBxQhBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1187&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大白话来说，企业的老板，为了响应政府的政策，需要对企业内部做调整，但是政府每年政策都不一样，每次都要自己去亲力亲为，索性长痛不如短痛，专门成立一个政策应对部门，以后这些事情都交予这个部门去做，老板只需要指挥它们就好了。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.512372634643377&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWIm1UTTNP08TkYhUkic9BGt1gYTaGCCd31lPVs6jjMTxbBGV0Zogz28g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;687&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;结构组成读者们也清楚了，下面阿星只需对&lt;code&gt;Sync、NonfairSync、FairSync&lt;/code&gt;逐个击破，&lt;code&gt;ReentrantLock&lt;/code&gt;自然水到渠成。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;小贴士：在&lt;code&gt;ReentrantLock&lt;/code&gt;中，它对&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;的&lt;code&gt;state&lt;/code&gt;状态值定义为线程获取该锁的重入次数，&lt;code&gt;state&lt;/code&gt;状态值为&lt;code&gt;0&lt;/code&gt;表示当前没有被任何线程持有，&lt;code&gt;state&lt;/code&gt;状态值为&lt;code&gt;1&lt;/code&gt;表示被其他线程持有，因为支持可重入，如果是持有锁的线程，再次获取同一把锁，直接成功，并且&lt;code&gt;state&lt;/code&gt;状态值&lt;code&gt;+1&lt;/code&gt;，线程释放锁&lt;code&gt;state&lt;/code&gt;状态值&lt;code&gt;-1&lt;/code&gt;，同理重入多次锁的线程，需要释放相应的次数。&lt;/p&gt;&lt;/blockquote&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;Sync&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Sync&lt;/code&gt;可以说是&lt;code&gt;ReentrantLock&lt;/code&gt;的亲儿子，它寄托了全村的希望，完美的继承了&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;，是&lt;code&gt;ReentrantLock&lt;/code&gt;的核心，后面的&lt;code&gt;NonfairSync&lt;/code&gt;与&lt;code&gt;FairSync&lt;/code&gt;都是基于&lt;code&gt;Sync&lt;/code&gt;扩展出来的子类。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;听阿星吹完了&lt;code&gt;Sync&lt;/code&gt;，下面就来看看&lt;code&gt;Sync&lt;/code&gt;类定义的核心部分&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Sync&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;AbstractQueuedSynchronizer&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; serialVersionUID = -&lt;span&gt;5179523762034025860L&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 获取锁-子类实现&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 非公平-获取资源&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;nonfairTryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; acquires)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;//获取当前线程&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;final&lt;/span&gt; Thread current = Thread.currentThread();&lt;br/&gt;            &lt;span&gt;//获取当前状态&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;int&lt;/span&gt; c = getState();&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (c == &lt;span&gt;0&lt;/span&gt;) { &lt;span&gt;// state==0 代表资源可获取&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//cas设置state为acquires，acquires传入的是1&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (compareAndSetState(&lt;span&gt;0&lt;/span&gt;, acquires)) {&lt;br/&gt;                    &lt;span&gt;//cas成功，设置当前持有锁的线程&lt;/span&gt;&lt;br/&gt;                    setExclusiveOwnerThread(current);&lt;br/&gt;                    &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;                    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;            &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (current == getExclusiveOwnerThread()) { &lt;span&gt;//如果state!=0,但是当前线程是持有锁线程，直接重入&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//state状态+1&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;int&lt;/span&gt; nextc = c + acquires;&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (nextc &amp;lt; &lt;span&gt;0&lt;/span&gt;) &lt;span&gt;// overflow&lt;/span&gt;&lt;br/&gt;                    &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; Error(&lt;span&gt;&quot;Maximum lock count exceeded&quot;&lt;/span&gt;);&lt;br/&gt;                &lt;span&gt;//设置state状态，此处不需要cas，因为持有锁的线程只有一个    &lt;/span&gt;&lt;br/&gt;                setState(nextc);&lt;br/&gt;                &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;            }&lt;br/&gt;            &lt;span&gt;//返回失败&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;        &lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 释放资源&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryRelease&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; releases)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;//state状态-releases，releases传入的是1&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;int&lt;/span&gt; c = getState() - releases;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (Thread.currentThread() != getExclusiveOwnerThread()) &lt;span&gt;//如果当前线程不是持有锁线程，抛出异常&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalMonitorStateException();&lt;br/&gt;            &lt;span&gt;//设置返回状态，默认为失败&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;boolean&lt;/span&gt; free = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (c == &lt;span&gt;0&lt;/span&gt;) {&lt;span&gt;//state-1后，如果c==0代表释放资源成功&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//返回状态设置为true&lt;/span&gt;&lt;br/&gt;                free = &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;                &lt;span&gt;//清空持有锁线程&lt;/span&gt;&lt;br/&gt;                setExclusiveOwnerThread(&lt;span&gt;null&lt;/span&gt;);&lt;br/&gt;            }&lt;br/&gt;            &lt;span&gt;//如果state-1后，state还是&amp;gt;0，代表当前线程有锁重入操作，需要做相应的释放次数，设置state值&lt;/span&gt;&lt;br/&gt;            setState(c);&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; free;&lt;br/&gt;        }&lt;br/&gt;}        &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿星发现&lt;code&gt;Sync&lt;/code&gt;有点偏心，首先&lt;code&gt;Sync&lt;/code&gt;实现释放资源的细节（&lt;strong&gt;&lt;code&gt;A Q S&lt;/code&gt;留给子类实现的&lt;code&gt;tryRelease&lt;/code&gt;&lt;/strong&gt;），然后声明了获取锁的抽象函数（&lt;strong&gt;&lt;code&gt;lock&lt;/code&gt;&lt;/strong&gt;），子类根据业务实现，目前看来还是很公平，但是&lt;code&gt;Sync&lt;/code&gt;还定义了一个&lt;code&gt;nonfairTryAcquire&lt;/code&gt;函数，这个函数是专门给&lt;code&gt;NonfairSync&lt;/code&gt;使用的，&lt;code&gt;FairSync&lt;/code&gt;却没有这种待遇，所以说&lt;code&gt;Sync&lt;/code&gt;偏心。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Sync&lt;/code&gt;逻辑都比较简单，实现了&lt;code&gt;A Q S&lt;/code&gt;类的释放资源（&lt;strong&gt;&lt;code&gt;tryRelease&lt;/code&gt;&lt;/strong&gt;），然后抽象了一个获取锁的函数让子类自行实现（&lt;strong&gt;&lt;code&gt;lock&lt;/code&gt;&lt;/strong&gt;），再加一个偏心的函数&lt;code&gt;nonfairTryAcquire&lt;/code&gt;，但是再怎么简单，图还是要有的，这是阿星读者们的福利。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面放一张&lt;code&gt;tryRelease&lt;/code&gt;流程图，在后续的&lt;code&gt;NonfairSync、FairSync&lt;/code&gt;都会有全面的流程。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.4495268138801263&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWN5WP8M73hd1XHvH45siamI5gz0U4ibtrUQ4OBa8rCy0kh4YkNIybVEgw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;634&quot;/&gt;&lt;/figure&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;NonfairSync&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在我们把视线转移到&lt;code&gt;NonfairSync&lt;/code&gt;，在&lt;code&gt;ReentrantLock&lt;/code&gt;中支持两种获取锁的策略，分别是非公平策略与公平策略，&lt;code&gt;NonfairSync&lt;/code&gt;就是非公平策略。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时读者会有问道，阿星什么是非公平策略？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在说非公平策略前，先简单的说下&lt;code&gt;A Q S（AbstractQueuedSynchronizer）&lt;/code&gt;流程，&lt;code&gt;A Q S&lt;/code&gt;为加锁和解锁过程提供了统一的模板函数，加锁与解锁的模板流程是，获取锁失败的线程，会进入&lt;code&gt;CLH&lt;/code&gt;队列阻塞，其他线程解锁会唤醒&lt;code&gt;CLH&lt;/code&gt;队列线程，如下图所示（简化流程）&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5698924731182796&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWkAxxKBEOnzQeoRvicDdsmrRYz5vjychTKnHL0WtribwlAWUpVoZnkXKQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;837&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图中，线程释放锁时，会唤醒&lt;code&gt;CLH&lt;/code&gt;队列阻塞的线程，重新竞争锁，要注意，此时可能还有非&lt;code&gt;CLH&lt;/code&gt;队列的线程参与竞争，所以非公平就体现在这里，非&lt;code&gt;CLH&lt;/code&gt;队列线程与&lt;code&gt;CLH&lt;/code&gt;队列线程竞争，各凭本事，不会因为你是&lt;code&gt;CLH&lt;/code&gt;队列的线程，排了很久的队，就把锁让给你。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;了解了什么是非公平策略，我们再来看看&lt;code&gt;NonfairSync&lt;/code&gt;类定义&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;    &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;NonfairSync&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;Sync&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; serialVersionUID = &lt;span&gt;7316153563782823691L&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 获取锁&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;final&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (compareAndSetState(&lt;span&gt;0&lt;/span&gt;, &lt;span&gt;1&lt;/span&gt;))&lt;span&gt;//cas设置state为1成功，代表获取资源成功    &lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//资源获取成功，设置当前线程为持有锁线程&lt;/span&gt;&lt;br/&gt;                setExclusiveOwnerThread(Thread.currentThread());&lt;br/&gt;            &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//cas设置state为1失败，代表获取资源失败，执行AQS获取锁模板流程，否获取资源成功&lt;/span&gt;&lt;br/&gt;                acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;        }&lt;br/&gt;        &lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 获取资源-使用的是Sync提供的nonfairTryAcquire函数&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; acquires)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; nonfairTryAcquire(acquires);&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;    &lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * AQS获取锁模板函数，这是AQS类中的函数&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;acquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; arg)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 我们只需要关注tryAcquire函数，后面的函数是AQS获取资源失败，线程节点进入CLH队列的细节流程，本文不关注&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (!tryAcquire(arg) &amp;amp;&amp;amp;&lt;br/&gt;            acquireQueued(addWaiter(Node.EXCLUSIVE), arg))&lt;br/&gt;            selfInterrupt();&lt;br/&gt;    }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;NonfairSync&lt;/code&gt;继承&lt;code&gt;Sync&lt;/code&gt;实现了&lt;code&gt;lock&lt;/code&gt;函数，&lt;code&gt;lock&lt;/code&gt;函数也非常简单，&lt;code&gt;C A S&lt;/code&gt;设置状态值&lt;code&gt;state&lt;/code&gt;为&lt;code&gt;1&lt;/code&gt;代表获取锁成功，否则执行&lt;code&gt;A Q S&lt;/code&gt;的&lt;code&gt;acquire&lt;/code&gt;函数（&lt;strong&gt;获取锁模板&lt;/strong&gt;），另外&lt;code&gt;NonfairSync&lt;/code&gt;还实现了&lt;code&gt;A Q S&lt;/code&gt;留给子类实现的&lt;code&gt;tryAcquire&lt;/code&gt;函数（&lt;strong&gt;获取资源&lt;/strong&gt;），这个被&lt;code&gt;Sync&lt;/code&gt;宠幸的幸运儿，直接使用&lt;code&gt;Sync&lt;/code&gt;提供的&lt;code&gt;nonfairTryAcquire&lt;/code&gt;函数来实现&lt;code&gt;tryAcquire&lt;/code&gt;，最后子类实现的&lt;code&gt;tryAcquire&lt;/code&gt;函数在&lt;code&gt;A Q S&lt;/code&gt;的&lt;code&gt;acquire&lt;/code&gt;函数中被使用。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是不是有点绕？没事阿星带大家一起缕一缕&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7032734952481521&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWg0j6IsiaMeZY2evNyGibM5QXdlUIYaxxYEJ4DJewbVFU20en23OZydPA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;947&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首先&lt;code&gt;A Q S&lt;/code&gt;的&lt;code&gt;acquire&lt;/code&gt;函数是获取锁的流程模板，模板流程会先执行&lt;code&gt;tryAcquire&lt;/code&gt;函数获取资源，&lt;code&gt;tryAcquire&lt;/code&gt;函数要子类实现，&lt;code&gt;NonfairSync&lt;/code&gt;作为子类，实现了&lt;code&gt;tryAcquire&lt;/code&gt;函数，具体实现是调用了&lt;code&gt;Sync&lt;/code&gt;的&lt;code&gt;nonfairTryAcquire&lt;/code&gt;函数。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们再看看&lt;code&gt;Sync&lt;/code&gt;专门给&lt;code&gt;NonfairSync&lt;/code&gt;准备的&lt;code&gt;nonfairTryAcquire&lt;/code&gt;函数逻辑&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;    &lt;span&gt;/**&lt;br/&gt;     * 非公平-获取资源&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;nonfairTryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; acquires)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//获取当前线程&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;final&lt;/span&gt; Thread current = Thread.currentThread();&lt;br/&gt;        &lt;span&gt;//获取当前状态&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;int&lt;/span&gt; c = getState();&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (c == &lt;span&gt;0&lt;/span&gt;) { &lt;span&gt;// state==0 代表资源可获取&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;//cas设置state为acquires，acquires传入的是1&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (compareAndSetState(&lt;span&gt;0&lt;/span&gt;, acquires)) {&lt;br/&gt;                &lt;span&gt;//cas成功，设置当前持有锁的线程&lt;/span&gt;&lt;br/&gt;                setExclusiveOwnerThread(current);&lt;br/&gt;                &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;//如果state!=0,但是当前线程是持有锁线程，直接重入&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (current == getExclusiveOwnerThread()) {&lt;br/&gt;            &lt;span&gt;//state状态+1&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;int&lt;/span&gt; nextc = c + acquires;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (nextc &amp;lt; &lt;span&gt;0&lt;/span&gt;) &lt;span&gt;// overflow&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; Error(&lt;span&gt;&quot;Maximum lock count exceeded&quot;&lt;/span&gt;);&lt;br/&gt;            &lt;span&gt;//设置state状态，此处不需要cas，因为持有锁的线程只有一个    &lt;/span&gt;&lt;br/&gt;            setState(nextc);&lt;br/&gt;            &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;//返回失败&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿星对上述代码逻辑做个简单的概括，当前线程查看资源是否可获取：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;可获取，尝试使用&lt;code&gt;C A S&lt;/code&gt;设置&lt;code&gt;state&lt;/code&gt;为&lt;code&gt;1&lt;/code&gt;，&lt;code&gt;C A S&lt;/code&gt;成功代表获取资源成功，否则获取资源失败&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;不可获取，判断当线程是不是持有锁的线程，如果是，&lt;code&gt;state&lt;/code&gt;重入计数，获取资源成功，否则获取资源失败&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;就两句话，是不是十分简单，虽然简单但阿星还是画了一张&lt;code&gt;nonfairTryAcquire&lt;/code&gt;流程图给读者们观赏&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.529064039408867&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWsnuUCJMCeibN6fI6PqaNq4K2fFdzDMoxcXoBEMtiavsVVqRpGDCYNttQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1015&quot;/&gt;&lt;/figure&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;FairSync&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有非公平策略，就有公平策略，&lt;code&gt;FairSync&lt;/code&gt;就是&lt;code&gt;ReentrantLock&lt;/code&gt;的公平策略。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所谓公平策略就是，严格按照&lt;code&gt;CLH&lt;/code&gt;队列顺序获取锁，线程释放锁时，会唤醒&lt;code&gt;CLH&lt;/code&gt;队列阻塞的线程，重新竞争锁，要注意，此时可能还有非&lt;code&gt;CLH&lt;/code&gt;队列的线程参与竞争，为了保证公平，一定会让&lt;code&gt;CLH&lt;/code&gt;队列线程竞争成功，如果非&lt;code&gt;CLH&lt;/code&gt;队列线程一直占用时间片，那就一直失败（&lt;strong&gt;构建成节点插入到&lt;code&gt;CLH&lt;/code&gt;队尾，由&lt;code&gt;A S Q&lt;/code&gt;模板流程执行&lt;/strong&gt;），直到时间片轮到&lt;code&gt;CLH&lt;/code&gt;队列线程为止，所以公平策略的性能会更差。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3727598566308244&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWqDakiaWkTYsLnicnAOSarSSsgIFS0EQw4iacpGaicevIHEt5dp59qib73MA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1116&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;了解了什么是公平策略，我们再来看看&lt;code&gt;FairSync&lt;/code&gt;类定义&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;FairSync&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;Sync&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; serialVersionUID = -&lt;span&gt;3000897897090466540L&lt;/span&gt;;&lt;br/&gt;        &lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 获取锁&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;final&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//cas设置state为1失败，代表获取资源失败，执行AQS获取锁模板流程，否获取资源成功&lt;/span&gt;&lt;br/&gt;            acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 获取资源&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; acquires)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;//获取当前线程&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;final&lt;/span&gt; Thread current = Thread.currentThread();&lt;br/&gt;            &lt;span&gt;//获取state状态&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;int&lt;/span&gt; c = getState();&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (c == &lt;span&gt;0&lt;/span&gt;) { &lt;span&gt;// state==0 代表资源可获取&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;//1.hasQueuedPredecessors判断当前线程是不是CLH队列被唤醒的线程，如果是执行下一个步骤&lt;/span&gt;&lt;br/&gt;               &lt;span&gt;//2.cas设置state为acquires，acquires传入的是1&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (!hasQueuedPredecessors() &amp;amp;&amp;amp;&lt;br/&gt;                    compareAndSetState(&lt;span&gt;0&lt;/span&gt;, acquires)) {&lt;br/&gt;                    &lt;span&gt;//cas成功，设置当前持有锁的线程&lt;/span&gt;&lt;br/&gt;                    setExclusiveOwnerThread(current);&lt;br/&gt;                    &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;                    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;            &lt;span&gt;//如果state!=0,但是当前线程是持有锁线程，直接重入&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (current == getExclusiveOwnerThread()) {&lt;br/&gt;                &lt;span&gt;//state状态+1&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;int&lt;/span&gt; nextc = c + acquires;&lt;br/&gt;                &lt;span&gt;if&lt;/span&gt; (nextc &amp;lt; &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;                    &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; Error(&lt;span&gt;&quot;Maximum lock count exceeded&quot;&lt;/span&gt;);&lt;br/&gt;                &lt;span&gt;//设置state状态，此处不需要cas，因为持有锁的线程只有一个 &lt;/span&gt;&lt;br/&gt;                setState(nextc);&lt;br/&gt;                &lt;span&gt;//返回成功&lt;/span&gt;&lt;br/&gt;                &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;            }&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * AQS获取锁模板函数，这是AQS类中的函数&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;acquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; arg)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;/**&lt;br/&gt;         * 我们只需要关注tryAcquire函数，后面的函数是AQS获取资源失败，线程节点进入CLH队列的细节流程，本文不关注&lt;br/&gt;         */&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (!tryAcquire(arg) &amp;amp;&amp;amp;&lt;br/&gt;            acquireQueued(addWaiter(Node.EXCLUSIVE), arg))&lt;br/&gt;            selfInterrupt();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实我们不难发现&lt;code&gt;FairSync&lt;/code&gt;流程与&lt;code&gt;NonfairSync&lt;/code&gt;基本一致，唯一的区别就是在&lt;code&gt;C A S&lt;/code&gt;执行前，多了一步&lt;code&gt;hasQueuedPredecessors&lt;/code&gt;函数，这一步就是判断当前线程是不是&lt;code&gt;CLH&lt;/code&gt;队列被唤醒的线程，如果是就执行&lt;code&gt;C A S&lt;/code&gt;，否则获取资源失败，下面水一张图&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5708661417322834&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWfqogTGkgXa5V3BklWHd6HjVJChX97sK9vOBuozkpaGZHYYurD1GVng/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1016&quot;/&gt;&lt;/figure&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;Lock的实现&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后阿星带大家看看&lt;code&gt;ReentrantLock&lt;/code&gt;中是如何实现&lt;code&gt;Lock&lt;/code&gt;的，先看构造器部分&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;    &lt;span&gt;//同步器&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Sync sync;&lt;br/&gt;    &lt;br/&gt;    &lt;span&gt;//默认使用非公平策略&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;ReentrantLock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        sync = &lt;span&gt;new&lt;/span&gt; NonfairSync();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;//true-公平策略 false非公平策略&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;ReentrantLock&lt;/span&gt;&lt;span&gt;(&lt;span&gt;boolean&lt;/span&gt; fair)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        sync = fair ? &lt;span&gt;new&lt;/span&gt; FairSync() : &lt;span&gt;new&lt;/span&gt; NonfairSync();&lt;br/&gt;    }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;ReentrantLock&lt;/code&gt;默认是使用非公平策略，如果想指定模式，可以通过入参&lt;code&gt;fair&lt;/code&gt;来选择，这里就不做过多概述，接下来看看&lt;code&gt;ReentrantLock&lt;/code&gt;对&lt;code&gt;Lock&lt;/code&gt;的实现&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ReentrantLock&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;Lock&lt;/span&gt;, &lt;span&gt;java&lt;/span&gt;.&lt;span&gt;io&lt;/span&gt;.&lt;span&gt;Serializable&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; serialVersionUID = &lt;span&gt;7373984872572414699L&lt;/span&gt;;&lt;br/&gt;    &lt;span&gt;//同步器&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Sync sync;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;//默认使用非公平策略&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;ReentrantLock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        sync = &lt;span&gt;new&lt;/span&gt; NonfairSync();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;//true-公平策略 false非公平策略&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;ReentrantLock&lt;/span&gt;&lt;span&gt;(&lt;span&gt;boolean&lt;/span&gt; fair)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        sync = fair ? &lt;span&gt;new&lt;/span&gt; FairSync() : &lt;span&gt;new&lt;/span&gt; NonfairSync();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取锁-阻塞&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现&lt;/span&gt;&lt;br/&gt;        sync.lock();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取锁-阻塞，支持响应线程中断&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;lockInterruptibly&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现&lt;/span&gt;&lt;br/&gt;        sync.acquireInterruptibly(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取资源，返回是否成功状态-非阻塞&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; sync.nonfairTryAcquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 获取锁-阻塞，支持超时 &lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt; timeout, TimeUnit unit)&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现    &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; sync.tryAcquireNanos(&lt;span&gt;1&lt;/span&gt;, unit.toNanos(timeout));&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 释放锁&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;unlock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现&lt;/span&gt;&lt;br/&gt;        sync.release(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 创建条件变量&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Condition &lt;span&gt;newCondition&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;//基于sync实现&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; sync.newCondition();&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是不是特别简单，&lt;code&gt;ReentrantLock&lt;/code&gt;对&lt;code&gt;Lock&lt;/code&gt;的实现都是基于&lt;code&gt;Sync&lt;/code&gt;来做的，有一种神器在手，天下我有的风范。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Sync&lt;/code&gt;承包了所有事情，为何它如此牛皮，因为&lt;code&gt;Sync&lt;/code&gt;上有&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;老大哥罩着，下有&lt;code&gt;NonfairSync&lt;/code&gt;与&lt;code&gt;FairSync&lt;/code&gt;两小弟可差遣，所以成为&lt;code&gt;ReentrantLock&lt;/code&gt;的利器也合情合理。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWLcGwptSF8fxsGpfzxQgK8XvlGApg0RGickicoMyN8k0HyMMCx8N8zgiag/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;500&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后阿星肝一张结合&lt;code&gt;A Q S&lt;/code&gt;的流程图，来结束&lt;code&gt;ReentrantLock&lt;/code&gt;。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5472813238770685&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuWm9iaYN0XDjErGcpcGhtb8trJngBsuaiaW7tobtcyvx0PrndicDsljGNlw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1692&quot;/&gt;&lt;/figure&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;唠叨唠叨&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这次阿星写在风格稍微调整了下，不知道各位读者喜不喜欢，如果喜欢的话请&lt;strong&gt;点赞、再看&lt;/strong&gt;，让阿星感受下读者们的热情，最后下面会有一个关于阅读时间的调查，也希望读者们可以热情参与，好让阿星对发文时间心里有个B树。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span class=&quot;vote_area&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;历史好文推荐&lt;/h1&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;关于我&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里是阿星，一个热爱技术的Java程序猿，公众号  &lt;strong&gt;「程序猿阿星」&lt;/strong&gt; 里将会定期分享操作系统、计算机网络、Java、分布式、数据库等精品原创文章，2021，与您在 Be Better 的路上共同成长！。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5763888888888888&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/23OQmC1ia8nwcicjaib16o8pk7eQOzRKNuW9jRMgGUhrEIkkQC9UJRepdlIOSASxNEOL9ryefbaknUzeVH9xZaJaw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;288&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;非常感谢各位小哥哥小姐姐们能看到这里，原创不易，文章有帮助可以关注、点个赞、分享与评论，都是支持（莫要白嫖）！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;愿你我都能奔赴在各自想去的路上，我们下篇文章见&lt;/p&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>