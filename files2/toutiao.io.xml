<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>4a225e2d07d887526ac95e9ada8924b5</guid>
<title>面试过 200 人的经验，都在这里了 | 码农周刊第 325 期</title>
<link>https://toutiao.io/k/xvysg5s</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;body class=&quot;issue&quot; id=&quot;readabilityBody&quot;&gt;
        &lt;h1&gt;面试过 200 人的经验，都在这里了 | 码农周刊第 325 期&lt;/h1&gt;
        &lt;h2&gt;码农周刊第325期（2020-11-25）&lt;/h2&gt;
        &lt;p&gt;☞ &lt;a href=&quot;https://weekly.manong.io/bounce?nid=325&amp;amp;aid=19568&amp;amp;url=https%3A%2F%2Fvip.manong.io%2F%3F3250&quot; target=&quot;_blank&quot;&gt;薪资翻番如何实现？程序员的涨薪秘诀&lt;/a&gt;&lt;br/&gt;&amp;#13;
&lt;a href=&quot;https://weekly.manong.io/bounce?nid=325&amp;amp;aid=19568&amp;amp;url=https%3A%2F%2Fvip.manong.io%2F%3F3250&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_321.png&quot; alt=&quot;&quot;/&gt;&lt;/a&gt;&lt;br/&gt;&amp;#13;
&lt;small&gt;&lt;a href=&quot;https://weekly.manong.io/bounce?nid=325&amp;amp;aid=19185&amp;amp;url=https%3A%2F%2Fjinshuju.net%2Ff%2FV7DxN9&quot; target=&quot;_blank&quot;&gt;商务合作&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;
        
        &lt;h3 id=&quot;程序设计&quot;&gt;程序设计&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;「码农周刊 VIP 会员专属邮件周报」每周五发送，自订购之日算起，全年 52 期。&lt;/p&gt;
        
        &lt;p&gt;详细介绍&lt;/p&gt;
        
        &lt;p&gt;业界实战&lt;/p&gt;
        
        &lt;p&gt;经验分享&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_3041.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
        &lt;h3 id=&quot;VIP会员专区&quot;&gt;VIP会员专区&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;工作地点：成都 | 薪资：15-30K | 简历投递邮箱：xiexiaofang@huobi.com&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;相比 cocos2d 引擎有着更低的入门门槛和维护成本，为复杂动画的实现提供了一种全新的方式，新的复杂动画开发将会变得更加简单高效。&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;让您享受极简编程体验，快速访问支付宝开放平台开放的各项核心能力。&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;一个不错的 Python 学习教程，30 天循序渐进地教你学会 Python。&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;白皮书从技术、市场、趋势、挑战等多维度，对我国开源产业生态进行了全面、深度的剖析，指出了我国开源产业发展的几大重要趋势。&lt;/p&gt;
        &lt;h3 id=&quot;工具资料&quot;&gt;工具资料&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;「码农周刊 VIP 会员专属邮件周报」每周五发送，自订购之日算起，全年 52 期。&lt;/p&gt;
        
        &lt;p&gt;试试吧&lt;/p&gt;
        
        &lt;p&gt;经验总结&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;简明介绍&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        
        &lt;p&gt;一步步教你&lt;/p&gt;
        
        &lt;p&gt;结合代码&lt;/p&gt;
        
        &lt;p&gt;供参考&amp;#13;
&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;图文并茂&lt;/p&gt;
        
        &lt;p&gt;收藏吧&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        
        &lt;p&gt;实用&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        
        &lt;p&gt;经验分享&lt;/p&gt;
        
        &lt;p&gt;使用方便&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_3041.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
        &lt;h3 id=&quot;编程语言&quot;&gt;编程语言&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;「码农周刊 VIP 会员专属邮件周报」每周五发送，自订购之日算起，全年 52 期。&lt;/p&gt;
        
        &lt;p&gt;一步步教你&lt;/p&gt;
        
        &lt;p&gt;代码示例&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;良心教程&lt;/p&gt;
        
        &lt;p&gt;结合代码&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;你怎么看？&lt;/p&gt;
        
        &lt;p&gt;深入研究&lt;/p&gt;
        
        &lt;p&gt;详解&lt;/p&gt;
        
        &lt;p&gt;详细介绍&lt;/p&gt;
        
        &lt;p&gt;供参考&lt;/p&gt;
        &lt;h3 id=&quot;每周独家号推荐&quot;&gt;每周独家号推荐&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;技术总结，经验分享&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 451179 即可&lt;/p&gt;
        
        &lt;p&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 429587 即可&lt;/p&gt;
        
        &lt;p&gt;分享计算机视觉与机器学习技术的最前沿&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 359575 即可&lt;/p&gt;
        
        &lt;p&gt;聚焦基础架构和Linux。十年架构，日百亿流量，与你探讨高并发世界，给你不一样的味道。&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 351247 即可&lt;/p&gt;
        
        &lt;p&gt;学习就是不停的积累&lt;br/&gt;订阅方法：使用&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;，发现 &amp;gt; 搜索 24912 即可&lt;/p&gt;
        &lt;h3 id=&quot;每周一书&quot;&gt;每周一书&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;本手册以开发工程师为中心视角，划分为单元测试、安全规约、MySQL 数据库、工程结构等七个维度，相应的扩展解释和说明、正例和反例，全面、立体、形象地帮助开发工程师成长。欢迎到&lt;a href=&quot;http://toutiao.io/download?ref=v4.1.0&quot; target=&quot;_blank&quot;&gt;开发者头条客户端&lt;/a&gt;兑换阅读。&lt;/p&gt;
        &lt;h3 id=&quot;编程之外&quot;&gt;编程之外&lt;/h3&gt;
        &lt;p/&gt;
        
        &lt;p&gt;经验分享&lt;/p&gt;
        
        &lt;p&gt;个人经历&lt;/p&gt;
        
        &lt;p&gt;一直被追赶，从未被超越&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://img.toutiao.io/ads/vip_3041.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
        &lt;p&gt;
        &lt;/p&gt;
        
        
        
        
        &lt;div class=&quot;qrcode&quot;&gt;
  &lt;img src=&quot;https://img.toutiao.io/ads/vip_qrcode.png&quot; alt=&quot;Qrcode 258&quot;/&gt;&lt;span&gt;加入码农周刊VIP会员&lt;/span&gt;
&lt;/div&gt;
    &lt;/body&gt;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>ef0f0d2f64eccca1a51c59e98281bd65</guid>
<title>最近做 Code Review 的 5 点经验分享</title>
<link>https://toutiao.io/k/5sw3syp</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;背景&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;最近两周项目代码提交到我这里来review的每周有20多个commit。也和同事聊天一起探讨了一下，几点自己认为需要注意的地方拿出来探讨一下。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;以尽量小的单元提交push&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;其实我review代码的时候比较开放。有些仁者见仁的风格问题，除非统一内部讨论定下来，我是会放过的。比如有些人喜欢用lambda表达式，有些人喜欢用传统的for each。风格不同，没有必要让别人按照自己的想法来。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;但是有一点哈，每次提交到负责review人那边的代码尽量一次不要太多。可以将一个开发功能事先拆分好。每次以不超过2个新增类。除了全局替换的，共不超过5个修改类为宜。或者提交的代码功能单一。一些代码优化，删除废弃代码什么的至少要在修改内容里标出。最好单独提code review申请。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;为什么要这样呢？因为一次提交的代码太多了。从code review者的角度来讲：看代码的时候很可能联系不起来到底是出于什么功能修改的，一些问题可能会被漏掉。降低code review的质量。从开发者的角度来讲，一次开发考虑太多的东西，很可能每个都没有考虑细致到位。思路相对也没有那么清晰。在写代码被打断的时候，可能会中断其中一点的思考，一些要改进的漏掉了。相对是危险的操作。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;lombok的callSuper属性&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;这个是一个自己有没有思考的问题。拷贝别人的代码的时候要想一想。下面的代码大家想一想要不要cullSuper？&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;typescript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Setter&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Getter&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@ToString&lt;/span&gt;(callSuper = &lt;span class=&quot;code-snippet__literal&quot;&gt;true&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; User &lt;span class=&quot;code-snippet__keyword&quot;&gt;implements&lt;/span&gt; Serializable {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Integer id;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; name;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; password;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Integer age;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;实际运行结果如下：这时候User的super类的toString方法调用的object的toString就是打印类的全限定名@内存地址。对我们来说没有实际的参考价值，不建议用callSuper。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.437636761487965&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/2tk5ianItRl8okc6NNSYkYmhRIUeZ7y24DANrZibH76OfKe7jz3xSV1BOzNuGMcB456qicE97iah5YlkCxGUIOuGEA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;914&quot;/&gt;&lt;/p&gt;&lt;p&gt;大家再思考下下面呢？&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;typescript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Data&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; Pojo {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; value;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@NotBlank&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; detail;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Setter&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Getter&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@ToString&lt;/span&gt;(callSuper = &lt;span class=&quot;code-snippet__literal&quot;&gt;true&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; User &lt;span class=&quot;code-snippet__keyword&quot;&gt;extends&lt;/span&gt; Pojo{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Integer id;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; name;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;String&lt;/span&gt; password;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Integer age;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;这里的callSuper父类也是一个用户自己定义的类，它的属性是我们需要了解的，callSuper一点问题也没有。&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.44713656387665196&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/2tk5ianItRl8okc6NNSYkYmhRIUeZ7y24tZVMOnbBSt3tpasOT8VCjjreqDyueMVXlUEqEYpW2kXPIC2ibSZWiaZA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;908&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;业务代码建议定义非RuntimeException&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;一般我们使用的jar包中已经定义好了基本足够用的异常类型，我们可以直接拿来用。但是自定义异常也经常被见到。而且它们被使用通常只有一种情况：要标识出这个异常是某个特定的服务或者功能抛出的。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;那为什么要用非RuntimeException呢？在《&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUzNjAxODg4MQ==&amp;amp;mid=2247485101&amp;amp;idx=1&amp;amp;sn=c95f1a3fa03af199c78d59bb29ea411c&amp;amp;chksm=fafdec03cd8a6515f61cf42d3ce94ee7bc465f445cb61d4644d259c55a661cce4ab1a6dc4738&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Java异常处理总结&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;Java异常处理总结&lt;/a&gt;&lt;span&gt;》&lt;/span&gt;这篇文章中有提到。RuntimeException是非检查异常，其他Exception是检查异常。非检查异常不需要显示处理，而检查异常会提示要try catch或者throw不然编译不通过。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;非检查异常一般用于开发者小心一点就可以避免的异常，比如除以零，操作异常这样的。对于业务开发来说，这种异常何必让系统处理呢，自己不除以零就好，正常操作就好。如果定义为非检查异常，有些需要用户自己处理的异常可能会被漏掉了。所以不建议。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;给客户端用的接口自己吞掉异常要小心&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;从代码架构上来讲，一个服务，如果分成给前端用的接口模块、给其他业务RPC用的接口模块、后台服务接口模块的话。前端用的接口模块我通常是自己处理异常不向外抛出。而所有的RPC接口都是明确抛出一个自定义异常的。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;之所以这样是因为如果后端是java的话，前端一般是js等，异常的交互很不友好。前端处理很麻烦。而RPC接口，调用端也是后台语言。调用端是处理异常可以获取更详细的异常信息。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;举个之前遇到的异常的例子：&lt;/p&gt;&lt;p&gt;之前一个获取秘钥的接口，在获取秘钥失败的时候改了逻辑。没有抛出异常而是返回空字符串。调用端将其作为正常结果处理。结果有次这个接口出问题了。调用的服务正常启动，需要用秘钥来进行后续处理的地方全都异常了。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;如果这个地方，秘钥接口出错是抛出异常。因为当时获取秘钥是启动时加载。那么发版时这台机器就会无法启动。错误立即暴露出来。而线上发布都是低峰期灰度发布。所以几台机器没有启动没有影响。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;java接口定义不要加任何修饰符号&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;阿里巴巴编程规范里有写：&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.2940038684719536&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/2tk5ianItRlibXVp5n1DFp1JtdRXTRzXDiaGYFV4lxviaia4lxjWS73m2S7lWkTGYGBLFtBibIbUDG7ojrgHmEUM8iaew/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1034&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;推荐阅读&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>be3fe6c58f6195cae9e3749367a332ec</guid>
<title>Let Do 本地开发智能合约</title>
<link>https://toutiao.io/k/oplrws3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzU4OTI3NzY4OA==&amp;amp;mid=2247484646&amp;amp;idx=1&amp;amp;sn=a21bb52e8330aa79e807614f42b98979&amp;amp;chksm=fdceb471cab93d67d20ef0fc5cb51c11935b23503f88436fb89b8149977be360a7f0792814df&amp;amp;token=1771762631&amp;amp;lang=zh_CN&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;上篇文章&lt;/a&gt;我们发了个币，有人抱怨在线（remix）写代码不爽，好吧，那就来看下怎么在本地开发智能合约？&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;一、安装开发环境&lt;span/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.安装Node，Node v8.9.4或更高版本&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我安装的是：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3864306784660767&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78BKCJJ2fjibPJicfcPnXA9rUGdzRzicVpbbMvu2n3ibhC5IWjQubFnEIE2Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;339&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.集成开发框架truffle&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么Truffle（官网：https://www.trufflesuite.com/truffle）是什么，Truffle是一个世界级的开发环境，测试框架，以太坊的资源管理通道，致力于让以太坊上的开发变得简单：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;内置的智能合约编译，链接，部署和二进制管理。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;自动化合约测试，可快速发展。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;可编写脚本的，可扩展的部署和迁移框架。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;用于部署到任意数量的公共和专用网络的网络管理。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;包管理与EthPM＆NPM，使用ERC190标准。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;用于直接合约通信的交互式控制台。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;可配置的构建管道，支持紧密集成。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;外部脚本运行程序，在Truffle环境中执行脚本。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;$ npm install truffle -g&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注：-g是全局安装&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;安装完成后，查看truffle版本&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;$ truffle version&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果如下，我们可以看到 truffle、solidity、node和web3.js的版本，这里的solidity 是0.5.16，后面我们会用到这个版本。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Truffle v5.1.52 (core: 5.1.52)&lt;br/&gt;Solidity v0.5.16 (solc-js)&lt;br/&gt;Node v10.15.3&lt;br/&gt;Web3.js v1.2.9&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.下载ganache&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么ganache是什么呢？我们使用ganache来开启一个私链来进行开发测试，默认会在7545端口上运行一个开发链。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下载地址：https://www.trufflesuite.com/ganache ，下载后的文件后缀是appx，安装需要一点时间，第一次安装后，后面直接启动即可，启动依然是点击 下载的appx安装包，然后点击启动，愚笨的我刚开始竟然不知道怎么启动，还一直傻乎乎的在找安装目录。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6362545018007203&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA785qtsTo8Wd8BbNNoG9iagibssyWxicTjelL55N1I4jLmuz8cENfxBKibNMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;833&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Ganache 启动之后是这样：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6432906271072151&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78icfnEH5plkFbmZk5RlJ9pxcVB52Bc7qWjloZVff5jcrtnmK7OXSVGDg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1483&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在第一行我们可以看到有账户、区块、交易、合约、事件、日志。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;账户：默认会有10个账户，分别有100个ETH；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;区块：区块只有一个，即创世区块；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;交易、合约、事件：刚启动是空的；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.下载IDE&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里我们使用 VSCode，下载完成后我们需要给VSCode安装几个插件，solidity、solidity-windows、vscode-icons、local history。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然vscode-icons、local history 也可以不用安装，vscode-icons 只是将目录显示成带图标的文件夹，看起来更加方便而已。local history 只是每次修改保存文件时，都会在根目录的.history目录生成一个修改记录文件，只是一个历史记录而已，方便代码的找回。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;必备插件是 solidity、solidity-windows&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7400881057268722&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78zL02mcWwlDG4C0fd5CM9Ng928tF5fiaibQ02wvVHNSckZEYzLU8fPEyg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;454&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;好，以上我们的准备工作就已经做完了，让我们来一起开发智能合约吧，Just do it&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;二、创建一个Truffle项目&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于我们初学者，我们使用使用Truffle Boxes，它们是示例应用程序和项目模板。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.创建一个目录&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;D:\workspace\solidity\test&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.下载metacoin&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;切换到刚刚创建的目录，下载metacoin，执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;$ truffle unbox metacoin&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果你的机器和我一样是windows的话，你可以会遇到这个问题，&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;$ truffle unbox metacoin&lt;br/&gt;&lt;br/&gt;Starting unbox...&lt;br/&gt;=================&lt;br/&gt;&lt;br/&gt;- Preparing to download box&lt;br/&gt;√ Preparing to download box&lt;br/&gt;- Downloading&lt;br/&gt;× Downloading&lt;br/&gt;Unbox failed!&lt;br/&gt;RequestError: Error: getaddrinfo ENOENT raw.githubusercontent.com raw.githubusercontent.com:443&lt;br/&gt;    at new RequestError (D:\Program Files\nodejs\node_global\node_modules\truffle\build\webpack:\node_modules\request-promise-core\lib\errors.js:14:1)&lt;br/&gt;    at Request.plumbing.callback (D:\Program Files\nodejs\node_global\node_modules\truffle\build\webpack:\node_modules\request-promise-core\lib\plumbing.js:87:1)&lt;br/&gt;    at Request.RP&lt;span&gt;$callback&lt;/span&gt; [as _callback] (D:\Program Files\nodejs\node_global\node_modules\truffle\build\webpack:\node_modules\request-promise-core\lib\plumbing.js:46:1)&lt;br/&gt;    at self.callback (D:\Program Files\nodejs\node_global\node_modules\truffle\build\webpack:\node_modules\request\request.js:185:1)&lt;br/&gt;    at Request.emit (events.js:189:13)&lt;br/&gt;    at Request.onRequestError (D:\Program Files\nodejs\node_global\node_modules\truffle\build\webpack:\node_modules\request\request.js:881:1)&lt;br/&gt;    at ClientRequest.emit (events.js:189:13)&lt;br/&gt;    at TLSSocket.socketErrorListener (_http_client.js:392:9)&lt;br/&gt;    at TLSSocket.emit (events.js:189:13)&lt;br/&gt;    at emitErrorNT (internal/streams/destroy.js:82:8)&lt;br/&gt;    at emitErrorAndCloseNT (internal/streams/destroy.js:50:3)&lt;br/&gt;    at process._tickCallback (internal/process/next_tick.js:63:19)&lt;br/&gt;Truffle v5.1.52 (core: 5.1.52)&lt;br/&gt;Node v10.15.3&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;解决方法：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;通过https://www.ipaddress.com 查询 raw.githubusercontent.com 的地址。&lt;br/&gt;配置host文件  C:\Windows\System32\drivers\etc\host   增加地址&lt;br/&gt;199.232.68.133  raw.githubusercontent.com&lt;br/&gt;&lt;br/&gt;Linux是进入/etc/hosts 中添加&lt;br/&gt;199.232.68.133  raw.githubusercontent.com&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然后重新执行下载 metacoin的命令。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.使用VSCode打开&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用VSCode打开D:\workspace\solidity\test目录&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.064516129032258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78S3ZIAHib2VDxRtxvCb9s2kbyW9pV68674hqvDyiaLOZsg6LvCyPB659A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;434&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以看到有三个目录，contracts、migrations、test，&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;contracts/&lt;/code&gt; 智能合约的文件夹，所有的智能合约文件都放置在这里，里面包含一个重要的合约Migrations.sol（稍后再讲）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;migrations/&lt;/code&gt; 用来处理部署（迁移）智能合约 ，迁移是一个额外特别的合约用来保存合约的变化。（注意：每个migration文件前面有序号，这个序号表示migration文件的执行顺序）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;test/&lt;/code&gt; 智能合约测试用例文件夹&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;truffle.js/&lt;/code&gt; 配置文件，配置不同网络&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其他代码可以暂时不用管。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，我们看到.sol 文件中的solidity版本不是我们安装的版本，所以，改成我们刚刚安装的版本，改成^0.5.16，&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.18059299191374664&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA784pfogNxIWCOhgwgQ2PFWYoDpaqelqeibe0BOoBcdHnlPfwsANELNvlQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;371&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在truffle.js中，我们需要去掉networks的注释，在这里可以定义开发环境、测试环境、生产环境的host、port、network_id&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8198324022346368&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78d3Osd5BjjeVhUjbQn7cGtBXUia71mbBo0jGtw6Ea5e2YEicLIoy0U0eQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;716&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;代码的理解都比较简单，我几乎都加上了注释，这里就不讲解了，代码下载地址：https://github.com/joeBeckham/test.git&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7929901423877328&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78vtgVArEOWaIOaB2EVibmdsPdnHwEfNaFz24W4oxYaMmRoQ6hsc73B8g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;913&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;三、编译部署&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;打开VSCode的命令行：&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.编译&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;$ truffle compile&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我*，又报错：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;PS D:\workspace\solidity\metacoin&amp;gt; truffle compile&lt;br/&gt;&lt;br/&gt;truffle : 无法加载文件 D:\Program Files\nodejs\node_global\truffle.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 https:/go.microsoft.com/fwlink/?LinkI&lt;br/&gt;D=135170 中的 about_Execution_Policies。&lt;br/&gt;所在位置 行:1 字符: 1&lt;br/&gt;+ truffle compile&lt;br/&gt;+ ~~~~~~~&lt;br/&gt;    + CategoryInfo          : SecurityError: (:) []，PSSecurityException&lt;br/&gt;    + FullyQualifiedErrorId : UnauthorizedAccess&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;原因：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是在计算机上启动 Windows PowerShell 时，执行策略是 Restricted（默认设置）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Restricted 执行策略不允许任何脚本运行。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;AllSigned 和 RemoteSigned 执行策略可防止 Windows PowerShell 运行没有数字签名的脚本。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;解决方法：&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查看计算机上的现用执行策略，get-executionpolicy；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;管理员身份打开PowerShell 输入 &lt;strong&gt;set-executionpolicy remotesigned&lt;/strong&gt;，设置执行策略&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;PS D:\workspace\solidity\metacoin&amp;gt; get-executionpolicy&lt;br/&gt;Restricted&lt;br/&gt;PS D:\workspace\solidity\metacoin&amp;gt; &lt;span&gt;set&lt;/span&gt;-executionpolicy remotesigned&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;重新执行编译命令：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3753993610223642&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78icy8qxOP9rD3hqOFjSnvlPfjhHsY5OZib36n92zStEe2QPee00jYsxrg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;626&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;编译完成后，我们会看到在项目中出现了build文件夹，里面会有 abi、bytecode、network。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.45528455284552843&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA788u4ovSzR2I1ia1KDzJqQw8YAe7LgyrLpJDxpdyUJBBYbTFTEBbdzdrg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;369&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.部署&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;truffle migration&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;特别说明下，在migrations文件夹下已经有一个1_initial_migration.js部署脚本，用来部署Migrations.sol合约。Migrations.sol 用来确保不会部署相同的合约。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;而我们最主要的部署脚本是在2_deploy_contracts.js中，这个脚本是为了部署MetaCoin合约，会按顺序执行完上一步的脚本后执行。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个简单的部署合约脚本可以用三行实现：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;// 导入合约&lt;br/&gt;const TestContract = artifacts.require(&lt;span&gt;&quot;TestContract&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;module.exports = &lt;span&gt;function&lt;/span&gt;(deployer) {&lt;br/&gt;  // 部署合约&lt;br/&gt;  deployer.deploy(TestContract);&lt;br/&gt;};&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2_deploy_contracts.js中的内容只是又导入了ConvertLib，并且把ConvertLib部署，ConvertLib部署后把ConvertLib关联到MetaCoin合约，然后在部署MetaCoin合约。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4228855721393035&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78olwuxv6UqbMpnCSjn2v4g0OXZq77wzpZCGvUAIyx9Vtc5VAicGLymcw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;603&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，我们执行部署命令：&lt;code&gt;truffle migration&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行部署结果比较长，我只贴出一部分：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6183673469387755&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78lP4zC2qZK9tic8BXH80lml5Sa8fMEXyvbpq2QouslTOJYBRog1ka1YQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;980&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们可以看到有交易的hash、打包的区块、产生的区块数量、合约地址、账号地址、账户余额、gas费、总花费ETH。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们接下来在看下Ganache中，账户&lt;strong&gt;0x16664D3d037d041183ff998Cb218602457Aff012&lt;/strong&gt;的余额保留两位小数后确实是99.99，&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.28608650338718083&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78mCw6wRcjAzkcHSDCm7rSRcwAqpmvsNyDmNX7icReV2OMvWkibAbqZUDA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1919&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;区块确实产生了4个：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3324648254299114&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78iansnnW511tRdOiaLGBxvvWJicP9GFmIUGYlofVSIA8rFXENv7eOnTlWQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1919&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;还产生了5笔交易：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5161458333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA78VRACYW9JsPBCAPDa5gdjAYrPIHgrwrQUxwg7QNziaCPaC4TFkuWyCcg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;都展示的比较清楚。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.测试&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;truffle &lt;span&gt;test&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;合约部署完了，我们怎么测试正确性呢，总不能直接上吧，币圈不是都很多项目都是上线即崩盘嘛。项目目录中有一个test文件夹，文件夹中有两个文件，一个是metacoin.js，另一个是TestMetaCoin.sol。metacoin.js 是通过javascript测试，TestMetaCoin.sol 通过solidity来测试。这里我们使用 第二种方式 TestMetaCoin.sol，所以删除掉metacoin.js。TestMetaCoin.sol 中的代码也比较简单：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6472275334608031&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA788qjvDb9I89wBOiafpPde8R6yJfCBicu8Y83qyib6TC9lBreEctmJXD5Yw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1046&quot; title=&quot;&quot;/&gt;所有测试合约必须以 &lt;code&gt;Test&lt;/code&gt; 开头，使用大写的 &lt;code&gt;T&lt;/code&gt; 。这样的命名方式就将测试合约和普通合约区分开来了，
让测试运行器知道哪个合约代表测试套件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;跟测试合约类似，所有的测试方法，都必须以小写单词 &lt;code&gt;test&lt;/code&gt; 开头。每个测试方法都会被当作一个独立的交易，
根据在测试文件中定义的顺序执行。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，我们来执行测试命令：&lt;code&gt;truffle test&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5242236024844721&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nhibaFWXSPujhMRpoqjtLA7802ib1Oz4TPxvbyvtwVbp9bYgGwnvqfe6wicDvW09DJaB6zPg6N2bGiacg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;805&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们看到两个test都通过了，说明是部署合约的账户里面的余额是10000。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;到这里，我们的整个流程就已经跑通了，开发环境、编码工具、本地链、代码编译、部署、测试都ok了。后面我们更加深入的介绍智能合约。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，如果你和我一样不喜欢黑色背景的话，那么我们切换背景色，ctrl+k, ctrl+t，选择我们喜欢的颜色即可哦。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages __bg_gif&quot; data-ratio=&quot;0.204&quot; data-type=&quot;gif&quot; data-w=&quot;500&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/du7xBgeM5nhubeOr7uLdPGUiajmqk3pIq2KjYw9CMRETicNuiacRFm66H3E1ZC4soIGbMYbfmJwOMOYSH1jndSmQQ/640?wx_fmt=gif&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;600&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/du7xBgeM5nia4xfEIOuMorhv5ed8otG15MQPlqEyUNd5ZmNQ7Tq1iclCI2syx6VOaPyibuulKGv7amIUaiaTjQ7ANA/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>73ec382a0375008b23ff6d52ce80c56c</guid>
<title>数据结构能干吗，我花了一夜给女朋友写个走迷宫游戏</title>
<link>https://toutiao.io/k/qi0u26p</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.27699530516431925&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhmYrcCWjqvXuxibFa9a8We9HyLicTd5nRSF1YyfgIODchLZggT21o0IXFibjnOMCzEx25JnnQrTf1oQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;639&quot; data-width=&quot;100%&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.66640625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfpMJGkjpLYiaicZ3HaXwCgvS2sKaj93GNWHPqBiabkcYlmt9sTXX6S3gzA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot; data-backw=&quot;574&quot; data-backh=&quot;383&quot; data-before-oversubscription-url=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfpMJGkjpLYiaicZ3HaXwCgvS2sKaj93GNWHPqBiabkcYlmt9sTXX6S3gzA/640?wx_fmt=jpeg&quot;/&gt;&lt;/p&gt;&lt;p&gt;先看效果图(在线电脑尝试地址&lt;span&gt;http://biggsai.com/maze.html&lt;/span&gt;)：&lt;img class=&quot;&quot; data-ratio=&quot;0.7651057401812689&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfkMajwgZcGV8BIfExzJHrOEDFl0hbA7dLpodjknAFR4Tbru7ZkVdeOw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1324&quot; data-backw=&quot;338&quot; data-backh=&quot;258&quot; data-before-oversubscription-url=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfkMajwgZcGV8BIfExzJHrOEDFl0hbA7dLpodjknAFR4Tbru7ZkVdeOw/640?wx_fmt=gif&quot;/&gt;&lt;/p&gt;&lt;h1&gt;起因&lt;/h1&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;1.2121212121212122&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfEgjsDlTVlH10Y75WibDf3W3OFQh3Oh2EFN597ibwrEnBKqJibwen1j7Rg/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;198&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;又到深夜了，我按照以往在 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;公众号&lt;/span&gt;&lt;/code&gt;&lt;span&gt;写着数据结构！这占用了我大量的时间！我的超越妹妹严重缺乏陪伴而 怨气满满！&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfZ23XwIH7WrZwibqickul1vecXIfpuhUcsicazxDAAV0jUHq4iaac3qtoGg/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;240&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;超越妹妹时常埋怨，认为数据结构这么抽象难懂的东西没啥作用，常会问道：天天写这玩意，有啥作用。而我答道：能干事情多了，&lt;strong&gt;比如写个小游戏啥的！&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfHVXYsZ3oWib97zPKQJXjcJDvrMOfzNWibge1OV83nzVAgxQvAp4ia1iaQw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;240&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;当我码完字准备睡觉时：&lt;strong&gt;写不好别睡觉！&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong/&gt;&lt;img class=&quot;&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfPCaWYjpogkriaWsibtzic8xowfar24HibknM6qlRhib9GlBPYXcqnRsvcUA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;240&quot;/&gt;&lt;/p&gt;&lt;h1&gt;分析&lt;/h1&gt;&lt;p&gt;&lt;span&gt;如果用数据结构与算法造出东西来呢？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;有了( &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;灵光一闪&lt;/span&gt;&lt;/code&gt;&lt;span&gt;)，写个猜数字游戏，问他加减乘除等于几。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;经过一番折腾，终于在半夜12点确定写&lt;strong&gt;迷宫小游戏&lt;/strong&gt;了。大概弄清楚其中的几个步骤。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;大概是&lt;/strong&gt;：&lt;/p&gt;&lt;h1&gt;画线(棋盘)&lt;/h1&gt;&lt;p&gt;&lt;span&gt;对于html+js(canvas)画的东西，之前学过javaswing应该有点印象印象。在html中有个 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;canvas&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 的画布，可以在上面画一些东西和声明一些监听(键盘监听)。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;对于迷宫来说，那些&lt;strong&gt;线条是没有属性&lt;/strong&gt;的，只有 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;位置x,y&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，你操作这个画布时候，可能和我们习惯的面相对象思维不一样。所以，在你设计的线或者点的时候，记得那个点、线在什么位置，在后续划线还是擦线还是移动的时候根据这个位置进行操作。&lt;/span&gt;&lt;/p&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot;&gt;&lt;ol class=&quot;linenums list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dec&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;MyHtml.html&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;canvas&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;mycanvas&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;600px&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;600px&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&amp;lt;/canvas&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; aa=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; chess = document.getElementById(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&quot;mycanvas&quot;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; context = chess.getContext(&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#x27;2d&#x27;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//  var context2 = chess.getContext(&#x27;2d&#x27;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      context.strokeStyle = &#x27;yellow&#x27;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; tree = [];&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//存放是否联通&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; isling=[];&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//判断是否相连&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;i&amp;lt;aa;i++){&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        tree[i]=[];&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; j=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;j&amp;lt;aa;j++){&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            tree[i][j]=-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//初始值为0&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }  &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;i&amp;lt;aa*aa;i++){&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        isling[i]=[];&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; j=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;j&amp;lt;aa*aa;j++){&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            isling[i][j]=-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//初始值为0&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; drawChessBoard(){&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//绘画&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; i=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;i&amp;lt;aa+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;i++){&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.strokeStyle=&lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#x27;gray&#x27;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//可选区域&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.moveTo(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+i*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//垂直方向画15根线，相距30px;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.lineTo(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+i*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*aa);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.stroke();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.moveTo(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+i*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//水平方向画15根线，相距30px;棋盘为14*14；&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.lineTo(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;*aa,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+i*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.stroke();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    drawChessBoard();&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//绘制棋盘&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      var mymap=new Array(36);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      for(var i=0;i&amp;lt;36;i++)&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//     {mymap[i]=-1;}&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/pre&gt;&lt;p&gt;实现效果&lt;img class=&quot;&quot; data-ratio=&quot;0.5621222296843519&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfrlkApfVrtp4b7J8Wib4anVLPZJ2Jho9QRHnOkVVUpMPN3CnPPQ7X3Lw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1489&quot;/&gt;&lt;/p&gt;&lt;h1&gt;画迷宫&lt;/h1&gt;&lt;p&gt;随机迷宫怎么生成？怎么搞？一脸懵逼。因为我们想要迷宫，那么就需要这个迷宫出口和入口有连通路径，你可能压根不知道迷宫改怎么生成，用的什么算法。小声BB：&lt;strong&gt;用并查集(不相交集合)&lt;/strong&gt;。&lt;/p&gt;&lt;p&gt;&lt;span&gt;迷宫和不相交集合有什么联系呢？( &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;规则&lt;/span&gt;&lt;/code&gt;&lt;span&gt;)
之前笔者在前面数据结构与算法系列中曾经介绍过&lt;strong&gt;并查集(不相交集合)&lt;/strong&gt;，它的主要功能是森林的合并，不联通的通过并查集能够快速将两个森林合并，并且能够快速查询两个节点是否在同一个森林中！&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;而 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;我们的随机迷宫&lt;/span&gt;&lt;/code&gt;&lt;span&gt;：在每个方格都不联通的情况下，是一个&lt;strong&gt;棋盘方格&lt;/strong&gt;，这也是它的初始状态。而这个节点可以跟邻居可能相连，也可能不相连。我们可以通过 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;并查集&lt;/span&gt;&lt;/code&gt;&lt;span&gt;实现。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;具体思路为：(主要理解并查集)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;1&lt;/strong&gt;：定义好不想交集合的基本类和方法（ &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;search,union&lt;/span&gt;&lt;/code&gt;&lt;span&gt;等）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;2&lt;/strong&gt;：数组初始化，每一个数组元素都是一个集合，值为-1&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;3&lt;/strong&gt;：随机查找一个格子（一维数据要转换成二维，有点麻烦），在随机找一面墙（也就是找这个格子的上下左右），还要判断找的格子出没出界。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;具体在格子中找个随机数m——&amp;gt;随机数m在二维中的位置 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;[m/长,m%长]&lt;/span&gt;&lt;/code&gt;&lt;span&gt;——&amp;gt;这个二维的上下左右随机找一个位置p &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;[m/长+1,m%长]&lt;/span&gt;&lt;/code&gt;&lt;span&gt;或 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;[m/长-1,m%长]&lt;/span&gt;&lt;/code&gt;&lt;span&gt;或 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;[m/长,m%长+1]&lt;/span&gt;&lt;/code&gt;&lt;span&gt;或 &lt;/span&gt;&lt;code class=&quot;prettyprint code-in-text prettyprinted&quot;&gt;&lt;span&gt;[m/长,m%长-1]&lt;/span&gt;&lt;/code&gt;&lt;span&gt;——&amp;gt;判断是否越界&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;4&lt;/strong&gt;：判断两个格子(一维数组编号)是否在一个集合(&lt;strong&gt;并查集查找&lt;/strong&gt;)。如果在，则重新找，如果不在，那么把墙挖去&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;5&lt;/strong&gt;：把墙挖去有点繁琐，需要考虑奇偶判断它那种墙(上下还是左右，还要考虑位置)，然后擦掉。（根据数组转换成真实距离）。具体为找一个节点，根据位置关系找到一维数组的号位用并查集判断是否在一个集合中。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;6&lt;/strong&gt;：最终得到一个完整的迷宫。直到第一个(1,1)和(n,n)联通停止。虽然采用随机数找墙，但是效果并不是特别差。其中要搞清一维二维数组的关系。一维是真实数据，并查集操作。二维是位置。要搞懂转化！&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;注意&lt;/strong&gt;：避免混淆，搞清数组的地址和逻辑矩阵位置。数组从0开始的，逻辑上你自己判断。别搞混淆！&lt;/span&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.4880546075085324&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfGqtemOtfjLzPKpNkYQSITAwnZdO7teeGia1ziaay4fFM3mdtWcyUZdHQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1172&quot;/&gt;&lt;strong&gt;主要逻辑为：&lt;/strong&gt;&lt;/p&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot;&gt;&lt;ol class=&quot;linenums list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;kwd&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(search(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)!=search(aa*aa-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//主要思路&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; num = parseInt(&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.random() * aa*aa );&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//产生一个小于196的随机数&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; neihbour=getnei(num);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(search(num)==search(neihbour)){&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;}&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//不在一个上&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;           isling[num][neihbour]=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;isling[neihbour][num]=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            drawline(num,neihbour);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//划线&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;union&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(num,neihbour);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;js language-js&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/pre&gt;&lt;p&gt;那么在前面的代码为&lt;/p&gt;&lt;pre class=&quot;prettyprint linenums prettyprinted&quot;&gt;&lt;ol class=&quot;linenums list-paddingleft-3&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;dec&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;MyHtml.html&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;canvas&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;mycanvas&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;600px&quot;&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;600px&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&amp;lt;/canvas&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;script&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;atn&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;atv&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;com&quot;&gt;//自行添加上面代码&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      var mymap=new Array(36);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      for(var i=0;i&amp;lt;36;i++)&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//     {mymap[i]=-1;}&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; getnei(a)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//获得邻居号  random&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; x=parseInt(a/aa);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//要精确成整数&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; y=a%aa;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mynei=&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//储存邻居&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(x-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){mynei.push((x-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)*aa+y);}&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//上节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(x+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){mynei.push((x+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)*aa+y);}&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//下节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(y+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){mynei.push(x*aa+y+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);}&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//有节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(y-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;){mynei.push(x*aa+y-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);}&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//下节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; ran=parseInt(&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.random() * mynei.length );&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; mynei[ran];&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; search(a)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//找到根节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(tree[parseInt(a/aa)][a%aa]&amp;gt;&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//说明是子节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; search(tree[parseInt(a/aa)][a%aa]);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//不能压缩路径路径压缩&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; value(a)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//找到树的大小&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(tree[parseInt(a/aa)][a%aa]&amp;gt;&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//说明是子节点&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; tree[parseInt(a/aa)][a%aa]=value(tree[parseInt(a/aa)][a%aa]);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//不能路径压缩&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; -tree[parseInt(a/aa)][a%aa];&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;union&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(a,b)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//合并&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; a1=search(a);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//a根&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; b1=search(b);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//b根&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(a1==b1){}&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(tree[parseInt(a1/aa)][a1%aa]&amp;lt;tree[parseInt(b1/aa)][b1%aa])&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//这个是负数()，为了简单减少计算，不在调用value函数&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;                tree[parseInt(a1/aa)][a1%aa]+=tree[parseInt(b1/aa)][b1%aa];&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//个数相加  注意是负数相加&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;                tree[parseInt(b1/aa)][b1%aa]=a1;       &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//b树成为a树的子树，b的根b1直接指向a；&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;                tree[parseInt(b1/aa)][b1%aa]+=tree[parseInt(a1/aa)][a1%aa];&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;                tree[parseInt(a1/aa)][a1%aa]=b1;&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//a所在树成为b所在树的子树&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; drawline(a,b)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//划线，要判断是上下还是左右&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; x1=parseInt(a/aa);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; y1=a%aa;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; x2=parseInt(b/aa);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; y2=b%aa;        &lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; x3=(x1+x2)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; y3=(y1+y2)/&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(x1-x2==&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;||x1-x2==-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//左右方向的点  需要上下划线&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//alert(x1);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//  context.beginPath();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.strokeStyle = &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#x27;white&#x27;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//    context.moveTo(30+x3*30,y3*30+15);//&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//   context.lineTo(30+x3*30,y3*30+45);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.clearRect(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+x3*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;, y3*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//    context.stroke();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//   context.beginPath();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.strokeStyle = &lt;/span&gt;&lt;span class=&quot;str&quot;&gt;&#x27;white&#x27;&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//  context.moveTo(x3*30+15,30+y3*30);//&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//    context.lineTo(45+x3*30,30+y3*30);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            context.clearRect(x3*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;+y3*&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//      context.stroke();&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(search(&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;)!=search(aa*aa-&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//主要思路&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; num = parseInt(&lt;/span&gt;&lt;span class=&quot;typ&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;.random() * aa*aa );&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//产生一个小于196的随机数&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;pln&quot;&gt; neihbour=getnei(num);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(search(num)==search(neihbour)){&lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;}&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//不在一个上&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;           isling[num][neihbour]=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;isling[neihbour][num]=&lt;/span&gt;&lt;span class=&quot;lit&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            drawline(num,neihbour);&lt;/span&gt;&lt;span class=&quot;com&quot;&gt;//划线&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;kwd&quot;&gt;union&lt;/span&gt;&lt;span class=&quot;pun&quot;&gt;(num,neihbour);&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;pln&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;code class=&quot;html language-html&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;实现效果：&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;1.1073825503355705&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfqTveNib8S5XAyFwAlpZA75BmTY4nGlpgnlQjC15hz5ic4E2zednwibxUg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;596&quot;/&gt;&lt;/p&gt;&lt;h1&gt;方块移动&lt;/h1&gt;&lt;p&gt;&lt;span&gt;这部分我采用的方法不是&lt;strong&gt;动态真的移动&lt;/strong&gt;，而是一格一格的跳跃。也就是当走到下一个格子将当前格子的方块擦掉，在移动的那个格子中再画一个方块。选择方块是因为方块更方便擦除，可以根据像素大小精准擦除。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;另外，再移动中要注意不能穿墙、越界。那么怎么判断呢？很好办，我们再前面会判断两个格子是否联通，如果不连通我们将把这个墙拆开。&lt;strong&gt;再拆的时候把这个墙&lt;/strong&gt;的时候记录这两点拆墙可走即可(数组)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;另外，事件的监听上下左右查一查就可以得到，添加按钮对一些事件监听，这些不是最主要的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为了丰富游戏可玩性，将方法封装，可以设置关卡(只需改变迷宫大小)。这样就可以实现通关了。另外，如果写成动态存库那就更好了。&lt;/span&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.8165517241379311&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThyZMEiayn9TiajcEXiczPG2OXfPzlVuv9nacZyjkJUGVrRNpyr9BShl0IiadoFK0z1DtPqO3UboB9g4BQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;725&quot;/&gt;&lt;/p&gt;&lt;h1&gt;结语&lt;/h1&gt;&lt;p&gt;&lt;span&gt;在线尝试地址，代码直接查看网页源代码即可！&lt;span&gt;http://biggsai.com/maze.html&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;笔者前端能力和算法能力有限，写的可能不是特别好，还请见谅！当然，笔者欢迎和一起热爱学习的人共同进步、学习！欢迎关注笔者公众号：&lt;strong&gt;bigsai&lt;/strong&gt;，如果感觉不错，欢迎关注、再看！蟹蟹！&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;推荐阅读：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483971&amp;amp;idx=1&amp;amp;sn=08ae0369734aa67e19287b1679be5ed1&amp;amp;chksm=ce1a25f2f96dace4436194b3ff4333a959f7e400cf2ca8c9c01b0bfc734c4fa3e2309ce9fa78&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot;&gt;最短路径—弄懂Dijkstra(迪杰斯特拉)算法&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483964&amp;amp;idx=1&amp;amp;sn=4c434df531dbdd2ef72d338e6a10844b&amp;amp;chksm=ce1a258df96dac9bd4f9f5baa1b24b0ea3625594462f4e6f0c07be7b46a37af38a887152461b&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一种非大小排序(先后关系排序)—拓扑排序&lt;/a&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483932&amp;amp;idx=1&amp;amp;sn=cee5c41237306459430a706fd54fb0a3&amp;amp;chksm=ce1a25adf96dacbb55edd61376a0fc573da1a7d225f9431e1ac2c800492e996527da1baecfa2&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;数据结构与算法—深度、宽度优先(dfs,bfs)搜索&lt;/a&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483921&amp;amp;idx=1&amp;amp;sn=6a2d802025d816446f9167622d9e706c&amp;amp;chksm=ce1a25a0f96dacb66f9169639bf608565564ac80196c02267e43117202b5fb6bdfb12267f51c&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;哈夫曼树(最优二叉树)详解与构造&lt;/a&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483911&amp;amp;idx=1&amp;amp;sn=3e7e0263a0d9e03c3e243220652aad51&amp;amp;chksm=ce1a25b6f96daca0af957b1a359495f1b2cf68b8550533d28f27830f3d531b5dabc12413da42&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;写文没高质量配图？教你python爬虫绕过限制一键搜索下载图虫创意图片！&lt;/a&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483904&amp;amp;idx=1&amp;amp;sn=3851acc79d2500880a7f048724630a8a&amp;amp;chksm=ce1a25b1f96daca73975c05e04fd6721ad6334685351495695391a286d3dc1524f90bf5ca71a&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;一文搞懂简单数据结构—并查集(不相交集合)&lt;/a&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg2MTE1NjA2Mg==&amp;amp;mid=2247483851&amp;amp;idx=1&amp;amp;sn=261406366829c1cbd286f2e5715171bf&amp;amp;chksm=ce1a267af96daf6c2c72514ff2f6088ac447ff57f69d6fc59d206a562b14f7c531f0606ac894&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; data-itemshowtype=&quot;0&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;从阶乘、斐波那契、汉诺塔剖析彻底搞懂递归算法&lt;/a&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.28515625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Lia5wemIHThz75LRZbQPS9TU9GxVgjW6QlhEjKg1hYMMic5NyM0f9jToqib5y0m4gRdVThGLl8y3tvVLm6O6wtOeg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p class=&quot;md_block&quot;&gt;&lt;span class=&quot;md_line&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-id=&quot;432&quot; class=&quot;fzneditor xmt-style-block&quot; data-tools=&quot;非找你编辑器&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section data-id=&quot;489&quot; class=&quot;fzneditor xmt-style-block&quot; data-tools=&quot;非找你编辑器&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;30px&quot;&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.9242424242424242&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaZicicVdVyXPlCQ4ay6sjDoSzwnz4Rb3rtJ7NLMVlz59SxibtUJw5ZS75rteLgWqu4B4sfmYt09XQcw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;66&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;转载是一种动力 分享是一种美德&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;&quot; data-ratio=&quot;0.0743801652892562&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWgyb2brRg7aGfp6Zbgy5ozX1Bb3aZEvUImaiaDJxNSSDqLlMRgibQUeDaXqJTKsm8icMPbciaCTlZniaTw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;242&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;section data-width=&quot;6%&quot;&gt;&lt;section&gt;&lt;img class=&quot;&quot; data-ratio=&quot;2.611464968152866&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgPG4dWLqDTgcEkS4ZjIvsYniaGa2AyV2KVItC5ZFMD9VkfoTrhtxxNprr39tN1Bj47RIGHAkPoYOQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;157&quot; data-width=&quot;auto&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>fcc8a8c6b22ecca0d53e5bbafc6eb6ed</guid>
<title>ElasticSearch 使用规范 beta 版</title>
<link>https://toutiao.io/k/6qqfb9x</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最近一年多开始“搞”ES(ElasticSearch)，遇到了很多“坑”，希望和大家也一起分享下，由于接触时间不长，如有问题麻烦联系我及时指出。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;本公众号后续将改名为“Redis&amp;amp;ElasticSearch开发运维实战”&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ElasticSearch除了在日志场景（监控、数据分析、debug）等场景大量使用以外，最近一年多在很多核心上的线上业务（譬如电商业务）大量使用，目前接近了5000个节点，目前在db-ranking（2020-11-24日），ElasticSearch在search-engine中常年第一：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4524033930254477&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0vmFVBPwcsfqhnUfhahBqPSYHibQexZCZFTBF5IurlssjduX16Aics9ibg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2122&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于MySQL、Redis这类存储缓存许多开发同学多有很强的最佳实践，但对于ElasticSearch的使用经验相对模式。我个人经验是ElasticSearch非常便于开发（譬如支持dynamic mapping）但它相对脆弱：一方面是开发同学对于其重视程度不够（譬如没有自己制定mapping）、另一方面它本身的一些设计（例如聚合计算都在JVM完成）导致其相对脆弱。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为此我们提供一份关于ElasticSearch的开发规范帮助ElasticSearch使用者减少一些可能碰到的坑&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;一、容量规划&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.  分片(shard)容量&lt;span/&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;非日志型(搜索型、线上业务型)的shard容量在10~30GB（建议在10G）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;日志型的shard容量在30~100GB（建议30G）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;单个shard的文档个数不能超过21亿左右(Integer.MAX_VALUE - 128)&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注：一个shard就是一个lucene分片，ES底层基于lucene实现。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2. 索引(index)数量&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;反例：一个10T的索引，例如按date查询、name查询&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;正例：index_name拆成多个index_name_${date}&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;正例：index_name按hash拆分index_name_{1,2,3,...100..}&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;提示：索引和shard数并不是越多越好，对于批量读写都会有性能下降，所以要综合考虑性能和容量规划，同时配合压力测试，不存在真正的最优解。&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3. 节点、分片、索引&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个节点管理的shard数不要超过200个&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4. 示意图&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(1) 集群&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.531055900621118&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0M4WGAffTGVVZJLPpnt8EVRtnMWZEqArTYc8mLfpoqdf13IzicTOB6Ww/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1288&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(2) 节点：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5271317829457365&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0sOEvnxTOfJMTmqGvywxQLE17uqetyyt1P8GOGD7X6mAhN4Ch5AdhxQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1290&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(3) 索引：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5235109717868338&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0IGUM2TibhXoViaAPghuwG61Z9lzHPdM6IH42ibZg9yfCCTNRLQuh5q0PQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1276&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(4) 分片(shard)&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.9064171122994652&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0BjyIqQb6yUw4XxyR6X1q96ic329mtCn5vDSRTQicJoT64Qece02AXMxw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;748&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;二、 索引mapping设计&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大原则：不用默认配置和动态mapping、数据用途（类型、分词、存储、排序）弄清，下面是一个标准mapping：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.447488584474886&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0oiaY8nvtz6aARhafXmuONJSMEgtwkD8ibefcbyCt2SgpIFQhic4XddwtQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;876&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.  shard个数（number_of_shards）：&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;参考一&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.  refresh频率（refresh_interval）：&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ES的定位是准实时搜索引擎，该值默认是1s，表示写入后1秒后可被搜索到，所以这里的值取决于业务对实时性的要求，注意这里并不是越小越好，刷新频率高也意味着对ES的开销也大，通常业务类型在1-5s，日志型在30s-120s，如果集中导入数据可将其设置为-1，ES会自动完成数据刷新（注意完成后更改回来，否则后续会出现搜索不到数据）&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.66&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0sdtoVFLQCma5Bial7NBqq5pAGNuZeY5ylDsIo0x6GdXcpLwoyriaSo1Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;750&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br/&gt;3.  使用别名（aliases）：不要过度依赖别名功能&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;正例：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;索引名：index_name_v1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;别名：index_name&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;未来重建index_name_v2索引，对于业务来说只需要换别名。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.  type个数&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1个就够了，从ES6开始只支持一个type，这个type比较鸡肋，后面的版本可能会去掉。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果一定用：针对已经使用多个type的场景，一定要保证不同type下字段尽量保持一致，否则会加大数据稀疏性，存储与查询性能受影响&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5. 慢日志（slowlog）：&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一定要配置，默认不记录慢查询，kcc提供了grafana、kibana查询功能。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6. 副本（number_of_replicas）&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1个就够用，副本多写入压力不可忽视。极端情况下：譬如批量导入数据，可以将其调整为0.&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7. 字段设计&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(1) text和keyword的用途必须分清：分词和关键词（确定字段是否需要分词）&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(2) 确定字段是否需要独立存储&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(3) 字段类型不支持修改，必须谨慎。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(4) 对不需要进行聚合/排序的字段禁用doc_values&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;text 类型作用：分词，用于搜索。&lt;br/&gt; 适用于：email 内容、某产品的描述等需要分词全文检索的字段；&lt;br/&gt; 不适用：排序或聚合（Significant Terms 聚合例外）&lt;br/&gt;keyword 类型：无需分词、整段完整精确匹配。&lt;br/&gt; 适用于：email 地址、住址、状态码、分类 tags。&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;(5) 不要在text做模糊搜索：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5082159624413145&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0icY7foMEicv8jcQ4RWRLTWkykYsL9AyEaoG3vJBzDzWp5hfyFQEtEC2A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1704&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;8. 设置合理的routing key(默认是id)&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;id不均衡：集群容量和访问不均衡，对于分布式存储是致命的。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;9. 关闭_all&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ES6.0已经去掉，对容量（索引过大）和性能（性能下降）都有影响。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;10. 避免大宽表：&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ES默认最大1000，但建议不要超过100.&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;11. text类型的字段不要使用聚合查询。&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;text类型fileddata会加大对内存的占用，如果有需求使用，建议使用keyword&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;12.聚合查询避免使用过多嵌套，&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;聚合查询的中间结果和最终结果都会在内存中进行，嵌套过多，会导致内存耗尽&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如以下聚合就嵌套了3层，country、city和salary的结果都会保存在内存中，如果唯一值较多，就会导致内存耗尽&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;    &lt;span&gt;&quot;aggs&quot;&lt;/span&gt;:{&lt;br/&gt;        &lt;span&gt;&quot;country&quot;&lt;/span&gt;:{&lt;br/&gt;            &lt;span&gt;&quot;terms&quot;&lt;/span&gt;:{&lt;br/&gt;                &lt;span&gt;&quot;filed&quot;&lt;/span&gt;:&lt;span&gt;&quot;country&quot;&lt;/span&gt;,&lt;br/&gt;                &lt;span&gt;&quot;size&quot;&lt;/span&gt;:10&lt;br/&gt;            },&lt;br/&gt;            &lt;span&gt;&quot;aggs&quot;&lt;/span&gt;:{&lt;br/&gt;                &lt;span&gt;&quot;city&quot;&lt;/span&gt;:{&lt;br/&gt;                    &lt;span&gt;&quot;terms&quot;&lt;/span&gt;:{&lt;br/&gt;                        &lt;span&gt;&quot;filed&quot;&lt;/span&gt;:&lt;span&gt;&quot;city&quot;&lt;/span&gt;,&lt;br/&gt;                        &lt;span&gt;&quot;size&quot;&lt;/span&gt;:20&lt;br/&gt;                    },&lt;br/&gt;                    &lt;span&gt;&quot;aggs&quot;&lt;/span&gt;:{&lt;br/&gt;                        &lt;span&gt;&quot;salary&quot;&lt;/span&gt;:{&lt;br/&gt;                            &lt;span&gt;&quot;terms&quot;&lt;/span&gt;:{&lt;br/&gt;                                &lt;span&gt;&quot;filed&quot;&lt;/span&gt;:&lt;span&gt;&quot;salary&quot;&lt;/span&gt;,&lt;br/&gt;                                &lt;span&gt;&quot;size&quot;&lt;/span&gt;:20&lt;br/&gt;                            }&lt;br/&gt;                        }&lt;br/&gt;                    }&lt;br/&gt;                }&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;三、违规操作&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1. 原则：不要忽略设计，快就是慢，坏的索引设计后患无穷.&lt;span/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.  拒绝大聚合 ：ES计算都在JVM内存中完成。&lt;span/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.  拒绝模糊查询：es一大杀手&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;    &lt;span&gt;&quot;query&quot;&lt;/span&gt;:{&lt;br/&gt;        &lt;span&gt;&quot;wildcard&quot;&lt;/span&gt;:{&lt;br/&gt;            &lt;span&gt;&quot;title.keyword&quot;&lt;/span&gt;:&lt;span&gt;&quot;*张三*&quot;&lt;/span&gt;&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4. 拒绝深度分页&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ES获取数据时，每次默认最多获取10000条，获取更多需要分页，但存在深度分页问题，一定不要使用from/Size方式，建议使用scroll或者searchAfter方式。scroll会把上一次查询结果缓存一定时间（通过配置scroll=1m实现)，所以在使用scroll时一定要保证search结果集不要太大。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5. 基数查询&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;尽量不要用基数查询去查询去重后的数据量大小（kibana中界面上显示是Unique Count，Distinct Count等），即少用如下的查询：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&quot;aggregations&quot;&lt;/span&gt;: {&lt;br/&gt;     &lt;span&gt;&quot;cardinality&quot;&lt;/span&gt;: {&lt;br/&gt;          &lt;span&gt;&quot;field&quot;&lt;/span&gt;: &lt;span&gt;&quot;userId&quot;&lt;/span&gt;&lt;br/&gt;      }&lt;br/&gt; }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;6. 禁止查询 indexName-*&lt;span/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;7. 避免使用script、update_by_query、delete_by_query，对线上性能影响较大。&lt;span/&gt;&lt;/h3&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;四、常见问题&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1. 一个索引的shard数一旦确定不能改变&lt;span/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2.  ES不支持事务ACID特性。&lt;span/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.  reindex：&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;reindex可以实现索引的shard变更，但代价非常大：速度慢、对性能有影响，所以好的设计和规划更重要&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;五、grafana使用规范&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1.查询范围不要太大，建议在3h以内&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如下查询7d，数据量巨大，严重影响集群查询性能&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5845070422535211&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0Y9Yr0dNVf5ZH3d9r16SwSbKAibvfHibS5fM8CGAXSNM5icX6LkfMyYS9A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;852&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br/&gt;2. 拒绝多层嵌套，不要超过2层&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如下图中进行了4层嵌套，每层嵌套的结果都缓存在内存中，导致内存崩溃&lt;img data-ratio=&quot;0.27837423312883436&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0Ab3OtYFsWNiaKnibq49Ea7AZlA6N2uYtRnPez0sHZvpAKyjlhGLKVvxA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2608&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3. 拒绝分时查询&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分位查询相当于一种分桶聚合方式，分的桶越多，带来的CPU计算量越大&lt;img data-ratio=&quot;0.25427509293680295&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K0jSpYNZQhK3caDkxuplDKHLq2XZQVicDCM4ajnywClP0icjF78RdSCojQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2690&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4. 拒绝TOP&amp;gt;100查询&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;top查询是在聚合的基础上再进行排序，如果top太大，cpu的计算量和耗费的内存都会导致查询瓶颈&lt;br/&gt;&lt;img data-ratio=&quot;0.32751091703056767&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZULLb8I10cwWA04kCpzicicJpoUGs3x5K016oM3eBNcEia4rebZCZ7GcPGszDpBdG6iaNAz2URzTvSsbQ1KQLj3Eicw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2290&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;5. 拒绝正则匹配查询&lt;span/&gt;&lt;/h3&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;快手长期招聘ElasticSearch工程师&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;职位要求：&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;公司：快手（北京）&lt;/p&gt;&lt;p&gt;薪资：30~60K（16薪）&lt;/p&gt;&lt;p&gt;联系人：付磊(微信 carlosfu)&lt;/p&gt;&lt;p&gt;规模：数千个ES节点，核心服务支撑&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;岗位职责：&lt;/p&gt;&lt;p&gt;1.负责大数据Elasticsearch平台的设计、开发、维护与优化&lt;/p&gt;&lt;p&gt;2.参与大数据Elasticsearch平台架构设计、开发、部署和数据分析等工作&lt;/p&gt;&lt;p&gt;3.参与ElasticSearch内核研发。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;岗位要求：&lt;/p&gt;&lt;p&gt;1.三年以上Java开发经验，具备系统架构设计和优化能力；&lt;/p&gt;&lt;p&gt;2.熟悉JAVA体系结构, 理解JVM原理；熟悉java开源框架，对于用过的开源框架，能了解到它的原理和机制；&lt;/p&gt;&lt;p&gt;3.熟悉Elasticsearch的工作原理，有相关平台应用开发经验；&lt;/p&gt;&lt;p&gt;4.熟悉分布式系统的设计和应用，熟悉分布式、缓存、消息、负载均衡等机制和实现；&lt;/p&gt;&lt;p&gt;5.热爱技术，对技术有不懈的追求，喜欢研究开源代码；&lt;/p&gt;&lt;p&gt;6.具有较强的学习能力、自我管理能力、能够在压力环境下工作；&lt;/p&gt;&lt;p&gt;7.性格积极乐观、诚信、有较强的语言表达能力，具备强烈的进取心、求知欲及团队合作精神;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>