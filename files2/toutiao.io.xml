<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>93977ec95cdbfc64bf4d6bd4a2aa971c</guid>
<title>互联网架构演进之路</title>
<link>https://toutiao.io/k/6w82jhc</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;前言&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;本文介绍下 互联网架构演进的4个阶段&lt;br/&gt;&lt;br/&gt;1、单体架构&lt;br/&gt;2、水平分层和面向服务架构（SOA）&lt;br/&gt;3、微服务架构&lt;br/&gt;4、服务网格架构(Service Mesh)&lt;br/&gt;&lt;br/&gt;在此之前先简单介绍一个小知识点&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;redis做分布式锁弊端&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;redis实现分布式锁 哨兵模式下 会导致 一个锁同时被多个线程持有&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8517887563884157&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc5mBW4ictvgNshibWZ4AyIiaNtagmaXnWaThnTWVIbHuTj0I0kMbWyNxhA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1174&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;分布式锁是CP模型 Redis是AP模型 用AP实现CP完全错误的&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;用ZK实现分布式锁 有性能问题&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;推荐使用etcd来实现分布式锁&lt;/strong&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;互联网发展&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;静态 广播式&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;动态 互动 比如微博关注&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;万物连接 &lt;br/&gt;比如微信群组 将一对一变成一对多 形成了网络&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;架构演进&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;单体&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4987980769230769&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccglm2JjmNiadchyYSxhMBm7jia0bhUahYzkDcWe73kqkmkcY7ianLPp1WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1664&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;优点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;开发、测试、部署、扩展 都很方便&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;扩展&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.9783783783783784&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccbgrBOUiaNFwLJr8ygEr1m76V9aBw60Eeb6SfM4szXcRFtr5sibMaia5Bg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1110&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;应用场景&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;性能： 吞吐量、平均响应延迟&lt;br/&gt;&lt;br/&gt;这里主要指平均响应延迟 &lt;br/&gt;比如股票、高频交易 需要及时捕捉到股票市场一些波动&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;缺点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如开发语言单一&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;水平分层&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;要解决这些问题 咱们先看看数据库是如何破局的 然后再类比到架构上&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据库如何解决单体瓶颈&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;拆分&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如 用户库 商户库&lt;br/&gt;&lt;br/&gt;但还是单表&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;比如 模1024 分1024表&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;db做了拆分 所以要考虑分布式事务&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;架构同理&lt;/strong&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;水平分层架构设计&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;按业务维度&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;物理分成多个独立进程&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;按功能纬度：网关层、业务逻辑层、数据访问层、数据存储层&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;每层逻辑解耦&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;数据访问层必须拆分出来 可以屏蔽掉分库分表逻辑和兼容不同的数据库（比如关系型、非关系型、NewSql）&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.28647014361300077&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccPnxp9ibKvyiajgVZoPvicFd6RGXPjlt7FvwoHgKszHyfGrbDhkFXUUMDw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2646&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;分层设计原则&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7345679012345679&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc1lwCicrCz5L9nh1J9xkW0nB45icne1YsEca8yibBUVxVbHRw7hn0I7oSA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1296&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;展示服务和网关服务分离举例&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;网关返回的发布时间是时间戳格式&lt;br/&gt;展示层（APP）将时间戳转换成具体的日期格式&lt;br/&gt;而非网关返回具体的日期格式&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;网关层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0788253477588872&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccLHB83rRcdwmY5GMicWpZWML48QOwImpwbadFjvTXXtc1EfEjkw4WrUw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1294&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;app 通过https/http协议 以json字符串的格式&lt;br/&gt;&lt;br/&gt;请求包：&lt;br/&gt;&lt;br/&gt;1 定长header(uid、sessionId(请求唯一标识、cmd(请求命令号)、body length)) &lt;br/&gt;&lt;br/&gt;2 变长body&lt;br/&gt;&lt;br/&gt;原则：&lt;br/&gt;&lt;br/&gt;不会对价格字段做检查（不会处理具体业务语意）&lt;br/&gt;&lt;br/&gt;但要做非空检查（通用逻辑）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;请求鉴权&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;粗粒度：ip白名单&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;细粒度：请求参数中有token，基于过滤器做token验证&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、登陆鉴权是属于具体业务 不属于请求鉴权 放在业务逻辑层&lt;br/&gt;&lt;br/&gt;2、鉴权规则配置到配置中心 可视化方式获取&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;请求进入网关之后 不用短连接&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;传输协议&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;rpc oven tcp&lt;br/&gt;可以提升传输效率&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据协议&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;protobuf google&lt;br/&gt;（用json传输量大 pb二进制且压缩）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5144454799627214&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccZiaajR44GLicdxXfIPK9zmuEoctD9zJCMBLxZn1EndfaWCnWGwwCsmNQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1073&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;网关不需要理解具体的业务语意&lt;br/&gt;&lt;br/&gt;1、json{k1,v1}转hashmap(string,object)&lt;br/&gt;&lt;br/&gt;2、hashmap序列化pb&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;路由转发&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;负载均衡&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;网关开源组件&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5760598503740648&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccE4BX9VxIEVOv0DMgczkeIs74WbLWqicgltg9xJbcyAsR92PtZHuw2ibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2406&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;简单解释：&lt;br/&gt;&lt;br/&gt;1、Kong基于nginx(Lua) 写了扩展性脚本&lt;br/&gt;&lt;br/&gt;2、BIO是阻塞IO模型&lt;br/&gt;&lt;br/&gt;3、Netty 用的NIO（N是New IO:IO复用）&lt;br/&gt;&lt;br/&gt;4、epoll （linux具体网络实现,实现NIO）&lt;br/&gt;&lt;br/&gt;5、AIO 异步IO模型 （用的不多 业务复杂度很高 性能最好）&lt;br/&gt;&lt;br/&gt;6、Zuul 已贡献给 Spring Cloud 推荐Zuul&lt;br/&gt;&lt;br/&gt;简单扩展：&lt;br/&gt;&lt;br/&gt;1、国际化 在APP启动层做&lt;br/&gt;&lt;br/&gt;2、第三方调用的场景用oauth授权  app用oauth意义不大&lt;br/&gt;&lt;br/&gt;3、多版本号场景 业务逻辑根据不同版本号做差异&lt;br/&gt;&lt;br/&gt;4、不同业务团队用一个网关 &lt;br/&gt;&lt;br/&gt;5、网关层是无状态的 每一个部署的模块是对等的 不存储数据&lt;br/&gt;&lt;br/&gt;6、selct和poll不用 性能较差 epoll用的更多&lt;br/&gt;&lt;br/&gt;7、springcloud大公司用的很少&lt;br/&gt;   中小型公司用的多 &lt;br/&gt;   用的是http协议 没有用rpc&lt;br/&gt;   &lt;br/&gt;8、服务治理每层都要做&lt;br/&gt;&lt;br/&gt;9、Zuul尽量少启动 一启动连接就丢了 &lt;br/&gt;&lt;br/&gt;10、app(混合式： 经常变的页面做成h5(不需要发版本) native)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;业务逻辑层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0504885993485342&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccibGib09SYrAt2btW1dCYV9aRQibHMOuCFof9pkjDWcp6hCicO4HpDA8z3Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1228&quot;/&gt;&lt;/figure&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;数据访问层功能&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.1595330739299612&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccVvuQ6PdAuYlnYpQ03Hc7zMviaDqca0m3ocSM8FibjWQ6ib7FEfOXdpMgw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1028&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;orm映射 : pb-&amp;gt;mysql协议&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;最难的是Sharding&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1 原因：&lt;br/&gt;&lt;br/&gt;很多情况 sharding不了&lt;br/&gt;&lt;br/&gt;对商品留言功能 几十个亿 分片不了&lt;br/&gt;&lt;br/&gt;留言id 留言商品id 留言人 留言时间 留言状态（有没有删除）&lt;br/&gt;&lt;br/&gt;未分表 只需要建立index就可以&lt;br/&gt;&lt;br/&gt;分表 parditing key只有一个&lt;br/&gt;&lt;br/&gt;其他的查询字段要遍历所有表 &lt;br/&gt;&lt;br/&gt;2 解决方式：&lt;br/&gt;&lt;br/&gt;通过映射表 基因法&lt;br/&gt;&lt;br/&gt;3、分库分表查询的业务逻辑在业务逻辑层实现&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;最好的方式是不分片&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;将分表逻辑下推到db层&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;数据库进化史&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、单机关系型数据库 &lt;br/&gt;2、08年之前&lt;br/&gt;3、比如mysql oracle&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、数据量大 互联网事务要求不高 (acid) 分布式非关系型数据库 &lt;br/&gt;&lt;br/&gt;2、解决了分库分表&lt;br/&gt;&lt;br/&gt;3、一致性解决不好 比如mongodb redis hive hbase&lt;br/&gt;&lt;br/&gt;4、mongodb 3.0之前事务性不好 4.0及以后支持事务&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;newsql&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、金融电信银行 数据量大 事务要求很高 &lt;br/&gt;&lt;br/&gt;2、分布式关系型数据库&lt;br/&gt;&lt;br/&gt;3、比如国内tidb&lt;br/&gt;&lt;br/&gt;a、tidb是强一致性的 支持事务acid&lt;br/&gt;&lt;br/&gt;对一致性要求不高的 不用关系型数据库也可以 比如用redis&lt;br/&gt;&lt;br/&gt;b、tidb用的是mysql协议 业务不需要升级&lt;br/&gt;&lt;br/&gt;c、单机mysql数据存储的下的话 tidb比mysql慢 因为tidb是分布式的&lt;br/&gt;&lt;br/&gt;d、异构存储 一致性很难保证&lt;br/&gt;&lt;br/&gt;4、用newsql 线上单表 1200多亿 查询只需要4毫秒&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;同步架构&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2528830313014827&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc9ml0KVq3X1wvGf1OXCepeKfYtyU4QJJr4LIjweMFPCjARdS2yIzfKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2428&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;异步架构&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2350265352539803&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccNeoycySzWBWt4BVQGlovxgXyvj3KA2Y0pAobmZJc1lyJFYyLvufUpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2638&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;1、为什么用mq做异步&lt;br/&gt;&lt;br/&gt;mq顺序写入磁盘 append 追加 效率高&lt;br/&gt;db随机写写磁盘&lt;br/&gt;&lt;br/&gt;2、mq要放在网关和业务逻辑层之间变成异步&lt;br/&gt;&lt;br/&gt;3、异步目的提升吞吐量&lt;br/&gt;&lt;br/&gt;4、推荐使用rocketmq&lt;br/&gt;&lt;br/&gt;5、读请求不能用mq &lt;br/&gt;   写请求可以用mq&lt;br/&gt;   &lt;br/&gt;   &lt;br/&gt;数据一致性要求强:充值 不能用异步 吞吐量不高 低并发&lt;br/&gt;&lt;br/&gt;数据一致性要求弱:发朋友圈 社交 可以用异步 吞吐量高 高并发&lt;br/&gt;&lt;br/&gt;写场景是异步&lt;br/&gt;读场景不是异步&lt;br/&gt;&lt;br/&gt;发朋友圈 缓存到本地 读从本地读 不是从网关-&amp;gt;业务逻辑层-&amp;gt;数据存储层-&amp;gt;db&lt;br/&gt;&lt;br/&gt;发好了直接看 解决自己看问题就好了 好多秒之后再看 就已经入DB了&lt;br/&gt;&lt;br/&gt;但异步也不定写成功到db&lt;br/&gt;&lt;br/&gt;微信怎么办的 有未发送成功的消息&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;层次划分个数&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、请求路径变长&lt;br/&gt;&lt;br/&gt;2、平均响应延迟变高&lt;br/&gt;&lt;br/&gt;3、定位问题复杂 分布式请求跟踪系统&lt;br/&gt;&lt;br/&gt;4、运维成本增加&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;单体&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.3596730245231607&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicc1ZJ3kb6JE07BSBRyqErTFzIv2GPY6icpEMXfAicibF75Kn6r2XApDNnhw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;734&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;缺点&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;每层粒度过粗&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;扩展&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、reacter 模型 本质是异步架构 是一个实现手段&lt;br/&gt;&lt;br/&gt;2、app和网关长连接 失败了会推给app&lt;br/&gt;若http必须长轮询&lt;br/&gt;&lt;br/&gt;3、使用nginx\f5\lvs意义会使请求更加健壮 因为网关会频繁重启 &lt;br/&gt;&lt;br/&gt;4、nginx反向代理 ip限流&lt;br/&gt;&lt;br/&gt;5、mq不适合用udp协议（高性能udp） mq要保证数据可靠性&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;同步水平分层架构&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;dns解析 -&amp;gt;静态资源获取-&amp;gt;动态资源获取&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.47806354009077157&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccys0PVicZFxKbX6As1iaSDkFnkhm7mW69LLom4r0dlBkicfW08Pakniboug/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2644&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、路由器虚拟化 NetGW&lt;br/&gt;&lt;br/&gt;2、对象存储 &lt;br/&gt;&lt;br/&gt;   a、fastdfs(规模小) &lt;br/&gt;   b、ceph(规模大 运维压力大 快存储、挂硬盘)&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;面向服务SOA&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;垂直拆分&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.39969604863221886&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccFHBTsBUtveg8UENsvZpNSqxczibcujJyF0qmZR1NLibcZhn2VibC9gv4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2632&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、多个独立服务（每个服务都是单体）&lt;br/&gt;&lt;br/&gt;2、通过ESB交互 对ESB依赖严重&lt;br/&gt;&lt;br/&gt;3、SOA不是微服务架构&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;微服务架构&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;垂直和水平都拆分&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、独立进程&lt;br/&gt;&lt;br/&gt;2、围绕业务建模能力&lt;br/&gt;&lt;br/&gt;3、独立部署&lt;br/&gt;&lt;br/&gt;4、去中心化管理 （网关、业务逻辑&lt;br/&gt;数据访问、存储层 都可以用各种语言写 但会带来很多问题）&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6682600382409177&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxiccV82NLXo5th4NPWUTg0mqXhf5HSXfQyG6bPBibPXmNlwGz4UttURQYLw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2092&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.41874527588813304&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wsYmlkqrXhN5pSBh2wrSBaoUfvPyNxicczGWsz9PsHamiaOicia7PLnfUHhmSChDL79s5H71f6DZoQBG8ddCgXE67A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2646&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、用zk、consul做注册中心不行 eurka 可以&lt;br/&gt;&lt;br/&gt;2、配置中心推荐 appllo 携程开源；不要用disconf(springcloud的生态)&lt;br/&gt;&lt;br/&gt;3、交易系统是同步分层架构&lt;br/&gt;&lt;br/&gt;4、注册中心不知道哪个服务挂掉 通过熔断可以知道&lt;br/&gt;&lt;br/&gt;5、forupdate并发锁 粒度大 量大不行&lt;br/&gt;&lt;br/&gt;6、同层之间不调用&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本质&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;两个拆分&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;垂直（业务）拆分比较难&lt;br/&gt;&lt;br/&gt;继续拆分 读、写微服务（按功能拆分 （api））&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;业务架构&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;微服务架构是业务架构 不是系统架构&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;组织架构&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;事业部制  公司-&amp;gt;房产(产品、研发、销售) 招聘(产品、研发、销售) 二手车(产品、研发、销售) 效率高&lt;br/&gt;&lt;br/&gt;公司-&amp;gt;产品、研发、销售 效率低&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;应用场景&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;需求层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;变化频繁 比如内部OA系统 ERP系统 不频繁 微服务意义不大&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;性能层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;1、吞吐量变高 平均响应延迟变高&lt;br/&gt;&lt;br/&gt;2、高频交易 量化交易 不合适微服务&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;数据一致性层面&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;一致性分为：&lt;br/&gt;   强一致性&lt;br/&gt;   和最终一致性（用微服务其实解决这个问题）&lt;br/&gt;&lt;br/&gt;多个db 分布式事务解决强一致性问题 性能就没了&lt;br/&gt;&lt;br/&gt;往往最终一致性 （分为同步、异步场景）&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;目的&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;快速迭代、持续交付&lt;br/&gt;&lt;br/&gt;降本（人力、机器）提效（开发、运维、测试）&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;后记&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;后续会介绍服务网格架构ServiceMesh&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>ce24729d5a1bf75f60801ba6a9f016cc</guid>
<title>网络存储文件共享之 WebDAV</title>
<link>https://toutiao.io/k/zccejvk</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;entry-content&quot;&gt;&amp;#13;

&lt;p&gt;WebDAV 基于 HTTP 协议的通信协议，在GET、POST、HEAD等几个HTTP标准方法以外添加了一些新的方法，使应用程序可对Web Server直接读写，并支持写文件锁定(Locking)及解锁(Unlock)，还可以支持文件的版本控制。&lt;/p&gt;



&lt;p&gt;常用的文件共享有三种：FTP、Samba、WebDAV，它们各有优缺点，了解后才能更好地根据自己的需求选择方案。&lt;/p&gt;



&lt;span id=&quot;more-238&quot;/&gt;



&lt;ul&gt;&lt;li&gt;FTP属于古老的文件共享方式了，因为安全性，现代浏览器最新已默认不能打开FTP协议。SFTP在FTP基础上增加了加密，在Linux上安装OpenSSH后可以直接用SFTP协议传输。使用SFTP临时传送文件还可以，但做文件共享，性能不高，速度较慢。&lt;/li&gt;&lt;li&gt;Samba是Linux下CIFS协议的实现，优势在于对于小白使用简章，和Windows系统文件共享访问一样，不需要安装第三方软件，而且移动端也有大量APP支持。苹果手机文件APP中添加网络存储用的就是这种方式。Windows下文件共享使用445端口，且不能更改。445端口常常受黑客关照，在广域网上大多运营封掉了访端口，所以这种文件共享只适合在内网使用。&lt;/li&gt;&lt;li&gt;WebDAV 基于 HTTP 协议的通信协议，在广域网上共享文件有天然的优势，移动端文件管理APP也大多支持WebDAV协议。使用HTTPS还能保安全性。Apache和Nginx支持WebDAV，可作为WebDAV文件共享服务器软件。也可以使用专门的WebDAV软件部署。&lt;/li&gt;&lt;/ul&gt;



&lt;h2 id=&quot;webdav-server-推荐&quot;&gt;WebDAV Server (推荐)&lt;/h2&gt;



&lt;p&gt;WebDAV 是 GitHub 上开源的项目，基于 Go 语言实现，不仅跨平台，还支持 ARM 架构，可在㠌入式设备中部署 WebDAV 服务器。&lt;/p&gt;



&lt;p&gt;项目地址：&lt;a href=&quot;https://github.com/hacdias/webdav&quot; target=&quot;_blank&quot; rel=&quot;noreferrer noopener&quot;&gt;https://github.com/hacdias/webdav&lt;/a&gt;&lt;/p&gt;



&lt;p&gt;在 GitHub 下载对应的架构 WebDAV，如：windows-amd64-webdav.zip 。解压后获得 webdav.exe 。&lt;/p&gt;



&lt;p&gt;用文本编辑器新建 config.yaml 文件，内容如下：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;&lt;em&gt;# 监听任意网卡，多网卡可指定对应ip&lt;/em&gt;
address: 0.0.0.0
port: 8081
&lt;em&gt;# 如果无需验证填 false&lt;/em&gt;
auth: true
&lt;em&gt;# 如果不需要 https 则填 false&lt;/em&gt;
tls: true
&lt;em&gt;# https证书和密钥，如果 tls 为 false，cert 和 key 不需要&lt;/em&gt;
cert: /data/www/cert/szhome.xf1024.com_nginx/cert.pem
key: /data/www/cert/szhome.xf1024.com_nginx/cert.key
&lt;em&gt;# 访问前缀，建议默认&lt;/em&gt;
prefix: /

&lt;em&gt;# 如果 auth 为 false 生效，文件共享的路径&lt;/em&gt;
scope: /data/users/public
&lt;em&gt;# 是否允许修改&lt;/em&gt;
modify: true
rules: []

&lt;em&gt;# 跨域设置&lt;/em&gt;
cors:
  enabled: true
  credentials: true
  allowed_headers:
    - Depth
  allowed_hosts:
    - http://localhost:8081
  allowed_methods:
    - GET
  exposed_headers:
    - Content-Length
    - Content-Range

&lt;em&gt;# 用户信息，如果 auth 为 true 生效&lt;/em&gt;
users:
  - username: user1
    password: 123456
    scope: /data/users/2021
  - username: user2
    password: 654321
    scope: /data/users/2022&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;注意 yaml 文件格式的书写规则，users 下是需认证的用户名，密码，及用户共享文件。&lt;/p&gt;



&lt;p&gt;启动服务：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;webdav -c ./config.yaml&lt;/code&gt;&lt;/pre&gt;



&lt;h2 id=&quot;apache-开启-webdav&quot;&gt;Apache 开启 WebDAV&lt;/h2&gt;



&lt;p&gt;Apache 开启 WebDAV 需要打开以下模块：&lt;/p&gt;



&lt;p&gt;LoadModule dav_module modules/mod_dav.so&lt;br/&gt;LoadModule dav_fs_module modules/mod_dav_fs.so&lt;br/&gt;LoadModule dav_lock_module modules/mod_dav_lock.so&lt;/p&gt;



&lt;p&gt;配置如下：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;
    ServerName dav.engr-z.com
    DocumentRoot /data/webdav
    &amp;lt;Directory &quot;/data/webdav&quot;&amp;gt;
        Options Indexes FollowSymLinks
        AllowOverride None
        Dav on
        AuthType Basic
        AuthName &quot;WebDAV Upload&quot;
        AuthUserFile conf/.htpasswd
        AuthBasicProvider file
        Require user webdav
    &amp;lt;/Directory&amp;gt;
&amp;lt;/VirtualHost&amp;gt;

&amp;lt;VirtualHost *:443&amp;gt;
    ServerName dav.engr-z.com
    DocumentRoot /data/webdav
    &amp;lt;Directory &quot;/data/webdav&quot;&amp;gt;
        Options Indexes FollowSymLinks
        AllowOverride None
        Dav on
        AuthType Basic
        AuthName &quot;WebDAV Upload&quot;
        AuthUserFile conf/.htpasswd
        AuthBasicProvider file
        Require user webdav
    &amp;lt;/Directory&amp;gt;
&lt;em&gt;#Header always set Strict-Transport-Security &quot;max-age=63072000; includeSubdomains; preload&quot;&lt;/em&gt;
    &lt;em&gt;# 添加 SSL 协议支持协议，去掉不安全的协议&lt;/em&gt;
    SSLProtocol all -SSLv2 -SSLv3
    &lt;em&gt;# 修改加密套件如下&lt;/em&gt;
    SSLCipherSuite HIGH:!RC4:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!EXP:+MEDIUM
    SSLHonorCipherOrder on
    &lt;em&gt;# 证书公钥配置&lt;/em&gt;
    SSLCertificateFile cert/dav.engr-z.com_apache/public.crt
    &lt;em&gt;# 证书私钥配置&lt;/em&gt;
    SSLCertificateKeyFile cert/dav.wangzhengzhen.com_apache/cert.key
    &lt;em&gt;# 证书链配置，如果该属性开头有 &#x27;#&#x27;字符，请删除掉&lt;/em&gt;
    SSLCertificateChainFile cert/dav.engr-z.com_apache/chain.crt
&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;.htpasswd 文件是保存用户名密码的文件，使用 apache 工具 htpasswd 创建：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;htpasswd -c /etc/webdav/.htpasswd user1&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;如果需要创建多个用户，在第二次执行时注意去掉 -c 参数，防止生成文件覆盖。&lt;/p&gt;



&lt;h2 id=&quot;nginx-开启-webdav&quot;&gt;Nginx 开启 WebDAV&lt;/h2&gt;



&lt;p&gt;在Nginx中实现WebDAV需要安装 libnginx-mod-http-dav-ext 模块，以下是Nginx的配置：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;server {
        listen 80;
        listen [::]:80;

        server_name dav.engr-z.com;
        auth_basic &quot;Authorized Users Only&quot;;
        auth_basic_user_file /etc/.htpasswd;

        location / {
                root /data/webdav;
                client_body_temp_path /var/temp;
                dav_methods PUT DELETE MKCOL COPY MOVE;
                dav_ext_methods PROPFIND OPTIONS;
                create_full_put_path on;
                client_max_body_size 10G;
        }
}

server {
        listen 443;
        listen [::]:443;
        server_name dav.engr-z.com;

        ssl on;
        ssl_certificate /data/www/cert/dav.engr-z.com_nginx/cert.pem;
        ssl_certificate_key /data/www/cert/dav.engr-z.com_nginx/cert.key;
        ssl_session_timeout 5m;
        ssl_protocols SSLv2 SSLv3 TLSv1;
        ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;
        ssl_prefer_server_ciphers on;

        location / {
                root /data/webdav;
                client_body_temp_path /var/temp;
                dav_methods PUT DELETE MKCOL COPY MOVE;
                dav_ext_methods PROPFIND OPTIONS;
                create_full_put_path on;
                client_max_body_size 10G;
        }

}&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;.htpasswd 用户密码文件的创建方式和 Apache 一样，htpasswd是apache的工具，如果使用nginx，可以单独安装该工具而不安装整个apache。在Ubuntu中使用 sudo apt install apache2-utils 安装。&lt;/p&gt;



&lt;p&gt;Nginx 对 WebDAV 支持不是太好，建议使用 Apache 或专用于 WebDAV 服务软件架设。&lt;/p&gt;



&lt;h2 id=&quot;webdav挂载映射&quot;&gt;WebDAV挂载/映射&lt;/h2&gt;







&lt;p&gt;打开 “计算机” ，点右键添加一个网络位置，按向导填入地址，用户名，密码。&lt;/p&gt;







&lt;p/&gt;







&lt;p&gt;挂载指定盘符：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;net use Y: https://dav.engr-z.com/ /user:engrz /persistent:YES 密码&lt;/code&gt;&lt;/pre&gt;



&lt;blockquote class=&quot;wp-block-quote&quot;&gt;&lt;p&gt;其中 qizheng 是我的用户名&lt;br/&gt;密码把 password 换成对应的密码。&lt;br/&gt;/persistent 表示保存映射，下次开机还在。&lt;br/&gt;执行完，打开资源管理器，可以看到磁盘映射了。&lt;br/&gt;如果下次开机，发现不能打开磁盘，访问失败，可以检查 WebClient 服务是否开启。&lt;/p&gt;&lt;/blockquote&gt;







&lt;p&gt;从Windows Vista起，微软就禁用了http形式的基本WebDAV验证形式（KB841215），必须使用https连接。我们可以修改注册表……&lt;/p&gt;



&lt;p&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters&lt;br/&gt;找到BasicAuthLevel把这个值从1改为2，然后进控制面板，服务，把WebClient服务重启（没有启动的就启动它）。&lt;/p&gt;







&lt;p&gt;在某些版本的 Windows 操作系统中，WebDAV 驱动器的最大文件大小被限制为 50MB。如果你试图复制超过 50MB 大小的文件，Windows 就会弹出错误提示框。当然，这个限制是可以通过修改注册表来消除的。&lt;/p&gt;



&lt;p&gt;将注册表中位于&lt;br/&gt;HKLM\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\FileSizeLimitInBytes&lt;br/&gt;处的键值由 50000000 (50MB) 修改为更大的数值。最大修改为：4294967295（0xffffffff）字节，即4G。&lt;/p&gt;







&lt;p&gt;这里推荐使用免费软件 RaiDrive ，通过 RaiDrive 映射的磁盘，没有 http 和 上传文件大小限制，无需修改注册表。&lt;/p&gt;



&lt;p&gt;RaiDrive 是一款能够将一些网盘映射为本地网络磁盘的工具，支持 Google Drive、Google Photos、Dropbox、OneDrive、FTP、SFTP、WebDAV。&lt;/p&gt;







&lt;p&gt;下载地址：&lt;a href=&quot;https://www.raidrive.com&quot; target=&quot;_blank&quot; rel=&quot;noreferrer noopener&quot;&gt;https://www.raidrive.com&lt;/a&gt;&lt;/p&gt;







&lt;p&gt;Linux 的文件管理工具大多都支持 WebDAV ，以 Ubuntu 为例：&lt;/p&gt;



&lt;figure class=&quot;wp-block-image size-large&quot;&gt;&lt;img loading=&quot;lazy&quot; src=&quot;https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图.png&quot; alt=&quot;&quot; class=&quot;wp-image-249&quot; srcset=&quot;https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图.png 882w, https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图-300x200.png 300w, https://engr-z.com/wp-content/uploads/2021/02/2021-02-23-01-01-05-的屏幕截图-768x511.png 768w&quot; sizes=&quot;(max-width: 882px) 100vw, 882px&quot;/&gt;&lt;/figure&gt;



&lt;p&gt;还可以使用命令挂载，需要安装 davfs2 ：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;apt install davfs2&lt;/code&gt;&lt;/pre&gt;



&lt;p&gt;执行命令后系统会自动安装，出现以下提示，选是。&lt;/p&gt;







&lt;p&gt;挂载：&lt;/p&gt;



&lt;pre class=&quot;wp-block-code&quot;&gt;&lt;code&gt;sudo mount -t davfs http://dav.engr-z/ ./webdav/&lt;/code&gt;&lt;/pre&gt;
&lt;hr/&gt;&lt;/div&gt;&amp;#13;
&amp;#13;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>d137a12bd3fa14f07123f98a2fc2376f</guid>
<title>10 个内存引发的大坑，你能躲开几个？（一）</title>
<link>https://toutiao.io/k/s1b0ao9</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;p&gt;&lt;span&gt;对程序员来说内存相关的 bug 排查难度几乎和多线程问题并驾齐驱，&lt;strong&gt;当程序出现运行异常时可能距离真正有 bug 的那行代码已经很远了&lt;/strong&gt;，这就导致问题定位排查非常困难，这篇文章将总结涉及内存的一些经典 bug ，快来看看你知道几个，或者你的程序中现在有几个。。。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;返回局部变量地址&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们来看这样一段代码：&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;int &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__title&quot;&gt;fun&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  int a = &lt;span class=&quot;code-snippet__number&quot;&gt;2&lt;/span&gt;;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &amp;amp;a;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;void main() {  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   int* p = &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__title&quot;&gt;fun&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   *p = &lt;span class=&quot;code-snippet__number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这段代码非常简单，func 函数返回一个指向局部变量的地址，main 函数中调用 fun 函数，获取到指针后将其设置为 20。&lt;/span&gt;&lt;br/&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;你能看出这段代码有什么问题吗？&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;问题在于局部变量 a 位于 func 的栈帧中，当 func 执行结束，其栈帧也不复存在，因此 main 函数中调用 func 函数后得到的指针&lt;strong&gt;指向一个不存在的变量&lt;/strong&gt;：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.19765625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NLuDDj1hjicp6SvV3TZlDbEN3H5Raf6Lg767Uu3mZvic5mK1cV0KSGh4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-backw=&quot;578&quot; data-backh=&quot;114&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;尽管上述代码仍然可以“正常”运行，但如果后续调用其它函数比如funcB，那么指针p指向的内容将被 funcB 函数的栈帧内容覆盖掉，又或者修改指针 p 实际上是在破坏 funcB 函数的栈帧，这将导致极其难以排查的 bug。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h5 cid=&quot;n15&quot; mdtype=&quot;heading&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;错误的理解指针运算&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/h5&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;sum&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt;* arr, &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; len&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; sum = &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;; i &amp;lt; len; i++) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      sum += *arr;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      arr += &lt;span class=&quot;code-snippet__keyword&quot;&gt;sizeof&lt;/span&gt;(&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; sum;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这段代码本意是想计算给定数组的和，但上述代码并没有理解指针运算的本意。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;指针运算中的加1并不是说移动一个字节而是移动一个单位，&lt;strong&gt;指针指向的数据结构大小就是一个单位&lt;/strong&gt;。因此，如果指针指向的数据类型是 int，那么指针加 1 则移动 4 个字节(32位)，如果指针指向的是结构体，该结构体的大小为 1024 字节，那么指针加 1 其实是移动 1024 字节。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.46953125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NcsFVMoKOPtpWNJtB3beLyDjRqyPxosmbDZEd9t3JOw1oFibalVG0jgg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;从这里我们可以看出，&lt;strong&gt;移动指针时我们根本不需要关心指针指向的数据类型的大小&lt;/strong&gt;，因此上述代码简单的将arr += sizeof(int)改为arr++即可。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;h5 cid=&quot;n22&quot; mdtype=&quot;heading&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;解引用有问题的指针&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/h5&gt;&lt;section&gt;&lt;span&gt;C语言初学者常会犯一个经典错误，那就是从标准输入中获取键盘数据，代码是这样写的：&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; a;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;scanf&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;%d&quot;&lt;/span&gt;, a);&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;很多同学并不知道这样写会有什么问题，因为上述代码有时并不会出现运行时错误。&lt;/span&gt;&lt;br/&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;原来 scanf 会将a的值当做地址来对待，并将从标准输入中获取到的数据写到该地址中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这时接下来程序的表现就取决于a的值了，而上述代码中局部变量a的值是不确定的，那么这时：&lt;/span&gt;&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-2&quot; start=&quot;&quot; cid=&quot;n28&quot; mdtype=&quot;list&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向代码区或者其它不可写区域，操作系统将立刻kill掉该进程，这是最好的情况，这时发现问题还不算很难&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向栈区，那么此时恭喜你，其它函数的栈帧已经被破坏掉了，那么程序接下来的行为将脱离掌控，这样的 bug 极难定位&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;如果a的值作为指针指向堆区，那么此时也恭喜你，代码中动态分配的内存已经被你破坏掉了，那么程序接下来的行为同样脱离掌控，这样的bug也极难定位&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7838137472283814&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8g3rwJPmya1uUWibqDaIhHmImXAiaRpv1NfpWRoPPLGXgiaGiciaxTuiczehCnAGCYFrB8Tj1luambYodsf2GEWhbbmg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;902&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__0&quot;&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2934&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2935&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2936&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2937&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2938&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2939&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2940&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2941&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2942&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2943&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;伟&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2944&quot;&gt;伟&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2945&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2946&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;分&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2947&quot;&gt;分&lt;/span&gt;&lt;span data-raw-text=&quot;割&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2948&quot;&gt;割&lt;/span&gt;&lt;span data-raw-text=&quot;线&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2949&quot;&gt;线&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2950&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2951&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2952&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2953&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2954&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2955&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2956&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2957&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2958&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2959&quot;&gt;-&lt;/span&gt;&lt;span data-raw-text=&quot;-&quot; data-textnode-index=&quot;97&quot; data-index=&quot;2960&quot;&gt;-&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzI0MjEwMDMzNQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/LHDiahSVnXhuEIChmoDpeesYyxoiaDWYice5SX31nCmv2QA1TuYxxudVAvwAwTT3ia0mrjHuicxSwLMJZM7MZcA6P2Q/0?wx_fmt=png&quot; data-nickname=&quot;PHP饭米粒&quot; data-alias=&quot;phpfamily&quot; data-signature=&quot;一群靠谱的人，愿为PHPer带来一些值得细细品味的精神食粮！&quot;/&gt;&lt;/section&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__1&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__2&quot;&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2961&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2962&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2963&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2964&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2965&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2966&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;(&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2967&quot;&gt;(&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2968&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2969&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;p&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2970&quot;&gt;p&lt;/span&gt;&lt;span data-raw-text=&quot;f&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2971&quot;&gt;f&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2972&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2973&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2974&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2975&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;y&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2976&quot;&gt;y&lt;/span&gt;&lt;span data-raw-text=&quot;)&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2977&quot;&gt;)&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;98&quot; data-index=&quot;2978&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2979&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2980&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;群&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2981&quot;&gt;群&lt;/span&gt;&lt;span data-raw-text=&quot;靠&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2982&quot;&gt;靠&lt;/span&gt;&lt;span data-raw-text=&quot;谱&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2983&quot;&gt;谱&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2984&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;人&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2985&quot;&gt;人&lt;/span&gt;&lt;span data-raw-text=&quot;建&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2986&quot;&gt;建&lt;/span&gt;&lt;span data-raw-text=&quot;立&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2987&quot;&gt;立&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2988&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;愿&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2989&quot;&gt;愿&lt;/span&gt;&lt;span data-raw-text=&quot;为&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2990&quot;&gt;为&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2991&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;H&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2992&quot;&gt;H&lt;/span&gt;&lt;span data-raw-text=&quot;P&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2993&quot;&gt;P&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2994&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;r&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2995&quot;&gt;r&lt;/span&gt;&lt;span data-raw-text=&quot;带&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2996&quot;&gt;带&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2997&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;一&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2998&quot;&gt;一&lt;/span&gt;&lt;span data-raw-text=&quot;些&quot; data-textnode-index=&quot;98&quot; data-index=&quot;2999&quot;&gt;些&lt;/span&gt;&lt;span data-raw-text=&quot;值&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3000&quot;&gt;值&lt;/span&gt;&lt;span data-raw-text=&quot;得&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3001&quot;&gt;得&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3002&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;细&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3003&quot;&gt;细&lt;/span&gt;&lt;span data-raw-text=&quot;品&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3004&quot;&gt;品&lt;/span&gt;&lt;span data-raw-text=&quot;味&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3005&quot;&gt;味&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3006&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;精&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3007&quot;&gt;精&lt;/span&gt;&lt;span data-raw-text=&quot;神&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3008&quot;&gt;神&lt;/span&gt;&lt;span data-raw-text=&quot;食&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3009&quot;&gt;食&lt;/span&gt;&lt;span data-raw-text=&quot;粮&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3010&quot;&gt;粮&lt;/span&gt;&lt;span data-raw-text=&quot;！&quot; data-textnode-index=&quot;98&quot; data-index=&quot;3011&quot;&gt;！&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__3&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__4&quot;&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3012&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3013&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3014&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot;只&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3015&quot;&gt;只&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3016&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3017&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;创&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3018&quot;&gt;创&lt;/span&gt;&lt;span data-raw-text=&quot;或&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3019&quot;&gt;或&lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3020&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3021&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3022&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;表&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3023&quot;&gt;表&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3024&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3025&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3026&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3027&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;不&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3028&quot;&gt;不&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3029&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3030&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;网&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3031&quot;&gt;网&lt;/span&gt;&lt;span data-raw-text=&quot;上&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3032&quot;&gt;上&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3033&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3034&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;99&quot; data-index=&quot;3035&quot;&gt;章&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__5&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__6&quot;&gt;&lt;span data-raw-text=&quot;所&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3036&quot;&gt;所&lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3037&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3038&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3039&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3040&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3041&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;均&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3042&quot;&gt;均&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3043&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;找&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3044&quot;&gt;找&lt;/span&gt;&lt;span data-raw-text=&quot;到&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3045&quot;&gt;到&lt;/span&gt;&lt;span data-raw-text=&quot;原&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3046&quot;&gt;原&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3047&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3048&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;进&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3049&quot;&gt;进&lt;/span&gt;&lt;span data-raw-text=&quot;行&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3050&quot;&gt;行&lt;/span&gt;&lt;span data-raw-text=&quot;沟&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3051&quot;&gt;沟&lt;/span&gt;&lt;span data-raw-text=&quot;通&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3052&quot;&gt;通&lt;/span&gt;&lt;span data-raw-text=&quot;。&quot; data-textnode-index=&quot;100&quot; data-index=&quot;3053&quot;&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__7&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__8&quot;&gt;&lt;span&gt;&lt;span data-raw-text=&quot;也&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3054&quot;&gt;也&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3055&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3056&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;各&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3057&quot;&gt;各&lt;/span&gt;&lt;span data-raw-text=&quot;位&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3058&quot;&gt;位&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3059&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3060&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;打&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3061&quot;&gt;打&lt;/span&gt;&lt;span data-raw-text=&quot;赏&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3062&quot;&gt;赏&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3063&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;算&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3064&quot;&gt;算&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3065&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3066&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;费&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3067&quot;&gt;费&lt;/span&gt;&lt;span data-raw-text=&quot;给&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3068&quot;&gt;给&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3069&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;章&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3070&quot;&gt;章&lt;/span&gt;&lt;span data-raw-text=&quot;作&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3071&quot;&gt;作&lt;/span&gt;&lt;span data-raw-text=&quot;者&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3072&quot;&gt;者&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3073&quot;&gt;）&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3074&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;更&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3075&quot;&gt;更&lt;/span&gt;&lt;span data-raw-text=&quot;希&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3076&quot;&gt;希&lt;/span&gt;&lt;span data-raw-text=&quot;望&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3077&quot;&gt;望&lt;/span&gt;&lt;span data-raw-text=&quot;大&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3078&quot;&gt;大&lt;/span&gt;&lt;span data-raw-text=&quot;家&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3079&quot;&gt;家&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3080&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;多&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3081&quot;&gt;多&lt;/span&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;101&quot; data-index=&quot;3082&quot;&gt;投&lt;/span&gt;&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;102&quot; data-index=&quot;3083&quot;&gt;稿&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__9&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__10&quot;&gt;&lt;span data-raw-text=&quot;投&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3085&quot;&gt;投&lt;/span&gt;&lt;span data-raw-text=&quot;稿&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3086&quot;&gt;稿&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3087&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;联&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3088&quot;&gt;联&lt;/span&gt;&lt;span data-raw-text=&quot;系&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3089&quot;&gt;系&lt;/span&gt;&lt;span data-raw-text=&quot;：&quot; data-textnode-index=&quot;104&quot; data-index=&quot;3090&quot;&gt;：&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__11&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__12&quot;&gt;&lt;span data-raw-text=&quot;s&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3091&quot;&gt;s&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3092&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3093&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;n&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3094&quot;&gt;n&lt;/span&gt;&lt;span data-raw-text=&quot;z&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3095&quot;&gt;z&lt;/span&gt;&lt;span data-raw-text=&quot;h&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3096&quot;&gt;h&lt;/span&gt;&lt;span data-raw-text=&quot;e&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3097&quot;&gt;e&lt;/span&gt;&lt;span data-raw-text=&quot;1&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3098&quot;&gt;1&lt;/span&gt;&lt;span data-raw-text=&quot;6&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3099&quot;&gt;6&lt;/span&gt;&lt;span data-raw-text=&quot;3&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3100&quot;&gt;3&lt;/span&gt;&lt;span data-raw-text=&quot;@&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3101&quot;&gt;@&lt;/span&gt;&lt;span data-raw-text=&quot;g&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3102&quot;&gt;g&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3103&quot;&gt;m&lt;/span&gt;&lt;span data-raw-text=&quot;a&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3104&quot;&gt;a&lt;/span&gt;&lt;span data-raw-text=&quot;i&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3105&quot;&gt;i&lt;/span&gt;&lt;span data-raw-text=&quot;l&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3106&quot;&gt;l&lt;/span&gt;&lt;span data-raw-text=&quot;.&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3107&quot;&gt;.&lt;/span&gt;&lt;span data-raw-text=&quot;c&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3108&quot;&gt;c&lt;/span&gt;&lt;span data-raw-text=&quot;o&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3109&quot;&gt;o&lt;/span&gt;&lt;span data-raw-text=&quot;m&quot; data-textnode-index=&quot;105&quot; data-index=&quot;3110&quot;&gt;m&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__13&quot;&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__14&quot;&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3111&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;文&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3112&quot;&gt;文&lt;/span&gt;&lt;span data-raw-text=&quot;由&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3113&quot;&gt;由&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3114&quot;&gt;&lt;span&gt;  &lt;/span&gt;&lt;span&gt;&lt;span&gt;码农的荒岛求生&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3118&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;授&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3119&quot;&gt;授&lt;/span&gt;&lt;span data-raw-text=&quot;权&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3120&quot;&gt;权&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3121&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;饭&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3122&quot;&gt;饭&lt;/span&gt;&lt;span data-raw-text=&quot;米&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3123&quot;&gt;米&lt;/span&gt;&lt;span data-raw-text=&quot;粒&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3124&quot;&gt;粒&lt;/span&gt;&lt;span data-raw-text=&quot; &quot; data-textnode-index=&quot;106&quot; data-index=&quot;3125&quot;&gt; &lt;/span&gt;&lt;span data-raw-text=&quot;发&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3126&quot;&gt;发&lt;/span&gt;&lt;span data-raw-text=&quot;布&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3127&quot;&gt;布&lt;/span&gt;&lt;span data-raw-text=&quot;，&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3128&quot;&gt;，&lt;/span&gt;&lt;span data-raw-text=&quot;转&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3129&quot;&gt;转&lt;/span&gt;&lt;span data-raw-text=&quot;载&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3130&quot;&gt;载&lt;/span&gt;&lt;span data-raw-text=&quot;请&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3131&quot;&gt;请&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3132&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;明&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3133&quot;&gt;明&lt;/span&gt;&lt;span data-raw-text=&quot;本&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3134&quot;&gt;本&lt;/span&gt;&lt;span data-raw-text=&quot;来&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3135&quot;&gt;来&lt;/span&gt;&lt;span data-raw-text=&quot;源&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3136&quot;&gt;源&lt;/span&gt;&lt;span data-raw-text=&quot;信&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3137&quot;&gt;信&lt;/span&gt;&lt;span data-raw-text=&quot;息&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3138&quot;&gt;息&lt;/span&gt;&lt;span data-raw-text=&quot;和&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3139&quot;&gt;和&lt;/span&gt;&lt;span data-raw-text=&quot;以&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3140&quot;&gt;以&lt;/span&gt;&lt;span data-raw-text=&quot;下&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3141&quot;&gt;下&lt;/span&gt;&lt;span data-raw-text=&quot;的&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3142&quot;&gt;的&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3143&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3144&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3145&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;（&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3146&quot;&gt;（&lt;/span&gt;&lt;span data-raw-text=&quot;长&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3147&quot;&gt;长&lt;/span&gt;&lt;span data-raw-text=&quot;按&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3148&quot;&gt;按&lt;/span&gt;&lt;span data-raw-text=&quot;可&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3149&quot;&gt;可&lt;/span&gt;&lt;span data-raw-text=&quot;识&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3150&quot;&gt;识&lt;/span&gt;&lt;span data-raw-text=&quot;别&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3151&quot;&gt;别&lt;/span&gt;&lt;span data-raw-text=&quot;二&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3152&quot;&gt;二&lt;/span&gt;&lt;span data-raw-text=&quot;维&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3153&quot;&gt;维&lt;/span&gt;&lt;span data-raw-text=&quot;码&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3154&quot;&gt;码&lt;/span&gt;&lt;span data-raw-text=&quot;关&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3155&quot;&gt;关&lt;/span&gt;&lt;span data-raw-text=&quot;注&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3156&quot;&gt;注&lt;/span&gt;&lt;span data-raw-text=&quot;）&quot; data-textnode-index=&quot;106&quot; data-index=&quot;3157&quot;&gt;）&lt;/span&gt;&lt;/p&gt;&lt;p data-style=&quot;color: rgb(53, 53, 53); font-size: 14px; text-align: start; white-space: normal; max-width: 100%; min-height: 1em; font-family: -apple-system-font, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot; class=&quot;js_darkmode__15&quot;&gt;&lt;span&gt;&lt;img data-ratio=&quot;1&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/LHDiahSVnXhunbEtuowcI7kF5kmUaeTrszibibQ3st6OU8hy2CoIotHHLxicicibyF1qkNI7HibXYHXGN6hRby4ZyjR6A/640?wx_fmt=jpeg&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.7272727272727273&quot; data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; data-w=&quot;198&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/dFZyR2JHA40ooBMYVEUxJCPXf4gibCfn7o9SibGwiaIsQFLIZj1fTCMntcXzojwibkvqgTMOiaw14icRwQkP7zNNO7Hw/640?wx_fmt=jpeg&quot;/&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;素质三连biubiubiu~&lt;img data-ratio=&quot;1&quot; data-type=&quot;png&quot; data-w=&quot;64&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/b96CibCt70iaajvl7fD4ZCicMcjhXMp1v6UibM134tIsO1j5yqHyNhh9arj090oAL7zGhRJRq6cFqFOlDZMleLl4pw/640?wx_fmt=png&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>da8010d4f3b8b6f285704ade7342ece6</guid>
<title>Java 实现大文件多线程下载，提速 30 倍！想学？我教你啊</title>
<link>https://toutiao.io/k/jvd3wnb</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;前言&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在上一篇文章 《面试篇》Http协议 中，我们有提到大文件下载和断点续传，本篇我们就来开发一个多线程文件下载器，最后我们用这个多线程下载器来突破下载的限速。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;兄弟们看到这个标题可能会觉得是个标题党，为了解决疑虑，我们先来看下最终的测试结果：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试云盘下载的文件 46M，自己本地最大下载速度 2M&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1. 单线程下载，总耗时: 603s&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.40326633165829145&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYPqufy2ZRcMwicDCI8GmEvPXV3ibnh1m1y8DtzjKvNjMb6OWDAonoo4g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1592&quot;/&gt;&lt;/figure&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2. 多线程下载，50个线程，总耗时：13s&lt;span/&gt;&lt;/h5&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.30311231393775373&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFZmndGed2WKA9ZZslhWGhS7jFMibKskmicqVRCEt3iaC2tGb5cLZo9WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1478&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;测试结果，&lt;strong&gt;「提速46倍」&lt;/strong&gt;，我还是太谦虚了，只说提速30倍，此处我们觉得应该有掌声（我听不到，还是点赞实在）&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQoZPHZKqHuUgj73VhdAQia6WG5ANwAMjFFD5ZAae0GjZuZdQicbG0029g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;255&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;❝&lt;/span&gt;&lt;p&gt;源码地址：https://gitee.com/silently9527/fast-download&lt;/p&gt;&lt;p&gt;喜欢请记得star哦&lt;/p&gt;&lt;span&gt;❞&lt;/span&gt;&lt;/blockquote&gt;&lt;hr data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;HTTP协议Range请求头&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Range主要是针对只需要获取部分资源的范围请求，通过指定Range即可告知服务器资源的指定范围。格式: &lt;code&gt;Range: bytes=start-end&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如：获取字节范围 5001-10000&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;Range: bytes=5001-10000&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;也可以指定开始位置不指定结束位置，表示获取开始位置之后的全部数据&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;Range: bytes=5001-&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;服务器接收到带有&lt;code&gt;Range&lt;/code&gt;的请求，会在处理请求之后返回状态码为&lt;code&gt;206 Partial Content&lt;/code&gt;的响应。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;基于Range的特性，我们就可以实现文件的多线程下载，文件的断点续传&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;准备工作&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文我们使用的SpringMVC中的&lt;code&gt;RestTemplate&lt;/code&gt;；由于云盘的链接是Https，所以我们需要设置&lt;code&gt;RestTemplate&lt;/code&gt;绕过证书验证&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;pom.xml&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5043859649122807&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQF1fkfGpQtt03eSGh1xMtH5pka7fC0D2FYnnS5tnvl2Jvv3Cwg9pjeA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;912&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;pom.xml&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;编写&lt;code&gt;RestTemplate&lt;/code&gt;的构造器，以及绕过https的证书验证&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.7910798122065728&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQcqKwWicEmibbegiaWibaBxkQqugm4jdia8CkrzdALLk4mKtzCIRTwFgVFDw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1704&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;RestTemplateBuilder&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;在下载的过程中，我们需要知道当前下载的速度是多少，所以需要定义一个显示下载速度的接口&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ5fUMV5ICxqkVzwdjA12Pf9ia4pYKiaYaawk4P7FK0ImXiaDc0E6AQy5Kw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1064&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;DisplayDownloadSpeed&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为计算下载速度，我们需要知道每秒传输的字节数是多少，为了监控传输数据的过程，我们需要了解SpringMVC中的接口&lt;code&gt;ResponseExtractor&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4767277856135402&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQLkxLMKv1NHuSHAPMwR0jQ9kBjUNe87XV8SuianhbqaXpwS5ON8Bibgpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1418&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;ResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该接口只有一个方法，当客户端和服务器端连接建立之后，会调用这个方法，我们可以在这个方法中监控下载的速度。&lt;/p&gt;&lt;ol start=&quot;4&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;DisplayDownloadSpeed&lt;/code&gt;接口的抽象实现 &lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.015625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQkfoic5voia3sJTbNAo9EdiagertfyWd8LWorOPNYfl5BtdTiaqnxm9luNQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2048&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;5&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;整个项目主要涉及到的类图&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6476014760147601&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ8alvn1Tv5Mur5g4XKuvc6Aj5nWmAnxbwNYTcib2Z9NaH3TZyrgnaQpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1084&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;简单的文件下载器&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里使用的是restTemplate调用&lt;code&gt;execute&lt;/code&gt;, 先文件获取到字节数组, 再将字节数组直接写到目标文件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里我们需要注意的点是: 这种方式会将文件的字节数组全部放入内存中, 及其消耗资源；我们来看看如何实现。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;创建&lt;code&gt;ByteArrayResponseExtractor&lt;/code&gt;类继承&lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5386934673366834&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQt0NUeNuxEHTO3MLibrerDJdZnmSu376tJAe8n0uwu0xb8auK8bdnibAw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1990&quot;/&gt;&lt;figcaption&gt;&lt;span/&gt;ByteArrayResponseExtractor&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;调用&lt;code&gt;restTemplate.execute&lt;/code&gt;执行下载，保存字节数据到文件中&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.22433862433862434&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQnhV7RhYX8bGc6cib0upHF9E8j5Wvje9Oic80KTpyQPoza2ZiaVjANcVfA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1890&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1972534332084894&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQicpGkQ03NMyDbhAZcszJ8fqCPK04W7FgAhhrJChGBVtF6Vfhs7pxU6w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1602&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5071174377224199&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQovibbCAicGo3g2bafgmKmfSqNiaJ75ibRWpNZyibV2FSJSAaYIARunkciaaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1124&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行一段时间之后，我们可以看到内存已经使用了800M左右，所以这种方式只能使用于小文件的下载，如果我们下载几G的大文件，内存肯定是不够用的。至于下载时间，因为文件太大也没有等下载完成就结束了程序。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;单线程大文件下载&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的方式只能下载小的文件，那大文件的下载我们该用什么方式呢？我们可以把流输出到文件而不是内存中。接下来我们来实现我们大文件的下载。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;创建&lt;code&gt;FileResponseExtractor&lt;/code&gt;类继承&lt;code&gt;AbstractDisplayDownloadSpeedResponseExtractor&lt;/code&gt;，把流输出到文件中&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6082474226804123&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQTEaNYWwmj08h1YkHw5ev7qZCWea5iaLQfusibC6OibtemNDTFEFSsaLvw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1940&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;文件下载器，先把流输出到临时下载文件（xxxxx.download），下载完成后在重命名文件&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.31890179514255546&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQVZGLic8EY5x8chrK1a4NCjDEnn5QRBsHHyV22AJu8x6u0ibh5B5jjqoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1894&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20572916666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFkIPOZWOW7J2ypPdGVS81oHJGgD8icLGGicHnnfibOicK7Bxic8yqACbtg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1536&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行一段时间之后，我们再看看下内存的使用情况，发现这种方式内存消耗较少，效果比较理想，下载时间：199s&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4954954954954955&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ4c2icBrvwhibR1T6TsGIXZ3GVwj7do3dKnBYnZ0gIdu31Gl7BOiaT9btg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1110&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.21212121212121213&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYeJhTsDkLdmzezcNKDnppibk6GWcD52YjKeWNeoH2ia8sx4Q1ZFRoLbg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1452&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;多线程文件下载&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果服务器不限速的话，通常能够把自己本地的带宽给跑满，那么使用单线程下载就够了，但是如果遇到服务器限速，下载速度远小于自己本地的带宽，那么可以考虑使用多线程下载。多线程我们使用&lt;code&gt;CompletableFuture&lt;/code&gt;（可以参考之前的文章 《CompletableFuture让你的代码免受阻塞之苦》）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现多线程文件下载的基本流程：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;首先我们通过Http协议的Head方法获取到文件的总大小&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;然后根据设置的线程数均分文件的大小，计算每个线程的下载的字节数据开始位置和结束位置&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;开启线程，设置HTTP请求头Range信息，开始下载数据到临时文件&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;下载完成后把每个线程下载完成的临时文件合并成一个文件&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;完成代码如下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0714985308521057&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQ0YiaqOUMYt63dubaia7jdPDbYrWuia0zqfbuCySKFTkJEKkK9okibRSITw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2042&quot;/&gt;&lt;/figure&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;开启30个线程测试下载819M的idea&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20441347270615565&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQOJ57WRO47iaAyPgNsnRnuaicY7WpicLqXLnyxZ24gcLv5MG7cN3OKojrQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1722&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4865350089766607&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQcwpIfrZQzicVNuTBIK9sprabz05XZejSlqbPTzadcyyf1Ee31zgd9cA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1114&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2981651376146789&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQfWicrJww3VUibsg2nxo306EV3ZsBNQhJCCbgTr66wl5ZsKDSEa9qbDRg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1308&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从执行的结果上来看，因为开启了30个线程同时在下载，内存的占用要比单线程消耗的多，但是也在接受范围内，下载时间：81s，速度提升2.5倍，这是因为idea的下载服务器没有限速，本次多线程速度的提升仅仅是在充分的压榨本地的带宽，所以提示的幅度不大。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;单线程下载和对线程下载对比测试&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为云盘对单个线程的下载速度做了限制，大概是在100kb，所以我们使用云盘的下载链接，来测试多线程和单线程的下载速度。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;测试云盘中 46M 的文件的下载速度，自己本地最大下载速度 2M&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;获取文件的下载地址&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.27808988764044945&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQtppmZFbB45LYtFnhVA7xlubiaQBqic8c7NqeXY0JOolJiawEpvt4uiaUJQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1424&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;❝&lt;/span&gt;&lt;p&gt;注意：从浏览器中获取的链接需要先使用URLDecode解码，否则下载会失败，并且云盘文件的下载链接是有时效性的，过期后就不能在下载，需要重新生成下载链接&lt;/p&gt;&lt;span&gt;❞&lt;/span&gt;&lt;/blockquote&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;测试单线程下载文件&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.40326633165829145&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQYPqufy2ZRcMwicDCI8GmEvPXV3ibnh1m1y8DtzjKvNjMb6OWDAonoo4g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1592&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行的结果可以看出，云盘对单线程的下载限速真的是丧心病狂， 46M的文件下载需要耗时：600s&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;测试多线程下载文件&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了充分的压榨网速，找出最合适的线程数，所以测试了不同线程数的下载速度&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;线程数&lt;/th&gt;&lt;th&gt;下载总耗时&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;60s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;20&lt;/td&gt;&lt;td&gt;30s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;30&lt;/td&gt;&lt;td&gt;21s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;40&lt;/td&gt;&lt;td&gt;15s&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;13s&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从测试的结果上来看，对于自己的运行环境把线程数设置在30个左右比较合适&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.30311231393775373&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ggRgNal7zGicf6vk3kaemSzAD7bHhK4yQEFZmndGed2WKA9ZZslhWGhS7jFMibKskmicqVRCEt3iaC2tGb5cLZo9WA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1478&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;最后（点关注，不迷路）&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;文中或许会存在或多或少的不足、错误之处，有建议或者意见也非常欢迎大家在评论交流。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后，&lt;strong&gt;「创作不易，请不要白嫖」&lt;/strong&gt;，希望朋友们可以&lt;strong&gt;「点赞」&lt;/strong&gt;，因为这些就是我分享的全部动力来源🙏&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9c1aeec510838f3132c3765659b95438</guid>
<title>通过 httpcmd 来灵活的管理的云服务器再也不担心被轻易 F4 了</title>
<link>https://toutiao.io/k/q57m20v</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;p cid=&quot;n0&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;事出有因，前俩天管理的一台云服务器有些异常，登录上去看了些有很多的ssh破解记录。当然我有自动防护和封地址的脚本在跑。但是只要端口开着肯定这样的请求肯定还是避免不了的。于是乎萌生了使用的时候打开防火墙，不使用的时候关闭的想法，因此老脑袋一拍用go撸了个小工具。通过http远程启动关闭需要的服务，执行命令之类的想法。我关了的主机比较多因此通过库配置命令，但是对于各位看官就不一定实用了，因此我又简单的改了下通过文件配置的。废话不多少走起。&lt;/span&gt;&lt;/p&gt;&lt;h6 cid=&quot;n6&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;配置文件&lt;/span&gt;&lt;/h6&gt;&lt;p cid=&quot;n12&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;简单的描述下，通过配置文件配置验证密钥，日志路径，已经执行命令的映射列表&lt;/span&gt;&lt;/p&gt;&lt;pre mdtype=&quot;fences&quot; cid=&quot;n8&quot; lang=&quot;json&quot; spellcheck=&quot;false&quot;&gt; &lt;span role=&quot;presentation&quot;&gt;{&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;&quot;akey&quot;&lt;/span&gt;:&lt;span&gt;&quot;your&#x27;skey&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;&quot;logpath&quot;&lt;/span&gt;:&lt;span&gt;&quot;/var/log/httpcmd.log&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;&quot;cmdlist&quot;&lt;/span&gt;:{&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;&quot;cmd1&quot;&lt;/span&gt;:&lt;span&gt;&quot;ipconfig&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;&quot;pingbd&quot;&lt;/span&gt;:&lt;span&gt;&quot;ping www.baidu.com&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;&quot;firewall-list&quot;&lt;/span&gt;:&lt;span&gt;&quot;firewall-cmd --list-all&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;&quot;open22&quot;&lt;/span&gt;: &lt;span&gt;&quot;firewall-cmd --permanent --add-port=22/tcp &amp;amp;&amp;amp; firewall-cmd --reload&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;&quot;close22&quot;&lt;/span&gt;: &lt;span&gt;&quot;firewall-cmd --permanent --remove-port=22/tcp &amp;amp;&amp;amp; firewall-cmd --reload&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    }&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;h6 mdtype=&quot;heading&quot; cid=&quot;n10&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;实现代码&lt;/span&gt;&lt;/h6&gt;&lt;p cid=&quot;n17&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;就一个文件，简单的一百多行代码，编译不用多数了吧。&lt;/span&gt;&lt;/p&gt;&lt;pre mdtype=&quot;fences&quot; cid=&quot;n13&quot; lang=&quot;go&quot; spellcheck=&quot;false&quot;&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;package&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; (&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;crypto/md5&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;encoding/hex&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;encoding/json&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;flag&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;fmt&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;github.com/google/logger&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;io/ioutil&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;net/http&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;os&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;os/exec&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;runtime&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;&quot;time&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;var&lt;/span&gt; &lt;span&gt;verbose&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;flag&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Bool&lt;/span&gt;(&lt;span&gt;&quot;verbose&quot;&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;, &lt;span&gt;&quot;print info level logs to stdout&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;var&lt;/span&gt; &lt;span&gt;akey&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;var&lt;/span&gt; &lt;span&gt;cmdlist&lt;/span&gt; &lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]&lt;span&gt;interface&lt;/span&gt;{}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;var&lt;/span&gt; &lt;span&gt;shell&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;func&lt;/span&gt; &lt;span&gt;main&lt;/span&gt;() {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;sysType&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;runtime&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;GOOS&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;jsonConfigFile&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;sysType&lt;/span&gt; &lt;span&gt;==&lt;/span&gt; &lt;span&gt;&quot;linux&quot;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;jsonConfigFile&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;&quot;/etc/httpcmd.conf&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;shell&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;sysType&lt;/span&gt; &lt;span&gt;==&lt;/span&gt; &lt;span&gt;&quot;windows&quot;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;jsonConfigFile&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;&quot;C:/httpcmd.conf&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;tempMap&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;make&lt;/span&gt;(&lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]&lt;span&gt;interface&lt;/span&gt;{})&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;content&lt;/span&gt;, &lt;span&gt;err&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;ioutil&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;ReadFile&lt;/span&gt;(&lt;span&gt;jsonConfigFile&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;err&lt;/span&gt; &lt;span&gt;!=&lt;/span&gt; &lt;span&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;panic&lt;/span&gt;(&lt;span&gt;err&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;err&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;json&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Unmarshal&lt;/span&gt;(&lt;span&gt;content&lt;/span&gt;, &lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;tempMap&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;akey&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;tempMap&lt;/span&gt;[&lt;span&gt;&quot;akey&quot;&lt;/span&gt;]&lt;span&gt;.&lt;/span&gt;(&lt;span&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logPath&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;tempMap&lt;/span&gt;[&lt;span&gt;&quot;logpath&quot;&lt;/span&gt;]&lt;span&gt;.&lt;/span&gt;(&lt;span&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;cmdlist&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;tempMap&lt;/span&gt;[&lt;span&gt;&quot;cmdlist&quot;&lt;/span&gt;]&lt;span&gt;.&lt;/span&gt;(&lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]&lt;span&gt;interface&lt;/span&gt;{})&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//for k, v := range cmdlist {&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//fmt.Println(&quot;============&quot;, k, &quot;==================&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;////responseBody := RunCmd()&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;////fmt.Println(responseBody)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//command := v.(string)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//responseBody := RunCmd(command, shell)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//fmt.Println(responseBody)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;lf&lt;/span&gt;, &lt;span&gt;err&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;os&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;OpenFile&lt;/span&gt;(&lt;span&gt;logPath&lt;/span&gt;, &lt;span&gt;os&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;O_CREATE&lt;/span&gt; &lt;span&gt;|&lt;/span&gt; &lt;span&gt;os&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;O_WRONLY&lt;/span&gt; &lt;span&gt;|&lt;/span&gt; &lt;span&gt;os&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;O_APPEND&lt;/span&gt;, &lt;span&gt;0660&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;err&lt;/span&gt; &lt;span&gt;!=&lt;/span&gt; &lt;span&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Fatalf&lt;/span&gt;(&lt;span&gt;&quot;Failed to open log file: %v&quot;&lt;/span&gt;, &lt;span&gt;err&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;defer&lt;/span&gt; &lt;span&gt;lf&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Close&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;defer&lt;/span&gt; &lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Init&lt;/span&gt;(&lt;span&gt;&quot;LoggerExample&quot;&lt;/span&gt;, &lt;span&gt;*&lt;/span&gt;&lt;span&gt;verbose&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;, &lt;span&gt;lf&lt;/span&gt;)&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Close&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;http&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;HandleFunc&lt;/span&gt;(&lt;span&gt;&quot;/httpcmd&quot;&lt;/span&gt;, &lt;span&gt;httpCmd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//设置监听的端口&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;errs&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;http&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;ListenAndServe&lt;/span&gt;(&lt;span&gt;&quot;:10000&quot;&lt;/span&gt;, &lt;span&gt;nil&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;errs&lt;/span&gt; &lt;span&gt;!=&lt;/span&gt; &lt;span&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;(&lt;span&gt;&quot;start error :&quot;&lt;/span&gt;, &lt;span&gt;errs&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;(&lt;span&gt;&quot;service is started&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;func&lt;/span&gt; &lt;span&gt;md5V&lt;/span&gt;(&lt;span&gt;str&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;) &lt;span&gt;string&lt;/span&gt;  {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;h&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;md5&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;New&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;h&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Write&lt;/span&gt;([]&lt;span&gt;byte&lt;/span&gt;(&lt;span&gt;str&lt;/span&gt;))&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;hex&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;EncodeToString&lt;/span&gt;(&lt;span&gt;h&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Sum&lt;/span&gt;(&lt;span&gt;nil&lt;/span&gt;))&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;func&lt;/span&gt; &lt;span&gt;httpCmd&lt;/span&gt;(&lt;span&gt;w&lt;/span&gt; &lt;span&gt;http&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;ResponseWriter&lt;/span&gt;, &lt;span&gt;r&lt;/span&gt; &lt;span&gt;*&lt;/span&gt;&lt;span&gt;http&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Request&lt;/span&gt;) {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;r&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;ParseForm&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;key&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;r&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Form&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Get&lt;/span&gt;(&lt;span&gt;&quot;key&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;item&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;r&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Form&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Get&lt;/span&gt;(&lt;span&gt;&quot;item&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;timeStr&lt;/span&gt;:&lt;span&gt;=&lt;/span&gt;&lt;span&gt;time&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Now&lt;/span&gt;()&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Format&lt;/span&gt;(&lt;span&gt;&quot;2006010215&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;fmt&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Println&lt;/span&gt;(&lt;span&gt;timeStr&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;responseBody&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;&quot;Invalid request&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//通过简单的md5校验实现简单层面的安全控制&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;key&lt;/span&gt; &lt;span&gt;==&lt;/span&gt; &lt;span&gt;md5V&lt;/span&gt;(&lt;span&gt;akey&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;&quot;:&quot;&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;timeStr&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;&quot;:&quot;&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;item&lt;/span&gt;) {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;realCmd&lt;/span&gt;, &lt;span&gt;ok&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;cmdlist&lt;/span&gt;[&lt;span&gt;item&lt;/span&gt;]; &lt;span&gt;ok&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;command&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;realCmd&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;(&lt;span&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;responseBody&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;RunCmd&lt;/span&gt;(&lt;span&gt;command&lt;/span&gt;, &lt;span&gt;shell&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;fmt&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Fprintln&lt;/span&gt;(&lt;span&gt;w&lt;/span&gt;, &lt;span&gt;responseBody&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;func&lt;/span&gt; &lt;span&gt;RunCmd&lt;/span&gt;(&lt;span&gt;cmd&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;, &lt;span&gt;shell&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt;) &lt;span&gt;string&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;(&lt;span&gt;&quot;cmd=&amp;gt; &quot;&lt;/span&gt;,&lt;span&gt;cmd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;shell&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;out&lt;/span&gt;, &lt;span&gt;err&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;exec&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Command&lt;/span&gt;(&lt;span&gt;&quot;bash&quot;&lt;/span&gt;, &lt;span&gt;&quot;-c&quot;&lt;/span&gt;, &lt;span&gt;cmd&lt;/span&gt;)&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Output&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;err&lt;/span&gt; &lt;span&gt;!=&lt;/span&gt; &lt;span&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;(&lt;span&gt;&quot;InvalidCmd=&amp;gt; &quot;&lt;/span&gt;,&lt;span&gt;cmd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//panic(&quot;some error found&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;(&lt;span&gt;out&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;} &lt;span&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;out&lt;/span&gt;, &lt;span&gt;err&lt;/span&gt; :&lt;span&gt;=&lt;/span&gt; &lt;span&gt;exec&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Command&lt;/span&gt;(&lt;span&gt;&quot;cmd&quot;&lt;/span&gt;, &lt;span&gt;&quot;/C&quot;&lt;/span&gt;, &lt;span&gt;cmd&lt;/span&gt;)&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Output&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;err&lt;/span&gt; &lt;span&gt;!=&lt;/span&gt; &lt;span&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;logger&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;(&lt;span&gt;&quot;InvalidCmd=&amp;gt; &quot;&lt;/span&gt;,&lt;span&gt;cmd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;//panic(&quot;some error found&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span role=&quot;presentation&quot; cm-text=&quot;&quot;&gt;    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;(&lt;span&gt;out&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;/pre&gt;&lt;h6 mdtype=&quot;heading&quot; cid=&quot;n15&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;服务器配置&lt;/span&gt;&lt;/h6&gt;&lt;p cid=&quot;n18&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;编译完后启动服务，并通过nginx映射的一个别人想不到的路径上。&lt;/span&gt;&lt;/p&gt;&lt;pre mdtype=&quot;fences&quot; cid=&quot;n20&quot; lang=&quot;bash&quot; spellcheck=&quot;false&quot;&gt; &lt;span role=&quot;presentation&quot;&gt;location /xxxpath {&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;proxy_pass http://localhost:10000/;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;p cid=&quot;n22&quot; mdtype=&quot;paragraph&quot;&gt;&lt;/p&gt;&lt;h6 mdtype=&quot;heading&quot; cid=&quot;n2&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;客户端实用&lt;/span&gt;&lt;/h6&gt;&lt;p cid=&quot;n24&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;此处我写了python脚本可以实用&lt;/span&gt;&lt;/p&gt;&lt;pre mdtype=&quot;fences&quot; cid=&quot;n26&quot; lang=&quot;python&quot; spellcheck=&quot;false&quot;&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;# coding:utf-8&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;time&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;sys&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;requests&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;from&lt;/span&gt; &lt;span&gt;bs4&lt;/span&gt; &lt;span&gt;import&lt;/span&gt; &lt;span&gt;BeautifulSoup&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;hashlib&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;time&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;headers&lt;/span&gt; = {&lt;span&gt;&quot;Accept&quot;&lt;/span&gt;: &lt;span&gt;&quot;text/html,application/xhtml+xml,application/xml;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;           &lt;span&gt;&quot;Accept-Encoding&quot;&lt;/span&gt;: &lt;span&gt;&quot;gzip&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;           &lt;span&gt;&quot;Accept-Language&quot;&lt;/span&gt;: &lt;span&gt;&quot;zh-CN,zh;q=0.8&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;           &lt;span&gt;&quot;User-Agent&quot;&lt;/span&gt;: &lt;span&gt;&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) &quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;md5str&lt;/span&gt;(&lt;span&gt;*&lt;/span&gt;&lt;span&gt;args&lt;/span&gt;):&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;datastr&lt;/span&gt; = &lt;span&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;for&lt;/span&gt; &lt;span&gt;x&lt;/span&gt; &lt;span&gt;in&lt;/span&gt; &lt;span&gt;args&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;datastr&lt;/span&gt; = &lt;span&gt;datastr&lt;/span&gt; &lt;span&gt;+&lt;/span&gt; &lt;span&gt;str&lt;/span&gt;(&lt;span&gt;x&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;m&lt;/span&gt; = &lt;span&gt;hashlib&lt;/span&gt;.&lt;span&gt;md5&lt;/span&gt;(&lt;span&gt;datastr&lt;/span&gt;.&lt;span&gt;encode&lt;/span&gt;(&lt;span&gt;encoding&lt;/span&gt;=&lt;span&gt;&#x27;utf-8&#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;m&lt;/span&gt;.&lt;span&gt;hexdigest&lt;/span&gt;()&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;__name__&lt;/span&gt; == &lt;span&gt;&quot;__main__&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;pagecount&lt;/span&gt; = &lt;span&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;times&lt;/span&gt; = &lt;span&gt;time&lt;/span&gt;.&lt;span&gt;strftime&lt;/span&gt;(&lt;span&gt;&#x27;%Y%m%d%H&#x27;&lt;/span&gt;, &lt;span&gt;time&lt;/span&gt;.&lt;span&gt;localtime&lt;/span&gt;(&lt;span&gt;time&lt;/span&gt;.&lt;span&gt;time&lt;/span&gt;()))&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;qh_search&lt;/span&gt; = &lt;span&gt;&quot;http://xadress/nixiangbudao/httpcmd&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;cmd&lt;/span&gt; = &lt;span&gt;sys&lt;/span&gt;.&lt;span&gt;argv&lt;/span&gt;[&lt;span&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;akey&lt;/span&gt; = &lt;span&gt;&quot;meiyoumima&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;key&lt;/span&gt; = &lt;span&gt;md5str&lt;/span&gt;(&lt;span&gt;akey&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;&quot;:&quot;&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;times&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;&quot;:&quot;&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;cmd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;data&lt;/span&gt; = {&lt;span&gt;&#x27;item&#x27;&lt;/span&gt;:&lt;span&gt;cmd&lt;/span&gt;,&lt;span&gt;&#x27;key&#x27;&lt;/span&gt;:&lt;span&gt;key&lt;/span&gt;}&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;r&lt;/span&gt; = &lt;span&gt;requests&lt;/span&gt;.&lt;span&gt;post&lt;/span&gt;(&lt;span&gt;qh_search&lt;/span&gt;, &lt;span&gt;headers&lt;/span&gt;=&lt;span&gt;headers&lt;/span&gt;,&lt;span&gt;data&lt;/span&gt;=&lt;span&gt;data&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;if&lt;/span&gt; &lt;span&gt;r&lt;/span&gt;.&lt;span&gt;status_code&lt;/span&gt; == &lt;span&gt;200&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;r&lt;/span&gt;.&lt;span&gt;text&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;    &lt;span&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;        &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;&quot;request error code &quot;&lt;/span&gt;, &lt;span&gt;r&lt;/span&gt;.&lt;span&gt;status_code&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt; &lt;/span&gt;&lt;/pre&gt;&lt;h6 cid=&quot;n28&quot; mdtype=&quot;heading&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;实例&lt;/span&gt;&lt;/h6&gt;&lt;pre mdtype=&quot;fences&quot; cid=&quot;n32&quot; lang=&quot;bash&quot; spellcheck=&quot;false&quot;&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;# 打开22端口&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;python3 httpcmd.py open22&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;/&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;&lt;span&gt;# 关闭22端口&lt;/span&gt;&lt;/span&gt;&lt;br/&gt; &lt;span role=&quot;presentation&quot;&gt;python3 httpcmd.py close22&lt;/span&gt;&lt;/pre&gt;&lt;p&gt;&lt;span role=&quot;presentation&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>