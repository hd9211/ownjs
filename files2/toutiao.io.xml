<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>4ca53c7a1e397c0d15f3435f1c3de1e0</guid>
<title>滴滴开源的，基于 Golang 的流量录制回放工具</title>
<link>https://toutiao.io/k/gro6npy</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;profile_inner&quot;&gt;
                              &lt;strong class=&quot;profile_nickname&quot;&gt;开发者头条&lt;/strong&gt;
                              &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;/&gt;

                              &lt;p class=&quot;profile_meta&quot;&gt;
                              &lt;label class=&quot;profile_meta_label&quot;&gt;Weixin ID&lt;/label&gt;
                              &lt;span class=&quot;profile_meta_value&quot;&gt;kaifazhetoutiao&lt;/span&gt;
                              &lt;/p&gt;

                              &lt;p class=&quot;profile_meta&quot;&gt;
                              &lt;label class=&quot;profile_meta_label&quot;&gt;About Feature&lt;/label&gt;
                              &lt;span class=&quot;profile_meta_value&quot;&gt;程序员分享平台 | 官方应用下载地址：http://toutiao.io/download&lt;/span&gt;
                              &lt;/p&gt;
                              
                          &lt;/div&gt;
                          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>1b094ce67898ae7f4c156e75e99e2424</guid>
<title>Go 泛型是怎么实现的？</title>
<link>https://toutiao.io/k/rcwqayq</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;pre&gt;&lt;p class=&quot;line&quot;&gt;# command-line-arguments&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.Test STEXT &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;185&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x48 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.Test(SB), ABIInternal, $&lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.Test STEXT &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;185&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x48 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.Test(SB), ABIInternal, $&lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)CMPQSP, &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;(R14)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0004 &lt;span class=&quot;number&quot;&gt;00004&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $-&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0004 &lt;span class=&quot;number&quot;&gt;00004&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)JLS&lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x000a &lt;span class=&quot;number&quot;&gt;00010&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x000a &lt;span class=&quot;number&quot;&gt;00010&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)SUBQ$&lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, SP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x000e &lt;span class=&quot;number&quot;&gt;00014&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)MOVQBP, &lt;span class=&quot;number&quot;&gt;64&lt;/span&gt;(SP)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0013 &lt;span class=&quot;number&quot;&gt;00019&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)LEAQ&lt;span class=&quot;number&quot;&gt;64&lt;/span&gt;(SP), BP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0018 &lt;span class=&quot;number&quot;&gt;00024&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)FUNCDATA$&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, gclocals·&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;cdeccccebe80329f1fdbee7f5874cb(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0018 &lt;span class=&quot;number&quot;&gt;00024&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)FUNCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, gclocals·&lt;span class=&quot;number&quot;&gt;54241&lt;/span&gt;e171da8af6ae173d69da0236748(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0018 &lt;span class=&quot;number&quot;&gt;00024&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x001f &lt;span class=&quot;number&quot;&gt;00031&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;)XORLBX, BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0021 &lt;span class=&quot;number&quot;&gt;00033&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0021 &lt;span class=&quot;number&quot;&gt;00033&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0026 &lt;span class=&quot;number&quot;&gt;00038&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[int32](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x002d &lt;span class=&quot;number&quot;&gt;00045&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;)XORLBX, BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x002f &lt;span class=&quot;number&quot;&gt;00047&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.int32](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0034 &lt;span class=&quot;number&quot;&gt;00052&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[uint32](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x003b &lt;span class=&quot;number&quot;&gt;00059&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;)XORLBX, BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x003d &lt;span class=&quot;number&quot;&gt;00061&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;)NOP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0040 &lt;span class=&quot;number&quot;&gt;00064&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint32](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0045 &lt;span class=&quot;number&quot;&gt;00069&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[uint64](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x004c &lt;span class=&quot;number&quot;&gt;00076&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)XORLBX, BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x004e &lt;span class=&quot;number&quot;&gt;00078&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint64](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0053 &lt;span class=&quot;number&quot;&gt;00083&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[string](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x005a &lt;span class=&quot;number&quot;&gt;00090&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;)LEAQgo.string.&lt;span class=&quot;string&quot;&gt;&quot;hello&quot;&lt;/span&gt;(SB), BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0061 &lt;span class=&quot;number&quot;&gt;00097&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;)MOVL$&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, CX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0066 &lt;span class=&quot;number&quot;&gt;00102&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.string](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x006b &lt;span class=&quot;number&quot;&gt;00107&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[struct{}](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0072 &lt;span class=&quot;number&quot;&gt;00114&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{}](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0077 &lt;span class=&quot;number&quot;&gt;00119&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;time.Now(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x007c &lt;span class=&quot;number&quot;&gt;00124&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQAX, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..autotmp_0+&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;(SP)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0081 &lt;span class=&quot;number&quot;&gt;00129&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQBX, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..autotmp_0+&lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;(SP)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0086 &lt;span class=&quot;number&quot;&gt;00134&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQCX, &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..autotmp_0+&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;(SP)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x008b &lt;span class=&quot;number&quot;&gt;00139&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQCX, DI&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x008e &lt;span class=&quot;number&quot;&gt;00142&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQBX, CX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0091 &lt;span class=&quot;number&quot;&gt;00145&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)MOVQAX, BX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0094 &lt;span class=&quot;number&quot;&gt;00148&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)LEAQ&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;..dict.echo[time.Time](SB), AX&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x009b &lt;span class=&quot;number&quot;&gt;00155&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)NOP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00a0 &lt;span class=&quot;number&quot;&gt;00160&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{ time.wall uint64; time.ext int64; time.loc *time.Location }](SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00a5 &lt;span class=&quot;number&quot;&gt;00165&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)MOVQ&lt;span class=&quot;number&quot;&gt;64&lt;/span&gt;(SP), BP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00aa &lt;span class=&quot;number&quot;&gt;00170&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)ADDQ$&lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, SP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00ae &lt;span class=&quot;number&quot;&gt;00174&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)RET&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00af &lt;span class=&quot;number&quot;&gt;00175&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;)NOP&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00af &lt;span class=&quot;number&quot;&gt;00175&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00af &lt;span class=&quot;number&quot;&gt;00175&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $-&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00af &lt;span class=&quot;number&quot;&gt;00175&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;runtime&lt;/span&gt;.morestack_noctxt(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00b4 &lt;span class=&quot;number&quot;&gt;00180&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, $-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00b4 &lt;span class=&quot;number&quot;&gt;00180&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;)JMP&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;268&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c2 &lt;span class=&quot;number&quot;&gt;00194&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)MOVQDI, SI&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.int32] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;266&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.int32](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00bd &lt;span class=&quot;number&quot;&gt;00189&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)MOVL$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, DI&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c2 &lt;span class=&quot;number&quot;&gt;00194&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)MOVQDI, SI&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint32] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;266&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint32](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint64] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;268&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x10 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.uint64](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c2 &lt;span class=&quot;number&quot;&gt;00194&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)MOVQDI, SI&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.string] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;295&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x18 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.string](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00d6 &lt;span class=&quot;number&quot;&gt;00214&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00d6 &lt;span class=&quot;number&quot;&gt;00214&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{}] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;208&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x8 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x88 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{}](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0093 &lt;span class=&quot;number&quot;&gt;00147&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)PCDATA$&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0093 &lt;span class=&quot;number&quot;&gt;00147&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;fmt.Sprintf(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;    .................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00cb &lt;span class=&quot;number&quot;&gt;00203&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)JMP&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{ time.wall uint64; time.ext int64; time.loc *time.Location }] STEXT dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;364&lt;/span&gt; args=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x20 locals=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;xa0 funcid=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00000&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)TEXT&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{ time.wall uint64; time.ext int64; time.loc *time.Location }](SB), DUPOK|ABIInternal, $&lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00c5 &lt;span class=&quot;number&quot;&gt;00197&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)CMPL&lt;span class=&quot;keyword&quot;&gt;runtime&lt;/span&gt;.writeBarrier(SB), $&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00cc &lt;span class=&quot;number&quot;&gt;00204&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)JEQ&lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00ce &lt;span class=&quot;number&quot;&gt;00206&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)JMP&lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00d0 &lt;span class=&quot;number&quot;&gt;00208&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)MOVQAX, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;(CX)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00d4 &lt;span class=&quot;number&quot;&gt;00212&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)JMP&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x00d6 &lt;span class=&quot;number&quot;&gt;00214&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;)&lt;span class=&quot;keyword&quot;&gt;CALL&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;runtime&lt;/span&gt;.gcWriteBarrier(SB)&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.................&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0167 &lt;span class=&quot;number&quot;&gt;00359&lt;/span&gt; (&lt;span class=&quot;regexp&quot;&gt;/Users/&lt;/span&gt;chaoyuepan&lt;span class=&quot;regexp&quot;&gt;/go/&lt;/span&gt;src&lt;span class=&quot;regexp&quot;&gt;/github.com/&lt;/span&gt;smallnest&lt;span class=&quot;regexp&quot;&gt;/study/&lt;/span&gt;type_parameter&lt;span class=&quot;regexp&quot;&gt;/generic/g&lt;/span&gt;eneric.go:&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;)JMP&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;/&gt;&lt;p class=&quot;line&quot;&gt;...............&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.string].stkobj SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.......&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.string].arginfo1 SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.......           ..........&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{}].stkobj SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.......&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{}].arginfo1 SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;.......&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{ time.wall uint64; time.ext int64; time.loc *time.Location }].stkobj SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;......&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;.echo[.shape.struct{ time.wall uint64; time.ext int64; time.loc *time.Location }].arginfo1 SRODATA &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; dupok &lt;span class=&quot;keyword&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;x0000 &lt;span class=&quot;number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; fe &lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; fd ff                 ...........&lt;/p&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>deb55603e0f669dd861abaf2a22a9da6</guid>
<title>Viddy：替代 watch 命令</title>
<link>https://toutiao.io/k/aq2nivr</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;article class=&quot;markdown-body entry-content container-lg&quot; itemprop=&quot;text&quot;&gt;&lt;h1&gt;&lt;a id=&quot;user-content-viddy&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#viddy&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Viddy&lt;/h1&gt;
&lt;p align=&quot;center&quot;&gt;
&lt;a target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; href=&quot;/sachaos/viddy/blob/master/images/logo.png&quot;&gt;&lt;img src=&quot;/sachaos/viddy/raw/master/images/logo.png&quot; alt=&quot;viddy&quot; title=&quot;viddy&quot;/&gt;&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;Modern &lt;code&gt;watch&lt;/code&gt; command.&lt;/p&gt;
&lt;p&gt;Viddy well, gopher. Viddy well.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-demo&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#demo&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Demo&lt;/h2&gt;
&lt;p align=&quot;center&quot;&gt;
&lt;a target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; href=&quot;/sachaos/viddy/blob/master/images/demo.gif&quot;&gt;&lt;img src=&quot;/sachaos/viddy/raw/master/images/demo.gif&quot; alt=&quot;viddy&quot; title=&quot;viddy&quot;/&gt;&lt;/a&gt;
&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-features&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#features&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Basic features of original watch command.
&lt;ul&gt;
&lt;li&gt;Execute command periodically, and display the result.&lt;/li&gt;
&lt;li&gt;color output.&lt;/li&gt;
&lt;li&gt;diff highlight.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Time machine mode. &lt;g-emoji class=&quot;g-emoji&quot; alias=&quot;sunglasses&quot; fallback-src=&quot;https://github.githubassets.com/images/icons/emoji/unicode/1f60e.png&quot;&gt;😎&lt;/g-emoji&gt;
&lt;ul&gt;
&lt;li&gt;Rewind like video.&lt;/li&gt;
&lt;li&gt;Go to the past, and back to the future.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;See output in pager.&lt;/li&gt;
&lt;li&gt;Vim like keymaps.&lt;/li&gt;
&lt;li&gt;Search text.&lt;/li&gt;
&lt;li&gt;Suspend and restart execution.&lt;/li&gt;
&lt;li&gt;Run command in precise intervals forcibly.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-install&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#install&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Install&lt;/h2&gt;
&lt;h3&gt;&lt;a id=&quot;user-content-mac&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#mac&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Mac&lt;/h3&gt;
&lt;p&gt;...via &lt;a href=&quot;https://brew.sh&quot; rel=&quot;nofollow&quot;&gt;Homebrew&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell position-relative&quot; data-snippet-clipboard-copy-content=&quot;brew install sachaos/tap/viddy&amp;#10;&quot;&gt;&lt;pre&gt;brew install sachaos/tap/viddy&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;...via &lt;a href=&quot;https://www.macports.org&quot; rel=&quot;nofollow&quot;&gt;MacPorts&lt;/a&gt;:&lt;/p&gt;

&lt;h3&gt;&lt;a id=&quot;user-content-linux&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#linux&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Linux&lt;/h3&gt;
&lt;div class=&quot;highlight highlight-source-shell position-relative&quot; data-snippet-clipboard-copy-content=&quot;wget -O viddy.tar.gz https://github.com/sachaos/viddy/releases/download/v0.1.8/viddy_0.1.8_Linux_x86_64.tar.gz &amp;amp;&amp;amp; tar xvf viddy.tar.gz &amp;amp;&amp;amp; mv viddy /usr/local/bin&amp;#10;&quot;&gt;&lt;pre&gt;wget -O viddy.tar.gz https://github.com/sachaos/viddy/releases/download/v0.1.8/viddy_0.1.8_Linux_x86_64.tar.gz &lt;span class=&quot;pl-k&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tar xvf viddy.tar.gz &lt;span class=&quot;pl-k&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; mv viddy /usr/local/bin&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;&lt;a id=&quot;user-content-go&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#go&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Go&lt;/h3&gt;
&lt;div class=&quot;highlight highlight-source-shell position-relative&quot; data-snippet-clipboard-copy-content=&quot;go install github.com/sachaos/viddy@latest&amp;#10;&quot;&gt;&lt;pre&gt;go install github.com/sachaos/viddy@latest&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Download from &lt;a href=&quot;https://github.com/sachaos/viddy/releases&quot;&gt;release page&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-keymaps&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#keymaps&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Keymaps&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;key&lt;/th&gt;
&lt;th/&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;SPACE&lt;/td&gt;
&lt;td&gt;Toggle time machine mode&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s&lt;/td&gt;
&lt;td&gt;Toggle suspend execution&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;d&lt;/td&gt;
&lt;td&gt;Toggle diff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;t&lt;/td&gt;
&lt;td&gt;Toggle header display&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/&lt;/td&gt;
&lt;td&gt;Search text&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;j&lt;/td&gt;
&lt;td&gt;Pager: next line&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;k&lt;/td&gt;
&lt;td&gt;Pager: previous line&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Control-F&lt;/td&gt;
&lt;td&gt;Pager: page down&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Control-B&lt;/td&gt;
&lt;td&gt;Pager: page up&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;g&lt;/td&gt;
&lt;td&gt;Pager: go to top of page&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift-G&lt;/td&gt;
&lt;td&gt;Pager: go to bottom of page&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift-J&lt;/td&gt;
&lt;td&gt;(Time machine mode) Go to the past&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift-K&lt;/td&gt;
&lt;td&gt;(Time machine mode) Back to the future&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift-F&lt;/td&gt;
&lt;td&gt;(Time machine mode) Go to more past&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift-B&lt;/td&gt;
&lt;td&gt;(Time machine mode) Back to more future&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-what-is-viddy-&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#what-is-viddy-&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;What is &quot;viddy&quot; ?&lt;/h2&gt;
&lt;p&gt;&quot;viddy&quot; is Nadsat word meaning to see.
Nadsat is fictional argot of gangs in the violence movie &quot;A Clockwork Orange&quot;.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;user-content-credits&quot; class=&quot;anchor&quot; aria-hidden=&quot;true&quot; href=&quot;#credits&quot;&gt;&lt;svg class=&quot;octicon octicon-link&quot; viewbox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;Credits&lt;/h2&gt;
&lt;p&gt;The gopher&#x27;s logo of viddy is licensed under the Creative Commons 3.0 Attributions license.&lt;/p&gt;
&lt;p&gt;The original Go gopher was designed by &lt;a href=&quot;https://reneefrench.blogspot.com/&quot; rel=&quot;nofollow&quot;&gt;Renee French&lt;/a&gt;.&lt;/p&gt;
&lt;/article&gt;
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>2099d730b647dd00cb900ff84dccca64</guid>
<title>​大概几集下饭剧时间就能懂的 Vue3 原理</title>
<link>https://toutiao.io/k/w4obhlb</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大概几集下饭剧时间就能懂的VUE3原理&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大家好，我是卡颂。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最近中午没胃口，找来&lt;code&gt;VUE&lt;/code&gt;源码相关视频来当下饭剧。几顿饭下去，人胖了，&lt;code&gt;VUE&lt;/code&gt;也整明白了。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.96&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQK20Zvboaia31ibs3dcAZEW80DvKNnicDFXAd1D8Mmbaib3fYCUloFxkDFg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;350&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这篇文章为你带来一份&lt;code&gt;VUE3&lt;/code&gt;原理速成指南。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;模块划分&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果我们用&lt;strong&gt;「VUE的模版语法」&lt;/strong&gt;定义：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;hello&lt;span&gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最终&lt;code&gt;VUE&lt;/code&gt;会帮我们在浏览器中渲染对应的&lt;code&gt;DOM节点&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这之间对这段节点的描述会经历4次变化，横跨&lt;strong&gt;「编译时」&lt;/strong&gt;与&lt;strong&gt;「运行时」&lt;/strong&gt;：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.48428571428571426&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQnzzqFxYEBicdnI0YbmvCqqVjsp3xBv71gMDGiaHQQJsNNUTfFlyWmmqw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1400&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;「模版语法」&lt;/strong&gt;在编译时会被&lt;strong&gt;「编译器」&lt;/strong&gt;转化为&lt;strong&gt;「render函数」&lt;/strong&gt;，类似：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;render(h) {&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; h(&lt;span&gt;&#x27;div&#x27;&lt;/span&gt;, &lt;span&gt;&#x27;hello&#x27;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在运行时，&lt;strong&gt;「render函数」&lt;/strong&gt;执行后返回的&lt;strong&gt;「h函数的执行结果」&lt;/strong&gt;就是&lt;code&gt;VNode&lt;/code&gt;（也就是&lt;code&gt;虚拟DOM&lt;/code&gt;），类似：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;tag&lt;/span&gt;: &lt;span&gt;&quot;div&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;children&lt;/span&gt;: [&lt;br/&gt;    {&lt;br/&gt;      &lt;span&gt;text&lt;/span&gt;: &lt;span&gt;&quot;Hello&quot;&lt;/span&gt;&lt;br/&gt;    }&lt;br/&gt;  ]&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最终，&lt;code&gt;VUE&lt;/code&gt;根据&lt;code&gt;VNode&lt;/code&gt;的信息，在浏览器渲染对应&lt;code&gt;DOM&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，是谁在驱动这一流程？&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;mount和patch&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;组件有两种不同的渲染逻辑：&lt;strong&gt;「首次渲染」&lt;/strong&gt;和&lt;strong&gt;「更新」&lt;/strong&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;「首次渲染」&lt;/strong&gt;意味着从无到有，比如上文的&lt;code&gt;VNode&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;tag&lt;/span&gt;: &lt;span&gt;&quot;div&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;children&lt;/span&gt;: [&lt;br/&gt;    {&lt;br/&gt;      &lt;span&gt;text&lt;/span&gt;: &lt;span&gt;&quot;Hello&quot;&lt;/span&gt;&lt;br/&gt;    }&lt;br/&gt;  ]&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可能对应如下&lt;code&gt;DOM&lt;/code&gt;操作：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;const&lt;/span&gt; node = &lt;span&gt;document&lt;/span&gt;.createElement(VNode.tag);&lt;br/&gt;node.textConent = &lt;span&gt;&#x27;Hello&#x27;&lt;/span&gt;;&lt;br/&gt;contanerDOM.appendChild(node);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;「更新」&lt;/strong&gt;则需要对比更新前后&lt;code&gt;VNode&lt;/code&gt;，对变化部分执行&lt;code&gt;DOM&lt;/code&gt;操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如，以上&lt;code&gt;VNode&lt;/code&gt;如果变为：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;tag&lt;/span&gt;: &lt;span&gt;&quot;div&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;children&lt;/span&gt;: [&lt;br/&gt;    {&lt;br/&gt;      &lt;span&gt;// text改变&lt;/span&gt;&lt;br/&gt;      &lt;span&gt;text&lt;/span&gt;: &lt;span&gt;&quot;world&quot;&lt;/span&gt;&lt;br/&gt;    }&lt;br/&gt;  ]&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;则最终执行：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;node.textContent = &lt;span&gt;&#x27;world&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;VUE&lt;/code&gt;的&lt;strong&gt;「首次渲染」&lt;/strong&gt;对应&lt;code&gt;mount&lt;/code&gt;模块，&lt;strong&gt;「更新」&lt;/strong&gt;对应&lt;code&gt;patch&lt;/code&gt;模块。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，&lt;code&gt;render函数&lt;/code&gt;执行后返回&lt;code&gt;VNode&lt;/code&gt;，根据情况不同，会走&lt;code&gt;mount&lt;/code&gt;或&lt;code&gt;patch&lt;/code&gt;的渲染逻辑：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.44881889763779526&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQ0fRRn6gjgic4NNZdTHS01FqicFZhgfBCWrSEYT6jZjZDKZmh7QRc6I9g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1524&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;如果想深入&lt;code&gt;虚拟DOM&lt;/code&gt;相关知识，推荐阅读&lt;span&gt;snabbdom&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;源码。这是个优秀的虚拟DOM库，&lt;code&gt;VUE2&lt;/code&gt;的&lt;code&gt;虚拟DOM&lt;/code&gt;部分就是&lt;code&gt;fork&lt;/code&gt;这个库改造的。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么是谁在什么时机调用了&lt;code&gt;render函数&lt;/code&gt;呢？&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;响应式更新&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在&lt;code&gt;VUE&lt;/code&gt;中，状态变化会实时反映到视图上，比如：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt; @&lt;span&gt;click&lt;/span&gt;=&lt;span&gt;&quot;count++&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;{{count}}&lt;span&gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;点击&lt;code&gt;div&lt;/code&gt;后：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;触发点击事件，&lt;code&gt;count&lt;/code&gt;变化&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;count&lt;/code&gt;变化触发回调，回调中更新视图&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当前我们已经知道第二步是由于触发了如下流程：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.44881889763779526&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQ0fRRn6gjgic4NNZdTHS01FqicFZhgfBCWrSEYT6jZjZDKZmh7QRc6I9g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1524&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以只需要建立&lt;code&gt;count&lt;/code&gt;变化到执行&lt;code&gt;render函数&lt;/code&gt;的联系即可。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体来说，我们希望实现&lt;code&gt;reactive&lt;/code&gt;及&lt;code&gt;watchEffect&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// 定义状态&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; state = reactive({&lt;span&gt;count&lt;/span&gt;: &lt;span&gt;0&lt;/span&gt;});&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 监听状态变化&lt;/span&gt;&lt;br/&gt;watchEffect(&lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(state.count);&lt;br/&gt;})&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 改变状态&lt;/span&gt;&lt;br/&gt;state.count++;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;reactive&lt;/code&gt;定义状态。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;watchEffect&lt;/code&gt;根据回调执行的情况决定监听哪些状态。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如&lt;code&gt;watchEffect&lt;/code&gt;回调执行了&lt;code&gt;console.log(state.count);&lt;/code&gt;，他就会监听&lt;code&gt;state&lt;/code&gt;的变化。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当执行&lt;code&gt;state.count++;&lt;/code&gt;，由于&lt;code&gt;watchEffect&lt;/code&gt;监听了&lt;code&gt;state&lt;/code&gt;的变化，则其回调会触发，打印&lt;code&gt;state.count&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这就是&lt;code&gt;Reactivity&lt;/code&gt;模块。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQTAIjzp7TzKR9KGIDDUtB0JYjBSjTClUqFgQggzwlvZo3HFdWGZb25A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;240&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;VUE官方推出了&lt;span&gt;VUE3响应式原理&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;课程讲解&lt;code&gt;Reactivity&lt;/code&gt;的实现，这是B站链接。如果经济允许，请支持&lt;span&gt;正版&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当实现了&lt;code&gt;Reactivity&lt;/code&gt;模块，我们就能将&lt;strong&gt;「组件状态」&lt;/strong&gt;与后续流程串联起来。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;刚才讲过，&lt;code&gt;render函数&lt;/code&gt;是编译器根据&lt;strong&gt;「模版语法」&lt;/strong&gt;生成的。在面对带状态的模版语法时，比如上文的&lt;code&gt;count&lt;/code&gt;：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt; @&lt;span&gt;click&lt;/span&gt;=&lt;span&gt;&quot;count++&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;{{count}}&lt;span&gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;render函数&lt;/code&gt;内的&lt;code&gt;count&lt;/code&gt;是响应式的（即：&lt;code&gt;count&lt;/code&gt;实际是&lt;code&gt;reactive({count: 0})&lt;/code&gt;）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么就能用&lt;code&gt;watchEffect&lt;/code&gt;监听&lt;code&gt;count&lt;/code&gt;的变化。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，在应用初始化时，会有类似逻辑：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;let&lt;/span&gt; isMounted = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;&lt;span&gt;let&lt;/span&gt; oldVNode;&lt;br/&gt;watchEffect(&lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt; (!isMounted) {&lt;br/&gt;    &lt;span&gt;// mount逻辑&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;// 调用render函数&lt;/span&gt;&lt;br/&gt;    oldVNode = component.render();&lt;br/&gt;    &lt;span&gt;// mount&lt;/span&gt;&lt;br/&gt;    mount(oldVNode);&lt;br/&gt;  } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;// patch逻辑&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;// 调用render函数&lt;/span&gt;&lt;br/&gt;    newVNode = component.render();&lt;br/&gt;    patch(oldVNode, newVNode);&lt;br/&gt;    oldVNode = newVNode;&lt;br/&gt;  }&lt;br/&gt;})&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其中&lt;code&gt;component.render()&lt;/code&gt;（render函数的执行）达到上文&lt;strong&gt;「监听状态变化」&lt;/strong&gt;的效果：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;// 监听状态变化&lt;/span&gt;&lt;br/&gt;watchEffect(&lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(state.count);&lt;br/&gt;})&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以，该组件内任何状态变化都会触发&lt;code&gt;watchEffect&lt;/code&gt;的执行，&lt;code&gt;watchEffect&lt;/code&gt;回调内会触发后续流程。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.739568345323741&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5Q3ZxrD2qNBQe7S5necrQyBtuww1H6qQub02CZBXW7PYLI3pj4ETUHNouf3iaE2xban5FbssgkKt06tZic2OSgfw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1390&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;总结&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;VUE3&lt;/code&gt;按原理大体可以划分为：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;VUE&lt;/code&gt;官方推出了&lt;span&gt;实现简易VUE3教程&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;，感兴趣的朋友可以去看看。如果有能力，记得去支持&lt;span&gt;正版&lt;/span&gt;&lt;sup&gt;[5]&lt;/sup&gt;哦。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;参考资料&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;snabbdom: &lt;span&gt;https://github.com/snabbdom/snabbdom&lt;/span&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;VUE3响应式原理: &lt;span&gt;https://www.bilibili.com/video/BV1SZ4y1x7a9/?spm_id_from=333.788.b_7265636f5f6c697374.6&lt;/span&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;正版: &lt;span&gt;https://www.vuemastery.com/free-weekend/?gclid=Cj0KCQjwpreJBhDvARIsAF1_BU16x7gElbhGqGzZZ1geo5RzOqz_PuaJzBM41jHcAAC6CPwPSPvo8G8aAkdhEALw_wcB&lt;/span&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;实现简易VUE3教程: &lt;span&gt;https://www.bilibili.com/video/BV1rC4y187Vw?p=10&lt;/span&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[5]&lt;/span&gt;&lt;p&gt;正版: &lt;span&gt;https://www.vuemastery.com/free-weekend/?gclid=Cj0KCQjwpreJBhDvARIsAF1_BU16x7gElbhGqGzZZ1geo5RzOqz_PuaJzBM41jHcAAC6CPwPSPvo8G8aAkdhEALw_wcB&lt;/span&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>f2ea3bb808e870228d50b14aafb7c154</guid>
<title>万字长文详解 PaaS toB 场景下 K8s 离线部署方案</title>
<link>https://toutiao.io/k/fq1crck</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;post-body&quot; itemprop=&quot;articleBody&quot;&gt;
&lt;p&gt;åœ¨ä¼�ä¸šç§�æœ‰äº‘ç�¯å¢ƒå½“ä¸­ï¼Œå‡ºäº�å¯¹æ•°æ�®å®‰å…¨çš„è€ƒè™‘ä»¥å�Šæ»¡è¶³ &lt;a href=&quot;http://www.djbh.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç½‘ç»œå®‰å…¨ç­‰çº§ä¿�æŠ¤&lt;/a&gt; çš„è¦�æ±‚ï¼Œå¾€å¾€ä¼šå¯¹å†…éƒ¨ç�¯å¢ƒä¸­çš„æœ�åŠ¡å™¨å�šå‡ºä¸¥æ ¼çš„è®¿é—®é™�åˆ¶ã€‚ä¸€èˆ¬æ�¥è®²ç”Ÿäº§ç�¯å¢ƒéƒ½ä¼šç¦�æ­¢è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œå¼€å�‘äººå‘˜è¦�è®¿é—®ç”Ÿäº§ç�¯å¢ƒä¹Ÿå¿…é¡»é€šè¿‡å ¡å�’æœºæˆ–è€…å…¶ä»–æ–¹å¼�è¿›è¡Œå®‰å…¨å®¡è®¡ç™»å½•ã€‚åœ¨è¿™ç§�æ— ç½‘ï¼ˆæ— æ³•è®¿é—®å…¬ç½‘ï¼‰çš„ç�¯å¢ƒä¸­ï¼Œæƒ³è¦�éƒ¨ç½²å¥½ä¸€ä¸ª K8s é›†ç¾¤å¹¶ä¸�æ˜¯ä¸€ä»¶è½»æ�¾çš„äº‹å„¿ã€‚å¸‚é�¢ä¸Š K8s éƒ¨ç½²å·¥å…·ä¹Ÿå¤šä¸�èƒœæ•°ï¼Œå¯¹äº�ç¦»çº¿éƒ¨ç½²çš„æ”¯æŒ�æƒ…å†µä¹Ÿå�„ä¸�ç›¸å�Œï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;Item&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;Language&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;Star&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;Fork&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;ç¦»çº¿éƒ¨ç½²æ”¯æŒ�æƒ…å†µ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/kubernetes/kops&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kops&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Golang&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;13.2k&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4.1k&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;ä¸�æ”¯æŒ�&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/kubespray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubespray&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Ansible&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;11.1k&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4.7k&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;æ”¯æŒ�ï¼Œéœ€è‡ªè¡Œæ�„å»ºå®‰è£…åŒ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/easzlab/kubeasz&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubeasz&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Ansible&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;7.2k&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2.7k&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;æ”¯æŒ�ï¼Œéœ€è‡ªè¡Œæ�„å»ºå®‰è£…åŒ…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Golang&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;4.1k&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;790&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;æ”¯æŒ�ï¼Œéœ€ä»˜è´¹å……å€¼ä¼šå‘˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/rancher/rke&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;RKE&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Golang&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2.5k&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;480&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;ä¸�æ”¯æŒ�ï¼Œéœ€è‡ªè¡Œå®‰è£… docker&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/alibaba/sealer&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealer&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Golang&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;503&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;112&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;æ”¯æŒ�ï¼Œæº�è‡ª &lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/kubesphere/kubekey&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubekey&lt;/a&gt;&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;Golang&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;471&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;155&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;éƒ¨åˆ†æ”¯æŒ�ï¼Œä»…é•œåƒ�å�¯ç¦»çº¿&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;æ— ç½‘ç�¯å¢ƒç¦»çº¿éƒ¨ç½² K8s å¾€å¾€æ˜¯ä½œä¸ºä¸€ä¸ªå•†ä¸šæœ�åŠ¡æˆ–è€…å•†ä¸šä»˜è´¹äº§å“�æ�¥å‡ºå”®ï¼ˆå¦‚ &lt;a href=&quot;https://www.sealyun.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt; ï¼‰ï¼Œå¾ˆå°‘æœ‰å¼€æº�å…�è´¹çš„è§£å†³æ–¹æ¡ˆï¼›æˆ–è€…è™½ç„¶æ��ä¾›äº†ç¦»çº¿éƒ¨ç½²æ–¹æ¡ˆï¼Œä½†æƒ³è¦�æ“�ä½œèµ·æ�¥å��åˆ†ç¹�ç��ï¼Œå¾ˆéš¾é¡ºç•…åœ°å�šåˆ°ä¸€é”®éƒ¨ç½²ï¼›å�ˆæˆ–è€…å�ªæ”¯æŒ�éƒ¨åˆ†ç¦»çº¿éƒ¨ç½²ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†èµ„æº�éœ€è¦�åœ¨éƒ¨ç½²çš„æ—¶å€™é€šè¿‡å…¬ç½‘è�·å�–ã€‚&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œæœ¬æ–‡è°ƒç ”ä¸»æµ�çš„ K8s éƒ¨ç½²å·¥å…·ï¼Œå¹¶åŸºäº�è¿™äº›å·¥å…·è®¾è®¡å¹¶å®�ç�°ä¸€ç§�ä»�æ�„å»ºç¦»çº¿å®‰è£…åŒ…åˆ°ä¸€é”®éƒ¨ç½² K8s é›†ç¾¤å…¨æµ�ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥æ»¡è¶³åœ¨æ— ç½‘çš„ç�¯å¢ƒä¸­ä¸€é”®éƒ¨ç½² K8s é›†ç¾¤çš„éœ€æ±‚ï¼Œæ¯”è¾ƒé€‚å�ˆåŸºäº� K8s çš„ PaaS toB äº§å“�ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç¦»çº¿èµ„æº�&quot;&gt;&lt;a href=&quot;#ç¦»çº¿èµ„æº�&quot; class=&quot;headerlink&quot; title=&quot;ç¦»çº¿èµ„æº�&quot;/&gt;ç¦»çº¿èµ„æº�&lt;/h2&gt;&lt;p&gt;æ€»ä½“æ�¥è®²éƒ¨ç½²ä¸€ä¸ª K8s é›†ç¾¤å¤§è‡´éœ€è¦�ä¾�èµ–å¦‚ä¸‹ä¸‰ç§�èµ„æº�ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç³»ç»Ÿ OS çš„ rpm/deb åŒ…ï¼šå¦‚ docker-ceã€�containerdã€�ipvsadmã€�conntrack ç­‰ï¼›&lt;/li&gt;
&lt;li&gt;äºŒè¿›åˆ¶æ–‡ä»¶ï¼šå¦‚ kubeletã€�kubectlã€�kubeadmã€�crictl ç­‰ï¼›&lt;/li&gt;
&lt;li&gt;ç»„ä»¶å®¹å™¨é•œåƒ�ï¼šå¦‚ kube-apiserverã€�kube-proxyã€�corednsã€�calicoã€�flannel ç­‰ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;OS-packages&quot;&gt;&lt;a href=&quot;#OS-packages&quot; class=&quot;headerlink&quot; title=&quot;OS packages&quot;/&gt;OS packages&lt;/h3&gt;&lt;p&gt;è¿™ç±»å±�äº� OS ç³»ç»Ÿå±‚é�¢çš„ä¾�èµ–ï¼Œæ ¹æ�®ä¸�å�Œç³»ç»Ÿæˆ–è€…æ”¯æŒ�çš„åŠŸèƒ½éœ€è¦�ä½¿ç”¨ç›¸åº”çš„åŒ…ç®¡ç�†å™¨å®‰è£…ç›¸åº”çš„ä¾�èµ–åŒ…ï¼Œå¤§è‡´åˆ†ä¸ºå¦‚ä¸‹å‡ ç§�ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- conntrack           &lt;span class=&quot;comment&quot;&gt;# kube-proxy ä¾�èµ–&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ipset               &lt;span class=&quot;comment&quot;&gt;# kube-proxy ä½¿ç”¨ ipvs æ¨¡å¼�éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ipvsadm             &lt;span class=&quot;comment&quot;&gt;# kube-proxy ä½¿ç”¨ ipvs æ¨¡å¼�éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- socat               &lt;span class=&quot;comment&quot;&gt;# ç”¨äº� port forwarding&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://kubernetes.io/docs/reference/setup-tools/kubeadm/implementation-details/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Implementation details&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;[Error] if conntrack, ip, iptables, mount, nsenter commands are not present in the command path&lt;br/&gt;[warning] if ebtables, ethtool, socat, tc, touch, crictl commands are not present in the command path&lt;/p&gt;
&lt;/blockquote&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- ebtables            &lt;span class=&quot;comment&quot;&gt;# kubeadm ä¾�èµ–å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ethtool             &lt;span class=&quot;comment&quot;&gt;# kubeadm ä¾�èµ–å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- chrony              &lt;span class=&quot;comment&quot;&gt;# æ—¶é’Ÿå�Œæ­¥å·¥å…·ï¼Œéƒ¨ç½²å‰�èŠ‚ç‚¹çš„æ—¶å€™å¿…é¡»ä¸€è‡´ï¼Œä¸�ç„¶è¯�ä¹¦æˆ–è€… CNI æ�’ä»¶ä¼šå‡ºç�°é—®é¢˜&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;CRI å®¹å™¨è¿�è¡Œè¿�è¡Œæ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- containerd.io       &lt;span class=&quot;comment&quot;&gt;# å�¯å�•ç‹¬å®‰è£…/docker-ce ä¾�èµ–&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- docker-ce           &lt;span class=&quot;comment&quot;&gt;# docker-ce&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- libseccomp          &lt;span class=&quot;comment&quot;&gt;# å®‰è£… containerd éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- nvidia-container-runtime &lt;span class=&quot;comment&quot;&gt;# æ”¯æŒ� GPU æ—¶éœ€è¦�ä¾�èµ–&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- nfs-utils/nfs-common &lt;span class=&quot;comment&quot;&gt;# åˆ›å»ºåŸºäº� nfs çš„ PV éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ceph-common          &lt;span class=&quot;comment&quot;&gt;# ceph å®¢æˆ·ç«¯å®‰è£…åŒ…ï¼Œåˆ›å»ºåŸºäº� ceph çš„ pv éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- lvm2                 &lt;span class=&quot;comment&quot;&gt;# åˆ›å»ºåŸºäº� ceph çš„ pv éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- glusterfs-client     &lt;span class=&quot;comment&quot;&gt;# åˆ›å»ºåŸºäº� glusterfs çš„ pv éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- glusterfs-common     &lt;span class=&quot;comment&quot;&gt;# åˆ›å»ºåŸºäº� glusterfs çš„ pv éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cifs-utils           &lt;span class=&quot;comment&quot;&gt;# åˆ›å»ºåŸºäº� cifs çš„ pv éœ€è¦�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- fuse                 &lt;span class=&quot;comment&quot;&gt;# ceph æˆ–è€…å…¶ä»–å­˜å‚¨å®¢æˆ·ç«¯ä¾�èµ–&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æƒ³è¦�è§£å†³ä¸Šé�¢è¿™äº›ä¾�èµ–é¡¹å��åˆ†æ£˜æ‰‹ï¼Œä¹Ÿæ˜¯ç¦»çº¿éƒ¨ç½²åœºæ™¯ä¸‹æœ€éš¾çš„ä¸€éƒ¨åˆ†ï¼Œè‡³ä»Šå¹¶æ²¡æœ‰ä¸€ä¸ªæˆ�ç†Ÿçš„æ–¹æ¡ˆå®�ç�°è¿™äº›ä¾�èµ–çš„ç¦»çº¿éƒ¨ç½²ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ k8s éƒ¨ç½²å·¥å…·éƒ½æ²¡æœ‰æ��ä¾›è¿™äº›åŒ…çš„ç¦»çº¿å®‰è£…æ–¹å¼�ã€‚å¯¹äº�è¿™äº›åŒ…çš„ä¾�èµ–ï¼Œç›®å‰�ä¸»è¦�æœ‰é�¿å…�å®‰è£…è¿™äº›ä¾�èµ–å’Œåˆ¶ä½œç¦»çº¿æº�è¿™ä¸¤ç§�è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id=&quot;sealos&quot;&gt;&lt;a href=&quot;#sealos&quot; class=&quot;headerlink&quot; title=&quot;sealos&quot;/&gt;sealos&lt;/h4&gt;&lt;p&gt;åœ¨ &lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt; ä¸­å°±æ��åŠ›é�¿å…�ä½¿ç”¨åŒ…ç®¡ç�†å™¨æ�¥å®‰è£…ä¾�èµ–ï¼Œæ¯”å¦‚å®‰è£… containerd æ—¶çš„ä¾�èµ– libseccomp ä½¿ç”¨çš„æ˜¯ç¼–è¯‘å¥½çš„ .so æ–‡ä»¶çš„æ–¹å¼�ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ tar -tf kube1.20.0.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/README.md&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/libseccomp.so.2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/libseccomp.so.2.3.1&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®‰è£… docker ä½¿ç”¨çš„äºŒè¿›åˆ¶çš„æ–¹å¼�ï¼Œä½† docker å®˜æ–¹æ–‡æ¡£ä¸­ä¹Ÿæ˜�ç¡®è¯´æ˜�&lt;strong&gt;ä¸�å»ºè®®ä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼�æ�¥å®‰è£… docker&lt;/strong&gt;ï¼Œåº”è¯¥ä½¿ç”¨å�‘è¡Œç‰ˆè‡ªå¸¦çš„åŒ…ç®¡ç�†å™¨æ�¥å®‰è£…ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you want to try Docker or use it in a testing environment, but youâ€™re not on a supported platform, you can try installing from static binaries. &lt;strong&gt;If possible, you should use packages built for your operating system&lt;/strong&gt;, and use your operating systemâ€™s package management system to manage Docker installation and upgrades.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.docker.com/engine/install/binaries/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Install Docker Engine from binaries&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®�é™…ä¸Šä»»ä½•éƒ¨ç½²å·¥å…·éƒ½ä¼šå¯¹ç³»ç»Ÿ rpm/deb åŒ…éƒ½ä¼šæœ‰ä¸�å�Œç¨‹åº¦ä¸Šçš„ä¾�èµ–ï¼Œæœ‰ä¸€éƒ¨åˆ†ä¾�èµ–å�¯ä»¥åƒ� &lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt; è¿™æ ·é€šè¿‡æŸ�ç§�æ–¹å¼�å�»è§„é�¿æ�‰ã€‚ä½†å¹¶ä¸�æ˜¯æ‰€æœ‰çš„ä¾�èµ–éƒ½èƒ½è§„é�¿çš„ï¼Œæ¯”å¦‚æ��ä¾›æŒ‚è½½ PV éœ€è¦�ä¾�èµ–çš„å­˜å‚¨å®¢æˆ·ç«¯ï¼ˆnfs-common/nfs-utilsï¼Œlvm2ï¼Œgluster-clientï¼‰è¿™äº›åŒ…ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰ä»»ä½•è§„é�¿çš„é€”å¾„ï¼Œå¿…é¡»é€šè¿‡åŒ…ç®¡ç�†å™¨æ�¥å®‰è£…æ‰�è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶å¦‚æ�œè¿™äº›å‰�ç½®çš„ä¾�èµ–é¡¹åœ¨éƒ¨ç½²å·¥å…·ä¹‹å¤–æ‰‹åŠ¨è§£å†³æˆ–è€…è®©ç”¨æˆ·è‡ªè¡Œå�»è§£å†³ï¼Œé‚£ä¹ˆä½¿ç”¨ &lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt; è¿™ç§�è½»é‡�çº§çš„å·¥å…·æ�¥éƒ¨ç½² K8s æ˜¯æ¯”è¾ƒå�ˆé€‚çš„ã€‚ä½†å¯¹äº�ä¸€äº› PaaS toB çš„äº§å“�è€Œè¨€ï¼Œè®©ç”¨æˆ·è‡ªå·±å�»æ‰‹åŠ¨è§£å†³è¿™äº›ä¾�èµ–æ��æ€•ä¸�å¤ªå¥½ã€‚ç«™åœ¨å®¢æˆ·çš„è§’åº¦æ�¥è€ƒè™‘æ—¢ç„¶å¹³å�°æ��ä¾›äº†è¿™éƒ¨åˆ†åŠŸèƒ½ï¼Œå°±åº”è¯¥åœ¨éƒ¨ç½²çš„æ—¶å€™è§£å†³æ‰€æœ‰çš„ä¾�èµ–é—®é¢˜ï¼Œè€Œä¸�æ˜¯è®©æˆ‘è‡ªå·±æ‰‹åŠ¨ä¸´æ—¶æ�¥è§£å†³ã€‚&lt;/p&gt;
&lt;h4 id=&quot;kubekey&quot;&gt;&lt;a href=&quot;#kubekey&quot; class=&quot;headerlink&quot; title=&quot;kubekey&quot;/&gt;kubekey&lt;/h4&gt;&lt;p&gt;åœ¨ kubekey ä¸­ä¸€äº›ä¾�èµ–é¡¹ç›®åˆ™æ˜¯è¦�æ±‚ç”¨æˆ·è‡ªè¡Œå®‰è£…ï¼Œå¹¶æ²¡æœ‰æ��ä¾›ç¦»çº¿å®‰è£…çš„æ–¹å¼�ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å»ºè®®æ‚¨ä½¿ç”¨å¹²å‡€çš„æ“�ä½œç³»ç»Ÿï¼ˆä¸�å®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶ï¼‰ï¼Œå�¦åˆ™å�¯èƒ½ä¼šæœ‰å†²çª�ã€‚&lt;/li&gt;
&lt;li&gt;è¯·ç¡®ä¿�æ¯�ä¸ªèŠ‚ç‚¹çš„ç¡¬ç›˜è‡³å°‘æœ‰ &lt;strong&gt;100G&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰èŠ‚ç‚¹å¿…é¡»éƒ½èƒ½é€šè¿‡ &lt;code&gt;SSH&lt;/code&gt; è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰èŠ‚ç‚¹æ—¶é—´å�Œæ­¥ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰èŠ‚ç‚¹éƒ½åº”ä½¿ç”¨ &lt;code&gt;sudo&lt;/code&gt;/&lt;code&gt;curl&lt;/code&gt;/&lt;code&gt;openssl&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;KubeKey èƒ½å¤Ÿå�Œæ—¶å®‰è£… Kubernetes å’Œ KubeSphereã€‚æ ¹æ�®è¦�å®‰è£…çš„ Kubernetes ç‰ˆæœ¬ï¼Œéœ€è¦�å®‰è£…çš„ä¾�èµ–é¡¹å�¯èƒ½ä¼šä¸�å�Œã€‚æ‚¨å�¯ä»¥å�‚è€ƒä¸‹æ–¹åˆ—è¡¨ï¼ŒæŸ¥çœ‹æ˜¯å�¦éœ€è¦�æ��å‰�åœ¨æ‚¨çš„èŠ‚ç‚¹ä¸Šå®‰è£…ç›¸å…³ä¾�èµ–é¡¹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;left&quot;&gt;ä¾�èµ–é¡¹&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;Kubernetes ç‰ˆæœ¬ â‰¥ 1.18&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;Kubernetes ç‰ˆæœ¬ &amp;lt; 1.18&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;&lt;code&gt;socat&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å¿…é¡»&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;&lt;code&gt;conntrack&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å¿…é¡»&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;&lt;code&gt;ebtables&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;&lt;code&gt;ipset&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;å�¯é€‰ä½†å»ºè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;å¤‡æ³¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ç¦»çº¿ç�¯å¢ƒä¸­ï¼Œæ‚¨å�¯ä»¥ä½¿ç”¨ç§�æœ‰åŒ…ã€�RPM åŒ…ï¼ˆé€‚ç”¨äº� CentOSï¼‰æˆ–è€… Deb åŒ…ï¼ˆé€‚ç”¨äº� Debianï¼‰æ�¥å®‰è£…è¿™äº›ä¾�èµ–é¡¹ã€‚&lt;/li&gt;
&lt;li&gt;å»ºè®®æ‚¨äº‹å…ˆåˆ›å»ºä¸€ä¸ªæ“�ä½œç³»ç»Ÿé•œåƒ�æ–‡ä»¶ï¼Œå¹¶ä¸”å®‰è£…å¥½æ‰€æœ‰ç›¸å…³ä¾�èµ–é¡¹ã€‚è¿™æ ·ï¼Œæ‚¨ä¾¿å�¯ä»¥ç›´æ�¥ä½¿ç”¨è¯¥é•œåƒ�æ–‡ä»¶åœ¨æ¯�å�°æœºå™¨ä¸Šå®‰è£…æ“�ä½œç³»ç»Ÿï¼Œæ��é«˜éƒ¨ç½²æ•ˆç�‡ï¼Œä¹Ÿä¸�ç”¨æ‹…å¿ƒä»»ä½•ä¾�èµ–é¡¹é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‚¨çš„é›†ç¾¤å¿…é¡»æœ‰ä¸€ä¸ªå�¯ç”¨çš„å®¹å™¨è¿�è¡Œæ—¶ã€‚åœ¨ç¦»çº¿ç�¯å¢ƒä¸­åˆ›å»ºé›†ç¾¤ä¹‹å‰�ï¼Œæ‚¨å¿…é¡»æ‰‹åŠ¨å®‰è£… Docker æˆ–å…¶ä»–å®¹å™¨è¿�è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubesphere/kubekey#requirements-and-recommendations&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Requirements and Recommendations&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;æ�„å»ºç¦»çº¿æº�&quot;&gt;&lt;a href=&quot;#æ�„å»ºç¦»çº¿æº�&quot; class=&quot;headerlink&quot; title=&quot;æ�„å»ºç¦»çº¿æº�&quot;/&gt;æ�„å»ºç¦»çº¿æº�&lt;/h4&gt;&lt;p&gt;å¯¹äº�ç³»ç»Ÿ rpm/deb åŒ…çš„ä¾�èµ–ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¸�è¸�å®�å®�åœ°ä½¿ç”¨åŒ…ç®¡ç�†å™¨æ�¥å®‰è£…è¿™äº›åŒ…è¾ƒä¸ºå¦¥å½“ï¼Œå› æ­¤æˆ‘ä»¬æœ‰å¿…è¦�ä¸ºè¿™äº›ä¾�èµ–çš„ rpm/deb åŒ…æ�„å»ºæˆ�ç¦»çº¿æº�ï¼Œéƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªç¦»çº¿æº�æ�¥å®‰è£…è¿™äº›ä¾�èµ–ã€‚åœ¨ ã€Š&lt;a href=&quot;https://blog.k8s.li/make-offline-mirrors.html&quot;&gt;ä½¿ç”¨ docker build åˆ¶ä½œ yum/apt ç¦»çº¿æº�&lt;/a&gt;ã€‹ä¸€æ–‡ä¸­æ›¾åˆ†æ��è¿‡åˆ¶ä½œå’Œä½¿ç”¨ç¦»çº¿æº�è¿™ä¹ˆéš¾çš„å�Ÿå› ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½œä¸ºå¹³å�°éƒ¨ç½²å·¥å…·çš„å¼€å�‘è€…ï¼Œå§‹ç»ˆè¢«ç¦»çº¿éƒ¨ç½²è¿™ä¸ªéš¾é¢˜å›°æ‰°ç�€ã€‚åœ¨çº¿çš„å®¹å™¨é•œåƒ�å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒå¥½è§£å†³ï¼Œå› ä¸ºè¿™äº›èµ„æº�æ˜¯ä¸� OS æ— å…³çš„ï¼Œå�ªè¦�ä¸‹è½½ä¸‹æ�¥æ”¾åˆ°å®‰è£…åŒ…é‡Œï¼Œéƒ¨ç½²çš„æ—¶å€™å�¯åŠ¨ä¸€ä¸ª HTTP æœ�åŠ¡å™¨å’Œé•œåƒ�ä»“åº“æœ�åŠ¡æ��ä¾›è¿™äº›èµ„æº�çš„ä¸‹è½½å�³å�¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¯¹äº� yum/apt ä¹‹ç±»çš„è½¯ä»¶æ�¥è®²å¹¶ä¸�é‚£ä¹ˆç®€å�•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆç”±äº�å�„ä¸ªåŒ…ä¹‹é—´çš„ä¾�èµ–å…³ç³»æ¯”è¾ƒå¤�æ�‚ï¼Œå¹¶ä¸�èƒ½å°†å®ƒä»¬ç›´æ�¥ä¸‹è½½ä¸‹æ�¥ï¼›&lt;/li&gt;
&lt;li&gt;å…¶æ¬¡å�³ä¾¿ä¸‹è½½ä¸‹æ�¥ä¹‹å��ä¹Ÿæ— æ³•ç›´æ�¥é€šè¿‡ yum/apt çš„æ–¹å¼�å®‰è£…æŒ‡å®šçš„è½¯ä»¶åŒ…ï¼Œè™½ç„¶ä¹Ÿå�¯ä»¥ä½¿ç”¨ scp çš„æ–¹å¼�å°†è¿™äº›åŒ…å¤�åˆ¶åˆ°éƒ¨ç½²èŠ‚ç‚¹ï¼Œé€šè¿‡ rpm æˆ– dpkg çš„æ–¹å¼�æ�¥å®‰è£…ä¸Šï¼Œä½†è¿™æ ·å¹¶ä¸�æ˜¯å¾ˆä¼˜é›…ï¼Œè€Œä¸”é€šç”¨æ€§èƒ½ä¹Ÿä¸�æ˜¯å¾ˆå¥½ï¼›&lt;/li&gt;
&lt;li&gt;æœ€å��éœ€è¦�é€‚é…�çš„ Linux å�‘è¡Œç‰ˆå’ŒåŒ…ç®¡ç�†å™¨ç§�ç±»ä¹Ÿæœ‰å¤šç§�ï¼Œè€Œä¸”æœ‰äº›åŒ…çš„åŒ…å��æˆ–è€…ç‰ˆæœ¬å�·åœ¨ä¸�å�Œçš„åŒ…ç®¡ç�†ä¹‹é—´ä¹Ÿç›¸å·®ç”šå¤§ï¼Œæ— æ³•å�šåˆ°ç»Ÿä¸€ç®¡ç�†ã€‚&lt;/li&gt;
&lt;li&gt;ç¦»çº¿æº�å�Œæ—¶é€‚é…�é€‚é…� ARM64 å’Œ AMD64 æœ‰ä¸€å®šçš„éš¾åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¥½åœ¨æ–‡ä¸­ä¹Ÿç»™å‡ºäº†ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œå�³é€šè¿‡ Dockerfile æ�¥æ�„å»ºç¦»çº¿æº�ï¼Œå…·ä½“çš„å®�ç�°ç»†èŠ‚å�¯ä»¥ç¿»çœ‹ã€Š&lt;a href=&quot;https://blog.k8s.li/make-offline-mirrors.html&quot;&gt;ä½¿ç”¨ docker build åˆ¶ä½œ yum/apt ç¦»çº¿æº�&lt;/a&gt;ã€‹ä¸€æ–‡ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆå�¯ä»¥è§£å†³ PaaS æˆ–è€… IaaS å±‚é�¢çš„ç¦»çº¿æº�åˆ¶ä½œçš„éš¾é¢˜ï¼Œå�Œæ ·ä¹Ÿé€‚ç”¨äº�æˆ‘ä»¬éƒ¨ç½² K8s é›†ç¾¤çš„åœºæ™¯ï¼Œè€Œä¸”é‡‡ç”¨ Dockerfile çš„æ–¹å¼�æ�¥æ�„å»ºç¦»çº¿æº�å�¯ä»¥å®Œç¾�åœ°è§£å†³å�Œæ—¶é€‚é…� arm64 å’Œ amd64 çš„éš¾é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&quot;files&quot;&gt;&lt;a href=&quot;#files&quot; class=&quot;headerlink&quot; title=&quot;files&quot;/&gt;files&lt;/h3&gt;&lt;p&gt;ä¸€äº›éƒ¨ç½²è¿‡ç¨‹ä¸­éœ€è¦�çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- kubelet&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- kubeadm&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- kubectl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- etcd            &lt;span class=&quot;comment&quot;&gt;# systemd æ–¹å¼�éƒ¨ç½² etcd æ—¶éœ€è¦�çš„å®‰è£…åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- crictl          &lt;span class=&quot;comment&quot;&gt;# k8s å®˜æ–¹çš„ CRI CLI å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- calicoctl       &lt;span class=&quot;comment&quot;&gt;# calico çš„ CLI å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- helm            &lt;span class=&quot;comment&quot;&gt;# å®‰è£… helm éœ€è¦�çš„äºŒè¿›åˆ¶å®‰è£…åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- nerdctl         &lt;span class=&quot;comment&quot;&gt;# containerd çš„ CLI å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cni-plugins     &lt;span class=&quot;comment&quot;&gt;# CNI æ�’ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cuda            &lt;span class=&quot;comment&quot;&gt;# GPU ä¾�èµ–&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- nvidia_driver   &lt;span class=&quot;comment&quot;&gt;# GPU é©±åŠ¨&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;sealos-1&quot;&gt;&lt;a href=&quot;#sealos-1&quot; class=&quot;headerlink&quot; title=&quot;sealos&quot;/&gt;sealos&lt;/h4&gt;&lt;p&gt;sealos å¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤„ç�†æ¯”è¾ƒå¥½ï¼Œå…¨éƒ¨æ‰“åŒ…åœ¨ç¦»çº¿å®‰è£…åŒ…é‡Œï¼Œéƒ¨ç½²çš„æ—¶å€™ä¼šåˆ†å�‘åˆ°é›†ç¾¤èŠ‚ç‚¹ä¸Šï¼Œæ•´ä¸ªéƒ¨ç½²è¿‡ç¨‹éƒ½æ— éœ€è®¿é—®å…¬ç½‘ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ tar -tf kube1.20.0.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubelet&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubectl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/conntrack&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubeadm&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;kubekey-1&quot;&gt;&lt;a href=&quot;#kubekey-1&quot; class=&quot;headerlink&quot; title=&quot;kubekey&quot;/&gt;kubekey&lt;/h4&gt;&lt;p&gt;åœ¨ kubekey çš„æº�ç �å½“ä¸­ï¼Œæ˜¯å°†æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶çš„ URL ç¡¬ç¼–ç �åœ¨ä»£ç �å½“ä¸­çš„ã€‚å¦‚æ�œåœ¨éƒ¨ç½²çš„æ—¶å€™éœ€è¦�æ ¹æ�®éƒ¨ç½²ç�¯å¢ƒæ�¥ä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸‹è½½åœ°å�€ï¼Œæ¯”å¦‚ä»�å†…ç½‘ nginx æœ�åŠ¡å™¨ä¸Šä¸‹è½½ï¼Œå°±éœ€è¦�ä¿®æ”¹è¿™éƒ¨åˆ†æº�ç �æŠŠ &lt;code&gt;https://kubernetes-release.pek3b.qingstor.com&lt;/code&gt; ä¿®æ”¹æˆ�å†…ç½‘åœ°å�€ï¼Œæ¯”å¦‚ &lt;code&gt;http://172.20.0.25:8080/files&lt;/code&gt; ï¼Œç„¶è€Œåœ¨éƒ¨ç½²çš„æ—¶å€™é‡�æ–°ç¼–è¯‘ kubekey çš„ä»£ç �å�ˆå¿…é¡»èƒ½è®¿é—®å…¬ç½‘æ‰�è¡Œï¼Œè¿™å°±å¾ˆåƒµç¡¬ã€‚æ‰€ä»¥ä»¥ç›®å‰�å¼€æº�çš„ kubekey æ�¥çœ‹ï¼Œæ˜¯æ²¡æœ‰åŠ�æ³•å�šåˆ°æ— ç½‘ç�¯å¢ƒä¸­æ„‰å¿«åœ°éƒ¨ç½² k8s çš„ï¼Œå�¯èƒ½å•†ä¸šç‰ˆçš„æ”¯æŒ�ï¼ˆçŒœæµ‹ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight golang&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// FilesDownloadHTTP defines the kubernetes&#x27; binaries that need to be downloaded in advance and downloads them.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FilesDownloadHTTP&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(mgr *manager.Manager, filepath, version, arch &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;error&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kkzone := os.Getenv(&lt;span class=&quot;string&quot;&gt;&quot;KKZONE&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;etcd := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;etcd&quot;&lt;/span&gt;, Arch: arch, Version: kubekeyapiv1alpha1.DefaultEtcdVersion}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeadm := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;kubeadm&quot;&lt;/span&gt;, Arch: arch, Version: version}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubelet := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;kubelet&quot;&lt;/span&gt;, Arch: arch, Version: version}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubectl := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;kubectl&quot;&lt;/span&gt;, Arch: arch, Version: version}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubecni := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;kubecni&quot;&lt;/span&gt;, Arch: arch, Version: kubekeyapiv1alpha1.DefaultCniVersion}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm := files.KubeBinary{Name: &lt;span class=&quot;string&quot;&gt;&quot;helm&quot;&lt;/span&gt;, Arch: arch, Version: kubekeyapiv1alpha1.DefaultHelmVersion}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;etcd.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/etcd-%s-linux-%s.tar.gz&quot;&lt;/span&gt;, filepath, kubekeyapiv1alpha1.DefaultEtcdVersion, arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeadm.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/kubeadm&quot;&lt;/span&gt;, filepath)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubelet.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/kubelet&quot;&lt;/span&gt;, filepath)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubectl.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/kubectl&quot;&lt;/span&gt;, filepath)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubecni.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/cni-plugins-linux-%s-%s.tgz&quot;&lt;/span&gt;, filepath, arch, kubekeyapiv1alpha1.DefaultCniVersion)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm.Path = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/helm&quot;&lt;/span&gt;, filepath)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; kkzone == &lt;span class=&quot;string&quot;&gt;&quot;cn&quot;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;etcd.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://kubernetes-release.pek3b.qingstor.com/etcd/release/download/%s/etcd-%s-linux-%s.tar.gz&quot;&lt;/span&gt;, etcd.Version, etcd.Version, etcd.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeadm.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://kubernetes-release.pek3b.qingstor.com/release/%s/bin/linux/%s/kubeadm&quot;&lt;/span&gt;, kubeadm.Version, kubeadm.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubelet.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://kubernetes-release.pek3b.qingstor.com/release/%s/bin/linux/%s/kubelet&quot;&lt;/span&gt;, kubelet.Version, kubelet.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubectl.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://kubernetes-release.pek3b.qingstor.com/release/%s/bin/linux/%s/kubectl&quot;&lt;/span&gt;, kubectl.Version, kubectl.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubecni.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://containernetworking.pek3b.qingstor.com/plugins/releases/download/%s/cni-plugins-linux-%s-%s.tgz&quot;&lt;/span&gt;, kubecni.Version, kubecni.Arch, kubecni.Version)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://kubernetes-helm.pek3b.qingstor.com/linux-%s/%s/helm&quot;&lt;/span&gt;, helm.Arch, helm.Version)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm.GetCmd = mgr.DownloadCommand(helm.Path, helm.Url)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;etcd.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://github.com/coreos/etcd/releases/download/%s/etcd-%s-linux-%s.tar.gz&quot;&lt;/span&gt;, etcd.Version, etcd.Version, etcd.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeadm.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://storage.googleapis.com/kubernetes-release/release/%s/bin/linux/%s/kubeadm&quot;&lt;/span&gt;, kubeadm.Version, kubeadm.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubelet.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://storage.googleapis.com/kubernetes-release/release/%s/bin/linux/%s/kubelet&quot;&lt;/span&gt;, kubelet.Version, kubelet.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubectl.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://storage.googleapis.com/kubernetes-release/release/%s/bin/linux/%s/kubectl&quot;&lt;/span&gt;, kubectl.Version, kubectl.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubecni.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://github.com/containernetworking/plugins/releases/download/%s/cni-plugins-linux-%s-%s.tgz&quot;&lt;/span&gt;, kubecni.Version, kubecni.Arch, kubecni.Version)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm.Url = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;https://get.helm.sh/helm-%s-linux-%s.tar.gz&quot;&lt;/span&gt;, helm.Version, helm.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;getCmd := mgr.DownloadCommand(fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s/helm-%s-linux-%s.tar.gz&quot;&lt;/span&gt;, filepath, helm.Version, helm.Arch), helm.Url)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;helm.GetCmd = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;%s &amp;amp;&amp;amp; cd %s &amp;amp;&amp;amp; tar -zxf helm-%s-linux-%s.tar.gz &amp;amp;&amp;amp; mv linux-%s/helm . &amp;amp;&amp;amp; rm -rf *linux-%s*&quot;&lt;/span&gt;, getCmd, filepath, helm.Version, helm.Arch, helm.Arch, helm.Arch)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ­¤å¤– kubekey åœ¨å®‰è£… docker æ—¶ï¼Œæ˜¯ç›´æ�¥è°ƒç”¨çš„ &lt;a href=&quot;https://get.docker.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;docker å®˜æ–¹çš„è„šæœ¬&lt;/a&gt; æ�¥å®‰è£…ï¼Œå®‰è£…è¿‡ç¨‹ä¹Ÿå¿…é¡»è®¿é—®å…¬ç½‘æ‰�è¡Œã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;installDockerOnNode&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(mgr *manager.Manager, _ *kubekeyapiv1alpha1.HostCfg)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;error&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;dockerConfig, err := GenerateDockerConfig(mgr)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; err != &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; err&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;dockerConfigBase64 := base64.StdEncoding.EncodeToString([]&lt;span class=&quot;keyword&quot;&gt;byte&lt;/span&gt;(dockerConfig))&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;output, err1 := mgr.Runner.ExecuteCmd(fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;sudo -E /bin/sh -c \&quot;if [ -z $(which docker) ] || [ ! -e /var/run/docker.sock ]; then curl https://kubernetes.pek3b.qingstor.com/tools/kubekey/docker-install.sh | sh &amp;amp;&amp;amp; systemctl enable docker; if [ ! -f /etc/docker/daemon.json ]; then mkdir -p /etc/docker &amp;amp;&amp;amp; echo %s | base64 -d &amp;gt; /etc/docker/daemon.json; fi; systemctl daemon-reload &amp;amp;&amp;amp; systemctl restart docker; fi\&quot;&quot;&lt;/span&gt;, dockerConfigBase64), &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; err1 != &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; errors.Wrap(errors.WithStack(err1), fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;Failed to install docker:\n%s&quot;&lt;/span&gt;, output))&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨ docker å®˜æ–¹çš„å®‰è£…è„šæœ¬æ�¥å®‰è£… docker æ˜¯æœ‰ä¸€ä¸ªæ˜�æ˜¾çš„é—®é¢˜å°±æ˜¯ï¼šæ²¡æœ‰ç‰ˆæœ¬æ�§åˆ¶ï¼Œä¸�èƒ½æŒ‡å®š docker çš„ç‰ˆæœ¬ï¼Œæ¯�æ¬¡å®‰è£…çš„ docker ç‰ˆæœ¬éƒ½æ˜¯æœ€æ–°çš„ stable ç‰ˆæœ¬ã€‚æ²¡æœ‰ç‰ˆæœ¬æ�§åˆ¶å°±ä¼šå¯¼è‡´ä¸�å�Œæ—¶é—´éƒ¨ç½²çš„é›†ç¾¤æˆ–è€…åŠ å…¥çš„èŠ‚ç‚¹ï¼Œdocker ç‰ˆæœ¬å�¯èƒ½å°±ä¸�ä¸€æ ·ï¼Œåœ¨è¿™é‡Œå�¯èƒ½ä¼šåŸ‹ä¸‹ä¸€äº›å�‘ï¼Œå�¯èƒ½ä¼šå¸¦æ�¥ä¸€å®šçš„ç»´æŠ¤æˆ�æœ¬æˆ–è€…å°†æ�¥å�‡çº§æ—¶é�‡åˆ°é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘è¿‡ kubernetes ç»„ä»¶çš„å�¯èƒ½éƒ½çŸ¥é�“ k8s æº�ç �å½“ä¸­å­˜åœ¨ä¸€ä¸ª &lt;a href=&quot;https://github.com/kubernetes/kubernetes/blob/master/build/dependencies.yaml&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;build/dependencies.yaml&lt;/a&gt; çš„æ–‡ä»¶ï¼Œé‡Œé�¢è®°å½•çš„æ˜¯ k8s ç»„ä»¶ä¸�å…¶ä»–ç»„ä»¶ (å¦‚ docker, etcd, coredns, cni, pause) æ‰€åŒ¹é…�çš„æœ€ä½³ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;On each of your nodes, install the Docker for your Linux distribution as per &lt;a href=&quot;https://docs.docker.com/engine/install/#server&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Install Docker Engine&lt;/a&gt;. You can find the latest validated version of Docker in this &lt;a href=&quot;https://git.k8s.io/kubernetes/build/dependencies.yaml&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;dependencies&lt;/a&gt; file.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;dependencies:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# zeitgeist (https://github.com/kubernetes-sigs/zeitgeist) was inspired by&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# (and now replaces) the cmd/verifydependencies tool to verify external&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# dependencies across the repo.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# The zeitgeist dependencies.yaml file format is intended to be&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# backwards-compatible with the original tooling.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# In instances where the file format may change across versions, this meta&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# dependency check exists to ensure we&#x27;re pinned to a known good version.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# ref: https://github.com/kubernetes/kubernetes/pull/98845&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Docker&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;docker&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;version:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;19.03&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;refPaths:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;path:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;vendor/k8s.io/system-validators/validators/docker_validator.go&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;match:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;latestValidatedDockerVersion&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä»¥ 1.20.x ç‰ˆæœ¬çš„ k8s ä¸ºä¾‹ï¼Œå®ƒæ‰€ä¾�èµ–çš„ docker ç‰ˆæœ¬ä¸º 19.03ï¼Œè€Œç�°åœ¨æœ€æ–°çš„ docker ç‰ˆæœ¬å¦‚ 20.10.8ï¼Œå¹¶ä¸�æ˜¯ K8s å®˜æ–¹æ‰€å»ºè®®çš„æœ€ä½³ç‰ˆæœ¬ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬åœ¨éƒ¨ç½² K8s æ—¶ï¼Œå�¯ä»¥å�‚è€ƒ &lt;a href=&quot;https://github.com/kubernetes/kubernetes/blob/master/build/dependencies.yaml&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;build/dependencies.yaml&lt;/a&gt; æ�¥ç¡®å®šä¸� K8s ç›¸å…³çš„ç»„ä»¶åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªæœ€ä½³çš„ç‰ˆæœ¬ï¼Œè€Œä¸�æ˜¯éš�ä¾¿è£…ä¸€ä¸ªæœ€æ–°çš„ç‰ˆæœ¬å°±å®Œäº‹å„¿äº†ã€‚&lt;/p&gt;
&lt;h4 id=&quot;kubespray&quot;&gt;&lt;a href=&quot;#kubespray&quot; class=&quot;headerlink&quot; title=&quot;kubespray&quot;/&gt;kubespray&lt;/h4&gt;&lt;p&gt;åœ¨ kubespray ä¸­ï¼Œæ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶çš„ URL éƒ½æ˜¯é€šè¿‡å�˜é‡�çš„æ–¹å¼�å®šä¹‰çš„ï¼Œæƒ³è¦�å�šåˆ°ç¦»çº¿éƒ¨ç½²å��åˆ†ç®€å�•ï¼Œå�ªéœ€è¦�é€šè¿‡ ansible å�˜é‡�ä¼˜å…ˆçº§çš„ç‰¹æ€§ï¼Œå°†å®ƒä»¬åœ¨ group_vars é€šè¿‡ overrides çš„æ–¹å¼�è¦†ç›–å�³å�¯ã€‚æ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Download URLs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubelet_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubelet&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubectl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubectl&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubeadm_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubeadm&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;images&quot;&gt;&lt;a href=&quot;#images&quot; class=&quot;headerlink&quot; title=&quot;images&quot;/&gt;images&lt;/h3&gt;&lt;p&gt;ä¸€äº›å¦‚ kube-proxyã€�kube-apiserverã€�corednsã€�calico ç»„ä»¶é•œåƒ�ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/kube-apiserver:v1.20.7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/kube-controller-manager:v1.20.7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/kube-proxy:v1.20.7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/kube-registry-proxy:0.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/kube-scheduler:v1.20.7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/pause:3.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/coredns:1.7.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/cpa/cluster-proportional-autoscaler-amd64:1.8.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;k8s.gcr.io/dns/k8s-dns-node-cache:1.17.1&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;sealos-2&quot;&gt;&lt;a href=&quot;#sealos-2&quot; class=&quot;headerlink&quot; title=&quot;sealos&quot;/&gt;sealos&lt;/h4&gt;&lt;p&gt;sealos å°†è¿™äº›é•œåƒ�ä½¿ç”¨ docker save çš„æ–¹å¼�æ‰“åŒ…æˆ�ä¸€ä¸ª tar åŒ…ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨ docker/ctr load çš„æ–¹å¼�å°†é•œåƒ�å¯¼å…¥åˆ°å®¹å™¨è¿�è¡Œæ—¶çš„å­˜å‚¨ç›®å½•å½“ä¸­ï¼Œæº�ç �å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// SendPackage is send new pkg to all nodes.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(u *SealosUpgrade)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SendPackage&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;all := &lt;span class=&quot;built_in&quot;&gt;append&lt;/span&gt;(u.Masters, u.Nodes...)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;pkg := path.Base(u.NewPkgUrl)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// rm old sealos in package avoid old version problem. if sealos not exist in package then skip rm&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; kubeHook &lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; For120(Version) {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// TODO update need load modprobe -- br_netfilter modprobe -- bridge.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// https://github.com/fanux/cloud-kernel/issues/23&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeHook = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;cd /root &amp;amp;&amp;amp; rm -rf kube &amp;amp;&amp;amp; tar zxvf %s  &amp;amp;&amp;amp; cd /root/kube/shell &amp;amp;&amp;amp; rm -f ../bin/sealos &amp;amp;&amp;amp; (ctr -n=k8s.io image import ../images/images.tar || true) &amp;amp;&amp;amp; cp -f ../bin/* /usr/bin/ &quot;&lt;/span&gt;, pkg)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;} &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kubeHook = fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&quot;cd /root &amp;amp;&amp;amp; rm -rf kube &amp;amp;&amp;amp; tar zxvf %s  &amp;amp;&amp;amp; cd /root/kube/shell &amp;amp;&amp;amp; rm -f ../bin/sealos &amp;amp;&amp;amp; (docker load -i ../images/images.tar || true) &amp;amp;&amp;amp; cp -f ../bin/* /usr/bin/ &quot;&lt;/span&gt;, pkg)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;PkgUrl = SendPackage(pkg, all, &lt;span class=&quot;string&quot;&gt;&quot;/root&quot;&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;, &amp;amp;kubeHook)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨è¿™ç§�æ–¹å¼�åŠ è½½é•œåƒ�æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜�æ˜¾çš„é™�åˆ¶å°±æ˜¯ kube-apiserver çš„ admission å‡†å…¥æ�§åˆ¶ä¸­ä¸�èƒ½åŠ å…¥ &lt;code&gt;AlwaysPullImages&lt;/code&gt; å�‚æ•°ã€‚ä¸�ç„¶ä¸�è¿™äº›é•œåƒ�ç›¸å…³çš„ pod é‡�æ–°è°ƒåº¦æˆ–è€…é‡�å�¯ä¹‹å��ä¼šé‡�æ–°ä»�æº�é•œåƒ�ä»“åº“æ‹‰å�–é•œåƒ�ï¼Œåœ¨æ— ç½‘æˆ–è€…ç½‘ç»œé™�åˆ¶çš„ç�¯å¢ƒä¸­å�¯èƒ½æ— æ³•æ‹‰å�–é•œåƒ�å¯¼è‡´è¿™äº› Pod å�¯åŠ¨å¤±è´¥ï¼Œä»�è€Œå¯¼è‡´é›†ç¾¤å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;è€Œåœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹ï¼Œå‡ºäº�å®‰å…¨çš„è€ƒè™‘ &lt;code&gt;AlwaysPullImages&lt;/code&gt; å‡†å…¥æ�§åˆ¶å¾€å¾€æ˜¯è¦�å¼€å�¯çš„ã€‚å› æ­¤ sealos å�¯èƒ½å¹¶ä¸�é€‚ç”¨äº�å¤šç§Ÿæˆ·æˆ–è€…å¯¹æ­¤æœ‰è¦�æ±‚çš„ç�¯å¢ƒä¸­ï¼ˆæœ€å¸¸è§�çš„å°±æ˜¯ PaaS å¹³å�°ï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯¥å‡†å…¥æ�§åˆ¶å™¨ä¼šä¿®æ”¹æ¯�ä¸€ä¸ªæ–°åˆ›å»ºçš„ Pod çš„é•œåƒ�æ‹‰å�–ç­–ç•¥ä¸º Always ã€‚ è¿™åœ¨å¤šç§Ÿæˆ·é›†ç¾¤ä¸­æ˜¯æœ‰ç”¨çš„ï¼Œè¿™æ ·ç”¨æˆ·å°±å�¯ä»¥æ”¾å¿ƒï¼Œä»–ä»¬çš„ç§�æœ‰é•œåƒ�å�ªèƒ½è¢«é‚£äº›æœ‰å‡­è¯�çš„äººä½¿ç”¨ã€‚ å¦‚æ�œæ²¡æœ‰è¿™ä¸ªå‡†å…¥æ�§åˆ¶å™¨ï¼Œä¸€æ—¦é•œåƒ�è¢«æ‹‰å�–åˆ°èŠ‚ç‚¹ä¸Šï¼Œä»»ä½•ç”¨æˆ·çš„ Pod éƒ½å�¯ä»¥é€šè¿‡å·²äº†è§£åˆ°çš„é•œåƒ�çš„å��ç§°ï¼ˆå�‡è®¾ Pod è¢«è°ƒåº¦åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ä¸Šï¼‰æ�¥ä½¿ç”¨å®ƒï¼Œè€Œä¸�éœ€è¦�å¯¹é•œåƒ�è¿›è¡Œä»»ä½•æ�ˆæ�ƒæ£€æŸ¥ã€‚ å½“å�¯ç”¨è¿™ä¸ªå‡†å…¥æ�§åˆ¶å™¨æ—¶ï¼Œæ€»æ˜¯åœ¨å�¯åŠ¨å®¹å™¨ä¹‹å‰�æ‹‰å�–é•œåƒ�ï¼Œè¿™æ„�å‘³ç�€éœ€è¦�æœ‰æ•ˆçš„å‡­è¯�ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;kubekey-2&quot;&gt;&lt;a href=&quot;#kubekey-2&quot; class=&quot;headerlink&quot; title=&quot;kubekey&quot;/&gt;kubekey&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;https://kubesphere.io/docs/installing-on-linux/introduction/air-gapped-installation/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubekey å®˜æ–¹çš„æ–‡æ¡£&lt;/a&gt; ä¸­æœ‰æ��åˆ°ç»„ä»¶é•œåƒ�ç¦»çº¿éƒ¨ç½²çš„æ–¹å¼�ï¼Œä¸�è¿‡å��åˆ†ç¹�ç��(åŠ�é€€ğŸ˜‚)ï¼Œåœ¨ &lt;a href=&quot;https://github.com/kubesphere/kubekey/issues/597&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Offline installation is too troublesome #597&lt;/a&gt; ä¸­ä¹Ÿæœ‰äººå��æ§½è¿™ä¸ªé—®é¢˜ã€‚ä¸�è¿‡ç›®å‰� kubekey å¼€å�‘å›¢é˜Ÿå·²ç»�åœ¨é‡�æ�„è¿™éƒ¨åˆ†å†…å®¹äº†ï¼Œè‡³äº�ç»“æ�œå¦‚ä½•ï¼Œå�ªèƒ½ç­‰äº†ã€‚&lt;/p&gt;
&lt;h4 id=&quot;é•œåƒ�ä»“åº“&quot;&gt;&lt;a href=&quot;#é•œåƒ�ä»“åº“&quot; class=&quot;headerlink&quot; title=&quot;é•œåƒ�ä»“åº“&quot;/&gt;é•œåƒ�ä»“åº“&lt;/h4&gt;&lt;p&gt;åœ¨ç§�æœ‰äº‘ç�¯å¢ƒä¸­ï¼Œä¼�ä¸šä¸€èˆ¬éƒ½ä¼šæœ‰è‡ªå·±çš„é•œåƒ�ä»“åº“ï¼ˆæ¯”å¦‚ harbor ï¼‰ç”¨äº�å­˜æ”¾ä¸šåŠ¡ç»„ä»¶é•œåƒ�æˆ–è€…ä¸€äº›å…¶ä»–å¹³å�°ä¾�èµ–çš„é•œåƒ�ã€‚å†�åŠ ä¸Š Docker Hub è‡ªä»�å�»å¹´å¼€å§‹å°±åŠ å…¥äº† pull é•œåƒ�æ¬¡æ•°çš„é™�åˆ¶ï¼Œå¦‚æ�œç›´æ�¥ä½¿ç”¨ Docker Hub ä¸Šé�¢çš„é•œåƒ�æ�¥éƒ¨ç½²é›†ç¾¤ï¼Œå¾ˆæœ‰å�¯èƒ½ä¼šå› ä¸º &lt;a href=&quot;https://www.docker.com/increase-rate-limit&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;429 toomanyrequests&lt;/a&gt; æˆ–è€…ä¸€äº›ç½‘ç»œå�Ÿå› å¯¼è‡´æ‹‰å�–é•œåƒ�å¤±è´¥ã€‚å› æ­¤å¯¹äº� k8s é›†ç¾¤éƒ¨ç½²è€Œè¨€ï¼Œå»ºè®®ä½¿ç”¨å†…éƒ¨è‡ªå·±çš„é•œåƒ�ä»“åº“ï¼Œè€Œé��å…¬ç½‘ä¸Šé•œåƒ�ä»“åº“ã€‚å¦‚æ�œæ²¡æœ‰çš„è¯�å�¯ä»¥ä½¿ç”¨ harbor æˆ–è€… docker registry åœ¨æœ¬åœ°éƒ¨ç½²ä¸€ä¸ªé•œåƒ�ä»“åº“ã€‚æˆ‘ä»¬å°†éƒ¨ç½²ä¾�èµ–çš„é•œåƒ�å¯¼å…¥åˆ°å·²ç»�å­˜åœ¨çš„é•œåƒ�ä»“åº“ä¸­ï¼Œéƒ¨ç½²çš„æ—¶å€™ä»�è¯¥é•œåƒ�ä»“åº“æ‹‰å�–å�³å�¯ã€‚&lt;/p&gt;
&lt;h2 id=&quot;éƒ¨ç½²å·¥å…·é€‰æ‹©&quot;&gt;&lt;a href=&quot;#éƒ¨ç½²å·¥å…·é€‰æ‹©&quot; class=&quot;headerlink&quot; title=&quot;éƒ¨ç½²å·¥å…·é€‰æ‹©&quot;/&gt;éƒ¨ç½²å·¥å…·é€‰æ‹©&lt;/h2&gt;&lt;p&gt;ä¸Šé�¢ç®€å�•æ¢³ç�†äº†ä¸€ä¸‹éƒ¨ç½² k8s é›†ç¾¤è¿‡ç¨‹ä¸­æ‰€ä¾�èµ–çš„çš„åœ¨çº¿èµ„æº�ï¼Œä»¥å�Šå¦‚ä½•å°†å®ƒä»¬åˆ¶ä½œæˆ�ç¦»çº¿èµ„æº�çš„ä¸€äº›åˆ†æ��ã€‚ä¸Šé�¢æ��å�Šçš„éƒ¨ç½²å·¥å…·å�„æœ‰å�„çš„ä¼˜ç¼ºç‚¹ï¼Œé’ˆå¯¹ä»¥ä¸‹ä¸¤ç§�ä¸�å�Œçš„åœºæ™¯å�¯ä»¥é€‰æ‹©ä¸�å�Œçš„éƒ¨ç½²å·¥å…·ã€‚&lt;/p&gt;
&lt;h3 id=&quot;sealos-3&quot;&gt;&lt;a href=&quot;#sealos-3&quot; class=&quot;headerlink&quot; title=&quot;sealos&quot;/&gt;sealos&lt;/h3&gt;&lt;p&gt;å¦‚æ�œä»…ä»…æ˜¯éƒ¨ç½²ä¸€ä¸ªç®€å�•çš„ k8s é›†ç¾¤ï¼Œå¯¹é›†ç¾¤æ²¡æœ‰å¤ªå¤šå®šåˆ¶åŒ–çš„éœ€æ±‚ï¼Œé‚£ä¹ˆä½¿ç”¨ &lt;a href=&quot;https://github.com/fanux/sealos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealos&lt;/a&gt; å�¯èƒ½æ˜¯æœ€ä½³çš„é€‰æ‹©ï¼Œå�ªä¸�è¿‡å®ƒæ˜¯æ”¶è´¹çš„ï¼Œ&lt;a href=&quot;https://www.sealyun.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éœ€è¦�å……å€¼ä¼šå‘˜&lt;/a&gt; ğŸ˜‚ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;ç�°åœ¨å¼€å§‹-ï¿¥99-ï¿¥69-å¹´&quot;&gt;&lt;a href=&quot;#ç�°åœ¨å¼€å§‹-ï¿¥99-ï¿¥69-å¹´&quot; class=&quot;headerlink&quot; title=&quot;ç�°åœ¨å¼€å§‹ ï¿¥99 ï¿¥69/å¹´&quot;/&gt;ç�°åœ¨å¼€å§‹ &lt;del&gt;ï¿¥99&lt;/del&gt; ï¿¥69/å¹´&lt;/h3&gt;&lt;p&gt;æ¬¢è¿�æˆ�ä¸ºå¹´è´¹ä¼šå‘˜ï¼Œä»»æ„�ä¸‹è½½æ‰€æœ‰ç‰ˆæœ¬è½¯ä»¶åŒ…!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;@F-liuhui ç¦»çº¿åŒ…å±…ç„¶è¦�æ”¶è´¹ï¼Ÿé‚£è¿˜æ˜¯å¼€æº�é¡¹ç›®å�—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¼€æº�ä¸�ä»˜è´¹ä¸�å†²çª�ï¼Œ100%å¼€æº� 100%ä»˜è´¹&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sealyun.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;sealyun.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æ�œåŠ¨æ‰‹èƒ½åŠ›å¼ºçš„è¯�ï¼Œå�¯ä»¥æ ¹æ�® selaos ç¦»çº¿å®‰è£…åŒ…çš„ç›®å½•ç»“æ�„ä½¿ç”¨ GitHub Actions æ�¥æ�„å»ºï¼Œå®�ç�°èµ·æ�¥ä¹Ÿä¸�æ˜¯å¾ˆéš¾ã€‚å�ªä¸�è¿‡ç ¸åˆ«äººé¥­ç¢—çš„äº‹å„¿è¿˜æ˜¯ä¸�å�šä¸ºå¥½ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥é€‰æ‹©å�¦ä¸€ç§�æ–¹æ¡ˆæ�¥å®�ç�°ï¼Œè¿™æ ·ä¹Ÿèƒ½é�¿å…�ä¸€äº›å•†ä¸šçº çº·é—®é¢˜ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ tar -tf kube1.20.0.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/README.md&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/libseccomp.so.2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/lib64/libseccomp.so.2.3.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/shell/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/shell/containerd.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/shell/init.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/shell/master.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/README.md&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubelet&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubectl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/conntrack&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubeadm&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/bin/kubelet-pre-start.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/kubeadm.yaml&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/kubelet.service&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/calico.yaml&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/10-kubeadm.conf&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/net/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/conf/net/calico.yaml&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/containerd/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/containerd/README.md&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/containerd/cri-containerd-cni-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/images/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/images/images.tar&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;kube/images/README.md&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;kubekey-3&quot;&gt;&lt;a href=&quot;#kubekey-3&quot; class=&quot;headerlink&quot; title=&quot;kubekey&quot;/&gt;kubekey&lt;/h3&gt;&lt;p&gt;ç”±äº� kubekey éƒ¨ç½²æ—¶äºŒè¿›åˆ¶æ–‡ä»¶éœ€è¦�å…¬ç½‘è�·å�–ï¼Œdocker æ— æ³•ç¦»çº¿éƒ¨ç½²ä»¥å�Šéœ€è¦�æ‰‹åŠ¨å®‰è£…ä¸€äº›å‰�ç½®ä¾�èµ–ï¼Œæ²¡æœ‰åŠ�æ³•å�šåˆ°å®Œæ•´çš„ç¦»çº¿éƒ¨ç½²ï¼Œå› æ­¤ç¦»çº¿éƒ¨ç½²çš„æ–¹æ¡ˆä¹Ÿå°±ç›´æ�¥æ”¾å¼ƒæ�‰äº†ï¼ŒæŠ½ç©ºä»–ä»¬æ��ä¸ª Issue æˆ– PR çœ‹çœ‹èƒ½å�¦æ”¯æŒ�è¿™éƒ¨åˆ† ğŸ˜…ã€‚&lt;/p&gt;
&lt;h3 id=&quot;kubespray-1&quot;&gt;&lt;a href=&quot;#kubespray-1&quot; class=&quot;headerlink&quot; title=&quot;kubespray&quot;/&gt;kubespray&lt;/h3&gt;&lt;p&gt;å¦‚æ�œæƒ³æ‰¾ä¸€ä¸ªå�³å¼€æº�å�ˆå…�è´¹çš„ç¦»çº¿éƒ¨ç½²æ–¹æ¡ˆï¼Œæˆ–è€…å¯¹é›†ç¾¤éƒ¨ç½²æœ‰ç‰¹æ®Šçš„è¦�æ±‚ï¼Œæ¯”å¦‚åŸºäº� K8s çš„ PaaS toB äº§å“�ï¼Œéœ€è¦�åœ¨éƒ¨ç½²æ—¶å®‰è£…å¹³å�°æœ¬èº«éœ€è¦�çš„ä¸€äº›ä¾�èµ–ï¼ˆå¦‚å­˜å‚¨å®¢æˆ·ç«¯ã€�GPU é©±åŠ¨ç­‰ï¼‰ã€‚é‚£ä¹ˆä¸�å¦¨å…ˆçœ‹ä¸€ä¸‹ kubernetes-sig ç¤¾åŒºçš„ &lt;a href=&quot;https://github.com/kubernetes-sigs/kubespray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubespray&lt;/a&gt; å¦‚ä½• ğŸ¤”ï¼Œä¸»è¦�çš„ç‰¹æ€§å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ�çš„ 10 ç§� CNI æ�’ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- cni-plugins v0.9.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- calico v3.17.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- canal (given calico/flannel versions)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cilium v1.9.9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- flanneld v0.14.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- kube-ovn v1.7.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- kube-router v1.3.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- multus v3.7.2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ovn4nfv v1.1.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- weave v2.8.1&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒ� 3 ç§�å®¹å™¨è¿�è¡Œæ—¶ä»¥å�Š &lt;a href=&quot;https://github.com/kubernetes-sigs/kubespray/blob/master/docs/kata-containers.md&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Kata Containers&lt;/a&gt; è¿˜æœ‰ nvidia-gpu-device-plugin ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- docker v20.10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- containerd v1.4.6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cri-o v1.21&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;é€‚é…�äº† 10 ç§� Linux å�‘è¡Œç‰ˆï¼Œè¦†ç›–äº†ç»�å¤§å¤šæ•°ç§�æœ‰äº‘åœºæ™¯&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- Flatcar Container Linux by Kinvolk&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Debian Buster, Jessie, Stretch, Wheezy&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Ubuntu 16.04, 18.04, 20.04&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- CentOS/RHEL 7, 8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Fedora 33, 34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Fedora CoreOS (see fcos Note)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- openSUSE Leap 15.x/Tumbleweed&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Oracle Linux 7, 8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Alma Linux 8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- Amazon Linux 2&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## å·¥å…·ç±»&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- helm&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- krew&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- nerdctl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## ä¸€äº› controller å’Œ provisioner&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ambassador: v1.5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cephfs-provisioner v2.1.0-k8s1.11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- rbd-provisioner v2.1.1-k8s1.11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- cert-manager v0.16.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- coredns v1.8.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;- ingress-nginx v0.43.0&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;kubespray å¯¹æ‰€æœ‰çš„ä¾�èµ–èµ„æº�éƒ½å�šåˆ°äº†ç¦»çº¿ä¸‹è½½çš„æ”¯æŒ�ï¼šæ¯”å¦‚æ‰€æœ‰ä¾�èµ–æ–‡ä»¶çš„ URL éƒ½é€šè¿‡å�˜é‡�çš„æ–¹å¼�æ�¥å®šä¹‰ï¼Œè€Œé�� kubekey é‚£æ ·ç¡¬ç¼–ç �åœ¨ä»£ç �ä¸­ï¼›æ‰€æœ‰é•œåƒ�çš„ repo å’Œ tag éƒ½æ˜¯é€šè¿‡å�˜é‡�çš„æ–¹å¼�æ�¥å®šä¹‰ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯åœ¨éƒ¨ç½²çš„æ—¶å€™å�¯ä»¥æ ¹æ�®å®¢æˆ·ç�¯å¢ƒçš„çš„é•œåƒ�ä»“åº“åœ°å�€å’Œæ–‡ä»¶æœ�åŠ¡å™¨çš„ URL åœ°å�€æ�¥å¡«å†™ç›¸åº”çš„å�‚æ•°ï¼Œæ— éœ€é€šè¿‡å…¬ç½‘æ�¥è�·å�–ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Registry overrides&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ registry_host }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;gcr_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ registry_host }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;docker_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ registry_host }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;quay_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ registry_host }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubeadm_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/kubeadm&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubectl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/kubectl&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubelet_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/kubelet&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# etcd is optional if you **DON&#x27;T** use etcd_deployment=host&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;etcd_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/etcd/etcd-&lt;span class=&quot;template-variable&quot;&gt;{{ etcd_version }}&lt;/span&gt;-linux-amd64.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;cni_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/cni/cni-plugins-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ cni_version }}&lt;/span&gt;.tgz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;crictl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/cri-tools/crictl-&lt;span class=&quot;template-variable&quot;&gt;{{ crictl_version }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ ansible_system | lower }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# If using Calico&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calicoctl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ files_repo }}&lt;/span&gt;/kubernetes/calico/&lt;span class=&quot;template-variable&quot;&gt;{{ calico_ctl_version }}&lt;/span&gt;/calicoctl-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å’Œä¸Šè¿°å‡ ç§�éƒ¨ç½²å·¥å…·å¯¹æ¯”ä¸�éš¾å�‘ç�°ï¼Œkubespray ç�µæ´»æ€§å’Œå�¯æ‰©å±•æ€§è¦�é¢†å…ˆå…¶ä»–å·¥å…·ï¼ˆæ”¯æŒ� 10 ç§� CNIã€�10ç§� Linux å�‘è¡Œç‰ˆã€�3 ç§� CRIã€�ä»¥å�Šå¤šç§�æ�’ä»¶å’Œæ‰©å±•ï¼‰å¹¶åœ¨å�‚æ•°å±‚é�¢ä¸Šå�šåˆ°äº†ç¦»çº¿éƒ¨ç½²çš„æ”¯æŒ�ã€‚å› æ­¤æˆ‘ä»¬é¦–å…ˆé€‰ç”¨ kubespray ä½œä¸ºé›†ç¾¤éƒ¨ç½²çš„åº•å±‚å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ kubespray è™½ç„¶åœ¨å�‚æ•°é…�ç½®ä¸Šæ”¯æŒ�ç¦»çº¿éƒ¨ç½²ï¼Œä½†æ˜¯ä»�åˆ¶ä½œç¦»çº¿å®‰è£…åŒ…åˆ°ä¸€é”®éƒ¨ç½²ï¼Œç›®å‰�ä¸ºæ­¢è¿˜æœªæœ‰ä¸€ä¸ªå®Œæ•´çš„å®�ç�°æ–¹æ¡ˆã€‚å› æ­¤éœ€è¦�ä¸º kubespray è®¾è®¡ä¸€å¥—ä»�ç¦»çº¿å®‰è£…åŒ…çš„æ�„å»ºåˆ°é›†ç¾¤ä¸€é”®éƒ¨ç½²çš„æµ�ç¨‹å’Œæ–¹æ¡ˆï¼Œä¸ºæ­¤æˆ‘ä»¬æ–°å»ºä¸€ä¸ªå��ä¸º &lt;a href=&quot;https://github.com/k8sli/kubeplay&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubeplay&lt;/a&gt; çš„ repo æ�¥å®Œæˆ�è¿™éƒ¨åˆ†å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;å�¦å¤–å€¼å¾—ä¸€æ��çš„æ˜¯ kubesphere æ—©æœŸçš„ç‰ˆæœ¬ v2.x ä½¿ç”¨ä¹Ÿæ˜¯ kubespray éƒ¨ç½²çš„ k8sï¼Œè‡³ä»Š ks-installer ä»£ç �ä¸­ä»�æ®‹ç•™ç�€ &lt;a href=&quot;https://github.com/kubesphere/ks-installer/commits/master/roles/download/tasks&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éƒ¨åˆ† kubespray çš„ä»£ç �&lt;/a&gt; ï¼Œåˆ°äº† 3.0 çš„æ—¶å€™å¼€å§‹ä½¿ç”¨è‡ªç ”çš„ kubekey æ�¥éƒ¨ç½² K8s äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åŸºäº� Ansible çš„å®‰è£…ç¨‹åº�å…·æœ‰å¤§é‡�è½¯ä»¶ä¾�èµ–æ€§ï¼Œä¾‹å¦‚ Pythonã€‚KubeKey æ˜¯ä½¿ç”¨ Go è¯­è¨€å¼€å�‘çš„ï¼Œå�¯ä»¥æ¶ˆé™¤åœ¨å�„ç§�ç�¯å¢ƒä¸­å‡ºç�°çš„é—®é¢˜ï¼Œä»�è€Œæ��é«˜å®‰è£…æˆ�åŠŸç�‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kubesphere/kubekey/blob/master/README_zh-CN.md&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;README_zh-CN.md&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸�è¿‡ ansible çš„ä¾�èµ–é—®é¢˜å½“æ—¶ä¸ºä»€ä¹ˆæ²¡æœ‰è€ƒè™‘é‡‡ç”¨å®¹å™¨åŒ–çš„æ–¹å¼�è¿�è¡Œ kubespray ğŸ¤”ï¼Œè‡³äº� ansible çš„æ€§èƒ½é—®é¢˜ä¹Ÿä¸�æ˜¯æ²¡æœ‰ä¼˜åŒ–çš„ä½™åœ°ã€‚&lt;/p&gt;
&lt;p&gt;kubeplay è¿™ä¸ªé¡¹ç›®ä¸»è¦�æ˜¯å®�ç�° K8s ç¦»çº¿å®‰è£…åŒ…çš„æ�„å»ºå’Œä¸€é”®éƒ¨ç½²åŠŸèƒ½ï¼Œç›®å‰�å�ªé€‚é…�äº† kubesprayï¼Œç­‰åˆ°å��é�¢ä¼šé€‚é…�ä¸€äº›å…¶ä»–éƒ¨ç½²å·¥å…·å¦‚ kubekeyã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ‰“åŒ…æ–¹å¼�&quot;&gt;&lt;a href=&quot;#æ‰“åŒ…æ–¹å¼�&quot; class=&quot;headerlink&quot; title=&quot;æ‰“åŒ…æ–¹å¼�&quot;/&gt;æ‰“åŒ…æ–¹å¼�&lt;/h3&gt;&lt;p&gt;ç”±äº�éƒ¨ç½²ä¾�èµ–çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œç»„ä»¶é•œåƒ�å¤§éƒ½å­˜æ”¾åœ¨ GitHub ã€�Docker Hubã€�gcr.ioï¼ˆGoogle Container Registryï¼‰ã€�quay.io è¿™äº›å›½å¤–çš„å¹³å�°ä¸Šï¼Œåœ¨å›½å†…ç�¯å¢ƒè�·å�–è¿™äº›èµ„æº�æ˜¯æœ‰ä¸€å®šçš„ç½‘ç»œé™�åˆ¶ã€‚è€Œ GitHub æ‰˜ç®¡çš„ runner è¿�è¡Œåœ¨å›½å¤–çš„æœºæˆ¿å½“ä¸­ï¼Œå�¯ä»¥å¾ˆé¡ºç•…åœ°è�·å�–è¿™äº›èµ„æº�ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ GitHub Actions æ�¥è¿›è¡Œç¦»çº¿å®‰è£…åŒ…çš„æ�„å»ºã€‚&lt;/p&gt;
&lt;p&gt;åƒ� selos é‚£æ ·å°†å®‰è£…åŒ…å­˜æ”¾åœ¨é˜¿é‡Œäº‘ OSS ä¸Šï¼Œåœ¨å›½å†…èƒ½å��åˆ†é¡ºç•…åœ°é«˜é€Ÿä¸‹è½½ï¼Œæ”¶è´¹ä¹Ÿæ˜¯ç�†æ‰€å½“ç„¶ã€‚ä½†æˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯ 100% å¼€æº� 100% å…�è´¹ï¼Œæ¯�ä¸ªäººéƒ½å�¯ä»¥ fork ä»£ç �åˆ°è‡ªå·±çš„ repoï¼Œæ ¹æ�®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œæ�„å»ºã€‚å› æ­¤é€‰æ‹© GitHub æ�¥æ�„å»ºå’Œå­˜æ”¾æˆ‘ä»¬çš„å®‰è£…åŒ…æ˜¯æœ€å�ˆé€‚çš„é€‰æ‹©ï¼Œè¿™æ ·ä¹Ÿä¸�ç”¨å�»é¢�å¤–è€ƒè™‘å®‰è£…åŒ…ä¸‹è½½çš„é—®é¢˜ã€‚è‡³äº�ä»� GitHub ä¸Šä¸‹è½½å®‰è£…åŒ…æ…¢çš„é—®é¢˜ï¼Œé‚£åº”è¯¥ç”±ä½¿ç”¨è€…è‡ªè¡Œå�»è§£å†³ï¼Œè€Œé��æœ¬æ–¹æ¡ˆæ‰€å…³å¿ƒçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Qï¼šå¦‚ä½•æ‘†è„±ç½‘ç»œçš„ä¾�èµ–æ�¥åˆ›å»ºä¸ª Docker çš„ image å‘¢ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæ˜¯ Docker ç”¨æˆ·è‡ªå·±çš„åŸºæœ¬æ�ƒåˆ©ï¼Ÿ&lt;/p&gt;
&lt;p&gt;Aï¼šè¿™ä¸ªåŸºæœ¬æ�ƒåˆ©æˆ‘è§‰å¾—è¿˜æ˜¯è¦�é—® GFW ï¼Œå›½å¤–çš„å¼€å�‘äººå‘˜æ˜¯é��å¸¸éš¾ç�†è§£æœ‰äº›ä»–ä»¬è®¤ä¸ºè·Ÿæ°´ç”µä¸€æ ·æ™®å�Šçš„åŸºç¡€è®¾æ–½åœ¨æŸ�äº›åœ°æ–¹è¿˜æ˜¯å¾ˆå›°éš¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„å¼•ç”¨ &lt;a href=&quot;http://dockone.io/article/722&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DockOneæŠ€æœ¯åˆ†äº«ï¼ˆäºŒå��å››ï¼‰ï¼šå®¹å™¨å’ŒIaaSï¼šè°�åŠ¨äº†è°�çš„å¥¶é…ª&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€‰æ‹©å¥½çš„æ�„å»ºåœºæ‰€ä¸º GitHub Actions ä¹‹å��æˆ‘ä»¬å†�å°†è¿™äº›ç¦»çº¿èµ„æº�è¿›è¡Œæ‹†åˆ†ï¼Œç›®çš„æ˜¯ä¸ºäº†å®�ç�°å�„ä¸ªç¦»çº¿èµ„æº�ä¹‹é—´çš„è§£è€¦ï¼Œè¿™æ ·å�šç�µæ´»æ€§æ›´å¥½ä¸€äº›ï¼Œæ¯”å¦‚èƒ½å¤Ÿé€‚é…�å¤šç§� OSã€�æ”¯æŒ�å¤šä¸ª k8s ç‰ˆæœ¬ç­‰ã€‚ä¸»è¦�æ‹†åˆ†æˆ�å¦‚ä¸‹å‡ ä¸ªæ¨¡å�—ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¨¡å�—&lt;/th&gt;
&lt;th&gt;Repo&lt;/th&gt;
&lt;th&gt;ç”¨é€”&lt;/th&gt;
&lt;th&gt;è¿�è¡Œ/ä½¿ç”¨æ–¹å¼�&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;compose&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/kubeplay&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubeplay&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ç”¨äº�éƒ¨ç½² nginx å’Œ registry æœ�åŠ¡&lt;/td&gt;
&lt;td&gt;nerdctl compose&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;os-tools&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/kubeplay&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubeplay&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;éƒ¨ç½² compose æ—¶çš„ä¸€äº›ä¾�èµ–å·¥å…·&lt;/td&gt;
&lt;td&gt;äºŒè¿›åˆ¶å®‰è£…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;os-packages&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/os-packages&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;os-packages&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ��ä¾› rpm/deb ç¦»çº¿æº�&lt;/td&gt;
&lt;td&gt;nginx æ��ä¾› http æ–¹å¼�ä¸‹è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kubespray&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/kubespray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubespray&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ç”¨äº�éƒ¨ç½²/æ‰©ç¼©å®¹ k8s é›†ç¾¤&lt;/td&gt;
&lt;td&gt;å®¹å™¨æˆ–è€… pod&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kubespray-files&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/kubespray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubespray&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ��ä¾›äºŒè¿›åˆ¶æ–‡ä»¶ä¾�èµ–&lt;/td&gt;
&lt;td&gt;nginx æ��ä¾› http æ–¹å¼�ä¸‹è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;kubespray-images&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/k8sli/kubespray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;kubespray&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ��ä¾›ç»„ä»¶é•œåƒ�&lt;/td&gt;
&lt;td&gt;registry æ��ä¾›é•œåƒ�ä¸‹è½½&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;æ‹†åˆ†å®Œæˆ�ä¹‹å��ï¼Œæˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯éœ€è¦�å°†å®ƒä»¬ç»„å�ˆæˆ�ä¸€ä¸ªå®Œæˆ�çš„ç¦»çº¿å®‰è£…åŒ…ã€‚ä¸ºäº†å‡�å°‘ç»´æŠ¤æˆ�æœ¬ï¼Œæˆ‘ä»¬å°†æ¯�ä¸ªæ¨¡å�—çš„æ�„å»ºæ“�ä½œéƒ½æ”¾åœ¨ Dockerfile ä¸­ï¼Œå�³ &lt;code&gt;All in Dockerfile&lt;/code&gt; ğŸ¤£ã€‚è¿™æ ·æ¯�ä¸ªæ¨¡å�—çš„ GitHub Actions æµ�æ°´çº¿æœ€ç»ˆäº¤ä»˜çš„éƒ½æ˜¯ä¸€ä¸ªé•œåƒ�ï¼Œç„¶å��é•œåƒ�éƒ½æ�¨é€�åˆ° &lt;code&gt;ghcr.io&lt;/code&gt; ä¸Šï¼Œè¿™æ ·å°±è§£å†³äº†æ¨¡å�—é—´äº§ç‰©ä¼ é€’ä»¥å�Šé•œåƒ�ç¼“å­˜çš„é—®é¢˜ã€‚æœ€ç»ˆé€šè¿‡ä¸€ä¸ªæœ€ç»ˆçš„ &lt;a href=&quot;https://github.com/k8sli/kubeplay/blob/main/Dockerfile&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Dockerfile&lt;/a&gt; å°†è¿™äº›æ¨¡å�—çš„é•œåƒ�å…¨éƒ¨ COPY åˆ°ä¸€ä¸ªé•œåƒ�å½“ä¸­ï¼Œå�ªè¦�æ‰“åŒ…è¿™ä¸ªæœ€ç»ˆçš„é•œåƒ�ä¸ºç¦»çº¿å®‰è£…åŒ…å�³å�¯ï¼›å�¦ä¸€ä¸ªå¥½å¤„å°±ä½¿ç”¨ buildx æ�„å»ºè¿™äº›ç¦»çº¿èµ„æº�å°±å�Ÿç”Ÿæ”¯æŒ�å¤š CPU ä½“ç³»æ�¶æ�„ï¼Œèƒ½å¤Ÿå�Œæ—¶é€‚é…� amd64 å’Œ arm64 ä½“ç³»æ�¶æ�„ï¼Œè¿™æ · arm64 ä¹Ÿèƒ½æ„‰å¿«åœ°ç�©è€�äº†ï¼ŒçœŸæ˜¯ä¸€ä¸¾ä¸¤å¾—ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é�¢å°±è¯¦ç»†è®²è§£æ¯�ä¸ªæ¨¡å�—çš„åŠŸèƒ½ä»¥å�Šæ˜¯å¦‚ä½•æ‰“åŒ…çš„ï¼š&lt;/p&gt;
&lt;h3 id=&quot;compose&quot;&gt;&lt;a href=&quot;#compose&quot; class=&quot;headerlink&quot; title=&quot;compose&quot;/&gt;compose&lt;/h3&gt;&lt;p&gt;compose æ¨¡å�—é‡Œé�¢ä¸»è¦�è¿�ä¸¤ä¸ªæœ�åŠ¡ï¼š ç”¨äº�æ��ä¾›æ–‡ä»¶ä¸‹è½½çš„ nginx å’Œç»„ä»¶é•œåƒ�æ‹‰å�–çš„ registryã€‚è¿™ä¸¤ä¸ªæˆ‘ä»¬ä¾�æ—§æ˜¯å®¹å™¨åŒ–ä»¥ç±»ä¼¼ docker-compose çš„æ–¹å¼�æ�¥éƒ¨ç½²ï¼Œè€Œæ‰€ä¾�èµ–çš„ä¹Ÿå�ªæœ‰ä¸¤ä¸ªé•œåƒ�å’Œä¸€äº›é…�ç½®æ–‡ä»¶è€Œå·²ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;version:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;3.1&#x27;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;services:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;nginx:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;container_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nginx:1.20-alpine&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;restart:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;always&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;volumes:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./resources/nginx:/usr/share/nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./config/compose/certs/domain.crt:/etc/nginx/conf.d/domain.crt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./config/compose/certs/domain.key:/etc/nginx/conf.d/domain.key&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./config/compose/nginx.conf:/etc/nginx/conf.d/default.conf&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;ports:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;# 443 ç«¯å�£å��å�‘ä»£ç�† registr çš„ 5000 ç«¯å�£ï¼Œä»…ç”¨äº� pull é•œåƒ�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;:443&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;8080&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;:8080&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;registry:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;registry:2.7.1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;container_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;registry&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;restart:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;always&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;volumes:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;./resources/registry:/var/lib/registry&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;ports:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;# å�ªå…�è®¸æœ¬åœ° 5000 ç«¯å�£ push é•œåƒ�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;:5000:5000&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªé•œåƒ�æˆ‘ä»¬ä½¿ç”¨ skopeo copy çš„æ–¹å¼�ä¿�å­˜ä¸º tar åŒ…ï¼Œéƒ¨ç½²çš„æ—¶å€™ load åˆ°å®¹å™¨è¿�è¡Œæ—¶çš„å­˜å‚¨ä¸­ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Qï¼šä¸ºä»€ä¹ˆè¦�ç”¨ skopeo è€Œä¸�æ˜¯ dockerï¼Ÿ&lt;/p&gt;
&lt;p&gt;Aï¼šå› ä¸º Dockerfile æ�„å»ºè¿‡ç¨‹ä¸­ä¸�æ”¯æŒ�è¿�è¡Œ docker å‘½ä»¤ save é•œåƒ�&lt;/p&gt;
&lt;/blockquote&gt;

&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; alpine:latest as downloader&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; SKOPEO_VERSION=v1.&lt;span class=&quot;number&quot;&gt;4.0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; NGINX_VERSION=&lt;span class=&quot;number&quot;&gt;1.20&lt;/span&gt;-alpine&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; RERGISRRY_VERSION=&lt;span class=&quot;number&quot;&gt;2.7&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; apk --no-cache add wget ca-certificates \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/k8sli/skopeo/releases/download/v1.4.0/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; -O /tools/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; chmod a+x /tools/* \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; ln -s /tools/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; /usr/bin/skopeo&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; skopeo copy --insecure-policy --src-tls-verify=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; --override-arch &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; --additional-tag nginx:&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;       docker://docker.io/library/nginx:&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt; docker-archive:nginx-&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt;.tar \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; skopeo copy --insecure-policy --src-tls-verify=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; --override-arch &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; --additional-tag registry:&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;       docker://docker.io/library/registry:&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt; docker-archive:registry-&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt;.tar&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨éƒ¨ç½²çš„æ—¶å€™æˆ‘ä»¬ä½¿ç”¨ nerdctl compose çš„æ–¹å¼�å�¯åŠ¨å�³å�¯ï¼Œä½¿ç”¨æ–¹å¼�æœ‰ç‚¹ç±»ä¼¼äº� docker-composeã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Q: ä¸ºä»€ä¹ˆä¸�ç”¨ docker å’Œ docker-compose&lt;/p&gt;
&lt;p&gt;Aï¼šK8s å�» docker æ˜¯å¤§åŠ¿æ‰€è¶‹ï¼Œé€‰æ‹© containerd æ›´ç¬¦å�ˆä¸»æµ�å�‘å±•æ–¹å�‘&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# å°†é•œåƒ� load è¿› containerd å­˜å‚¨&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;$ find &lt;span class=&quot;variable&quot;&gt;${IMAGES_DIR}&lt;/span&gt; -&lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt; f -name &lt;span class=&quot;string&quot;&gt;&#x27;*.tar&#x27;&lt;/span&gt; | xargs -L1 nerdctl load -i&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# nerdctl compose å�¯åŠ¨ nginx å’Œ registry&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;$ nerdctl compose -f compose.yaml up&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;os-packages&quot;&gt;&lt;a href=&quot;#os-packages&quot; class=&quot;headerlink&quot; title=&quot;os-packages&quot;/&gt;os-packages&lt;/h3&gt;&lt;p&gt;è¿™éƒ¨åˆ†æ˜¯ rpm/deb ç¦»çº¿æº�çš„æ�„å»ºï¼Œå…¶è¯¦ç»†çš„è¿‡ç¨‹å’Œå�Ÿç�†å�¯ä»¥å�‚è€ƒæˆ‘ä¹‹å‰�å†™çš„å�šå®¢ ã€Š&lt;a href=&quot;https://blog.k8s.li/make-offline-mirrors.html&quot;&gt;ä½¿ç”¨ docker build åˆ¶ä½œ yum/apt ç¦»çº¿æº�&lt;/a&gt;ã€‹ï¼Œä¸‹é�¢å�ªåˆ—ä¸¾ä¸€ä¸‹ CentOS7 ç¦»çº¿æº�çš„æ�„å»ºé…�ç½®ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; centos:&lt;span class=&quot;number&quot;&gt;7.9&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;2009&lt;/span&gt; as os-centos7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; OS_VERSION=&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; DOCKER_MIRROR_URL=&lt;span class=&quot;string&quot;&gt;&quot;https://download.docker.com&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; BUILD_TOOLS=&lt;span class=&quot;string&quot;&gt;&quot;yum-utils createrepo epel-release wget&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# å®‰è£…æ�„å»ºå·¥å…·ï¼Œé…�ç½® docker å®˜æ–¹ yum æº�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; yum install -q -y &lt;span class=&quot;variable&quot;&gt;${BUILD_TOOLS}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; yum-config-manager --add-repo &lt;span class=&quot;variable&quot;&gt;${DOCKER_MIRROR_URL}&lt;/span&gt;/linux/centos/docker-ce.repo \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; yum makecache&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /centos/&lt;span class=&quot;variable&quot;&gt;$OS_VERSION&lt;/span&gt;/os&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; packages.yaml .&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=mikefarah/yq:4.11.1 /usr/bin/yq /usr/bin/yq&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# æ ¹æ�®é…�ç½®æ–‡ä»¶è§£æ��è¯¥ OS éœ€è¦�æ�„å»ºçš„åŒ…ï¼Œå¹¶è�·å�–è¿™äº›åŒ…çš„ä¸‹è½½ url&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; yq &lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;.common[],.yum[],.centos7[],.kubespray.common[],.kubespray.yum[]&#x27;&lt;/span&gt; packages.yaml &amp;gt; packages.list \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; sort -u packages.list | xargs repotrack --urls | sort -u &amp;gt; packages.urls&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# é€šè¿‡ wget çš„æ–¹å¼�ä¸‹è½½ rpm åŒ…ï¼Œä½¿ç”¨ createrepo åˆ›å»º repo ç´¢å¼•æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -x -P &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; -i packages.urls \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; createrepo -d &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# å°†æ�„å»ºçš„å†…å®¹ COPY æˆ�å�•ç‹¬çš„ä¸€å±‚&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; scratch&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=os-centos7 /centos /centos&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯éœ€è¦�å®‰è£…åŒ…çš„é…�ç½®æ–‡ä»¶ï¼Œå�¯ä»¥æ ¹æ�®å¹³å�°æˆ–è€…å®¢æˆ·çš„ä¸€äº›è¦�æ±‚é…�ç½®ä¸Šä¸�å�Œçš„åŒ…&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;---&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubespray:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;common:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;curl&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;rsync&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;socat&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;unzip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;e2fsprogs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;xfsprogs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ebtables&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bash-completion&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ipvsadm&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ipset&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;conntrack&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;yum:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nss&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;libselinux-python&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;device-mapper-libs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;apt:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;python-apt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;python3-apt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;aufs-tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;apt-transport-https&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;software-properties-common&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;common:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;cifs-utils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;lsof&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;lvm2&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;openssl&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sshpass&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;vim&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;wget&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ethtool&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;net-tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;rsync&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;chrony&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;yum:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nfs-utils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;yum-utils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;createrepo&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;epel-release&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nc&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;httpd-tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;apt:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nfs-common&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;apt-transport-https&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ca-certificates&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;gnupg&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;lsb-release&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;aptitude&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;dpkg-dev&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;gnupg2&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;netcat&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;apache2-utils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;centos7:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;containerd.io-1.4.6&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;ubuntu:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;containerd.io=1.4.6-1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;debian10:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;containerd.io=1.4.6-1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äº� toB äº§å“�ï¼Œå»ºè®®å°†ä¸‹é�¢è¿™äº›å¸¸è§�çš„è¿�ç»´è°ƒè¯•å·¥å…·ï¼ˆå¦‚ tcpdump, strace, lsof, net-tools ç­‰ï¼‰ä¹Ÿæ�„å»ºåœ¨ç¦»çº¿æº�ä¸­ã€‚è¿™æ ·ä¹Ÿä¸�è‡³äº�åœ¨å®¢æˆ·çš„ç�¯å¢ƒä¸­æ�’æŸ¥é—®é¢˜çš„æ—¶å€™æœºå™¨ä¸Šè¿�ä¸ª tcpdump éƒ½æ²¡æœ‰ï¼Œå°¤å…¶æ˜¯åœ¨æ— ç½‘çš„ç�¯å¢ƒä¸­ï¼Œå¦‚æ�œæ²¡æœ‰è¿™äº›å¸¸ç”¨çš„è¿�ç»´å·¥å…·ï¼Œæ�’æŸ¥é—®é¢˜å°†ä¼šå��åˆ†æ£˜æ‰‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;tools:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bash-completion&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;chrony&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;cifs-utils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;curl&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;dstat&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;e2fsprogs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ebtables&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;expect&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;gdb&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;htop&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;iftop&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;iotop&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ipset&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ipvsadm&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;jq&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;lsof&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;lvm2&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ncdu&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;net-tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nethogs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;nload&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ntpdate&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;openssl&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;pciutils&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;psmisc&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;rsync&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;smartmontools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;socat&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sshpass&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;strace&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sysstat&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tcpdump&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;telnet&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tmux&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;kubespray-2&quot;&gt;&lt;a href=&quot;#kubespray-2&quot; class=&quot;headerlink&quot; title=&quot;kubespray&quot;/&gt;kubespray&lt;/h3&gt;&lt;p&gt;kubespray æ˜¯éƒ¨ç½² K8s é›†ç¾¤ã€�å¢�åŠ èŠ‚ç‚¹ã€�åˆ é™¤èŠ‚ç‚¹ã€�ç§»é™¤é›†ç¾¤ç­‰æ¶‰å�Šå¯¹é›†ç¾¤æ“�ä½œçš„ä¸»è¦�å·¥å…·ã€‚æˆ‘ä»¬ä¾�æ—§é‡‡ç”¨å®¹å™¨åŒ–çš„æ–¹å¼�è¿�è¡Œ kubesprayï¼Œä¸»è¦�æœ‰ä»¥ä¸‹åœºæ™¯ä¼šç”¨åˆ° kubesprayï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨éƒ¨ç½²å·¥å…·è¿�è¡ŒèŠ‚ç‚¹ï¼Œä½¿ç”¨ nerdctl æ�¥è¿�è¡Œ kubespray å®¹å™¨éƒ¨ç½² K8s é›†ç¾¤&lt;/li&gt;
&lt;li&gt;K8s é›†ç¾¤éƒ¨ç½²å®Œæ¯•å��ï¼Œä»¥ Job pod çš„æ–¹å¼�è¿�è¡Œéƒ¨ç½²å�¦ä¸€ä¸ª K8s é›†ç¾¤ï¼Œå®�ç�°å¤šé›†ç¾¤éƒ¨ç½²çš„åŸºæœ¬èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;K8s é›†ç¾¤éƒ¨ç½²å®Œæ¯•å��ï¼Œä»¥ Job pod çš„æ–¹å¼�è¿�è¡Œ kubespray å¯¹è¯¥é›†ç¾¤é›†ç¾¤èŠ‚ç‚¹è¿›è¡Œæ‰©ç¼©å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Job pod æ–¹å¼�å¯¹é›†ç¾¤è¿›è¡Œæ‰©ç¼©å®¹çš„è®¾è®¡çš„æ˜¯ä¸ºäº†ä»�ä¸€å®šç¨‹åº¦ä¸Šè§£å†³éƒ¨ç½²å¤§è§„æ¨¡é›†ç¾¤æ—¶ ansible æ€§èƒ½é—®é¢˜ã€‚å�³æˆ‘ä»¬ä¸€å¼€å§‹ä¸�å¿…å°±éƒ¨ç½²ä¸€ä¸ªä¸Šå�ƒèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œè€Œæ˜¯å…ˆæŠŠä¸€ä¸ªè§„æ¨¡è¾ƒå°�çš„é›†ç¾¤éƒ¨ç½²èµ·æ�¥ï¼Œç„¶å��é€šè¿‡åˆ›å»ºæ‰¹é‡�çš„ Job çš„æ–¹å¼�è¿�è¡Œ kubespray å†�å°†é›†ç¾¤æ…¢æ…¢æ‰©å®¹èµ·æ�¥ï¼Œæ¯”å¦‚æ‰©å®¹åˆ°ä¸Šå�ƒå�°èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;kubespray å®˜æ–¹çš„ Dockerfile æ�„å»ºå‡ºæ�¥çš„é•œåƒ�æœ‰ 1.4GBï¼Œå®�åœ¨æ˜¯å¤ªå¤§äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦�ä¼˜åŒ–ä¸€ä¸‹ï¼Œå‡�å°‘é•œåƒ�å¤§å°�&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæ�„å»ºä¸€ä¸ª base é•œåƒ�ï¼Œå¯¹äº�ä¸�ç»�å¸¸å�˜åŠ¨çš„å†…å®¹æˆ‘ä»¬æŠŠå®ƒå°�è£…åœ¨ä¸€ä¸ª base é•œåƒ�é‡Œï¼Œå�ªæœ‰å½“ç›¸å…³ä¾�èµ–æ›´æ–°äº†æ‰�éœ€è¦�é‡�æ–°æ�„å»ºè¿™ä¸ª base é•œåƒ�ï¼Œ&lt;code&gt;Dockerfile.base&lt;/code&gt; å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; python:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; as builder&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; KUBE_VERSION=v1.&lt;span class=&quot;number&quot;&gt;21.3&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; requirements.txt requirements.txt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; tests/requirements.txt tests/requirements.txt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;shellcheck-py==0.7.2.1&#x27;&lt;/span&gt; &amp;gt;&amp;gt; requirements.txt \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; grep -E &lt;span class=&quot;string&quot;&gt;&#x27;^yamllint|^ansible-lint&#x27;&lt;/span&gt; tests/requirements.txt &amp;gt;&amp;gt; requirements.txt \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; pip3 install --user -r requirements.txt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -O /root/.&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/kubectl -q https://dl.k8s.io/&lt;span class=&quot;variable&quot;&gt;${KUBE_VERSION}&lt;/span&gt;/bin/linux/&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;/kubectl \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;&amp;amp;&amp;amp; chmod a+x /root/.&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/kubectl&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; python:&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;-slim&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; DEBIAN_FRONTEND=noninteractive apt-get update -y -qq \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; apt-get install -y -qq --no-install-recommends \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;        ca-certificates libssl-dev openssh-client sshpass curl gnupg2 rsync \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;        jq moreutils vim iputils-ping wget tcpdump xz-utils \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=builder /root/.&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt; /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /kubespray&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;FROM çš„ base é•œåƒ�å°±ä½¿ç”¨æˆ‘ä»¬åˆšåˆšæ�„å»ºå¥½çš„é•œåƒ�ï¼Œç›¸å…³ä¾�èµ–å·²ç»�åœ¨ base é•œåƒ�ä¸­å®‰è£…å¥½äº†ï¼Œè¿™é‡Œæ�„å»ºçš„æ—¶å€™å�ªéœ€è¦�æŠŠ repo æº�ç �å¤�åˆ¶åˆ° /kubespray ç›®å½•ä¸‹å�³å�¯ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; BASE_IMAGE=ghcr.io/k8sli/kubespray-base&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; BASE_IMAGE_VERSION=latest&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; $BASE_IMAGE:$BASE_IMAGE_VERSION&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /kubespray&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; . .&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;kubespray é›†ç¾¤éƒ¨ç½²å…¥å�£ &lt;code&gt;run.sh&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å°†é›†ç¾¤éƒ¨ç½²ã€�å¢�åŠ èŠ‚ç‚¹ã€�åˆ é™¤èŠ‚ç‚¹ã€�åˆ é™¤é›†ç¾¤ç­‰æ“�ä½œå°�è£…æˆ�ä¸€ä¸ªå…¥å�£çš„è„šæœ¬ï¼Œæ��ä¾›å¤–éƒ¨å·¥å…·è°ƒç”¨è¯¥è„šæœ¬ï¼Œä¸�ç„¶å¤–éƒ¨è°ƒç”¨çš„æ—¶å€™ç›´æ�¥è¿�è¡Œ &lt;code&gt;ansible-playbook&lt;/code&gt; å‘½ä»¤å®�åœ¨æ˜¯ä¸�å¤ªæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;TYPE=&lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;NODES=&lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;KUBE_ROOT=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(cd &quot;$(dirname &quot;$0&quot;)&lt;/span&gt;&quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;pwd&lt;/span&gt;)&lt;span class=&quot;string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${TYPE:=deploy-cluster}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_FORKS:=10}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${BECOME_USER:=root}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_LOG_FORMAT:=yaml}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${INVENTORY:=${KUBE_ROOT}&lt;/span&gt;/config/inventory}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${ENV_FILE:=${KUBE_ROOT}&lt;/span&gt;/config/env.yml}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE:=${KUBE_ROOT}&lt;/span&gt;/config/.install_steps}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;export ANSIBLE_STDOUT_CALLBACK=&lt;span class=&quot;variable&quot;&gt;${ANSIBLE_LOG_FORMAT}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;export ANSIBLE_ARGS=&quot;&lt;/span&gt;-f &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_FORKS}&lt;/span&gt; --become --become-user=&lt;span class=&quot;variable&quot;&gt;${BECOME_USER}&lt;/span&gt; -i &lt;span class=&quot;variable&quot;&gt;${INVENTORY}&lt;/span&gt; -e @&lt;span class=&quot;variable&quot;&gt;${ENV_FILE}&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;# Set logging colors&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;NORMAL_COL=&lt;span class=&quot;variable&quot;&gt;$(tput sgr0)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;RED_COL=&lt;span class=&quot;variable&quot;&gt;$(tput setaf 1)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;WHITE_COL=&lt;span class=&quot;variable&quot;&gt;$(tput setaf 7)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;GREEN_COL=&lt;span class=&quot;variable&quot;&gt;$(tput setaf 76)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;YELLOW_COL=&lt;span class=&quot;variable&quot;&gt;$(tput setaf 202)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;debuglog(){ printf &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;${WHITE_COL}&lt;/span&gt;%s&lt;span class=&quot;variable&quot;&gt;${NORMAL_COL}&lt;/span&gt;\n&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;d2f692&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;; }&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;infolog(){ printf &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;${GREEN_COL}&lt;/span&gt;âœ” %s&lt;span class=&quot;variable&quot;&gt;${NORMAL_COL}&lt;/span&gt;\n&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;d5f195&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;; }&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;warnlog(){ printf &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;${YELLOW_COL}&lt;/span&gt;â�œ %s&lt;span class=&quot;variable&quot;&gt;${NORMAL_COL}&lt;/span&gt;\n&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;331773&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;; }&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;errorlog(){ printf &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;${RED_COL}&lt;/span&gt;âœ– %s&lt;span class=&quot;variable&quot;&gt;${NORMAL_COL}&lt;/span&gt;\n&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;250165&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;; }&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;set -eo pipefail&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;if [[ ! -f &lt;span class=&quot;variable&quot;&gt;${INVENTORY}&lt;/span&gt; ]]; then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;  errorlog &quot;&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;${INVENTORY}&lt;/span&gt; file is missing, please check the inventory file is exists&lt;span class=&quot;string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;  exit 1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;deploy_cluster(){&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;/&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;main(){&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;  case &lt;span class=&quot;variable&quot;&gt;$TYPE&lt;/span&gt; in&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;    deploy-cluster)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;      infolog &quot;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;######  start deploy kubernetes cluster  ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      deploy_cluster&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;######  kubernetes cluster successfully installed  ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    remove-cluster)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;######  start remove kubernetes cluster  ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ansible-playbook &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARGS}&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${KUBE_ROOT}&lt;/span&gt;/reset.yml &amp;gt;/dev/stdout 2&amp;gt;/dev/stderr; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        rm -f &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEP_FILE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        infolog &lt;span class=&quot;string&quot;&gt;&quot;######  kubernetes cluster successfully removed ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    add-node)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      check_nodename&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;######  start add worker to kubernetes cluster  ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ansible-playbook &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARGS}&lt;/span&gt; --&lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${NODES}&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${KUBE_ROOT}&lt;/span&gt;/playbooks/10-scale-nodes.yml &amp;gt;/dev/stdout 2&amp;gt;/dev/stderr&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    remove-node)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      check_nodename&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;######  start remove worker from kubernetes cluster  ######&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ansible-playbook &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARGS}&lt;/span&gt; -e node=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${NODES}&lt;/span&gt;&quot;&lt;/span&gt; -e reset_nodes=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${KUBE_ROOT}&lt;/span&gt;/remove-node.yml &amp;gt;/dev/stdout 2&amp;gt;/dev/stderr&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    *)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      errorlog &lt;span class=&quot;string&quot;&gt;&quot;unknow [TYPE] parameter: &lt;span class=&quot;variable&quot;&gt;${TYPE}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;esac&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;main &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;5d791d&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä¸�å�Œäº� kubespray å®˜æ–¹ä½¿ç”¨ä¸€ä¸ªå®Œæ•´çš„ &lt;a href=&quot;https://github.com/kubernetes-sigs/kubespray/blob/master/cluster.yml&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;cluster.yaml&lt;/a&gt; æ�¥å®Œæˆ�æ•´ä¸ª K8s é›†ç¾¤çš„éƒ¨ç½²ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå¼•å…¥äº†åˆ†å±‚éƒ¨ç½²çš„ç‰¹æ€§ã€‚å�³å°†é›†ç¾¤éƒ¨ç½²åˆ†æˆ�è‹¥å¹²ä¸ªç›¸äº’ç‹¬ç«‹çš„ playbookï¼Œç„¶å��åœ¨å�„ä¸ª playbook é‡Œå¼•å…¥æˆ‘ä»¬å¢�åŠ çš„ roles ä»¥å�ŠäºŒå¼€å†…å®¹ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯èƒ½å’Œ kubespray ä¸Šæ¸¸çš„ä»£ç �ä¿�æŒ�ç›¸äº’ç‹¬ç«‹ï¼Œåœ¨ rebase æˆ–è€… cherry-pick ä¸Šæ¸¸æœ€æ–°çš„ä»£ç �èƒ½å¤Ÿé�¿å…�å‡ºç�°å†²çª�çš„ç�°è±¡ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;playbooks&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 00-default-ssh-config.yml    &lt;span class=&quot;comment&quot;&gt;# é…�ç½® ssh è¿�æ�¥&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 01-cluster-bootstrap-os.yml  &lt;span class=&quot;comment&quot;&gt;# åˆ�å§‹åŒ–é›†ç¾¤èŠ‚ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 02-cluster-etcd.yml          &lt;span class=&quot;comment&quot;&gt;# éƒ¨ç½² etcd é›†ç¾¤&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 03-cluster-kubernetes.yml    &lt;span class=&quot;comment&quot;&gt;# éƒ¨ç½² k8s master å’Œ node&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 04-cluster-network.yml       &lt;span class=&quot;comment&quot;&gt;# éƒ¨ç½² CNI æ�’ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ 05-cluster-apps.yml          &lt;span class=&quot;comment&quot;&gt;# éƒ¨ç½²ä¸€äº› addon ç»„ä»¶å¦‚ coredns&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â””â”€â”€ 10-scale-nodes.yml           &lt;span class=&quot;comment&quot;&gt;# å¢�åˆ èŠ‚ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åˆ†å±‚éƒ¨ç½²çš„æ—¶å€™é€šè¿‡ä¸€ä¸ªæ–‡ä»¶æ�¥è®°å½•å·²ç»�éƒ¨ç½²æˆ�åŠŸçš„æ­¥éª¤ï¼Œè¿™æ ·å¦‚æ�œæœ¬æ¬¡å› ä¸ºä¸€äº›å�Ÿå› å¯¼è‡´éƒ¨ç½²å¤±è´¥ï¼ˆå¦‚ç½‘ç»œä¸­æ–­ï¼‰ï¼Œé‚£ä¹ˆä¸‹æ¬¡é‡�æ–°éƒ¨ç½²çš„æ—¶å€™ä¼šè·³è¿‡å·²ç»�éƒ¨ç½²å¥½çš„æ­¥éª¤ï¼Œä»�å¤±è´¥çš„åœ°æ–¹ç»§ç»­éƒ¨ç½²ï¼Œä»¥æ��å�‡æ•´ä½“çš„éƒ¨ç½²æ•ˆç�‡ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;deploy_cluster&lt;/span&gt;&lt;/span&gt;(){&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  touch &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  STEPS=&lt;span class=&quot;string&quot;&gt;&quot;00-default-ssh-config 01-cluster-bootstrap-os 02-cluster-etcd 03-cluster-kubernetes 04-cluster-network 05-cluster-apps&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; step &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${STEPS}&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! grep -q &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;start deploy &lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ansible-playbook &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARGS}&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${KUBE_ROOT}&lt;/span&gt;/playbooks/&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;.yml; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        infolog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; successfully installed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        errorlog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; installation failed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; 1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      warnlog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; is already installed, so skipped...&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;æ–‡ä»¶å’Œé•œåƒ�&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶å’Œé•œåƒ�&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶å’Œé•œåƒ�&quot;/&gt;æ–‡ä»¶å’Œé•œåƒ�&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬éœ€è¦�æ��å�–å‡º kubespray éƒ¨ç½²çš„æ—¶å€™ä¾�èµ–çš„æ–‡ä»¶å’Œé•œåƒ�ï¼Œç”Ÿæˆ�ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨å’Œé•œåƒ�åˆ—è¡¨ï¼Œç„¶å��æ ¹æ�®è¿™äº›åˆ—è¡¨ä¸‹è½½å¹¶æ�„å»ºåˆ°ä¸€ä¸ªé•œåƒ�é‡Œã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Download URLs&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubelet_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubelet&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubectl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubectl&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubeadm_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/storage.googleapis.com/kubernetes-release/release/&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;/bin/linux/&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;/kubeadm&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;etcd_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/coreos/etcd/releases/download/&lt;span class=&quot;template-variable&quot;&gt;{{ etcd_version }}&lt;/span&gt;/etcd-&lt;span class=&quot;template-variable&quot;&gt;{{ etcd_version }}&lt;/span&gt;-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;cni_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/containernetworking/plugins/releases/download/&lt;span class=&quot;template-variable&quot;&gt;{{ cni_version }}&lt;/span&gt;/cni-plugins-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ cni_version }}&lt;/span&gt;.tgz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calicoctl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/projectcalico/calicoctl/releases/download/&lt;span class=&quot;template-variable&quot;&gt;{{ calico_ctl_version }}&lt;/span&gt;/calicoctl-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calico_crds_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/projectcalico/calico/archive/&lt;span class=&quot;template-variable&quot;&gt;{{ calico_version }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;crictl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/kubernetes-sigs/cri-tools/releases/download/&lt;span class=&quot;template-variable&quot;&gt;{{ crictl_version }}&lt;/span&gt;/crictl-&lt;span class=&quot;template-variable&quot;&gt;{{ crictl_version }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ ansible_system | lower }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;helm_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/get.helm.sh/helm-&lt;span class=&quot;template-variable&quot;&gt;{{ helm_version }}&lt;/span&gt;-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;nerdctl_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/containerd/nerdctl/releases/download/v&lt;span class=&quot;template-variable&quot;&gt;{{ nerdctl_version }}&lt;/span&gt;/nerdctl-&lt;span class=&quot;template-variable&quot;&gt;{{ nerdctl_version }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ ansible_system | lower }}&lt;/span&gt;-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;.tar.gz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;patched_kubeadm_download_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ download_url }}&lt;/span&gt;/github.com/k8sli/kubernetes/releases/download/&lt;span class=&quot;template-variable&quot;&gt;{{ kubeadm_patch_version }}&lt;/span&gt;/kubeadm-linux-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨æ�„å»ºå®‰è£…åŒ…çš„æ—¶å€™ï¼Œå°† download_url å�˜é‡�è®¾ç½®ä¸º &lt;code&gt;https://&lt;/code&gt; ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™å°† &lt;code&gt;download_url&lt;/code&gt; è®¾ç½®ä¸ºå†…ç½‘ æ–‡ä»¶æœ�åŠ¡å™¨æœ�åŠ¡å™¨çš„ URLï¼Œæ¯”å¦‚ &lt;code&gt;https://172.20.0.25:8080/files&lt;/code&gt;ï¼Œè¿™æ ·å°±å�¯ä»¥å®�ç�°æ–‡ä»¶æ�„å»ºå’Œéƒ¨ç½²ä½¿ç”¨çš„ç»Ÿä¸€ï¼ŒèŠ‚çœ�ç»´æŠ¤æˆ�æœ¬ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Define image repo and tag overwrite role/download/default/main.yml&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;pod_infra_image_tag:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ pod_infra_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;pod_infra_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/pause&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_proxy_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/kube-proxy&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_apiserver_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/kube-apiserver&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_scheduler_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/kube-scheduler&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_controller_manager_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/kube-controller-manager&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;coredns_image_tag:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ coredns_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;dnsautoscaler_image_tag:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ dnsautoscaler_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;coredns_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ docker_image_repo }}&lt;/span&gt;/coredns&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;dnsautoscaler_image_repo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_image_repo }}&lt;/span&gt;/cluster-proportional-autoscaler-&lt;span class=&quot;template-variable&quot;&gt;{{ image_arch }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Full image name for generate images list&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_proxy_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_proxy_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_apiserver_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_apiserver_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_scheduler_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_scheduler_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kube_controller_manager_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ kube_controller_manager_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ kube_version }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;coredns_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ coredns_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ coredns_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;dnsautoscaler_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ dnsautoscaler_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ dnsautoscaler_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;nginx_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ nginx_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ nginx_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;pod_infra_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ pod_infra_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ pod_infra_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calico_policy_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ calico_policy_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ calico_policy_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calico_cni_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ calico_cni_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ calico_cni_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;calico_node_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ calico_node_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ calico_node_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;flannel_image_name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ flannel_image_repo }}&lt;/span&gt;:&lt;span class=&quot;template-variable&quot;&gt;{{ flannel_image_tag }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;generate.sh&lt;/code&gt; åˆ—è¡¨ç”Ÿæˆ�è„šæœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬æ ¹æ�®ä¸Šé�¢ group_vars ä¸­å®šä¹‰çš„ç‰ˆæœ¬å�·å’Œä¸€äº›å�‚æ•°ï¼Œä½¿ç”¨è„šæœ¬çš„æ–¹å¼�è‡ªåŠ¨ç”Ÿæˆ�ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨å’Œé•œåƒ�åˆ—è¡¨ï¼Œæ�„å»ºçš„æ—¶å€™æ ¹æ�®è¿™äº›åˆ—è¡¨æ�¥ä¸‹è½½æ‰€éœ€è¦�çš„æ–‡ä»¶å’Œé•œåƒ�ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; -eo pipefail&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;SCRIPT_PATH=$(&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; $(dirname &lt;span class=&quot;variable&quot;&gt;$0&lt;/span&gt;); &lt;span class=&quot;built_in&quot;&gt;pwd&lt;/span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;REPO_PATH=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${SCRIPT_PATH%/build}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${IMAGE_ARCH:=&quot;amd64&quot;}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARCHITECTURE:=&quot;x86_64&quot;}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;${DOWNLOAD_YML:=&quot;config/group_vars/all/download.yml&quot;}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ARCH used in convert {%- if image_arch != &#x27;amd64&#x27; -%}-{{ image_arch }}{%- endif -%} to {{arch}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [[ &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${IMAGE_ARCH}&lt;/span&gt;&quot;&lt;/span&gt; != &lt;span class=&quot;string&quot;&gt;&quot;amd64&quot;&lt;/span&gt; ]]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; ARCH=&lt;span class=&quot;string&quot;&gt;&quot;-&lt;span class=&quot;variable&quot;&gt;${IMAGE_ARCH}&lt;/span&gt;&quot;&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;cat &amp;gt; /tmp/generate.sh &amp;lt;&amp;lt; EOF&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;arch=&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;download_url=https:/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;image_arch=&lt;span class=&quot;variable&quot;&gt;${IMAGE_ARCH}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;ansible_system=linux&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;ansible_architecture=&lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARCHITECTURE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;registry_project=library&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;registry_domain=localhost&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;EOF&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# generate all component version by $DOWNLOAD_YML&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;grep &lt;span class=&quot;string&quot;&gt;&#x27;_version:&#x27;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${REPO_PATH}&lt;/span&gt;/&lt;span class=&quot;variable&quot;&gt;${DOWNLOAD_YML}&lt;/span&gt; \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;| sed &lt;span class=&quot;string&quot;&gt;&#x27;s/: /=/g;s/{{/${/g;s/}}/}/g&#x27;&lt;/span&gt; | tr -d &lt;span class=&quot;string&quot;&gt;&#x27; &#x27;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/generate.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# generate download files url list&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;grep &lt;span class=&quot;string&quot;&gt;&#x27;_download_url:&#x27;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${REPO_PATH}&lt;/span&gt;/&lt;span class=&quot;variable&quot;&gt;${DOWNLOAD_YML}&lt;/span&gt; \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;| sed &lt;span class=&quot;string&quot;&gt;&#x27;s/: /=/g;s/ //g;s/{{/${/g;s/}}/}/g;s/|lower//g;s/^.*_url=/echo /g&#x27;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/generate.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# generate download images list&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;grep -E &lt;span class=&quot;string&quot;&gt;&#x27;_image_tag:|_image_repo:|_image_name:&#x27;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${REPO_PATH}&lt;/span&gt;/&lt;span class=&quot;variable&quot;&gt;${DOWNLOAD_YML}&lt;/span&gt; \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;| sed &lt;span class=&quot;string&quot;&gt;&quot;s#{%- if image_arch != &#x27;amd64&#x27; -%}-{{ image_arch }}{%- endif -%}#{{arch}}#g&quot;&lt;/span&gt; \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;| sed &lt;span class=&quot;string&quot;&gt;&#x27;s/: /=/g;s/{{/${/g;s/}}/}/g&#x27;&lt;/span&gt; | tr -d &lt;span class=&quot;string&quot;&gt;&#x27; &#x27;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/generate.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;grep &lt;span class=&quot;string&quot;&gt;&#x27;_image_name:&#x27;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${REPO_PATH}&lt;/span&gt;/&lt;span class=&quot;variable&quot;&gt;${DOWNLOAD_YML}&lt;/span&gt; \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;| cut -d &lt;span class=&quot;string&quot;&gt;&#x27;:&#x27;&lt;/span&gt; -f1 | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/^/echo $/g&#x27;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/generate.sh&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸ºäº†å�Œæ—¶æ”¯æŒ� amd64 å’Œ arm64 çš„ CPU æ�¶æ�„ï¼Œéœ€è¦�ä¸ºä¸¤ç§�æ�¶æ�„å�„è‡ªç”Ÿæˆ�åˆ—è¡¨ï¼Œéœ€è¦�ç‰¹æ®Šå¤„ç�†ä¸€ä¸‹ã€‚åœ¨è¿™é‡Œè¸©çš„ä¸€ä¸ªå�‘å°±æ˜¯ä¸�å�Œçš„ç»„ä»¶é•œåƒ�çš„å‘½å��æ–¹æ³•å�ƒå·®ä¸‡åˆ«ï¼Œå¤§è‡´å�¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å››ç§�æƒ…å†µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åƒ� kube-apiserver è¿™äº› k8s ç»„ä»¶çš„é•œåƒ�ï¼Œé•œåƒ�å��ç§°å’Œé•œåƒ� tag æ˜¯ä¸�éœ€è¦�åŠ ä¸Š CPU ä½“ç³»æ�¶æ�„çš„ï¼›&lt;/li&gt;
&lt;li&gt;cluster-proportional-autoscaler çš„é•œåƒ�åˆ™æ˜¯åœ¨é•œåƒ�çš„å��ç§°å��é�¢åŠ ä¸Šäº† CPU ä½“ç³»æ�¶æ�„çš„å��ç§°å¦‚ cluster-proportional-autoscaler-amd64ï¼Œcluster-proportional-autoscaler-arm64ï¼›&lt;/li&gt;
&lt;li&gt;flannel åˆ™æ˜¯å°† CPU ä½“ç³»æ�¶æ�„å��ç§°å®šä¹‰åœ¨é•œåƒ� tag å��é�¢æ¯”å¦‚ &lt;code&gt;flannel:v0.14.0-amd64&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;è¿˜æœ‰ calico æ›´å¥‡è‘©ï¼Œamd64 æ�¶æ�„çš„é•œåƒ�ä¸�éœ€è¦�åŠ ä½“ç³»æ�¶æ�„çš„å��ç§°å¦‚ &lt;code&gt;calico/cni:v3.18.4&lt;/code&gt;ï¼Œè€Œ arm64 çš„åˆ™å¿…é¡»è¦�åœ¨é•œåƒ� tag å��é�¢å¸¦ä¸Š CPU ä½“ç³»æ�¶æ�„æ¯”å¦‚ &lt;code&gt;calico/cni:v3.18.4-arm64&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://p.k8s.li/2021-08-31-pass-tob-k8s-offline-deploy-2.jpeg&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œéœ€è¦�å¼ºè°ƒä¸€ä¸‹ï¼Œæ–‡ä»¶åˆ—è¡¨å’Œé•œåƒ�åˆ—è¡¨ä¸€å®šè¦�ä½¿ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼�æ�¥ç®¡ç�†ï¼Œåˆ‡å‹¿æ‰‹åŠ¨æ›´æ–°ï¼Œè¿™æ ·èƒ½èŠ‚çœ�å¤§é‡�çš„ç»´æŠ¤æˆ�æœ¬ï¼Œä¸�ç„¶çš„è¯�æ¯�æ¬¡éƒ½æ‰‹åŠ¨å�»æ›´æ–°è¿™äº›åˆ—è¡¨æˆ�æœ¬å®�åœ¨æ˜¯å¤ªé«˜äº†ï¼Œè€Œä¸”ç‰¹åˆ«å®¹æ˜“å‡ºå‡ºé”™æˆ–è€…é�—æ¼�æŸ�ä¸ªç»„ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&quot;kubespray-files&quot;&gt;&lt;a href=&quot;#kubespray-files&quot; class=&quot;headerlink&quot; title=&quot;kubespray-files&quot;/&gt;kubespray-files&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å°† kubespray éƒ¨ç½²æ‰€ä¾�èµ–çš„äºŒè¿›åˆ¶æ–‡ä»¶æ�„å»ºåœ¨ä¸€ä¸ªå��ä¸º kubespray-files çš„é•œåƒ�å½“ä¸­ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;https://get.helm.sh/helm-v3.6.3-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/containerd/nerdctl/releases/download/v0.8.1/nerdctl-0.8.1-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/containernetworking/plugins/releases/download/v0.9.1/cni-plugins-linux-amd64-v0.9.1.tgz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/coreos/etcd/releases/download/v3.4.13/etcd-v3.4.13-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/k8sli/kubernetes/releases/download/v1.21.3-patch-1.0/kubeadm-linux-amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.21.0/crictl-v1.21.0-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/projectcalico/calico/archive/v3.18.4.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/projectcalico/calicoctl/releases/download/v3.18.4/calicoctl-linux-amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://storage.googleapis.com/kubernetes-release/release/v1.21.3/bin/linux/amd64/kubeadm&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://storage.googleapis.com/kubernetes-release/release/v1.21.3/bin/linux/amd64/kubectl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;https://storage.googleapis.com/kubernetes-release/release/v1.21.3/bin/linux/amd64/kubelet&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; alpine:latest as files&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; apk --no-cache add wget ca-certificates&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /build&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; build/kubespray-files/files_*.list /build/&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; sed &lt;span class=&quot;string&quot;&gt;&#x27;/#/d&#x27;&lt;/span&gt; *&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;.list &amp;gt; all_files.list \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -x -P /files -i all_files.list&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; scratch&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=files /files /files&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æ�„å»ºå��çš„ç›®å½•ç»“æ�„ï¼Œé€šè¿‡ç›®å½•å±‚çº§çš„æ–¹å¼�ä¿�ç•™å�Ÿæœ‰çš„ URL åœ°å�€ï¼Œç»´æŠ¤å’Œä½¿ç”¨èµ·æ�¥æ¯”è¾ƒæ–¹ä¾¿&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;files/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ get.helm.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ helm-v3.6.3-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ github.com&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ containerd&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ nerdctl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â      â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â          â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â              â””â”€â”€ v0.8.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â                  â””â”€â”€ nerdctl-0.8.1-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ containernetworking&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ plugins&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â      â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â          â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â              â””â”€â”€ v0.9.1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â                  â””â”€â”€ cni-plugins-linux-amd64-v0.9.1.tgz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ coreos&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ etcd&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â      â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â          â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â              â””â”€â”€ v3.4.13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â                  â””â”€â”€ etcd-v3.4.13-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ k8sli&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ kubernetes&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â      â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â          â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â              â””â”€â”€ v1.21.3-patch-1.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â                  â””â”€â”€ kubeadm-linux-amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ kubernetes-sigs&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ cri-tools&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â      â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â          â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â              â””â”€â”€ v1.21.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â                  â””â”€â”€ crictl-v1.21.0-linux-amd64.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ projectcalico&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â      â”œâ”€â”€ calico&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â      â”‚Â Â  â””â”€â”€ archive&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â      â”‚Â Â      â””â”€â”€ v3.18.4.tar.gz&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â      â””â”€â”€ calicoctl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â          â””â”€â”€ releases&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â              â””â”€â”€ download&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â                  â””â”€â”€ v3.18.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â                      â””â”€â”€ calicoctl-linux-amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â””â”€â”€ storage.googleapis.com&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â””â”€â”€ kubernetes-release&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        â””â”€â”€ release&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;            â””â”€â”€ v1.21.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                â””â”€â”€ bin&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                    â””â”€â”€ linux&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                        â””â”€â”€ amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                            â”œâ”€â”€ kubeadm&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                            â”œâ”€â”€ kubectl&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;                            â””â”€â”€ kubelet&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;kubespray-images&quot;&gt;&lt;a href=&quot;#kubespray-images&quot; class=&quot;headerlink&quot; title=&quot;kubespray-images&quot;/&gt;kubespray-images&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å�Œæ ·å°† kubespray éƒ¨ç½²æ‰€éœ€è¦�çš„ç»„ä»¶é•œåƒ�æ�„å»ºåœ¨ä¸€ä¸ªå��ä¸º kubespray-images çš„é•œåƒ�å½“ä¸­ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;library/calico-cni:v3.18.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/calico-kube-controllers:v3.18.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/calico-node:v3.18.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/calico-pod2daemon-flexvol:v3.18.4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/cluster-proportional-autoscaler-amd64:1.8.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/coredns:v1.8.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/flannel:v0.14.0-amd64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/kube-apiserver:v1.21.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/kube-controller-manager:v1.21.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/kube-proxy:v1.21.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/kube-scheduler:v1.21.3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/nginx:1.19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;library/pause:3.3&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;åœ¨ Dockerfile é‡Œå®Œæˆ�æ‰€æœ‰é•œåƒ�çš„ä¸‹è½½ï¼Œå¹¶ä½¿ç”¨ ã€Š&lt;a href=&quot;https://blog.k8s.li/skopeo-to-registry.html&quot;&gt;å¦‚ä½•ä½¿ç”¨ registry å­˜å‚¨çš„ç‰¹æ€§&lt;/a&gt;ã€‹æ–‡ä¸­æ��åˆ°çš„éªšæ“�ä½œï¼Œåˆ©ç”¨ registry å­˜å‚¨å¤�ç”¨ç›¸å�Œ layer çš„ç‰¹æ€§ï¼Œå°† skopeo sync ä¸‹è½½çš„é•œåƒ�è½¬æ�¢æˆ� registry å­˜å‚¨çš„ç»“æ�„ã€‚è¿™æ ·åœ¨éƒ¨ç½²çš„æ—¶å€™ç›´æ�¥æŠŠè¿™ä¸ª registry å­˜å‚¨ç›®å½•æŒ‚è½½è¿› registry å®¹å™¨çš„ &lt;code&gt;/var/lib/registry&lt;/code&gt; å�³å�¯ã€‚ç‰¹ç‚¹æ˜¯æ€§èƒ½æ–¹é�¢æ— è®ºæ˜¯æ�„å»ºå’Œéƒ¨ç½²ï¼Œéƒ½æ¯”å¸¸è§„ä½¿ç”¨ docker save å’Œ docker load çš„æ–¹å¼�è¦�å¿«è‡³å°‘ 5 åˆ° 10 å€�ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;FROM alpine:3.12 as images&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;ARG SKOPEO_VERSION=v1.4.0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;ARG YQ_VERSION=v4.11.2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;RUN ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; apk --no-cache add bash wget ca-certificates \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/mikefarah/yq/releases/download/&lt;span class=&quot;variable&quot;&gt;${YQ_VERSION}&lt;/span&gt;/yq_linux_&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; -O /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/yq \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/k8sli/skopeo/releases/download/&lt;span class=&quot;variable&quot;&gt;${SKOPEO_VERSION}&lt;/span&gt;/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; -O /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/skopeo \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; chmod a+x /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/*&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;WORKDIR /build&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;COPY build/kubespray-images/*  /build/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;RUN ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &amp;amp;&amp;amp; IMAGE_ARCH=&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; bash build.sh&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;FROM scratch&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;COPY --from=images /build/docker /docker&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;images_origin.yaml é•œåƒ�é…�ç½®æ–‡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€ƒè™‘åˆ°æœ‰å°†é•œåƒ�å¯¼å…¥åˆ°å·²ç»�å­˜åœ¨çš„é•œåƒ�ä»“åº“ä¸­çš„åœºæ™¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦�ä¿®æ”¹ä¸€ä¸‹é•œåƒ�ä»“åº“çš„ repoã€‚å› ä¸º &lt;code&gt;library&lt;/code&gt; è¿™ä¸ª repo åœ¨ harbor ä¸­æ˜¯é»˜è®¤è‡ªå¸¦çš„ï¼Œåœ¨å¯¼å…¥åˆ° harbor çš„è¿‡ç¨‹ä¸­ä¹Ÿä¸�éœ€è¦�åˆ›å»ºä¸€äº›é¢�å¤–çš„ project ï¼Œæ‰€ä»¥å°†æ‰€æœ‰é•œåƒ�çš„ repo å…¨éƒ¨ç»Ÿä¸€ä¸º &lt;code&gt;library&lt;/code&gt; æ›´é€šç”¨ä¸€äº›ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œç”¨ä¸€ä¸ª yaml é…�ç½®æ–‡ä»¶æ�¥è®°å½•å�Ÿé•œåƒ�åœ°å�€å’Œ library é•œåƒ�çš„åœ°å�€çš„å¯¹åº”å…³ç³»ã€‚æ¯”å¦‚ä¸Šæ¸¸çš„ &lt;code&gt;k8s.gcr.io/kube-apiserver&lt;/code&gt; æ˜ å°„ä¸º &lt;code&gt;library/kube-apiserver&lt;/code&gt;ï¼Œ &lt;code&gt;quay.io/calico/node&lt;/code&gt; æ˜ å°„ä¸º &lt;code&gt;library/calico-node&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;---&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# kubeadm core images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/kube-apiserver&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/kube-apiserver&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/kube-controller-manager&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/kube-controller-manager&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/kube-proxy&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/kube-proxy&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/kube-scheduler&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/kube-scheduler&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/coredns/coredns&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/coredns&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/pause&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/pause&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# kubernetes addons&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/dns/k8s-dns-node-cache&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/k8s-dns-node-cache&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/cpa/cluster-proportional-autoscaler-amd64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/cluster-proportional-autoscaler-amd64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;k8s.gcr.io/cpa/cluster-proportional-autoscaler-arm64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/cluster-proportional-autoscaler-arm64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# network plugin&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/calico/cni&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/calico-cni&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/calico/node&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/calico-node&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/calico/kube-controllers&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/calico-kube-controllers&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/calico/pod2daemon-flexvol&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/calico-pod2daemon-flexvol&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/calico/typha&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/calico-typha&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;quay.io/coreos/flannel&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/flannel&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# nginx for daemonset and offline&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;docker.io/library/nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library/nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;kubeplay-1&quot;&gt;&lt;a href=&quot;#kubeplay-1&quot; class=&quot;headerlink&quot; title=&quot;kubeplay&quot;/&gt;kubeplay&lt;/h3&gt;&lt;p&gt;kubeplay éƒ¨ç½²çš„ä»£ç �ä¸»è¦�æ˜¯ç”±ä¸€äº› shell è„šæœ¬å’Œé…�ç½®æ–‡ä»¶æ�„æˆ�ï¼Œç”¨äº�å®Œæˆ� nginx æœ�åŠ¡å’Œ registry æœ�åŠ¡çš„éƒ¨ç½²ï¼Œä»¥å�Šæœ€å��è°ƒç”¨ kubespray æ�¥å®Œæˆ�é›†ç¾¤éƒ¨ç½²ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;kubeplay/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ Dockerfile          &lt;span class=&quot;comment&quot;&gt;# æ�„å»ºå®Œæ•´å®‰è£…åŒ…çš„ Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ compose.yaml        &lt;span class=&quot;comment&quot;&gt;# compose å�¯åŠ¨é…�ç½® yaml æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ config&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ compose&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ nginx.conf  &lt;span class=&quot;comment&quot;&gt;# nginx é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ rootCA.cnf      &lt;span class=&quot;comment&quot;&gt;# ç”Ÿæˆ�é•œåƒ�ä»“åº“è¯�ä¹¦ç”¨åˆ°çš„ openssl é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ config-sample.yaml  &lt;span class=&quot;comment&quot;&gt;# ä¸»é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ install.sh          &lt;span class=&quot;comment&quot;&gt;# å®‰è£…æ“�ä½œç„¶å��&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â””â”€â”€ library             &lt;span class=&quot;comment&quot;&gt;# ä¸€äº› shell å‡½æ•°åº“&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; alpine:latest as downloader&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; SKOPEO_VERSION=v1.&lt;span class=&quot;number&quot;&gt;4.0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; YQ_VERSION=v4.&lt;span class=&quot;number&quot;&gt;11.2&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; NERDCTL_VERSION=&lt;span class=&quot;number&quot;&gt;0.11&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; NGINX_VERSION=&lt;span class=&quot;number&quot;&gt;1.20&lt;/span&gt;-alpine&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; RERGISRRY_VERSION=&lt;span class=&quot;number&quot;&gt;2.7&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; KUBESPRAY_VERSION=latest&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ARG&lt;/span&gt; KUBESPRAY_IMAGE=ghcr.io/k8sli/kubespray&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ä¸‹è½½éƒ¨ç½²æ—¶éœ€è¦�çš„å·¥å…·ï¼Œå¦‚ yqã€�skopeoã€�nerdctl-fullsss&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; apk --no-cache add wget ca-certificates \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/mikefarah/yq/releases/download/&lt;span class=&quot;variable&quot;&gt;${YQ_VERSION}&lt;/span&gt;/yq_linux_&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;  -O /tools/yq-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/k8sli/skopeo/releases/download/v1.4.0/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; -O /tools/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; wget -q -k https://github.com/containerd/nerdctl/releases/download/v&lt;span class=&quot;variable&quot;&gt;${NERDCTL_VERSION}&lt;/span&gt;/nerdctl-full-&lt;span class=&quot;variable&quot;&gt;${NERDCTL_VERSION}&lt;/span&gt;-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt;.tar.gz \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; chmod a+x /tools/* \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; ln -s /tools/skopeo-linux-&lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; /usr/bin/skopeo&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ä¸‹è½½ä¸€äº›é•œåƒ�ï¼Œå¦‚ nginxã€�registryã€�kubespray&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; /images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;RUN&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ARCH=$(uname -m | sed &lt;span class=&quot;string&quot;&gt;&#x27;s/x86_64/amd64/;s/aarch64/arm64/&#x27;&lt;/span&gt;) \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; skopeo copy --insecure-policy --src-tls-verify=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; --override-arch &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; --additional-tag nginx:&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;       docker://docker.io/library/nginx:&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt; docker-archive:nginx-&lt;span class=&quot;variable&quot;&gt;${NGINX_VERSION}&lt;/span&gt;.tar \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; skopeo copy --insecure-policy --src-tls-verify=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; --override-arch &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; --additional-tag registry:&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;       docker://docker.io/library/registry:&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt; docker-archive:registry-&lt;span class=&quot;variable&quot;&gt;${RERGISRRY_VERSION}&lt;/span&gt;.tar \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;    &amp;amp;&amp;amp; skopeo copy --insecure-policy --src-tls-verify=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; --override-arch &lt;span class=&quot;variable&quot;&gt;${ARCH}&lt;/span&gt; --additional-tag kubespray:&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_VERSION}&lt;/span&gt; \&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bash&quot;&gt;       docker://&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_IMAGE}&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_VERSION}&lt;/span&gt; docker-archive:kubespray-&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_VERSION}&lt;/span&gt;.tar&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; scratch&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; . .&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;comment&quot;&gt;# å°†å…¶å®ƒæ¨¡å�—ä¸­çš„å†…å®¹å¤�åˆ¶åˆ° scratch é•œåƒ�ä¸­ï¼Œæ�„å»ºçš„æ—¶å€™å¯¼å‡ºä¸º local æ–¹å¼�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=downloader /tools /resources/nginx/tools&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=downloader /images /resources/images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=&lt;span class=&quot;variable&quot;&gt;${OS_PACKAGES_IMAGE}&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;${OS_PACKAGE_REPO_TAG}&lt;/span&gt; / /resources/nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_FILES_IMAGE}&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_REPO_TAG}&lt;/span&gt; / /resources/nginx&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; --from=&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_IMAGES_IMAGE}&lt;/span&gt;:&lt;span class=&quot;variable&quot;&gt;${KUBESPRAY_REPO_TAG}&lt;/span&gt; / /resources/registry&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;æ�„å»º&quot;&gt;&lt;a href=&quot;#æ�„å»º&quot; class=&quot;headerlink&quot; title=&quot;æ�„å»º&quot;/&gt;æ�„å»º&lt;/h3&gt;&lt;p&gt;ç”±äº�æœ€ç»ˆçš„æ�„å»ºæ¶‰å�Šå¤šä¸ªæ¨¡å�—å’Œ repoï¼Œå…¶æµ�ç¨‹æ¯”è¾ƒå¤�æ�‚ï¼Œè¯¦ç»†çš„ä»£ç �å�¯å�‚è€ƒæº�ç � &lt;a href=&quot;https://github.com/k8sli/kubeplay/blob/main/.github/workflows/build.yaml&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;build.yaml&lt;/a&gt; ï¼Œåœ¨è¿™é‡Œå�ªè®²å‡ ä¸ªå…³é”®çš„éƒ¨åˆ†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;checkout repoï¼Œå°† kubespray å’Œ os-packages repo clone åˆ°å·¥ä½œç›®å½•&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;jobs:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;build-package:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# ä»¥ tag çš„äº‹ä»¶è§¦å�‘æ�„å»ºæµ�æ°´çº¿&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;if:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;startsWith(github.ref,&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;refs/tags/&#x27;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;runs-on:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;ubuntu-20.04&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;steps:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Checkout&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;actions/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;53303b3630383c2627132561&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;comment&quot;&gt;# fetch all git repo tag for define image tag&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;fetch-depth:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Checkout&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;repo&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;actions/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;c5a6ada0a6aeaab0b185b3f7&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;ref:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;main&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;fetch-depth:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;path:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;repository:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;github.repository_owner&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}/kubespray&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Checkout&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;os-packages&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;repo&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;actions/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;73101b1610181c0607330541&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;ref:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;main&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;fetch-depth:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;path:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;os-packages&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;repository:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;github.repository_owner&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}/os-packages&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;è�·å�– kubespray å’Œ os-packages çš„ repo tagï¼Œæ ¹æ�®å®ƒæ�¥ç¡®å®š os-packages, kubespray-files, kubespray-images è¿™ä¸ªä¸‰ä¸ªé•œåƒ�çš„ tagï¼Œå¹¶ç”Ÿæˆ�ä¸€ä¸ª All in One çš„ Dockerfile ç”¨äº�å®Œæˆ�å��ç»­å®‰è£…åŒ…çš„æ�„å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# è�·å�–ä¸€äº›ç»„ä»¶çš„ç‰ˆæœ¬å’Œå�˜é‡�ä¼ é€’ç»™ Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Prepare&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;build&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;shell:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bash&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;run:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--always&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/IMAGE_TAG=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--always&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/KUBESPRAY_VERSION=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;..&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;os-packages&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--always&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/OS_PACKAGE_REPO_TAG=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;..&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray/config&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;config/kubespray&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;os-packages&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;COPY --from=${OS_PACKAGES_IMAGE}:${OS_PACKAGE_REPO_TAG} / /resources/nginx&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;COPY --from=${KUBESPRAY_FILES_IMAGE}:${KUBESPRAY_VERSION} / /resources/nginx&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;COPY --from=${KUBESPRAY_IMAGES_IMAGE}:${KUBESPRAY_VERSION} / /resources/registry&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s|image: nginx:|NGINX_VERSION=|p&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;compose.yaml&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27; &#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s|image: registry:|RERGISRRY_VERSION=|p&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;compose.yaml&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27; &#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;outputs: type=local,dest=./&lt;/code&gt; æ�„å»ºé•œåƒ�åˆ°æœ¬åœ°ç›®å½•è€Œé�� push åˆ° registry&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Build&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;docker/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;8be9fee2e7efa6fbfef8e3a6eae8ffe2e4e5cbfdb9&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;context:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;file:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;platforms:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;linux/amd64,linux/arm64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;build-args:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;NGINX_VERSION=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.NGINX_VERSION&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;RERGISRRY_VERSION=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.RERGISRRY_VERSION&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;KUBESPRAY_IMAGE=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.KUBESPRAY_IMAGE&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;KUBESPRAY_VERSION=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.KUBESPRAY_VERSION&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;outputs:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;type=local,dest=./&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æ‰“åŒ…å¹¶ä¸Šä¼ å®‰è£…åŒ…åˆ° GitHub release å­˜å‚¨&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Prepare&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;package&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;shell:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bash&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;run:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;linux_{amd64,arm64}/{Dockerfile,LICENSE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;linux_amd64&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;pigz&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-cf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay-${IMAGE_TAG}-linux-amd64.tar.gz&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--remove-files&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;linux_arm64&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;pigz&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-cf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay-${IMAGE_TAG}-linux-arm64.tar.gz&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--remove-files&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;sha256sum&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeplay-${IMAGE_TAG}-linux-{amd64,arm64}.tar.gz&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sha256sum.txt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Release&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;upload&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;packages&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;softprops/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;553436213c3a3b78323d7827303930342630152364&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;env:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;GITHUB_TOKEN:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;secrets.GITHUB_TOKEN&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;files:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;sha256sum.txt&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;kubeplay-${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.IMAGE_TAG&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}-linux-amd64.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;kubeplay-${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.IMAGE_TAG&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}-linux-arm64.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç”±æ­¤ä¸€ä¸ªå®Œæ•´çš„ç¦»çº¿å®‰è£…åŒ…å°±æ�„å»ºå®Œæˆ�äº†ï¼Œæ�¥ä¸‹æ�¥å†�è®²ä¸€ä¸‹å®‰è£…æµ�ç¨‹&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£…æµ�ç¨‹&quot;&gt;&lt;a href=&quot;#å®‰è£…æµ�ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…æµ�ç¨‹&quot;/&gt;å®‰è£…æµ�ç¨‹&lt;/h2&gt;&lt;p&gt;åœ¨ &lt;a href=&quot;https://github.com/k8sli/kubeplay/releases&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitHub release é¡µé�¢&lt;/a&gt; å°†æˆ‘ä»¬çš„ç¦»çº¿å®‰è£…åŒ…ä¸‹è½½åˆ°æœ¬åœ°ï¼Œéœ€è¦�æ ¹æ�® CPU æ�¶æ�„çš„ç±»å�‹é€‰æ‹©ç›¸åº”çš„å®‰è£…åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://p.k8s.li/2021-08-24-offline-deploy-k8s-1.png&quot; alt=&quot;image&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½å®Œæˆ�ä¹‹å��å†�å°†å®‰è£…åŒ…é€šè¿‡ scp æˆ–è€…å…¶ä»–æ–¹å¼�ä¸Šä¼ åˆ°å†…ç½‘çš„éƒ¨ç½²èŠ‚ç‚¹ä¸Šï¼Œéƒ¨ç½²çš„æ–‡æ¡£å�¯å�‚è€ƒ &lt;a href=&quot;https://github.com/k8sli/kubeplay&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;README&lt;/a&gt; ã€‚è¿‡ç¨‹å��åˆ†ç®€å�•ï¼šå�ªéœ€è¦�å¡«å†™å¥½ &lt;code&gt;config.yaml&lt;/code&gt; é…�ç½®æ–‡ä»¶ç„¶å��æ‰§è¡Œ &lt;code&gt;bash install.sh&lt;/code&gt; å�³å�¯å®Œæˆ� K8s é›†ç¾¤çš„ä¸€é”®éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é�¢ä»�æº�ç �è€Œé�� README æ–‡æ¡£çš„è§’åº¦æ�¥è®²ä¸€ä¸‹éƒ¨ç½²æµ�ç¨‹çš„å®�ç�°ç»†èŠ‚&lt;/p&gt;
&lt;h3 id=&quot;å®‰è£…åŒ…ç»“æ�„&quot;&gt;&lt;a href=&quot;#å®‰è£…åŒ…ç»“æ�„&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…åŒ…ç»“æ�„&quot;/&gt;å®‰è£…åŒ…ç»“æ�„&lt;/h3&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# nginx ç«¯å�£å’Œ registry åŸŸå��é…�ç½®å�‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;compose:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Compose bootstrap node ip, default is local internal ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;internal_ip:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;172.20&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.25&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Nginx http server bind port for download files and packages&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;nginx_http_port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;8080&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Registry domain for CRI runtime download images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;registry_domain:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kube.registry.local&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# kubespray å�‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;kubespray:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Kubernetes version by default, only support v1.20.6&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;kube_version:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;v1.21.3&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# For deploy HA cluster you must configure a external apiserver access ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;external_apiserver_access_ip:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;127.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Set network plugin to calico with vxlan mode by default&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;kube_network_plugin:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;calico&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;#Container runtime, only support containerd if offline deploy&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;container_manager:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;containerd&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Now only support host if use containerd as CRI runtime&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;etcd_deployment_type:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;host&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Settings for etcd event server&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;etcd_events_cluster_setup:&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;etcd_events_cluster_enabled:&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# é›†ç¾¤èŠ‚ç‚¹ ssh ç™»å½• inventory é…�ç½®&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Cluster nodes inventory info&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;inventory:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;all:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;vars:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;ansible_port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;ansible_user:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;root&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;ansible_ssh_pass:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Password&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;# ansible_ssh_private_key_file: /kubespray/config/id_rsa&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;node1:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;ansible_host:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;172.20&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.21&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;node2:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;ansible_host:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;172.20&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.22&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;node3:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;ansible_host:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;172.20&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.23&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;node4:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;ansible_host:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;172.20&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.24&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;children:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;kube_control_plane:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node1:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node2:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node3:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;kube_node:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node1:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node2:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node3:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node4:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;etcd:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node1:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node2:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;node3:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;k8s_cluster:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;children:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;kube_control_plane:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attr&quot;&gt;kube_node:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;gpu:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;calico_rr:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attr&quot;&gt;hosts:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ä¸€äº›é»˜è®¤çš„é…�ç½®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ— éœ€ä¿®æ”¹&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### Default parameters ###&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## This filed not need config, will auto update,&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## if no special requirement, do not modify these parameters.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;default:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# NTP server ip address or domain, default is internal_ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;ntp_server:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;internal_ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Registry ip address, default is internal_ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;registry_ip:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;internal_ip&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Offline resource url for download files, default is internal_ip:nginx_http_port&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;offline_resources_url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;internal_ip:nginx_http_port&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Use nginx and registry provide all offline resources&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;offline_resources_enabled:&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Image repo in registry&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;image_repository:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;library&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Kubespray container image for deploy user cluster or scale&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;kubespray_image:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;kubespray&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Auto generate self-signed certificate for registry domain&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;generate_domain_crt:&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# For nodes pull image, use 443 as default&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;registry_https_port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;443&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# For push image to this registry, use 5000 as default, and only bind at 127.0.0.1&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;registry_push_port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# Set false to disable download all container images on all nodes&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;download_container:&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;kubeplay/&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;.&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ compose.yaml                 &lt;span class=&quot;comment&quot;&gt;# compose é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ config&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ compose&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ nginx.conf           &lt;span class=&quot;comment&quot;&gt;# nginx é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ kubespray&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â”œâ”€â”€ env.yml&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â”œâ”€â”€ group_vars           &lt;span class=&quot;comment&quot;&gt;# kubespray group_vars  é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”‚Â Â  â””â”€â”€ inventory.ini&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ rootCA.cnf               &lt;span class=&quot;comment&quot;&gt;# openssl é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ config-sample.yaml           &lt;span class=&quot;comment&quot;&gt;# ä¸»é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ install.sh                   &lt;span class=&quot;comment&quot;&gt;# å®‰è£…åŒ…å…¥å�£è„šæœ¬&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ library&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;â””â”€â”€ resources                    &lt;span class=&quot;comment&quot;&gt;# æ‰€æœ‰ç¦»çº¿èµ„æº�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”œâ”€â”€ images&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ kubespray-v2.16.tar  &lt;span class=&quot;comment&quot;&gt;# kubespray é•œåƒ�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ nginx-1.20-alpine.tar&lt;span class=&quot;comment&quot;&gt;# nginx é•œåƒ�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â””â”€â”€ registry-2.7.1.tar   &lt;span class=&quot;comment&quot;&gt;# registry é•œåƒ�&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”œâ”€â”€ nginx                    &lt;span class=&quot;comment&quot;&gt;# rpm/deb åŒ…ä»¥å�Šä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ centos               &lt;span class=&quot;comment&quot;&gt;# centos rpm åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ debian               &lt;span class=&quot;comment&quot;&gt;# debian deb åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ files                &lt;span class=&quot;comment&quot;&gt;# ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ repos                &lt;span class=&quot;comment&quot;&gt;# yum/apt é…�ç½®æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â”œâ”€â”€ tools                &lt;span class=&quot;comment&quot;&gt;# ä¸€äº›éƒ¨ç½²æ—¶ä¾�èµ–çš„å·¥å…·&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â”‚Â Â  â””â”€â”€ ubuntu               &lt;span class=&quot;comment&quot;&gt;# ubuntu deb åŒ…&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    â””â”€â”€ registry&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        â””â”€â”€ docker               &lt;span class=&quot;comment&quot;&gt;# ç»„ä»¶é•œåƒ� registry å­˜å‚¨ç›®å½•&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;compose-èŠ‚ç‚¹&quot;&gt;&lt;a href=&quot;#compose-èŠ‚ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;compose èŠ‚ç‚¹&quot;/&gt;compose èŠ‚ç‚¹&lt;/h3&gt;&lt;p&gt;éœ€è¦�å�•ç‹¬åˆ’åˆ†å‡ºä¸€ä¸ªèŠ‚ç‚¹ç”¨æˆ·éƒ¨ç½² nginx å’Œé•œåƒ�ä»“åº“æœ�åŠ¡ï¼Œå¹¶åœ¨è¯¥èŠ‚ç‚¹ä¸Šè¿�è¡Œ kubespray æ�¥éƒ¨ç½² K8s é›†ç¾¤ã€‚å¤§è‡´æµ�ç¨‹çš„ä»£ç �å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;deploy_compose&lt;/span&gt;&lt;/span&gt;(){&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${ID}&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    Debian|debian)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      system::debian::config_repo&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    CentOS|centos)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      system::centos::disable_selinux&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      system::centos::config_repo&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    Ubuntu|ubuntu)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      system::ubuntu::config_repo&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    *)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      errorlog &lt;span class=&quot;string&quot;&gt;&quot;Not support system: &lt;span class=&quot;variable&quot;&gt;${ID}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; 1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;esac&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  system::disable_firewalld&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  system::install_pkgs&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::install_tools&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::rudder_config&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::update_hosts&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::generate_domain_certs&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::load_images&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::compose_up&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  common::health_check&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  system::install_chrony&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;/span&gt;(){&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${INSTALL_TYPE}&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    all)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      deploy_compose&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      common::push_kubespray_image&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      common::run_kubespray &lt;span class=&quot;string&quot;&gt;&quot;bash /kubespray/run.sh deploy-cluster&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    *)&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      echowarn &lt;span class=&quot;string&quot;&gt;&quot;unknow [TYPE] parameter: &lt;span class=&quot;variable&quot;&gt;${INSTALL_TYPE}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      common::usage&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      ;;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;esac&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;main &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;c5e185&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆåˆ�å§‹åŒ–èŠ‚ç‚¹ï¼Œå…³é—­é˜²ç�«å¢™å’Œ &lt;code&gt;SELinux&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é…�ç½®éƒ¨ç½²èŠ‚ç‚¹ yum/apt ç¦»çº¿æº�&lt;/li&gt;
&lt;li&gt;å®‰è£…ä¸€äº›éƒ¨ç½²ä¾�èµ–åŒ…ï¼Œå¦‚ chronyã€� libseccomp ç­‰&lt;/li&gt;
&lt;li&gt;å®‰è£…ä¸€äº›å·¥å…·å¦‚ yq, skopeo, kubectl ç­‰&lt;/li&gt;
&lt;li&gt;å®‰è£… nerdctl-full (containerd)&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ nerdctl load -i çš„æ–¹å¼�å¯¼å…¥nginx, registry, kubespray é•œåƒ�&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ yq æ¸²æŸ“é…�ç½®æ–‡ä»¶ï¼Œç”Ÿæˆ� kubespray éœ€è¦�çš„ env æ–‡ä»¶å’Œ inventory æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆ�é•œåƒ�ä»“åº“åŸŸå��è¯�ä¹¦å¹¶å°†è‡ªç­¾è¯�ä¹¦æ·»åŠ åˆ°ä¸»æœºçš„ CA trust ä¿¡ä»»å½“ä¸­&lt;/li&gt;
&lt;li&gt;åœ¨ &lt;code&gt;/etc/hosts&lt;/code&gt; ä¸­æ·»åŠ é•œåƒ�ä»“åº“åŸŸå�� hosts æ˜ å°„&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ nerdctl compose å�¯åŠ¨ nginx å’Œ registry æœ�åŠ¡&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²æ—¶é’Ÿå�Œæ­¥æœ�åŠ¡ chrony&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥å�„ä¸ªæœ�åŠ¡çš„çŠ¶æ€�&lt;/li&gt;
&lt;li&gt;æœ€å��ä½¿ç”¨ nerdctl run å�¯åŠ¨ kubespray å®¹å™¨æ�¥éƒ¨ç½² k8s é›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;kubespray-3&quot;&gt;&lt;a href=&quot;#kubespray-3&quot; class=&quot;headerlink&quot; title=&quot;kubespray&quot;/&gt;kubespray&lt;/h3&gt;&lt;p&gt;éƒ¨ç½²çš„æµ�ç¨‹ä¸ŠåŸºæœ¬ä¸Šå’Œ kubespray å®˜æ–¹å¤§ä½“ä¸€è‡´ï¼Œå�ªä¸�è¿‡æˆ‘ä»¬å¼•å…¥é‡Œåˆ†å±‚éƒ¨ç½²çš„ç‰¹æ€§&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;deploy_cluster&lt;/span&gt;&lt;/span&gt;(){&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  touch &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  STEPS=&lt;span class=&quot;string&quot;&gt;&quot;00-default-ssh-config 01-cluster-bootstrap-os 02-cluster-etcd 03-cluster-kubernetes 04-cluster-network 05-cluster-apps&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; step &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${STEPS}&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! grep -q &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      infolog &lt;span class=&quot;string&quot;&gt;&quot;start deploy &lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ansible-playbook &lt;span class=&quot;variable&quot;&gt;${ANSIBLE_ARGS}&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${KUBE_ROOT}&lt;/span&gt;/playbooks/&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt;.yml; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; &amp;gt;&amp;gt; &lt;span class=&quot;variable&quot;&gt;${INSTALL_STEPS_FILE}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        infolog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; successfully installed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        errorlog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; installation failed&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; 1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      warnlog &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;${step}&lt;/span&gt; is already installed, so skipped...&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;é…�ç½®å ¡å�’æœº ssh ç™»å½•ï¼ˆå�¯é€‰ï¼‰&lt;/li&gt;
&lt;li&gt;é…�ç½®èŠ‚ç‚¹ yum/apt æº�ä¸º nginx æœ�åŠ¡æ��ä¾›çš„æº�&lt;/li&gt;
&lt;li&gt;å°†è‡ªç­¾çš„åŸŸå��è¯�ä¹¦æ·»åŠ åˆ°ä¸»æœºçš„ CA trust ä¿¡ä»»å½“ä¸­&lt;/li&gt;
&lt;li&gt;åœ¨ &lt;code&gt;/etc/hosts&lt;/code&gt; ä¸­æ·»åŠ é•œåƒ�ä»“åº“åŸŸå�� hosts æ˜ å°„&lt;/li&gt;
&lt;li&gt;å…³é—­é˜²ç�«å¢™ï¼Œå®‰è£…æ—¶é’Ÿå�Œæ­¥æœ�åŠ¡ï¼Œè¿›è¡Œå�Œæ­¥æ—¶é’Ÿ&lt;/li&gt;
&lt;li&gt;åˆ�å§‹åŒ–é›†ç¾¤èŠ‚ç‚¹ï¼Œå®‰è£…éƒ¨ç½²ä¾�èµ–&lt;/li&gt;
&lt;li&gt;å®‰è£…å®¹å™¨è¿�è¡Œæ—¶ï¼Œä¸‹è½½æ–‡ä»¶å’Œç»„ä»¶é•œåƒ�&lt;/li&gt;
&lt;li&gt;éƒ¨ç½² etcd é›†ç¾¤&lt;/li&gt;
&lt;li&gt;éƒ¨ç½² K8s é›†ç¾¤&lt;/li&gt;
&lt;li&gt;éƒ¨ç½² CNI æ�’ä»¶&lt;/li&gt;
&lt;li&gt;å®‰è£…ä¸€äº›é¢�å¤–çš„ addon ç»„ä»¶å¦‚ (coredns)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è‡³æ­¤æ•´ä¸ªæ‰“åŒ…å’Œéƒ¨ç½²æµ�ç¨‹å°±å®Œæ¯•äº†ï¼Œä¸‹é�¢å†�è®²å‡ ä¸ªæ‰“åŒ…/éƒ¨ç½²å¸¸è§�çš„é—®é¢˜&lt;/p&gt;
&lt;h2 id=&quot;å…¶ä»–&quot;&gt;&lt;a href=&quot;#å…¶ä»–&quot; class=&quot;headerlink&quot; title=&quot;å…¶ä»–&quot;/&gt;å…¶ä»–&lt;/h2&gt;&lt;h3 id=&quot;kubeadm-è¯�ä¹¦&quot;&gt;&lt;a href=&quot;#kubeadm-è¯�ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;kubeadm è¯�ä¹¦&quot;/&gt;kubeadm è¯�ä¹¦&lt;/h3&gt;&lt;p&gt;é€šè¿‡ä¿®æ”¹ kubeadm æº�ç �çš„æ–¹å¼�å°†è¯�ä¹¦ç»­å‘½åˆ° 10 å¹´ï¼Œå¼€å�¯ &lt;code&gt;kubeadm_patch_enabled&lt;/code&gt; å�‚æ•°éƒ¨ç½²æ—¶å°±å°† kubeadm æ›¿æ�¢ä¸ºä¿®æ”¹å��çš„ kubeadmã€‚å…³äº� kubeadm çš„ä¿®æ”¹å’Œæ�„å»ºå’Œå�‚è€ƒæˆ‘ä¹‹å‰�å†™è¿‡çš„ã€Š&lt;a href=&quot;https://blog.k8s.li/build-k8s-binary-by-github-actions.html&quot;&gt;ä½¿ç”¨ GitHub Actions ç¼–è¯‘ kubernetes ç»„ä»¶&lt;/a&gt;ã€‹ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;---&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Relpace&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeadm&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;patched&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;version&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;get_url:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;url:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ patched_kubeadm_download_url }}&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;dest:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;template-variable&quot;&gt;{{ bin_dir }}&lt;/span&gt;/kubeadm&quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;mode:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0755&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;owner:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;root&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;group:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;root&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;tags:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeadm&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;when:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubeadm_patch_enabled&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;default(true)&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bool&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;é•œåƒ�ç¼“å­˜&quot;&gt;&lt;a href=&quot;#é•œåƒ�ç¼“å­˜&quot; class=&quot;headerlink&quot; title=&quot;é•œåƒ�ç¼“å­˜&quot;/&gt;é•œåƒ�ç¼“å­˜&lt;/h3&gt;&lt;p&gt;os-packages, kubespray-base, kubespray-files, kubespray-images è¿™å››ä¸ªé•œåƒ�åœ¨æ�„å»ºçš„æ—¶å€™éƒ½ä¼šé‡‡ç”¨ md5 å€¼çš„æ–¹å¼�æ ¡éªŒæ˜¯å�¦éœ€è¦�é‡�æ–°æ�„å»ºé•œåƒ�ï¼Œè¿™æ ·èƒ½å¤Ÿå¤§å¤§æ��å�‡ CI çš„æ‰§è¡Œæ•ˆç�‡ï¼Œä¸‹é�¢ä»¥ kubespray-base è¿™ä¸ªé•œåƒ�ä¸ºä¾‹ä»‹ç»�å…¶å�Ÿç�†å’Œå®�ç�°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æ�„å»ºé•œåƒ�å‰�ä¼šæœ‰ä¸€ä¸ª md5 è®¡ç®—å’Œæ ¡éªŒçš„æ­¥éª¤ï¼Œå°†ä¸�è¯¥é•œåƒ�ç´§å¯†ç›¸å…³çš„æ–‡ä»¶å†…å®¹è¿›è¡Œæ±‡æ€»å¹¶ç”Ÿæˆ� md5 å€¼ï¼Œå¹¶å°†è¿™ä¸ªå€¼å¾—ä»¥ label çš„æ–¹å¼�ä¿�å­˜åœ¨é•œåƒ�çš„å…ƒæ•°æ�®ä¿¡æ�¯å½“ä¸­ã€‚å¦‚æ�œè¯¥å€¼ä¸�ä¸Šä¸ªæœ€æ–°çš„é•œåƒ�ä¸­çš„ md5 å€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆå°±ä¸�éœ€è¦�é‡�æ–°æ�„å»ºè¯¥é•œåƒ�ï¼Œå�ªéœ€è¦�è¿›è¡Œ retag å�³å�¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Prepare&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;build&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;shell:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;bash&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;run:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--tags&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--always&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/IMAGE_TAG=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;branch&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--show-current&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/BRANCH_NAME=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;branch&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;--show-current&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/master/latest/;s/main/latest/;s/^/IMAGE_TAG_BY_BRANCH=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^kube_version: /KUBE_VERSION=/p&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;roles/kubespray-defaults/defaults/main.yaml&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;build/kubespray-base/Dockerfile&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;requirements.txt&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tests/requirements.txt&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;.github/workflows/build.yaml&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;md5sum&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;\ -&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/BASE_MD5=md5-/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;/&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;skopeo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;inspect&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;docker://${BASE_IMAGE_REPO}:${BRANCH_NAME}&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;mainfest.json;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;jq&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;.Labels.BASE_MD5&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;mainfest.json&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;s/^/LATEST_BASE_MD5=/&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;LATEST_BASE_MD5=null&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æ�œå½“å‰�md5 çš„å€¼ä¸�æœ€æ–°çš„ md5 å€¼ç›¸ç­‰ï¼Œå°±é‡�æ–°ç”Ÿæˆ�ä¸€ä¸ªæ–°çš„ Dockerfile æ�¥è¿›è¡Œé•œåƒ� retag çš„æ“�ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Replace&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Dockerfile&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;MD5&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;update&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;if:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_MD5&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.LATEST_BASE_MD5&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;run:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;FROM $&lt;span class=&quot;template-variable&quot;&gt;{{ env.BASE_IMAGE_REPO }}&lt;/span&gt;:$&lt;span class=&quot;template-variable&quot;&gt;{{ env.BASE_MD5 }}&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;build/kubespray-base/Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æ�„å»ºé•œåƒ�å¹¶å°† md5 å€¼ä½œä¸º labels å¡«å……åˆ°é•œåƒ�çš„å…ƒæ•°æ�®ä¿¡æ�¯å½“ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Build&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;push&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;kubespray-base&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;images&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;uses:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;docker/&lt;a href=&quot;/cdn-cgi/l/email-protection&quot; class=&quot;__cf_email__&quot; data-cfemail=&quot;0e6c7b67626a237e7b7d66236f6d7a6761604e783c&quot;&gt;[email protected]&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;with:&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;context:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;push:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;github.event_name&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#x27;pull_request&#x27;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;file:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;build/kubespray-base/Dockerfile&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;platforms:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;linux/amd64,linux/arm64&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;cache-from:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;type=local,src=/tmp/.buildx-cache&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;cache-to:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;type=local,dest=/tmp/.buildx-cache-new&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;build-args:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;KUBE_VERSION=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.KUBE_VERSION&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;labels:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;BASE_MD5=${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_MD5&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;tags:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_IMAGE_REPO&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}:${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.IMAGE_TAG&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_IMAGE_REPO&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}:${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_MD5&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_IMAGE_REPO&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}:${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BRANCH_NAME&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.BASE_IMAGE_REPO&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}:${{&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;env.IMAGE_TAG_BY_BRANCH&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;}}&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨è¿™ç§�æ–¹å¼�çš„å¥½å¤„å°±åœ¨äº�åœ¨ä¸�éœ€è¦�æ�„å»ºé•œåƒ�çš„æ—¶å€™èƒ½å¤§å¹…åº¦æ��å�‡ CI çš„è¿�è¡Œæ•ˆç�‡ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ�¨è��é˜…è¯»&quot;&gt;&lt;a href=&quot;#æ�¨è��é˜…è¯»&quot; class=&quot;headerlink&quot; title=&quot;æ�¨è��é˜…è¯»&quot;/&gt;æ�¨è��é˜…è¯»&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>