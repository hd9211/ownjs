<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>a75e6723af5b2d5244c119169d9d3943</guid>
<title>[推荐] 面试阿里，看这一篇就够了</title>
<link>https://toutiao.io/k/zdlcy5r</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;背景&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大家好，我是石头哥。&lt;/p&gt;&lt;figcaption&gt;&lt;span&gt;今天给大家分享下阿里面试攻略，声明一下：本文内容仅代表石头哥&lt;/span&gt;&lt;span&gt;个人观点，仅供参考&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/figcaption&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于想加入阿里的同学，或者想了解阿里面试流程（其实，很多公司，特别是 BAT 等大厂，有很多问题是相通的），一定&lt;strong&gt;不要错过&lt;/strong&gt;本文。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;作为候选人，从毕业到现在，参与的面试没有上百场也有大几十场了，也算是个面霸，不管失败和成功，积累的经验也都还不小。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;作为面试官，不管是社招还是校招，也都面试过很多人，也算久经沙场。在我参与的所有面试中，我都尽量期望能让候选人有所收获。（当然也期望自己在面试中也有所收获）&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文主要分为以下几个部分：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.8631732168850073&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6w7IZ1fdQoFnoCVEBowysYibZ5dnezLTDRMqiad67siawqLEnuv36uGtctw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;687&quot;/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;面试流程&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;简历投递及&lt;span&gt;注意事项&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;投递渠道&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;注意事项&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;没有主动投递简历，也会接到面试邀请？&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;在线笔试&lt;/span&gt;怎么进行？&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;面试过程注意事项&lt;/p&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;技术面会涉及哪些方面？&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;遇到不会的题目&lt;span&gt;怎么办&lt;/span&gt;？&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;某些问题能拒绝回答吗？&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;HR 面要注意什么？&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;一个部门面挂了还能继续面其他部门吗？&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;p&gt;背调注意事项&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;面试流程&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿里巴巴的面试流程，一般而言，会遵循如下如下图所示的流程进行：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.5763888888888888&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wnSH4ALaYmIraOOenic957YuZmmic504B6GsuYBAqAmGh0FPbwRX02ukw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;432&quot;/&gt;&lt;figcaption&gt;阿里面试流程&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体而言，不同业务线、不同部门、不同人可能有或多或少的差异（差异不大）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但对于整个阿里集团来讲，图中红色部分是必选的，在面试官考核流程里面有讲到。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;即面试官的构成必须遵循 &lt;code&gt;&lt;span&gt;1 OVER 1 + HR&lt;/span&gt;&lt;/code&gt; 原则：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;1：用人方直接主管&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;OVER 1：二级主管（主管的主管）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;HR：一般是部门的 HRG；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;且终面的面试官的层级需要高于招聘岗位层级至少2级。举个例子招聘P7，终面面试官职级必须&amp;gt;=P9，可能 P10 也会面。&lt;/p&gt;&lt;p&gt;比如我当初加入阿里时候的面试流程中，最后终面就是P10+HRG一起进行的面试。&lt;/p&gt;&lt;p&gt;一般而言，P7及以上的岗位都会要求进行交叉面（虽然公司招聘手册中并未强制要求）。交叉面一般是其他跨二级主管业务线的面试官。&lt;span/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，技术同学面试过程中，必须要有&lt;span&gt;至少一轮&lt;/span&gt;的&lt;span&gt;代码测评&lt;/span&gt;（笔试），具体测评工具和流程见后文详述。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面我将分别按照上文流程分别阐述其中的注意事项。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;简历投递及注意事项&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;投递渠道&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;投递简历无外乎就以下几个渠道：内推，猎头，官网投递，招聘平台（某聘、某 Boss 之类）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果能找到内推渠道，当然内推更好，且尽量找自己目标岗位对应部门的人内推，同部门的人肯定比其他人了解得更全。没有的话，就可以找我哈。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为什么内推更好以及其他内推注意事项，建议你应该看看我之前写的这篇文章 —— &lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247489516&amp;amp;idx=1&amp;amp;sn=2caba785992af70305ff15f4a740af4a&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;互联网大厂内推求职的正确姿势？&lt;/a&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;注意事项&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说说简历投递的注意事项。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;请确保简历中有如下基本信息：姓名、出生年月、邮箱、手机号、学校。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;投递相关岗位前，请一定确保自己了解目标岗位职级和要求。各个公司的岗位职级可以直接在网上搜索清楚，市场的职级和薪资水平大体上是对齐的。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5564814814814815&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wj3yqbh83bxLxy0SdHjJVhqxtD0ZKNFGfTMSo2PukiaKDk4nMAczCCUA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;figcaption&gt;大厂职级薪资对应关系，图源见水印&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图可以简单参考，确保自己打有准备之仗，不要再闹这样的笑话：比如曾经就有刚毕业 2 年的 Java 开发投递简历应聘“资深技术专家”（P9）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;其实阿里的职级从岗位名称上一般都能看出来，详见&lt;/span&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247489516&amp;amp;idx=1&amp;amp;sn=2caba785992af70305ff15f4a740af4a&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;这里&lt;/a&gt;&lt;span&gt;。实在不行，对照这个薪资水平也能看嘛，比如现在我年薪 20W，却试图找 P7，按照上图 P7 最低不得60W+呀，跳 2 级，薪资翻 3 倍？一般来说不太可能吧？&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，简历信息，请对自己负责一点，比如曾经收到这样一份简历：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.1417721518987343&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wFlEiaUJgCtG4mUPicULWZRdxtjTtV1z03j4XEhLeepG6beq83CJVfUeQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;395&quot;/&gt;&lt;figcaption&gt;“反例”简历&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个工作4年经验的同学，写着 “社会实践经验”？&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wMAxcJMZJgVN616HwqgZguNbnXbJYJ7nIoZZex3RdmWK3l5Bthiabm8Q/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;240&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，结合学校信息能&lt;strong&gt;猜测&lt;/strong&gt;出：这位同学17年毕业，前两份经验，应该算实习，后面才是正式工作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但为何我们自己不在简历中写明呢，不然还以为有两份正式工作经验不足2个月？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说到这，如果你换工作太频繁，这绝对是大大地减分项（不管你是主动还是被动）。&lt;span&gt;友情提醒一下，年轻人不要稍微有点不顺心，就想着换个环境，没有哪家公司、哪个工作环境是完美，事事如意的&lt;/span&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图流程中有写“&lt;span&gt;5年3跳&lt;/span&gt;”（5年内换了3份工作），公司可能会考虑到你的稳定性。此时，如果你简历很一般，加上频繁地换工作，大概率简历筛选这一关就过不了。（如果熟悉的人内推，有人帮忙“背书”，可能会&lt;span&gt;稍微&lt;/span&gt;好一丢丢）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果简历一般，学校一般，工作经验也一般，可能简历被拒的可能性比较大。因为大厂能收到的简历实在是太多了，如果没有自己的特色，很大众化的一份简历，确实不太容易通过。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;“简历造假”&lt;/strong&gt;（学历，工作经验等） 肯定是不能容忍的，哪怕你面试通过，后面背调也会揪出来的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，不管做啥，期望我们能够站在对方的角度思考和做事。正所谓 &lt;span&gt;&lt;strong&gt;与人方便，与己方便&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如曾经收到一份邮件，希望我帮忙内推：邮件标题 “内推”，正文无内容，附件“简历.pdf”。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时，我又只能如下表情了：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.048780487804878&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wqGZDI6pvJficKIiamkHCMIjfKXlebdDnuT3SHAqbwCWMrUJy5niccBf5Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;533&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种情况下，我一般简历都懒得打开看。有时候我还会收到微信，询问，“我给你发了邮件，怎么没反应啊？” 。关键微信他也没改名，也没说ta是谁。我咋知道你是谁发了啥邮件？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这也难怪，很多时候，候选人发了求职简历后，石沉大海。这样的方式，不石沉大海才怪！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们发送邮件最起码的“礼貌”还是要有的吧？简历命名格式建议“姓名-学校-岗位.pdf” 或 ”姓名-目前公司-岗位.pdf”，真的没必要太花哨，请用标准的PDF格式（或者Word），确保导入系统能正确被识别（一般花哨的pdf系统都不认识）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在陈述自己的技能栈、工作经验时要做到逻辑清晰，描述工作成果的时候，最好是要有数据支撑，比如，经过系统优化，性能提高了20%等等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，我们还是要注意一些“老生常谈”的细节，比如最好简历没错别字呀。也有遇到，一个人发个简历就发了两三遍的，要么忘了附件，要么简历发错了，岗位发错了等等。不是常说“&lt;span&gt;细节决定成败&lt;/span&gt;”么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我现在帮人内推，会直接给你一个标准（具体标准，公众号后台回复“阿里内推”），本来也是无偿帮忙提供一个内推渠道，但即便这样，也还是有很多人都不按照要求，不尊重别人的劳动成果。如果没按照要求的，一律拒绝。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;没有主动投递简历，也会接到面试邀请？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不知道你有没有经历过这种场景，明明我没有投递简历，可为啥还是会经常收到电话说是否看机会。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我经常收到这样的电话，最多的肯定是猎头了；然后就是各大公司的 HR；在阿里的话，就是对应部门的技术同学（这一点可能和其他公司不一样）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;猎头不用说了，有自己的渠道来源，能拿到你的联系方式。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;提醒大家，千万不要泄露同事信息，被揪出来，后果很严重。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大公司 HR，可能是你之前投递过他们公司，他们可能从公司内部系统里面捞到你，于是就问问。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿里也一样，内部有简历库，只要你的简历曾经到过阿里（不管校招、猎头、内推等），系统都会有记录，每次面试记录都有。然后各个用人部门（一般不是HR），就会定期去简历库捞捞自己感兴趣的简历，碰碰运气。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;因此，不要太频繁去投递简历，每次面试过程中实事求是，不要投机取巧，耍小花样。（点到为止，不能再多说了）&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经常收到同一个公司不同部门的电话，肯定也很烦人。这一点，公司内部也在逐渐优化整个招聘系统的流程，能看到一些进步。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如校招流程、内推流程，明显跟以前有较大的改进，对候选人更友好了，比如校招支持多个志愿。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;在线笔试&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面，聊聊在线笔试流程。其实，早在&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247493510&amp;amp;idx=1&amp;amp;sn=feeee082aef9a29747fc618cb7ca6c18&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;这篇文章&lt;/a&gt;中，我已经给大家介绍过了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要说明的是，不同部门，不同面试官可能用到的工具或形式不一样。本文提到的是公司系统推荐工具。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一般笔试前，面试官会通过公司的代码评测系统中，给候选人邮箱发送一份测评邀请。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.27710843373493976&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wpVbrv6HUlbibm2fZgjoiaz4bFVNMCPsyPk1HeJTR8WurwWzY8Qsmx0lA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1328&quot;/&gt;&lt;figcaption&gt;候选人收到的测评邀请&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;点击链接，会进入到在线编程系统，如下图所示：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.627906976744186&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wqQwnpWEJ1QNjk4hiaYTmPbrhMWOh4eoISR8b7VYbyMJ9Ur0lZEfvCZQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1978&quot;/&gt;&lt;figcaption&gt;阿里在线测评系统&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该系统有内置系统题库（如下图，5000+道题目，不过我很少看），其实每个面试官基本都有自己的小题库的。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.621859296482412&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wqumIIKIprs3eIKgeUNnPnkwnIqGokO2WyeAyfGpnu3m5nxOdGXKXkA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1592&quot;/&gt;&lt;figcaption&gt;阿里面试题库&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据面试官的风格，可能会选择开启视频，进行视频面试。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;候选人可点击左上角切换不用的编程语言，甚至可以切换到 &quot;vim&quot; 模式进行编程。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;这里补充分享下石头&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247487786&amp;amp;idx=1&amp;amp;sn=842202cc524477ec1546b4747bdbf1a8&amp;amp;chksm=eb4710cedc3099d86953451729c7f569866e6e58abbbec5c7ebe7423d12e1f11e189bb417f80&amp;amp;scene=21&amp;amp;cur_album_id=1514114646956425216#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;使用的 vim 插件列表&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5550122249388753&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6wWh7cbajgVXjG90nMFKTgWuZP721pHZXkEufFWdfXwhOwY0Y7EVIqgA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;818&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，提醒下大家，这个系统只是实时在线共享编辑，并不像 leetcode 刷题网站那样能直接编译提交。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;面试官其实也主要是&lt;span&gt;考察思路&lt;/span&gt;，&lt;span&gt;代码编写风格&lt;/span&gt;等，并不是说非得让候选人写出能够 AC 的代码。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;面试过程注意事项&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;面试时，在介绍自己的项目经验的时候，可以尝试用 “STAR行为面试法” 来回答：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;Situation、Task：项目当时的背景是怎样的，自己的任务和目标是啥？&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Action：要解决上述问题和实现目标，自己具体做了什么事情，怎样做的，为什么要这样做？&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Result：最  终成功是怎样的？在描述成果时，最好有数据能够支撑。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;技术面会涉及哪些方面？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;整体来讲，不同面试官可能问到的问题都不一样，题目难易程度，就看运气了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在线 coding 的笔试题必不可少，在前文也给予了说明。不过，整体来讲，我认为阿里在 coding 这块的难度（或者说在算法上的要求）还是比比如宇宙条等难度低一些。（以上基于石头哥面试后端开发岗，针对笔试环节的感受）&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在线笔试不用多说，刷题训练即可，社招可能没有太多时间大量刷题，但面试前刷点题目练练手，还是有必要的。推荐一份不错的 leetcode 刷题笔记，在公众号后台回复 “leetcode01” 获取。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;笔试过程中，多注意沟通。在 &lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247493510&amp;amp;idx=1&amp;amp;sn=feeee082aef9a29747fc618cb7ca6c18&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;面阿里P7，竟问这么简单的题目？&lt;/a&gt; 中，我也强调了，面试官在考察某道笔试题目的时候，并不是仅仅考察题目本身。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是期望以笔试题目为契机，考察候选人在解决实际问题时候的沟通能力，逻辑思维方式等。当然最后也会看看实实在在的 Code，从编码过程中看候选人的编程习惯，编码风格等等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;另外，不管怎样，你自己简历上的东西肯定是重点考察对象。多整理，理清自己的思路，介绍项目时强调你自己的贡献（前文提到的“STAR行为面试法”）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;面试八股文会考吗？&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可能会的，不同面试官可能风格不一样，有的可能不会很明显直接问你 “HashMap 是怎么实现的？”&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在回答这类问题的时候，我建议你如果能结合自身项目的具体case 分析，肯定会有加分的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;举个栗子哈。涉及 &quot;Java Full GC&quot; 这个话题时，你能结合某次生产的 “事故” 讲讲这个问题发生症状，当时如何解决的，如何定位根因等等？&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;遇到不会的题目怎么办？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;遇到不会的题目，不用紧张，可以尝试让面试官给予提示。多和面试官沟通，沟通能力也是在考察范围内的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;候选人有时候其实可以掌握主动权，比如“这个题目我虽然不太清楚，但类似的 XX，我很了解，……”。类似的套路，其实在我之前的推文中也多次说道，比如这篇中 —— &lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247491116&amp;amp;idx=1&amp;amp;sn=676c6dab8dbb095a31e6fb45cb31a828&amp;amp;chksm=eb471fc8dc3096dea5f1a8600fdc9163d3ce228e640ddb93fad310d44e739f9d719d0722efd7&amp;amp;token=1903173876&amp;amp;lang=zh_CN&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;一个读者大佬精心总结的阿里、腾讯、宇宙条大厂 Offer 面经和硬核面试攻略&lt;/a&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实在不行，直接回答 “这题我不会，换一道吧” 即可，也不用不懂装懂强行回答。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;作为成年人，我们知道最好不要在面试过程中和面试官起正面冲突。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;曾经，我在某家公司面试的时候，遇到过候选人怒怼题目，甚至还些许带些人身攻击，霸气离场。怼题目也就算了，还人身攻击。这种人，怎么说呢，素质堪忧。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为，面试本来就是一个双向选择，面试官和候选人双方平等交流、互相尊重的过程。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个优秀的面试官应该是要善于挖掘候选人的优点，而不是显示自己有多牛X，你提前准备的题目，就那么几道，换候选人提前准备还不是一样。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不过，程序员最基础的编码能力，我们还是需要具备的，这一点我在这篇文章中也多次强调 —— &lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247484698&amp;amp;idx=1&amp;amp;sn=03cc4636e7ee7364a85788a98809cc03&amp;amp;chksm=eb4704fedc308de8efd48ab9aed4fd1ddee5665d8e76d0d3767c1f704eac8b15a83e450a08f1&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;从一道面试题谈谈一线大厂码农应该具备的基本能力&lt;/a&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;某些问题能拒绝回答吗？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;遇到不能回答，或涉及商业机密的问题怎么办？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实，面试官手册中都明确说明，面试官只能提问与岗位要求和候选人任职资格相关的问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如，当面试官问你 “你们用户数多少？”&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果这确实是你公司相关商业机密数据，你可以直接拒绝回答。“不好意思，这一块数据，不太方便透露”。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;技术面试官问你 “你工资多少？”&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在面试流程中，其实是严禁面试官直接问你工资等个人隐私问题的。一般，谈薪流程都是由 HR 进行的。当然，这个你可以自己把握评判，比如在有的公司，这个面试官就是给你发 Offer 的人，他可能希望得到这数据进行判断。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不过，我们总不能啥问题都说 “这个数据涉及公司商业机密，不方便回答” 吧？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如，你这个系统平时负载如何，QPS 大概多少？你拿这个回应，就有点牵强了。（确实是商业机密除外）&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;HR 面要注意什么？&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;据我所知，多数情况下，一般公司的 HR 面试不会刷人。即便 HR 面试没通过，也很有可能是用人业务部门在有限 hc 的情况下，发现了更合适的候选人。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但阿里的 HR 在招人这块，权利还蛮大的，也具有一票否决权。即便前面技术（业务）面试都通过，但 HR 面试可能还是会刷掉，具体原因不好说，比如不符合公司文化？没有阿里味？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这块儿，其实没有特别好的建议，就看&lt;span&gt;缘分&lt;/span&gt;吧。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;咱们在 HR 面试过程中，表现真诚，如实的回答相关问题，只要没什么硬伤，一般来说，问题不太大。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;一个部门面挂了还能继续面其他部门吗&lt;/span&gt;？&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这是一个非常常见的问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一般来讲，面完一个部门后，可以继续面试其他部门的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个部门面试没通过，在另外的部门能面试通过吗？这个是有可能的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;之前在&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3OTUzMzcwNw==&amp;amp;mid=2247489516&amp;amp;idx=1&amp;amp;sn=2caba785992af70305ff15f4a740af4a&amp;amp;chksm=eb471608dc309f1ee4349dbedc0ff47a1670a804cba71818534ac3472fa12b183334397ea47b&amp;amp;token=196265126&amp;amp;lang=zh_CN&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;我的文章&lt;/a&gt;中也说过，一般而言，公司招聘都是一个萝卜一个坑，萝卜太大或太小都不一定合适。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为每个部门/每个岗位对候选人的要求、能力、技术栈等需求是不一样的，且每个面试官可能看中的点也可能不一样（说白了，面试确实也有一定运气成分）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，这并不能说明我们可以无限制重复下去。因为每一次面试记录，都会被面试官完整的记录下来。也许后面的面试官看到你前面的面试评价，就直接拒绝了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你多一次尝试，且拒绝后，简历通过率（或者一面通过率）就下降，到后面，很有可能根据这个通过率数字就被拒绝了（甚至简历都不会被看到）。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因此，还是建议我们“&lt;span&gt;打有准备之仗&lt;/span&gt;”，好好准备，珍惜自己每一次面试机会。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;背调注意事项&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果前面的面试流程通过，HR 谈薪等也满足预期后面就是 Offer、背调、体检、入职了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;背调一般会让第三方背调公司进行，有的公司调查得还挺详细的。我在 XX 公司的时候招人有看过候选人的背调报告，不过整体上来，主要是核实：工作经历（包括起止时间），是否属实；之前是否有违规（违法）记录；可能还会问你在之前公司表现如何呀、离职原因呀等等。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开始背调一般需要你提供之前公司的直属领导和HR的联系方式，背调公司可能会说仅参考你给的信息，访谈对象可能不仅限于你提供的人的联系方式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;你也没必要“造假”，说担心前面领导说你坏话啊等等，大家都是打工人，不至于。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如实提供相应信息就好，若耍小聪明，被发现了反而不太好。只要你别简历造假，比如学历造假，工作经验造假等等。背调，一般不会有什么幺蛾子的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;后记&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从投递简历到最后 Offer，整个流程算下来，耗时不短。比较快的，可能1个月之内能搞定，慢的就说不准了。我想，这也是招聘流程应该改进的地方吧。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关于面试相关话题更多的内容可以&lt;a href=&quot;https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI3OTUzMzcwNw==&amp;amp;action=getalbum&amp;amp;album_id=1551696963291693061&amp;amp;scene=173&amp;amp;subscene=&amp;amp;sessionid=undefined&amp;amp;enterid=0&amp;amp;from_msgid=2247493510&amp;amp;from_itemidx=1&amp;amp;count=3&amp;amp;nolastread=1#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;点击这里&lt;/a&gt;访问。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;公众号改变了推文规则，为了保证每周的最新分享能够及时送达到你，请按照下图添加星标。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;2.076923076923077&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/ZMXDhhGnYibu0eXyqAP5FvS55AiabLqH6w34eibMRyPH7hjgkASINwnmls4ibJs0pYwsRNWLAklyqEtjxDMqg1ljdw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;325&quot;/&gt;&lt;figcaption&gt;星标方法&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;期待能够和大家积极交流讨论，一起学习、共同进步。&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>feaf847ba77fe99478968dc0dc9d6f8b</guid>
<title>[推荐] Spring Boot 如何统一后端返回格式？老鸟们都是这样玩的</title>
<link>https://toutiao.io/k/290ect3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_png/PxMzT0Oibf4gOa4vJmA3Iz2aqv8C4e699G3oBEfic7adODd5HlOzXVxLgDu1sgreZv5vrd1SaRITNCaT17SVcT1w/0?wx_fmt=png&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;900.0000000000001&quot; data-cropy1=&quot;0&quot; data-cropy2=&quot;469.0140845070423&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5211111111111111&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/PxMzT0Oibf4gOa4vJmA3Iz2aqv8C4e699qibG4OFemkoiaP7pAkgs87ibAeWW4KIwXA5Acia5xbOicQbkyHV38n5yicvA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大家好，我是飘渺。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;今天我们来聊一聊在基于SpringBoot前后端分离开发模式下，如何&lt;span&gt;友好的&lt;/span&gt;返回统一的标准格式以及如何优雅的处理全局异常。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首先我们来看看为什么要返回统一的标准格式？&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;为什么要对SpringBoot返回统一的标准格式&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在默认情况下，SpringBoot的返回格式常见的有三种：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第一种：返回 String&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;getStr&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时调用接口获取到的返回值是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;hello,javadaily&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第二种：返回自定义对象&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/aniaml&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; Aniaml &lt;span&gt;getAniaml&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;  Aniaml aniaml = &lt;span&gt;new&lt;/span&gt; Aniaml(&lt;span&gt;1&lt;/span&gt;,&lt;span&gt;&quot;pig&quot;&lt;/span&gt;);&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; aniaml;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时调用接口获取到的返回值是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;id&quot;&lt;/span&gt;: &lt;span&gt;1&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;name&quot;&lt;/span&gt;: &lt;span&gt;&quot;pig&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;第三种：接口异常&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;@GetMapping(&lt;span&gt;&quot;/error&quot;&lt;/span&gt;)&lt;br/&gt;public int &lt;span&gt;&lt;span&gt;error&lt;/span&gt;&lt;/span&gt;(){&lt;br/&gt;    int i = 9/0;&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; i;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时调用接口获取到的返回值是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;&quot;2021-07-08T08:05:15.423+00:00&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;500&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;error&quot;&lt;/span&gt;: &lt;span&gt;&quot;Internal Server Error&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;path&quot;&lt;/span&gt;: &lt;span&gt;&quot;/wrong&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;基于以上种种情况，如果你和前端开发人员联调接口她们就会很懵逼，由于我们没有给他一个统一的格式，前端人员不知道如何处理返回值。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;还有甚者，有的同学比如小张喜欢对结果进行封装，他使用了Result对象，小王也喜欢对结果进行包装，但是他却使用的是Response对象，当出现这种情况时我相信前端人员一定会抓狂的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以我们项目中是需要定义一个统一的标准返回格式的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;定义返回标准格式&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一个标准的返回格式至少包含3部分：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;status 状态值：由后端统一定义各种返回结果的状态码&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;message 描述：本次接口调用的结果描述&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;data 数据：本次返回的数据。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;:&lt;span&gt;&quot;100&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;message&quot;&lt;/span&gt;:&lt;span&gt;&quot;操作成功&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;data&quot;&lt;/span&gt;:&lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然也可以按需加入其他扩展值，比如我们就在返回对象中添加了接口调用时间&lt;/p&gt;&lt;ol start=&quot;4&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;timestamp: 接口调用时间&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;定义返回对象&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@Data&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ResultData&lt;/span&gt;&amp;lt;&lt;span&gt;T&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;/** 结果状态 ,具体状态码参见ResultData.java*/&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; status;&lt;br/&gt;  &lt;span&gt;private&lt;/span&gt; String message;&lt;br/&gt;  &lt;span&gt;private&lt;/span&gt; T data;&lt;br/&gt;  &lt;span&gt;private&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; timestamp ;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;ResultData&lt;/span&gt; &lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;this&lt;/span&gt;.timestamp = System.currentTimeMillis();&lt;br/&gt;  }&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; &lt;span&gt;ResultData&amp;lt;T&amp;gt; &lt;span&gt;success&lt;/span&gt;&lt;span&gt;(T data)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    ResultData&amp;lt;T&amp;gt; resultData = &lt;span&gt;new&lt;/span&gt; ResultData&amp;lt;&amp;gt;();&lt;br/&gt;    resultData.setStatus(ReturnCode.RC100.getCode());&lt;br/&gt;    resultData.setMessage(ReturnCode.RC100.getMessage());&lt;br/&gt;    resultData.setData(data);&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; resultData;&lt;br/&gt;  }&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; &lt;span&gt;ResultData&amp;lt;T&amp;gt; &lt;span&gt;fail&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; code, String message)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    ResultData&amp;lt;T&amp;gt; resultData = &lt;span&gt;new&lt;/span&gt; ResultData&amp;lt;&amp;gt;();&lt;br/&gt;    resultData.setStatus(code);&lt;br/&gt;    resultData.setMessage(message);&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; resultData;&lt;br/&gt;  }&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;定义状态码&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;public enum ReturnCode {&lt;br/&gt;    /**操作成功**/&lt;br/&gt;    RC100(100,&lt;span&gt;&quot;操作成功&quot;&lt;/span&gt;),&lt;br/&gt;    /**操作失败**/&lt;br/&gt;    RC999(999,&lt;span&gt;&quot;操作失败&quot;&lt;/span&gt;),&lt;br/&gt;    /**服务限流**/&lt;br/&gt;    RC200(200,&lt;span&gt;&quot;服务开启限流保护,请稍后再试!&quot;&lt;/span&gt;),&lt;br/&gt;    /**服务降级**/&lt;br/&gt;    RC201(201,&lt;span&gt;&quot;服务开启降级保护,请稍后再试!&quot;&lt;/span&gt;),&lt;br/&gt;    /**热点参数限流**/&lt;br/&gt;    RC202(202,&lt;span&gt;&quot;热点参数限流,请稍后再试!&quot;&lt;/span&gt;),&lt;br/&gt;    /**系统规则不满足**/&lt;br/&gt;    RC203(203,&lt;span&gt;&quot;系统规则不满足要求,请稍后再试!&quot;&lt;/span&gt;),&lt;br/&gt;    /**授权规则不通过**/&lt;br/&gt;    RC204(204,&lt;span&gt;&quot;授权规则不通过,请稍后再试!&quot;&lt;/span&gt;),&lt;br/&gt;    /**access_denied**/&lt;br/&gt;    RC403(403,&lt;span&gt;&quot;无访问权限,请联系管理员授予权限&quot;&lt;/span&gt;),&lt;br/&gt;    /**access_denied**/&lt;br/&gt;    RC401(401,&lt;span&gt;&quot;匿名用户访问无权限资源时的异常&quot;&lt;/span&gt;),&lt;br/&gt;    /**服务异常**/&lt;br/&gt;    RC500(500,&lt;span&gt;&quot;系统异常，请稍后重试&quot;&lt;/span&gt;),&lt;br/&gt;&lt;br/&gt;    INVALID_TOKEN(2001,&lt;span&gt;&quot;访问令牌不合法&quot;&lt;/span&gt;),&lt;br/&gt;    ACCESS_DENIED(2003,&lt;span&gt;&quot;没有权限访问该资源&quot;&lt;/span&gt;),&lt;br/&gt;    CLIENT_AUTHENTICATION_FAILED(1001,&lt;span&gt;&quot;客户端认证失败&quot;&lt;/span&gt;),&lt;br/&gt;    USERNAME_OR_PASSWORD_ERROR(1002,&lt;span&gt;&quot;用户名或密码错误&quot;&lt;/span&gt;),&lt;br/&gt;    UNSUPPORTED_GRANT_TYPE(1003, &lt;span&gt;&quot;不支持的认证模式&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;    /**自定义状态码**/&lt;br/&gt;    private final int code;&lt;br/&gt;    /**自定义描述**/&lt;br/&gt;    private final String message;&lt;br/&gt;&lt;br/&gt;    ReturnCode(int code, String message){&lt;br/&gt;        this.code = code;&lt;br/&gt;        this.message = message;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;    public int &lt;span&gt;&lt;span&gt;getCode&lt;/span&gt;&lt;/span&gt;() {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; code;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    public String &lt;span&gt;&lt;span&gt;getMessage&lt;/span&gt;&lt;/span&gt;() {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; message;&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;统一返回格式&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; ResultData&amp;lt;String&amp;gt; &lt;span&gt;getStr&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt; &lt;span&gt;return&lt;/span&gt; ResultData.success(&lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时调用接口获取到的返回值是这样：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;100&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;message&quot;&lt;/span&gt;: &lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;data&quot;&lt;/span&gt;: &lt;span&gt;null&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;1625736481648&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;httpStatus&quot;&lt;/span&gt;: &lt;span&gt;0&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这样确实已经实现了我们想要的结果，我在很多项目中看到的都是这种写法，在Controller层通过&lt;code&gt;ResultData.success()&lt;/code&gt;对返回结果进行包装后返回给前端。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;看到这里我们不妨停下来想想，这样做有什么弊端呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;最大的弊端就是我们后面每写一个接口都需要调用&lt;code&gt;ResultData.success()&lt;/code&gt;这行代码对结果进行包装，重复劳动，浪费体力；&lt;br/&gt;&lt;br/&gt;而且还很容易被其他老鸟给嘲笑。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PxMzT0Oibf4gOa4vJmA3Iz2aqv8C4e699DGNhndOUYozjUs4rrYMKxpOEEkTiaW15gk9lPPwNPQo3hibG4fElxHPw/640?wx_fmt=png&quot; data-type=&quot;png&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以呢我们需要对代码进行优化，目标就是不要每个接口都手工制定&lt;code&gt;ResultData&lt;/code&gt;返回值。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;高级实现方式&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要优化这段代码很简单，我们只需要借助SpringBoot提供的&lt;code&gt;ResponseBodyAdvice&lt;/code&gt;即可。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;“&lt;/span&gt;&lt;p&gt;ResponseBodyAdvice的作用：拦截Controller方法的返回值，统一处理返回值/响应体，一般用来统一返回格式，加解密，签名等等。&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;先来看下&lt;code&gt;ResponseBodyAdvice&lt;/code&gt;的源码：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;interface&lt;/span&gt; &lt;span&gt;ResponseBodyAdvice&lt;/span&gt;&amp;lt;&lt;span&gt;T&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;/**&lt;br/&gt;  * 是否支持advice功能&lt;br/&gt;  * true 支持，false 不支持&lt;br/&gt;  */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;supports&lt;/span&gt;&lt;span&gt;(MethodParameter var1, Class&amp;lt;? extends HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; var2)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;   &lt;span&gt;/**&lt;br/&gt;  * 对返回的数据进行处理&lt;br/&gt;  */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Nullable&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;T &lt;span&gt;beforeBodyWrite&lt;/span&gt;&lt;span&gt;(@Nullable T var1, MethodParameter var2, MediaType var3, Class&amp;lt;? extends HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; var4, ServerHttpRequest var5, ServerHttpResponse var6)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们只需要编写一个具体实现类即可&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * &lt;span&gt;@author&lt;/span&gt; jam&lt;br/&gt; * &lt;span&gt;@date&lt;/span&gt; 2021/7/8 10:10 上午&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@RestControllerAdvice&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ResponseAdvice&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;ResponseBodyAdvice&lt;/span&gt;&amp;lt;&lt;span&gt;Object&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; ObjectMapper objectMapper;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;supports&lt;/span&gt;&lt;span&gt;(MethodParameter methodParameter, Class&amp;lt;? extends HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; aClass)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;@SneakyThrows&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;beforeBodyWrite&lt;/span&gt;&lt;span&gt;(Object o, MethodParameter methodParameter, MediaType mediaType, Class&amp;lt;? extends HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(o &lt;span&gt;instanceof&lt;/span&gt; String){&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; objectMapper.writeValueAsString(ResultData.success(o));&lt;br/&gt;        }        &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; ResultData.success(o);&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要注意两个地方：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;@RestControllerAdvice&lt;/code&gt;注解&lt;/p&gt;&lt;p&gt;&lt;code&gt;@RestControllerAdvice&lt;/code&gt;是&lt;code&gt;@RestController&lt;/code&gt;注解的增强，可以实现三个方面的功能：&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ol class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;全局异常处理&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;全局数据绑定&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;全局数据预处理&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;String类型判断&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;if&lt;/span&gt;(o &lt;span&gt;instanceof&lt;/span&gt; String){&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; objectMapper.writeValueAsString(ResultData.success(o));&lt;br/&gt;} &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这段代码一定要加，如果Controller直接返回String的话，SpringBoot是直接返回，故我们需要手动转换成json。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过上面的处理我们就再也不需要通过&lt;code&gt;ResultData.success()&lt;/code&gt;来进行转换了，直接返回原始数据格式，SpringBoot自动帮我们实现包装类的封装。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;getStr&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时我们调用接口返回的数据结果为：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;@GetMapping(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;public String getStr(){&lt;br/&gt;  return &lt;span&gt;&quot;hello,javadaily&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是不是感觉很完美，别急，还有个问题在等着你呢。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PxMzT0Oibf4gOa4vJmA3Iz2aqv8C4e699kLQhjyGc5xic06EVg7GH1ibETk09icl6qvkqDUObSz9U2Fpqnn5dBXz0Q/640?wx_fmt=png&quot; data-type=&quot;png&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;br/&gt;接口异常问题&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时有个问题，由于我们没对Controller的异常进行处理，当我们调用的方法一旦出现异常，就会出现问题，比如下面这个接口&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/wrong&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;error&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;9&lt;/span&gt;/&lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; i;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;返回的结果为：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PxMzT0Oibf4gOa4vJmA3Iz2aqv8C4e699F4vXppP4LAnKTsuvSGEfsU3NulReBHdmsX4Vic8n1EeopTPL8OLwwJw/640?wx_fmt=png&quot; data-type=&quot;png&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;br/&gt;这显然不是我们想要的结果，接口都报错了还返回操作成功的响应码，前端看了会打人的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;别急，接下来我们进入第二个议题，如何优雅的处理全局异常。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;SpringBoot为什么需要全局异常处理器&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;不用手写try...catch，由全局异常处理器统一捕获&lt;/p&gt;&lt;p&gt;使用全局异常处理器最大的便利就是程序员在写代码时不再需要手写&lt;code&gt;try...catch&lt;/code&gt;了，前面我们讲过，默认情况下SpringBoot出现异常时返回的结果是这样：&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;&quot;2021-07-08T08:05:15.423+00:00&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;500&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;error&quot;&lt;/span&gt;: &lt;span&gt;&quot;Internal Server Error&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;path&quot;&lt;/span&gt;: &lt;span&gt;&quot;/wrong&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种数据格式返回给前端，前端是看不懂的，所以这时候我们一般通过&lt;code&gt;try...catch&lt;/code&gt;来处理异常&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/wrong&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;error&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;int&lt;/span&gt; i;&lt;br/&gt;    &lt;span&gt;try&lt;/span&gt;{&lt;br/&gt;        i = &lt;span&gt;9&lt;/span&gt;/&lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;    }&lt;span&gt;catch&lt;/span&gt; (Exception e){&lt;br/&gt;        log.error(&lt;span&gt;&quot;error:{}&quot;&lt;/span&gt;,e);&lt;br/&gt;        i = &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; i;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们追求的目标肯定是不需要再手动写&lt;code&gt;try...catch&lt;/code&gt;了，而是希望由全局异常处理器处理。&lt;/p&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;对于自定义异常，只能通过全局异常处理器来处理&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;error1&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;empty&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt; &lt;span&gt;throw&lt;/span&gt;  &lt;span&gt;new&lt;/span&gt; RuntimeException(&lt;span&gt;&quot;自定义异常&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;当我们引入Validator参数校验器的时候，参数校验不通过会抛出异常，此时是无法用&lt;code&gt;try...catch&lt;/code&gt;捕获的，只能使用全局异常处理器。&lt;/p&gt;&lt;blockquote&gt;&lt;span&gt;“&lt;/span&gt;&lt;p&gt;SpringBoot集成参数校验请参考这篇文章&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzAwMTk4NjM1MA==&amp;amp;mid=2247490888&amp;amp;idx=1&amp;amp;sn=dd7c3a4feb185abdca42362000b336d3&amp;amp;chksm=9ad00709ada78e1f04f0d878e03625083abccb5f72b6ae473c6816e2039edf245fe4ac6f50a6&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;SpringBoot开发秘籍 - 集成参数校验及高阶技巧&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;SpringBoot开发秘籍 - 集成参数校验及高阶技巧&lt;/a&gt;&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;如何实现全局异常处理器&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@Slf&lt;/span&gt;4j&lt;br/&gt;&lt;span&gt;@RestControllerAdvice&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;RestExceptionHandler&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 默认全局异常处理。&lt;br/&gt;     * &lt;span&gt;@param&lt;/span&gt; e the e&lt;br/&gt;     * &lt;span&gt;@return&lt;/span&gt; ResultData&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@ExceptionHandler&lt;/span&gt;(Exception&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;br/&gt;    @&lt;span&gt;ResponseStatus&lt;/span&gt;(&lt;span&gt;HttpStatus&lt;/span&gt;.&lt;span&gt;INTERNAL_SERVER_ERROR&lt;/span&gt;)&lt;br/&gt;    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;ResultData&lt;/span&gt;&amp;lt;&lt;span&gt;String&lt;/span&gt;&amp;gt; &lt;span&gt;exception&lt;/span&gt;(&lt;span&gt;Exception&lt;/span&gt; &lt;span&gt;e&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;        log.error(&lt;span&gt;&quot;全局异常信息 ex={}&quot;&lt;/span&gt;, e.getMessage(), e);&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; ResultData.fail(ReturnCode.RC500.getCode(),e.getMessage());&lt;br/&gt;    }&lt;br/&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有三个细节需要说明一下：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;@RestControllerAdvice&lt;/code&gt;，RestController的增强类，可用于实现全局异常处理器&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;@ExceptionHandler&lt;/code&gt;,统一处理某一类异常，从而减少代码重复率和复杂度，比如要获取自定义异常可以&lt;code&gt;@ExceptionHandler(BusinessException.class)&lt;/code&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;@ResponseStatus&lt;/code&gt;指定客户端收到的http状态码&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;体验效果&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这时候我们调用如下接口：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;error1&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;empty&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;throw&lt;/span&gt;  &lt;span&gt;new&lt;/span&gt; RuntimeException(&lt;span&gt;&quot;自定义异常&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;返回的结果如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;500&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;message&quot;&lt;/span&gt;: &lt;span&gt;&quot;自定义异常&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;data&quot;&lt;/span&gt;: &lt;span&gt;null&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;1625795902556&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;基本满足我们的需求了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但是当我们同时启用统一标准格式封装功能&lt;code&gt;ResponseAdvice&lt;/code&gt;和&lt;code&gt;RestExceptionHandler&lt;/code&gt;全局异常处理器时又出现了新的问题：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;100&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;message&quot;&lt;/span&gt;: &lt;span&gt;&quot;操作成功&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;data&quot;&lt;/span&gt;: {&lt;br/&gt;    &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;500&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&quot;message&quot;&lt;/span&gt;: &lt;span&gt;&quot;自定义异常&quot;&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&quot;data&quot;&lt;/span&gt;: &lt;span&gt;null&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;1625796167986&lt;/span&gt;&lt;br/&gt;  },&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;1625796168008&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时返回的结果是这样，统一格式增强功能会给返回的异常结果再次封装，所以接下来我们需要解决这个问题。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;全局异常接入返回的标准格式&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要让全局异常接入标准格式很简单，因为全局异常处理器已经帮我们封装好了标准格式，我们只需要直接返回给客户端即可。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@SneakyThrows&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt; Object &lt;span&gt;beforeBodyWrite&lt;/span&gt;&lt;span&gt;(Object o, MethodParameter methodParameter, MediaType mediaType, Class&amp;lt;? extends HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt;(o &lt;span&gt;instanceof&lt;/span&gt; String){&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; objectMapper.writeValueAsString(ResultData.success(o));&lt;br/&gt;  }&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt;(o &lt;span&gt;instanceof&lt;/span&gt; ResultData){&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; o;&lt;br/&gt;  }&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; ResultData.success(o);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;关键代码：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;if&lt;/span&gt;(o &lt;span&gt;instanceof&lt;/span&gt; ResultData){&lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; o;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果返回的结果是ResultData对象，直接返回即可。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这时候我们再调用上面的错误方法，返回的结果就符合我们的要求了。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;  &lt;span&gt;&quot;status&quot;&lt;/span&gt;: &lt;span&gt;500&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;message&quot;&lt;/span&gt;: &lt;span&gt;&quot;自定义异常&quot;&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;data&quot;&lt;/span&gt;: &lt;span&gt;null&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;&quot;timestamp&quot;&lt;/span&gt;: &lt;span&gt;1625796580778&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;好了，今天的文章就到这里了，希望通过这篇文章你能掌握如何在你项目中友好实现统一标准格式到返回并且可以优雅的处理全局异常。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;github地址：https://github.com/jianzh5/cloud-blog/&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后，我是飘渺Jam，一名写代码的架构师，做架构的程序员，期待你的关注。咱们下期见！&lt;/p&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>36bd6b28422b2ff69e318cdab53ac553</guid>
<title>[推荐] 工具 | 阿里巴巴开源的，轻量、高性能、可集成、可扩展的流程引擎</title>
<link>https://toutiao.io/k/xuszkb1</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;weui-dialog&quot;&gt;
      &lt;p class=&quot;weui-dialog__hd&quot;&gt;&lt;strong class=&quot;weui-dialog__title&quot;&gt;&quot;Top Stories&quot; is disabled&lt;/strong&gt;&lt;/p&gt;
      &lt;p class=&quot;weui-dialog__bd&quot;&gt;
        Enable &quot;Top Stories&quot; in &quot;Settings&quot; &amp;gt; &quot;General&quot; &amp;gt; &quot;Manage Discover&quot;      &lt;/p&gt;
      
    &lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3a19da1216bbc7f8487cae5e563a25ce</guid>
<title>[推荐] 最近 GitHub 上很火的 7 个项目</title>
<link>https://toutiao.io/k/3ybk9zj</link>
<content:encoded>&lt;div&gt;&lt;div&gt;

                

                
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>c79eb16f0fb3dfe99024d2f1e72b103d</guid>
<title>[推荐] 慢 SQL 排查思路？就这</title>
<link>https://toutiao.io/k/xitokgg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;今天和大家聊一个常见的问题：慢SQL。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过本文你将了解到以下内容：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;慢SQL的危害&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;SQL语句的执行过程&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;存储引擎和索引的那些事儿&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;慢SQL解决之道&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;后续均以MySQL默认存储引擎InnoDB为例进行展开，话不多说，开搞！&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;1.慢SQL的危害&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;慢SQL，就是跑得很慢的SQL语句，你可能会问慢SQL会有啥问题吗？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;试想一个场景：&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;大白和小黑端午出去玩，机票太贵于是买了高铁，火车站的人真是乌央乌央的。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;马上检票了，大白和小黑准备去厕所清理下库存，坑位不多，排队的人还真不少。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;小黑发现其中有3个坑的乘客贼慢，其他2个坑位换了好几波人，这3位坑主就是不出来。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;等在外面的大伙，心里很是不爽，长期占用公共资源，后面的人没法用。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;小黑苦笑道：这不就是厕所版的慢SQL嘛！&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这是实际生活中的例子，换到MySQL服务器也是一样的，毕竟科技源自生活嘛。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;MySQL服务器的资源(CPU、IO、内存等)是有限的，尤其在高并发场景下需要快速处理掉请求，否则一旦出现慢SQL就会阻塞掉很多正常的请求，造成大面积的失败/超时等。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.7542262678803641&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawKIx7Ap2Bfx9G5kxrH9wMxUOAGoJEthtictIjPvwyAUmk9vCQEJVicyxA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1538&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;2.SQL语句执行过程&lt;/span&gt;&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3701188455008489&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawvAsmfEicYvbEJicic3Zw3Ud8icpIqm5e8xVH5vAEkPUkzEkUbeQ0CUEpZQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1178&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;客户端和MySQL服务端的交互过程简介：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;客户端发送一条SQL语句给服务端，服务端的连接器先进行账号/密码、权限等环节验证，有异常直接拒绝请求。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;服务端查询缓存，如果SQL语句命中了缓存，则返回缓存中的结果，否则继续处理。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;服务端对SQL语句进行词法解析、语法解析、预处理来检查SQL语句的合法性。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;服务端通过优化器对之前生成的解析树进行优化处理，生成最优的物理执行计划。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;将生成的物理执行计划调用存储引擎的相关接口，进行数据查询和处理。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;处理完成后将结果返回客户端。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;客户端和MySQL服务端的交互过程简图：&lt;img data-ratio=&quot;1.138095238095238&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawCB9kKgFQd2GrOsuGfXszyoH4VZBEzSEOODJcyc0WUQ6a2kgR7k3Jkw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1260&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;俗话说&quot;条条大路通罗马&quot;，优化器的作用就是找到这么多路中最优的那一条。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;存储引擎更是决定SQL执行的核心组件，适当了解其中原理十分有益。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;3. 存储引擎和索引的那些事儿&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.1 存储引擎&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;InnoDB存储引擎(Storage Engine)是MySQL默认之选，所以非常典型。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;存储引擎的主要作用是进行数据的存取和检索，也是真正执行SQL语句的组件。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;InnoDB的整体架构分为两个部分：内存架构和磁盘架构，如图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.76875&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawfb1drqp3TbIRyP2cCf6mGMDkVq98oaVOXibG7mtT1u02K0NJrupBQAQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;640&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;存储引擎的内容非常多，并不是一篇文章能说清楚的，本文不过多展开，我们在此只需要了解内存架构和磁盘架构的大致组成即可。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;InnoDB 引擎是面向行存储的，数据都是存储在磁盘的数据页中，数据页里面按照固定的行格式存储着每一行数据。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;行格式主要分为四种类型Compact、Redundant、Dynamic和Compressed，默认为Compact格式。&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.3352941176470588&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawHM0bYBZibKpjUnIBh96avgob6ImMts8IUrUp4meU3kSvZgvQXKIS18A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1360&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;磁盘预读机制和局部性原理&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当计算机访问一个数据时，不仅会加载当前数据所在的数据页，还会将当前数据页相邻的数据页一同加载到内存，磁盘预读的长度一般为页的整倍数，&lt;span&gt;从而有效降低磁盘IO的次数。&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5628834355828221&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawzADXHbHgXLrRvzTo6riacibYCuc6j9iaJVD8UAanYz8SzqUcqD0IS93cA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1304&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;磁盘和内存的交互&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;MySQL中磁盘的数据需要被交换到内存，才能完成一次SQL交互，大致如图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5955414012738853&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawuuDwcNhjLLYYNrica4icc1Hs92j2gLSUsdVFIn4Pia6XkGq2lPop6wHmw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1256&quot;/&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;扇区是硬盘的读写的基本单位，通常情况下每个扇区的大小是 512B&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;磁盘块文件系统读写数据的最小单位，相邻的扇区组合在一起形成一个块，一般是4KB&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;页是内存的最小存储单位，页的大小通常为磁盘块大小的 2^n 倍&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;InnoDB页面的默认大小是16KB，是数倍个操作系统的页&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5098039215686274&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawQcR5UBxgWJluY8rDsG1UbnabFia04265Pns6AicQticic2WIXJahNE0t0A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;918&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;随机磁盘IO&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;MySQL的数据是一行行存储在磁盘上的，并且这些数据并非物理连续地存储，这样的话要查找数据就无法避免随机在磁盘上读取和写入数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于MySQL来说，当出现大量磁盘随机IO时，大部分时间都被浪费到寻道上，磁盘呼噜呼噜转，就是传输不了多少数据。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;一次磁盘访问由三个动作组成：&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;寻道：磁头移动定位到指定磁道&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;旋转：等待指定扇区从磁头下旋转经过&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;数据传输：数据在磁盘与内存之间的实际传输&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于存储引擎来说，如何有效降低随机IO是个非常重要的问题。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3.2 索引&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以实现增删改查的数据结构非常多，包括：哈希表、二叉搜索树、AVL、红黑树、B树、B+树等，这些都是可以作为索引的候选数据结构。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结合MySQL的实际情况：磁盘和内存交互、随机磁盘IO、排序和范围查找、增删改的复杂度等等，综合考量之下B+树脱颖而出。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;B+树作为多叉平衡树，对于范围查找和排序都可以很好地支持，并且更加矮胖，访问数据时的平均磁盘IO次数取决于树的高度，因此B+树可以让磁盘的查找次数更少。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在InnoDB中B+树的高度一般都在2~4层，并且根节点常驻内存中，也就是说查找某值的行记录时最多只需要1~3次磁盘I/O操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;MyISAM是将数据和索引分开存储的，InnoDB存储引擎的数据和索引没有分开存储，这也就是为什么有人说Innodb索引即数据，数据即索引，如图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4496951219512195&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawXEfGDDbZyicTohgDN9B9QEOOW2VcHRltqJyshFNkPFxgC1via6ksic6JQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1312&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;说到InnoDB的数据和索引的存储，就提到一个名词：&lt;strong&gt;聚集索引&lt;/strong&gt;。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;聚集索引&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;聚集索引将索引和数据完美地融合在一起，是每个Innodb表都会有的一个特殊索引，一般来说是借助于表的主键来构建的B+树。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假设我们有student表，将id作为主键索引，那么聚集索引的B+树结构，如图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5038051750380518&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawTxntAYMkhaT4mp2Xb7oPJXxMC9lUd7qfqbBcX3PqXiaz2NbsngubJJA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1314&quot;/&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;非叶子节点不存数据，只有主键和相关指针&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;叶子节点包含主键、行数据、指针&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;叶子节点之间由双向指针串联形成有序双向链表，叶子节点内部也是有序的&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;聚集索引按照如下规则创建：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;有主键时InnoDB利用主键来生成&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;没有主键，InnoDB会选择一个非空的唯一索引来创建&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;无主键且非NULL唯一索引时，InnoDB会隐式创建一个自增的列来创建&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假如我们要查找id=10的数据，大致过程如下：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;索引的根结点在内存中，10&amp;gt;9 因此找到P3指针&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;P3指向的数据并没有在内存中，因此产生1次磁盘IO读取磁盘块3到内存&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;在内存中对磁盘块3进行二分查找，找到ID=9的全部值&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;非聚集索引&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;非聚集索引的叶子节点中存放的是二级索引值和主键键值，非叶子节点和叶子节点都没有存储整行数据值。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假设我们有student表，将name作为二级索引，那么非聚集索引的B+树结构，如图：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.4888558692421991&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawcfyMslw9iayvVYUmA00ia3xQgP1NRefw2oIWBRhSbqomtK8icuibOC7eiaQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1346&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由于非聚集索引的叶子节点没有存储行数据，如果通过非聚集索引来查找非二级索引值，需要分为两步：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;第一：通过非聚集索引的叶子节点来确定数据行对应的主键&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;第二：通过相应的主键值在聚集索引中查询到对应的行记录&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们把通过非聚集索引找到主键值，再根据主键值从聚集索引找对于行数据的过程称为：&lt;strong&gt;回表查询&lt;/strong&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;换句话说：select * from student where name = &#x27;Bob&#x27; 将产生回表查询，因为在name索引的叶子节点没有其他值，只能从聚集索引获得。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以如果查找的字段在非聚集索引就可以完成，就可以避免一次回表过程，这种称为：覆盖索引，所以select * 并不是好习惯，需要什么拿什么就好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假如我们要查找name=Tom的记录的所有值，大致过程如下：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;从非聚集索引开始，根节点在内存中，按照name的字典序找到P3指针&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;P3指针所指向的磁盘块不在内存中，产生1次磁盘IO加载到内存&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;在内存中对磁盘块3的数据进行搜索，获得name=tom的记录的主键值为4&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;根据主键值4从聚集索引的根节点中获得P2指针&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;P2指针所指向的磁盘块不在内存中，产生第2次磁盘IO加载到内存&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;将上一步获得的数据，在内存中进行二分查找获得全部行数据&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上述查询就包含了一次回表过程，因此性能比主键查询慢了一倍，因此尽量使用主键查询，一次完事。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;4. 慢SQL解决思路&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;出现慢SQL的原因很多，我们抛开单表数亿记录和无索引的特殊情况，来讨论一些更有普遍意义的慢SQL原因和解决之道。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们从两个方面来进行阐述：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.33779761904761907&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/wAkAIFs11qaMZss2ia9Bx0yJNIfuKRhiawibEssFkqTicicyicMbibAPy4NoZk2dKJvHUZLSnVldt6PtQzkAo4c5cd6VA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1344&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.1 索引设置原则&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;程序员的角度和存储引擎的角度是不一样的，索引写的好，SQL跑得快。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假如表中有1000w记录，其中有status字段表示状态，可能90%的数据status=1，可以不将status作为索引，因为其对数据记录区分度很低。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;每个索引都需要占用磁盘空间，修改表数据时会对索引进行更新，索引越多，更新越复杂。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;因为每添加一个索引，.ibd文件中就需要多维护一个B+Tree索引树，如果某一个table中存在10个索引，那么就需要维护10棵B+Tree，写入效率会降低，并且会浪费磁盘空间。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果某个字段经常用来做查询条件，那么该字段的查询速度会影响整个表的查询速度，属于热门字段，为其建立索引非常必要。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于需要经常使用ORDER BY、GROUP BY、DISTINCT和UNION等操作的字段建立索引，可以有效借助B+树的特性来加速执行。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;主键可以用来创建聚集索引，外键也是唯一的且常用于表关联的字段，也需要建索引来提高性能。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.2 SQL的优化&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果数据库表的索引设置比较合理，SQL语句书写不当会造成索引失效，甚至造成全表扫描，迅速拉低性能。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;索引失效&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们在写SQL的时候在某些情况下会出现索引失效的情况：&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;select id from std upper(name) = &#x27;JIM&#x27;;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;select id from std where id+1=10;&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;对索引使用&amp;lt;&amp;gt; 、not in 、not exist、!=&lt;/strong&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;select id from std where name != &#x27;jim&#x27;;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;select id from std name like &#x27;%jim&#x27;;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;比如：字符串类型索引字段不加引号，select id from std name = 100;保持变量类型与字段类型一致&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;并不是所有的or都会使索引失效，如果or连接的所有字段都设置了索引，是会走索引的，一旦有一个字段没有索引，就会走全表扫描。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;联合索引包含key1，key2，key3三列，但SQL语句没有key1，根据联合索引的最左匹配原则，不会走联合索引。&lt;br/&gt;select name from table where key2=1 and key3=2;&lt;/p&gt;&lt;/blockquote&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;好的建议&lt;/h4&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;对于数据库来说，在绝大部分情况下，连接会比子查询更快，使用连接的方式，MySQL优化器一般可以生成更佳的执行计划，更高效地处理查询&lt;br/&gt;而子查询往往需要运行重复的查询，子查询生成的临时表上也没有索引， 因此效率会更低。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;禁止分页查询偏移量过大，如limit 100000,10&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;使用覆盖索引&lt;/strong&gt;&lt;br/&gt;减少select * 借助覆盖索引，减少回表查询次数。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;多表关联查询时，小表在前，大表在后&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;在MySQL中，执行from后的表关联查询是从左往右执行的，第一张表会涉及到全表扫描，所以将小表放在前面，先扫小表，扫描快效率较高，在扫描后面的大表，或许只扫描大表的前100行就符合返回条件并return了。&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;MySQL采用从左往右的顺序解析where子句，可以将过滤数据多的条件放在前面，最快速度缩小结果集。&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;使用小范围事务，而非大范围事务&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;遵循最左匹配原则&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;使用联合索引，而非建立多个单独索引&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;4.3 慢SQL的分析&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在分析慢SQL之前需要通过MySQL进行相关设置：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;开启：SET GLOBAL slow_query_log = 1;&lt;br/&gt;开启状态：SHOW VARIABLES LIKE &lt;span&gt;&#x27;%slow_query_log%&#x27;&lt;/span&gt;;&lt;br/&gt;设置阈值：SET GLOBAL long_query_time=3;&lt;br/&gt;查看阈值：SHOW GLOBAL VARIABLES LIKE &lt;span&gt;&#x27;long_query_time%&#x27;&lt;/span&gt;; &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;explain分析SQL&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;explain命令只需要加在select之前即可，例如:&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;explain select * from std where id &amp;lt; 100;&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;该命令会展示sql语句的详细执行过程，帮助我们定位问题，网上关于explain的用法和讲解很多，本文不再展开。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;5. 小结&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文从慢SQL的危害、Innodb存储引擎、聚集索引、非聚集索引、索引失效、SQL优化、慢SQL分析等角度进行了阐述。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;MySQL的很多知识点都非常复杂，并非一两篇文章能讲清楚的，因此本文在很多地方显得很单薄，好在网上资料非常多。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果本文能在某些方面对读者有所启发，足矣。&lt;/p&gt;&lt;hr/&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;已经在写 MySQL 锁的文章了，关注我追更哟~&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzkxNTE3NjQ3MA==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/eSdk75TK4nEf5LN3Y4UErfNUkiaMseJPkdXA4xPD6Uicl8EqAJAEKVIKalU19xS41TO3aPmHK5bqbzGTwu3z92Kg/0?wx_fmt=png&quot; data-nickname=&quot;yes的练级攻略&quot; data-alias=&quot;yes_java&quot; data-signature=&quot;用接地气的话来分享一些后端技术或写一些想写的。&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>