<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>337802376e8ca46ba8246e5f3c990458</guid>
<title>大话后端开发的奇淫技巧（二）</title>
<link>https://toutiao.io/k/7eacn7b</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;article itemscope=&quot;&quot; itemtype=&quot;http://schema.org/BlogPosting&quot;&gt;
            &lt;p&gt;从事服务端工作，已经有大几年了，从懵懂的小菜鸡，成长为可以自由飞翔的秃鹰，那些逝去青春和的头发见证了自己的成长&lt;/p&gt;

&lt;p&gt;或许，这就是高手的应该有样子吧&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://blog.thankbabe.com/imgs/tule2.jpg&quot; alt=&quot;头秃图&quot;/&gt;&lt;/p&gt;

&lt;p&gt;这里将会把类似的问题/业务场景的解决方案中，提炼出相对通用的部分，作为经验进行梳理罗列出来，共勉&lt;/p&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;幂等&quot;&gt;幂等&lt;/h3&gt;

&lt;h4 id=&quot;业务场景&quot;&gt;业务场景：&lt;/h4&gt;

&lt;p&gt;用户多次点击按钮，或者因为设备的性能问题，连接的网络问题，点击按钮没反应，用户就会继续尝试点击，导致触发多次请求提交&lt;/p&gt;

&lt;h4 id=&quot;解决方案&quot;&gt;解决方案：&lt;/h4&gt;

&lt;p&gt;客户端防重点击：&lt;br/&gt;
防重点击，只允许点击一次，通过记录按钮的状态值，控制按钮不可点击，等响应结果回来才能再次被点击&lt;/p&gt;

&lt;p&gt;服务端:&lt;/p&gt;

&lt;p&gt;1.表约束&lt;/p&gt;

&lt;p&gt;表设计字段的唯一约束，比如：签到记录表，用户 ID+签到日期这两个字段组合建立唯一索引 UNIQUE，使用事物操作，先 INSERT 签到记录，成功后再去 UPDATE 积分
并行执行的时候，必然只能有一个 INSERT 成功，其他都失败，最终只会累加一次积分&lt;/p&gt;

&lt;p&gt;2.分布式锁&lt;/p&gt;

&lt;p&gt;分布式锁约束，可以利用 redis incr 原子操作的特性来实现&lt;/p&gt;

&lt;p&gt;在操作业务前，先获取用户 ID 的 incr，获取到值=1，代表获取到锁成功，进行原子操作，然后执行业务逻辑，执行成功后删除掉 key&lt;/p&gt;

&lt;p&gt;如果获取到值&amp;gt;1 获取执行锁失败，代表执行没结束，锁没有释放，无法继续执行，直接返回失败&lt;/p&gt;

&lt;p&gt;这里需要注意避免网络抖动或者业务执行报错导致最终 key 删除没成功，所以再执行 incr 获取锁成功后，同时获取下 ttl 值，如果 ttl 没设置，这个时候需要对 key 设置下 ttl，超出时间后让 key 自动过期，以免锁没释放，导致死锁&lt;/p&gt;

&lt;p&gt;3.token 机制&lt;/p&gt;

&lt;p&gt;在操作前先获取令牌 token，token 只能被使用一次，执行业务逻辑前，需要去 update token 使用状态，update 成功，才能执行后续业务逻辑，update 失败，代表 token 已经被使用，返回失败&lt;/p&gt;

&lt;p&gt;可以使用 mysql token 表+redis list，list 作为令牌桶，需要的业务从队列中 pop 获取令牌，使用的时候状态 update token 表&lt;/p&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;主从延迟&quot;&gt;主从延迟&lt;/h3&gt;

&lt;h4 id=&quot;业务场景-1&quot;&gt;业务场景：&lt;/h4&gt;
&lt;p&gt;用户反馈说看不到刚提交的数据或者没更新成功，或者触发了非正常流程能理解的逻辑，排查后发现数据正常&lt;/p&gt;

&lt;h4 id=&quot;解决方案-1&quot;&gt;解决方案：&lt;/h4&gt;

&lt;p&gt;说到主从延迟，大家应该就不陌生了，只要数据库（mysql，redis）部署是主从分离的，多多少少都会遇到过这种问题&lt;/p&gt;

&lt;p&gt;低概率场景，就是数据写入/更新到主库，从库因为网络抖动等原因，没有及时同步到，然后查询的时候走的是从库，导致查到的是脏数据，这种情况就只能竟可能保障服务器环境稳定&lt;/p&gt;

&lt;p&gt;其实出现这种问题比较多的情况是，insert/update 到主库成功后，马上就查询数据，这个时候可能数据还没同步到从库，虽然主从同步会比较快，但是还是有一定的延迟性&lt;/p&gt;

&lt;p&gt;这种情况就需要将查询指定到主库上进行操作，就可以避免主从延迟，查询不到最新数据的问题&lt;/p&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;并发&quot;&gt;并发&lt;/h3&gt;

&lt;h4 id=&quot;业务场景-2&quot;&gt;业务场景：&lt;/h4&gt;

&lt;p&gt;用户快速点击按钮，或者通过压测工具，写脚本发起并发请求分发到多台服务器，多台同时接收到请求，多次/并发请求有机率会并行执行，导致超出正常逻辑范围的问题&lt;/p&gt;

&lt;p&gt;往往在这种情况下，会出现很多异常的数据，比如：同一天多条的签到记录，并且多次累加积分奖励&lt;/p&gt;

&lt;p&gt;职业羊毛党使用工具或者写脚本恶意发起并发请求接口，翻倍获利后提现，从漏洞中谋取利益&lt;/p&gt;

&lt;h4 id=&quot;解决方案-2&quot;&gt;解决方案：&lt;/h4&gt;

&lt;p&gt;表约束&lt;br/&gt;
同 ↑ 幂等的解决方案&lt;/p&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;安全隐私&quot;&gt;安全隐私&lt;/h3&gt;

&lt;h4 id=&quot;业务场景-3&quot;&gt;业务场景：&lt;/h4&gt;

&lt;p&gt;在涉及用户隐私数据或者一些商业性敏感数据业务，接口下发数据的时候没有做脱敏，把用户的隐私的数据赤裸裸的暴露出来，如：将用户的手机号，身份证号码，等重要信息直接明文及接口输出&lt;/p&gt;

&lt;p&gt;将用户 ID 作为图片命名，可以轻松遍历用户上传的图片，身份证照片等，用于非法用途&lt;/p&gt;

&lt;h4 id=&quot;解决方案-3&quot;&gt;解决方案：&lt;/h4&gt;

&lt;p&gt;数据脱敏：&lt;/p&gt;

&lt;p&gt;在不违反系统规则条件下，对真实数据进行改造，进行数据脱敏&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;根据规则改造敏感数据输出
    
  &lt;/li&gt;
  &lt;li&gt;敏感数据传递，加密处理
    &lt;ul&gt;
      &lt;li&gt;aes 加密&lt;/li&gt;
      &lt;li&gt;hashids 足够短，不可预测且唯一的数字 ID&lt;/li&gt;
      &lt;li&gt;…&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CND 媒体地址安全：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;大部分 cdn 平台都支持&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;URL 鉴权
    
  &lt;/li&gt;
  &lt;li&gt;防盗链
    
  &lt;/li&gt;
  &lt;li&gt;限制访问
    &lt;ul&gt;
      &lt;li&gt;Referer 防盗链&lt;/li&gt;
      &lt;li&gt;UserAgent 黑白名单&lt;/li&gt;
      &lt;li&gt;IP 黑白名单&lt;/li&gt;
      &lt;li&gt;等（具体看第三支持）&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;mq-业务解耦神器&quot;&gt;MQ 业务解耦神器&lt;/h3&gt;

&lt;h4 id=&quot;异步业务解耦&quot;&gt;异步业务解耦&lt;/h4&gt;

&lt;p&gt;业务场景：&lt;/p&gt;

&lt;p&gt;比如，订单下单结算成功后，发送推送通知、发放优惠券奖励，操作业务异步任务，通知用户领取，等&lt;/p&gt;

&lt;p&gt;类似这种非业务主流程里内容，主流程执行完成后可以立即返回响应给用户，其他一些成功后的附加操作通过入列到 MQ，进行异步的处理&lt;/p&gt;

&lt;p&gt;MQ也可以用于实现跨进程，跨语言消息通讯&lt;/p&gt;

&lt;p&gt;通多订阅方便业务拓展，ack 机制保障执行的完成，死信队列，进行容错处理&lt;/p&gt;

&lt;p&gt;不同的MQ中间件的支持略有差异，各有各的特性，大同小异，不同MQ优势也不一样，可以根据自己的需求场景选择合适的中间件&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;rabbitmq&lt;/li&gt;
  &lt;li&gt;kafka&lt;/li&gt;
  &lt;li&gt;rocketmq&lt;/li&gt;
  &lt;li&gt;…&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;&lt;img src=&quot;http://blog.thankbabe.com/imgs/mq.jpg&quot; alt=&quot;&quot;/&gt;&lt;/h2&gt;

&lt;h3 id=&quot;缓存大法&quot;&gt;缓存大法&lt;/h3&gt;

&lt;p&gt;在高并发场景下，通过缓存热数据，减轻 DB 压力，提高响应速度&lt;/p&gt;

&lt;p&gt;缓存可以分为服务端缓存和客户端缓存&lt;/p&gt;

&lt;p&gt;服务端缓存：&lt;/p&gt;

&lt;p&gt;当前使用比较多的分布式内存缓存数据库就是 redis，结合支持的数据类型和特性，再加上开发的创造力，可以满足大部分需求&lt;/p&gt;

&lt;hr/&gt;

&lt;p&gt;但是在使用的过程中也会遇到一些使用不当的问题，这里罗列下常见的问题：&lt;/p&gt;

&lt;p&gt;1.缓存更新&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;对于一些用户私有数据&lt;/code&gt;，一般会在数据更新的时候，del cache，然后后续获取的数据的时候，先从 cache 中获取，如果不存在，再从 db-&amp;gt;cache，最后输出给用户&lt;/p&gt;

&lt;p&gt;但是由于网络抖动等，有可能会低概率的导致 del cache 没成功，所以，一般我们会在设置 cache 的时候加过期时间，让脏数据可以在短时间内失效，这样也可以对于一些不常查询的数据进行过期清理&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;对于一些公用的热数据&lt;/code&gt;，如：商品列表等，运营人员通过后台配置商品，配置完成后，最后操作缓存更新，这个时候需要对缓存进行平滑的过度更新，不能先删除 key，再写入缓存，这种操作会导致有用户在缓存更新进去前，短暂时间区间内获取不到商品&lt;/p&gt;

&lt;p&gt;之前做过类似的需求，解决方案就是，会在创建的缓存 key 设计版本号规则，然后缓存创建成功后，在替换可以展示的版本号，把旧的版本号的数据设置过期时间&lt;/p&gt;

&lt;p&gt;旧版本数据不能马上删除，设置合理过期时间，是因为旧版本数据还会在短时间内被使用，比如：用户已经使用旧版本数据查询，并且继续后面的分页查询，设置过期时间可以合理时间内再过去清理掉旧不使用的数据&lt;/p&gt;

&lt;p&gt;数据获取就先获取当前要展示的版本号，然后获取本号对应的数据&lt;/p&gt;

&lt;p&gt;早前有写过一个类似的，场景会更佳复杂的缓存更新的方案，&lt;a href=&quot;http://blog.thankbabe.com/2017/05/21/api-design/&quot;&gt;高并发业务接口开发思路&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2.穿透&lt;/p&gt;

&lt;p&gt;cache 和 db 中都没有数据，读完 cache 没有，再读 db 还是没有，每次都请求到 cache 和 db&lt;/p&gt;

&lt;p&gt;一般情况就是 null 数据问题导致，解决方案就是，可以将null也缓存起来，避免穿透到 DB
如果有较多 null 数据，可以使用 bitmaps 布隆过滤器，来标识存储 null 的数据，节约存储空间&lt;/p&gt;

&lt;p&gt;3.击穿，雪崩&lt;/p&gt;

&lt;p&gt;出现大量 cache 数据同时过期，导致大量请求同时请到 db&lt;/p&gt;

&lt;p&gt;对于高并发业务的热数据的缓存，就不能删除/设置过期时间，只能通过平滑的过度进行更新，类似上面缓存更新中提到的方案&lt;/p&gt;

&lt;p&gt;4.压缩数据，数据过期&lt;/p&gt;

&lt;p&gt;redis缓存使用的是内存空间，所以比较稀缺，即使财大气粗分布式再多的机器，也经不起不起随意的霍霍&lt;/p&gt;

&lt;p&gt;对于不使用的字段，或者数据，都不要存储到缓存，有时候就是为了方便，直接json序列化整个对象，就直接缓存起来了&lt;/p&gt;

&lt;p&gt;对于用户私有的缓存，或者热度不高的缓存，需要设置缓存过期时间，避免长期不查询的垃圾数据堆积，占用空间，后面遇到的瓶颈，再来清理就麻烦了&lt;/p&gt;

&lt;hr/&gt;

&lt;p&gt;客户端缓存:&lt;/p&gt;

&lt;p&gt;1.缓存版本数据&lt;/p&gt;

&lt;p&gt;客户端缓存数据+数据版本号，每次获取数据的时候上传数据版本号参数，服务端校验是否最新数据，如果是最新就不下发数据，客户端可以继续使用本地数据&lt;/p&gt;

&lt;p&gt;2.增量拉取更新&lt;/p&gt;

&lt;p&gt;服务端接口返回数据的时候，返回当前时间戳，客户端对数据和拉取时间戳进行缓存，后续客户端请求带上时间戳，服务端匹配更新时间&amp;gt;时间戳时间的数据，进行下发，实现客户端数据的增量/修改更新&lt;/p&gt;

&lt;hr/&gt;

&lt;p&gt;redis 巧用&lt;/p&gt;



&lt;hr/&gt;

&lt;h3 id=&quot;日志监控&quot;&gt;日志/监控&lt;/h3&gt;

&lt;p&gt;关于日志：&lt;/p&gt;

&lt;p&gt;当线上用户反馈问题的时候，我们需要去排查问题，就靠用户的几段描述和APP的截图，有时候很难排查出根本问题&lt;/p&gt;

&lt;p&gt;这个时候如果能提供用户的请求日志轨迹就可以很好帮助到排查&lt;/p&gt;

&lt;p&gt;我们目前对于日志这块的支持有两块，一个是nginx请求日志，通过elk搭建日志系统，进行日志的收集和展示&lt;/p&gt;

&lt;p&gt;同时在数加也会备份可一份长时间的请求日志，对于历史过长的请求日志，可以到数加进行表查询&lt;/p&gt;

&lt;p&gt;一般的错误日志也可以上报到elk中，独立出一个err group方便查询&lt;/p&gt;



&lt;hr/&gt;

&lt;p&gt;关于监控：&lt;/p&gt;

&lt;p&gt;监控可以分为，服务器的监控，业务功能的监控&lt;/p&gt;

&lt;p&gt;线上服务器稳定性，决定了业务功能的稳定一个重要因素，这部分主要是运维这边去保障&lt;/p&gt;

&lt;p&gt;业务功能的监控，除了偶尔翻下错误日志，修复异常情况以外，还需要对于一些业务进行功能的监控，比如：一些定时的服务，定时的推送，每天整点需要对没有记录的用户进行提醒推送，需要保障圈定用户的效率和推送的速度，保障在规定时间内容推送出去&lt;/p&gt;

&lt;p&gt;随着业务增长，数据不断的增加，原本一个小时搞定的执行，可能会一直的延长，最后可能一整天都执行不完，对应这种业务，就需要在用户反馈之前，优先的get到问题，然后进行优化改善&lt;/p&gt;

&lt;p&gt;这个时候就需要有一个监控功能，对业务功能进行监控，超出预警进行预警通知，尽快的改善问题&lt;/p&gt;

&lt;hr/&gt;

&lt;h3 id=&quot;总结&quot;&gt;总结&lt;/h3&gt;

&lt;p&gt;在服务端开发的这几年，参与过公司里的好几个项目，有电商相关，工具类相关，等，因为项目本身技术背景和技术改进需要，在开发语言上也涉猎了好几门，有 .net（项目），java（项目），nodejs（项目），python（采集，爬虫），php（转岗项目），golang（微服务），谈不上每个语言都有多么的熟练，一般的业务开发是没有多大问题&lt;/p&gt;

&lt;p&gt;其实语言就是一个实现业务需求的工具，就像锄头和镐子，镰刀和柴刀，菜刀和小刀，基础使用方式差不多，就是在不同的需求场景下优势不一样，适合的场景使用适合的工具&lt;/p&gt;

&lt;p&gt;参与这么多个项目和涉猎这么多的语言，会发现服务端的经验是通用的，与语言和项目无关，就是解决一些问题和业务场景的解决思路和方案&lt;/p&gt;

&lt;p&gt;竟可能在一段时间里对参与过的业务/问题的解决方案进行梳理总结，这样才能很好的把共同场景的解决方案，提炼成自己的经验，不然时间一长很多做过的内容都忘记了&lt;/p&gt;

            &lt;hr/&gt;
            
            &lt;hr/&gt;
            &lt;blockquote&gt;
                &lt;p&gt;
                    
                    有任何想说的请留言哦
                    &lt;br/&gt;
                    转载请申明原文地址，谢谢合作
                &lt;/p&gt;
            &lt;/blockquote&gt;
            
            &lt;div&gt;
                &lt;p&gt;老铁们关注我的《大话WEB开发》微信公众号，跟踪我的原创博文&lt;/p&gt;
                &lt;p&gt;并不定时推荐WEB开发相关技术博文，共勉与学习交流！二维码↓&lt;/p&gt;
                &lt;img src=&quot;http://blog.thankbabe.com/imgs/gzh.jpg&quot; alt=&quot;我的公众号&quot;/&gt;
            &lt;/div&gt;
            
            
        &lt;/article&gt;
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>d1a9fa46a90d25317228fc241281f968</guid>
<title>年轻人不讲武德，乱用索引，你到底走了多少弯路？</title>
<link>https://toutiao.io/k/ipqw7m5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;前言&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;继上一篇《&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxODkzNTQ3Nw==&amp;amp;mid=2247485392&amp;amp;idx=1&amp;amp;sn=a0a2728179e20ad09487f09e0a785ec2&amp;amp;chksm=f980010acef7881c0591beb4e90220de5c283a63c74e02910830f4cb99922c388ee0226e7c88&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;explain | 索引优化的这把绝世好剑，你真的会用吗？&lt;/a&gt;》之后，本篇是索引相关的第2篇文章。上一篇重点介绍的是使用&lt;code&gt;explain&lt;/code&gt;执行计划查看索引执行情况，以便于快速定位哪张表有索引使用问题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本篇主要介绍的是索引失效的常见原因和如何用好索引，跟上一篇正好承上启下，给有需要的朋友一个参考。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文将从以下几个方便进行讲解：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.索引失效常见原因：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6984848484848485&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFT0kyzic3NJUl7Voqg1mnnkbk7rOMXSu9Qfmlsx4f2nO6kT4NKKVOw9w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1320&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.索引失效常见误区：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.21721311475409835&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFdzBPnCBWuwBpg1j9N0ku2LYj9Oa0xsPS2N6ia0qibJtyvia4OVlqTdsmg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1464&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3.索引设计的几个建议：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.6717663421418637&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFwjMjELhessVgbm17YmT2lGEWiaM0rXg7sfkRmHeyRwvwMMEybv2sUMQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1438&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;准备工作&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查看当前&lt;code&gt;mysql&lt;/code&gt;的版本：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;  &lt;span&gt;select &lt;/span&gt; &lt;span&gt;VERSION&lt;/span&gt;();&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查出当前版本为：8.0.21&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;创建一张表&lt;code&gt;test1&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt; &lt;span&gt;CREATE&lt;/span&gt; &lt;span&gt;TABLE&lt;/span&gt; &lt;span&gt;`test1`&lt;/span&gt; (&lt;br/&gt;  &lt;span&gt;`id`&lt;/span&gt; &lt;span&gt;bigint&lt;/span&gt; &lt;span&gt;NOT&lt;/span&gt; &lt;span&gt;NULL&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;`code`&lt;/span&gt; &lt;span&gt;varchar&lt;/span&gt;(&lt;span&gt;30&lt;/span&gt;) &lt;span&gt;NOT&lt;/span&gt; &lt;span&gt;NULL&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;`age`&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;NOT&lt;/span&gt; &lt;span&gt;NULL&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;`name`&lt;/span&gt; &lt;span&gt;varchar&lt;/span&gt;(&lt;span&gt;30&lt;/span&gt;) &lt;span&gt;NOT&lt;/span&gt; &lt;span&gt;NULL&lt;/span&gt;,&lt;br/&gt;  &lt;span&gt;`height`&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;NOT&lt;/span&gt; &lt;span&gt;NULL&lt;/span&gt;,&lt;br/&gt;  PRIMARY &lt;span&gt;KEY&lt;/span&gt; (&lt;span&gt;`id`&lt;/span&gt;),&lt;br/&gt;  &lt;span&gt;KEY&lt;/span&gt; &lt;span&gt;`idx_code_age_name`&lt;/span&gt; (&lt;span&gt;`code`&lt;/span&gt;,&lt;span&gt;`age`&lt;/span&gt;,&lt;span&gt;`name`&lt;/span&gt;) &lt;span&gt;USING&lt;/span&gt; BTREE,&lt;br/&gt;  &lt;span&gt;KEY&lt;/span&gt; &lt;span&gt;`idx_height`&lt;/span&gt; (&lt;span&gt;`height`&lt;/span&gt;) &lt;span&gt;USING&lt;/span&gt; BTREE&lt;br/&gt;) &lt;span&gt;ENGINE&lt;/span&gt;=&lt;span&gt;InnoDB&lt;/span&gt; &lt;span&gt;DEFAULT&lt;/span&gt; &lt;span&gt;CHARSET&lt;/span&gt;=utf8&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;插入两条数据：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;INSERT&lt;/span&gt; &lt;span&gt;INTO&lt;/span&gt; &lt;span&gt;`test1`&lt;/span&gt;(&lt;span&gt;`id`&lt;/span&gt;, &lt;span&gt;`code`&lt;/span&gt;, &lt;span&gt;`name`&lt;/span&gt;, &lt;span&gt;`age`&lt;/span&gt;,&lt;span&gt;`address`&lt;/span&gt;) &lt;span&gt;VALUES&lt;/span&gt; (&lt;span&gt;1&lt;/span&gt;, &lt;span&gt;&#x27;001&#x27;&lt;/span&gt;, &lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt;, &lt;span&gt;18&lt;/span&gt;,&lt;span&gt;&#x27;7&#x27;&lt;/span&gt;);&lt;br/&gt;&lt;span&gt;INSERT&lt;/span&gt; &lt;span&gt;INTO&lt;/span&gt; &lt;span&gt;`test1`&lt;/span&gt;(&lt;span&gt;`id`&lt;/span&gt;, &lt;span&gt;`code`&lt;/span&gt;, &lt;span&gt;`name`&lt;/span&gt;, &lt;span&gt;`age`&lt;/span&gt;,&lt;span&gt;`address`&lt;/span&gt;) &lt;span&gt;VALUES&lt;/span&gt; (&lt;span&gt;2&lt;/span&gt;, &lt;span&gt;&#x27;002&#x27;&lt;/span&gt;, &lt;span&gt;&#x27;关羽&#x27;&lt;/span&gt;, &lt;span&gt;19&lt;/span&gt;,&lt;span&gt;&#x27;8&#x27;&lt;/span&gt;);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查询一下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.2226027397260274&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF2BG1iawbeABCpdus8nbfbF6ZHNSU0mdPviaRkfaLCmqBftsVkjtmX0XQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;584&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此外建立了两个索引：idx_code_age_name(&lt;code&gt;code&lt;/code&gt;, &lt;code&gt;age&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;)联合索引  和 idx_height(&lt;code&gt;height&lt;/code&gt;)普通索引。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.1392235609103079&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFRJ6sQrQyByIBokyxNvc9qpsiaTXgic56pLJBJle34GkAxnibXVNEHZ3Pg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1494&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;一. 索引失效常见原因&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;1.不满足最左前缀原则&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第1种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引的所有索引字段，并且顺序是按照：&lt;code&gt;code&lt;/code&gt;、&lt;code&gt;age&lt;/code&gt;、&lt;code&gt;name&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;    &lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age=&lt;span&gt;18 &lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt; ;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.054871220604703244&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFwbibM8fUZnibnd9ndjzxUU5GeCRttKzJEdWUXDS6ZeLiaobKAyHLzhZKA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1786&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从图中标红的地方可以看出已经走了联合索引idx_code_name_age，并且索引的长度是&lt;code&gt;188&lt;/code&gt;， &lt;code&gt;188 = 30 * 3 + 2 + 30 * 3 + 2 + 4&lt;/code&gt;，索引是使用充分的，索引使用效率最佳。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有些朋友可能会问：索引长度为什么是这样计算的？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答：请参考《&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxODkzNTQ3Nw==&amp;amp;mid=2247485392&amp;amp;idx=1&amp;amp;sn=a0a2728179e20ad09487f09e0a785ec2&amp;amp;chksm=f980010acef7881c0591beb4e90220de5c283a63c74e02910830f4cb99922c388ee0226e7c88&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;explain | 索引优化的这把绝世好剑，你真的会用吗？&lt;/a&gt;》，里面给出了非常详细的讲解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第2种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引的所有索引字段，顺序是不按照：&lt;code&gt;code&lt;/code&gt;、&lt;code&gt;age&lt;/code&gt;、&lt;code&gt;name&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;    &lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age=&lt;span&gt;18&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.0593505039193729&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFQB7lXDoE6ckCicWR0FYVoOhkZbqViaHnSpMTfOntTfHygh1SD5AU1HNQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1786&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出执行结果跟第一种情况一样。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;注意：这种情况比较特殊，在查询之前mysql会自动优化顺序。&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第3种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;code&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;    &lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.054871220604703244&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFm3274eGH64gQFxEvsYlMrFlIA1UPevlhFykKicQiaicibjOjC6qkU8caGA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1786&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图看出也走了索引，但是索引长度有所变化，现在变成了&lt;code&gt;92&lt;/code&gt;，&lt;code&gt;92 = 30*3 + 2&lt;/code&gt;，只用到了一个索引字段code，索引使用不充分。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第4种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;age&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;    &lt;span&gt;where&lt;/span&gt; age=&lt;span&gt;18&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.06263982102908278&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFgSiaRVqvITRfYicCj3sn0DxrCpRZiaibVLpO03NWDOYy7tLJsnTYlrF8Hw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看变成了全表扫描，所有的索引都失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第5种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;name&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;    &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;    &lt;span&gt;where &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.06263982102908278&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFgSiaRVqvITRfYicCj3sn0DxrCpRZiaibVLpO03NWDOYy7tLJsnTYlrF8Hw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;从上图中看变成了全表扫描，所有的索引都失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第6种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;code&lt;/code&gt;和&lt;code&gt;age&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;   &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;   &lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age=&lt;span&gt;18&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06263982102908278&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFS6zroeAmMPbbj9z7oWeNjtpYOoGvNNlmcCAiaewJWzq3DBv9iagwL9vg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出还是走了索引，但是索引长度变成了：&lt;code&gt;96&lt;/code&gt;，&lt;code&gt;96 = 30*3 + 2 + 4&lt;/code&gt;，只用到了两个索引字段code和age，索引使用也不充分。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第7种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;code&lt;/code&gt;和&lt;code&gt;name&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;   &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;   &lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06354515050167224&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF2rUPCvGnS0WNugyibelUfL9I0ZDfVpCX0BBRlQ5cFOVcLjDeL0FHZKA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1794&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走的索引长度跟第1种情况一样，长度也是&lt;code&gt;92&lt;/code&gt;。也就是说只用到了一个索引字段&lt;code&gt;code&lt;/code&gt;，而&lt;code&gt;age&lt;/code&gt;字段的索引失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;第8种情况&lt;/strong&gt;：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段包含了联合索引中的：&lt;code&gt;age&lt;/code&gt;和&lt;code&gt;name&lt;/code&gt;字段&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;   &lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;   &lt;span&gt;where&lt;/span&gt; age=&lt;span&gt;18 &lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.052572706935123045&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFyFwmmTLjCEV31YDrg3T1FtQ9lNhlux7ju8XVric28hjjtUiaghicLdrpQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出变成了全表扫描，所有的索引都失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;小结：&lt;/strong&gt;&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;满足最左前缀的场景：&lt;code&gt;code&lt;/code&gt;，&lt;code&gt;code、age&lt;/code&gt;，&lt;code&gt;code、age、name&lt;/code&gt;。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;包含：&lt;code&gt;code&lt;/code&gt;、&lt;code&gt;age&lt;/code&gt;、&lt;code&gt;name&lt;/code&gt;全索引字段的情况比较特殊，这三个字段作为查询条件的任意一种排序都OK，最终mysql会优化成最左前缀的顺序。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果中间出现断层，如：&lt;code&gt;code、name&lt;/code&gt;，只会走第一个索引code，从断层后的索引都会失效。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;其他的场景：&lt;code&gt;age&lt;/code&gt;，&lt;code&gt;name&lt;/code&gt;，&lt;code&gt;age,name&lt;/code&gt;索引都会失效。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;2.范围索引列没有放在最后&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;where&lt;/code&gt;条件后的字段&lt;code&gt;age&lt;/code&gt;用了大于等于，具体sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age&amp;gt;&lt;span&gt;18 &lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt; ;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.06060606060606061&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFPzKP07cVZdUrEicia6EPXWYpHWuZOn1fg9RxNA5ANYI2OLibkaeUw2Ibg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1782&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出索引长度变成：&lt;code&gt;96&lt;/code&gt;，&lt;code&gt;96 = 30*3 + 2 + 4&lt;/code&gt;，只用到了两个索引字段&lt;code&gt;code&lt;/code&gt;和&lt;code&gt;age&lt;/code&gt;，而&lt;code&gt;name&lt;/code&gt;字段的索引失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果范围查询的语句放到最后：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt; code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age&amp;gt;&lt;span&gt;18&lt;/span&gt; ;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05480984340044743&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFvZRsG1SQiazU3pSwfek11ooDcCFw7RHicDguQ6TVg9NDC3NhM3f3UtNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;什么鬼？怎么索引长度还是：&lt;code&gt;96&lt;/code&gt;？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;这是一个非常经典的错误&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;范围查询放最后是指创建联合索引的字段顺序，现在的顺序是：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.13981358189081225&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFxmSs9mYIS2jno7icHYdIAPQBfcwIAFAyiaib1RKyXYx2sv8jMIian9Zr2g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1502&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;调整一下把索引字段name和age的顺序调整一下：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.14&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFOIoTibPaO8ma3u1J86oI3ktcib5vUOD3sEUib8UPAmTFaNMhPNsSKe4HA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1500&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再执行上面的sql，结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06117908787541713&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFj6JXMwEzvwrhTK0plo70rlDW9rzqGSbhcb4ErJgczDP7daLicOw0tJA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1798&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出索引长度变成：&lt;code&gt;188&lt;/code&gt;，索引使用充分了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;回过头再执行刚开始的那条sql：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;and&lt;/span&gt; age&amp;gt;&lt;span&gt;18 &lt;/span&gt; &lt;span&gt;and &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;=&lt;span&gt;&#x27;张飞&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06200676437429538&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF6iaibUzTT6QsDYUV4xITl7NicXEQ35vQe7ZxpmBd3I7ryKPA1s5bw4O8Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1774&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;什么？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;索引长度也是：&lt;code&gt;188&lt;/code&gt;。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;注意：范围查询放最后，指的是联合索引中的范围列放在最后，不是指where条件中的范围列放最后。如果联合索引中的范围列放在最后了，即使where条件中的范围列没放最后也能正常走到索引。&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;3.使用了select *&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实在《阿里巴巴开发手册》中也明确说了，禁止使用select * ，这是为什么呢？&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;  &lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05448354143019296&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFyibuctOOibE2xuWqtLdGliahzhuNoOia7OFkyzX0eWAbovRXLgJmibabMTw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1762&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走了全表扫描。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么如果查询的是索引列：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; code,age,&lt;span&gt;name &lt;/span&gt; &lt;span&gt;from&lt;/span&gt; test1&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05592841163310962&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFzuFF5V3ToI8ffxRrpWiaV74niayic8ibrTXcsOOwkkfeJQtwSOkYEmH0Cg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从图中可以看出这种情况走了全索引扫描，比全表扫描效率更高。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实这里用到了：&lt;code&gt;覆盖索引&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果&lt;code&gt;select&lt;/code&gt;的列都是索引列，则被称为&lt;code&gt;覆盖索引&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果&lt;code&gt;select&lt;/code&gt;的列不只包含索引列，则需要&lt;code&gt;回表&lt;/code&gt;，即回到表中再查询出其他列，效率相当更低一些。&lt;code&gt;select *&lt;/code&gt; 大概率需要查询非索引列，需要&lt;code&gt;回表&lt;/code&gt;，因此要少用。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，本文中很多示例都使用了&lt;code&gt;select *&lt;/code&gt; ，主要是我表中只有两条数据，为了方便演示，正常业务代码中是要杜绝这种写法的。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;4.索引列上有计算&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;执行sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height+&lt;span&gt;1&lt;/span&gt; =&lt;span&gt;7&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.059085841694537344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF27rWHickeFVmdLGO31lt01aPhtWNhTd4JE2I0kia9ae3W3PobM1FbtmA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1794&quot;/&gt;从上图中可以看出变成全表扫描了，由此可见在索引列上有计算，索引会失效。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;5.索引列上使用了函数&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果在索引列加某个函数，具体sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where &lt;/span&gt;  &lt;span&gt;SUBSTR&lt;/span&gt;(height,&lt;span&gt;1&lt;/span&gt;,&lt;span&gt;1&lt;/span&gt;)=&lt;span&gt;8&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.059085841694537344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF27rWHickeFVmdLGO31lt01aPhtWNhTd4JE2I0kia9ae3W3PobM1FbtmA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1794&quot;/&gt;从上图中可以看出变成全表扫描了，由此可见在索引列上加了函数，索引也会失效。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;6.字符类型没加引号&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;废话不多说直接上sql：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where &lt;/span&gt; &lt;span&gt;name&lt;/span&gt; = &lt;span&gt;123&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.059085841694537344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF27rWHickeFVmdLGO31lt01aPhtWNhTd4JE2I0kia9ae3W3PobM1FbtmA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1794&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从图中看出走的全表扫描，索引失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为什么索引会失效呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里有些朋友可能会有点懵。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答：&lt;code&gt;name&lt;/code&gt;字段是&lt;code&gt;字符类型&lt;/code&gt;，而等于号右边的是&lt;code&gt;数字类型&lt;/code&gt;，类型不匹配导致索引丢失。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以在使用字符类型字段做判断时，一定要加上单引号。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;类型不匹配导致索引丢失问题，是我们平时工作中非常容易忽视的问题，一定要引起足够的重视&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;7.用is null和is not null没注意字段是否允许为空&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;前面创建的test1表中height字段是非空的。&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.30363636363636365&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFVbY2YmERSrk8wRyqT9fQLRr7gzg52HmjVKcyiajHh3nQ9Sx4lmvJGdA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1100&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;查询sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height &lt;span&gt;is &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height &lt;span&gt;is &lt;/span&gt; &lt;span&gt;not &lt;/span&gt; &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果都是：&lt;img data-ratio=&quot;0.059085841694537344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF27rWHickeFVmdLGO31lt01aPhtWNhTd4JE2I0kia9ae3W3PobM1FbtmA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1794&quot;/&gt;从上图中看出都是全表扫描，索引都失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果height字段改成允许为空的呢？&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.28104575163398693&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFPU3c2eEylkUZZqJXibgriaeUypxjjMfO0Cas4MGNJ2IqnKnSE9ZDeZdg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1224&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面第一条sql执行结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.059190031152647975&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFV3YefUYkpiaoOQcwuLkAHVt1Wna6Y1khahEEXu9QLMACCupgdNic05Dw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1926&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走了&lt;code&gt;ref&lt;/code&gt;类型的索引。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面第二条sql执行结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05931321540062435&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFZzFNTNoqpUaQg2J3JXPPNtibzeKPpFUFKrURnM3XpKlYMyo5usrV8vg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1922&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走了&lt;code&gt;range&lt;/code&gt;类型的索引。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;小结&lt;/strong&gt;&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;如果字段不允许为空，则is null 和 is not null这两种情况索引都会失效。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;如果字段允许为空，则is null走&lt;code&gt;ref&lt;/code&gt;类型的索引，而is not null走&lt;code&gt;range&lt;/code&gt;类型的索引。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;8.like查询左边有%&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;like查询主要有三种情况：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;like &#x27;%a&#x27;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;like &#x27;a%&#x27;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;like &#x27;%a%&#x27;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;先看看第一种情况：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code &lt;span&gt;like &lt;/span&gt;&lt;span&gt;&#x27;%001&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05460385438972163&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFDvkeETOPFlgEmtR3yUgbtyVbjoY0LG1iaJR7In7VrKc0JIgibat20tuA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1868&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图看出走的全表扫描，索引失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再看看第二种情况：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code &lt;span&gt;like &lt;/span&gt; &lt;span&gt;&#x27;001%&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.053169734151329244&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFVg37PUMyrSvicknicwRfQUGbFqHAFIgSKw0ZRKDQNQWms6Eibm7OVzNaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1956&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图看出走的&lt;code&gt;range&lt;/code&gt;类型的索引。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后看看第三种情况：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code &lt;span&gt;like &lt;/span&gt; &lt;span&gt;&#x27;%001%&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.05460385438972163&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFDvkeETOPFlgEmtR3yUgbtyVbjoY0LG1iaJR7In7VrKc0JIgibat20tuA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1868&quot;/&gt;从上图看出走的全表扫描，索引也失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从这三种结果看出&lt;code&gt;like&lt;/code&gt;语句只有&lt;code&gt;%&lt;/code&gt;在右边才能走索引。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果有些场景就是要使用&lt;code&gt;like&lt;/code&gt;语句&lt;code&gt;%&lt;/code&gt;在左边该怎么办呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答案：使用覆盖索引&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;具体sql如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; code,age,&lt;span&gt;name &lt;/span&gt; &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code &lt;span&gt;like &lt;/span&gt; &lt;span&gt;&#x27;%001%&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05454545454545454&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF8eXnytcgiaXtZ5oQaToIKLOjutHibnrGHtrzrfqiboRicdURo2hiaWJXicPA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1980&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图看出走的&lt;code&gt;index&lt;/code&gt;类型的全索引扫描，相对于全表扫描性能更好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当然，最佳实践是在&lt;code&gt;sql&lt;/code&gt;中要避免&lt;code&gt;like&lt;/code&gt;语句&lt;code&gt;%&lt;/code&gt;在左边的情况，如果有这种业务场景可以使用&lt;code&gt;es&lt;/code&gt;代替&lt;code&gt;mysql&lt;/code&gt;存储数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;小结：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;like &#x27;%a&#x27; 索引失效&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;like &#x27;a%&#x27; 走range类型索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;like &#x27;%a%&#x27; 索引失效&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;9.使用or关键字时没有注意&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;用法如下：&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height = &lt;span&gt;8 &lt;/span&gt; &lt;span&gt;or&lt;/span&gt; height = &lt;span&gt;9&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05567010309278351&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFYCvJTQxQ2tJM2HLEoV7Cj5YebbcSsUAUibC3HmN5C8PugSHKsuxY9Vw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1940&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走了&lt;code&gt;range&lt;/code&gt;类型的索引，不是没问题吗？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再把sql改一下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code = &lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;or&lt;/span&gt; height = &lt;span&gt;8&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.05452562704471101&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF3IwL4YYeM2VCp6B9AwOe5xAt9ic4SjP5mLfnSzqalAJibuVSXoZ6LD8Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1834&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中可以看出变成了全表扫描，索引失效了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们不妨单独查询一下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code = &lt;span&gt;&#x27;001&#x27;&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;img data-ratio=&quot;0.05749718151071026&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFlWKgvYaV2c2VuhQ42BSkwC1nP0KH1F2KjWeQFQ9hIblL84IJqicmV4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1774&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;和&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height = &lt;span&gt;8&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.06214039125431531&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFhpOlRqWQhWQCzMDBLyce1EicED70zx01XpCPvy8HasVGJWPbPmurCUg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1738&quot;/&gt;两种单独查询的情况都走了&lt;code&gt;ref&lt;/code&gt;类型的索引，但是使用&lt;code&gt;or&lt;/code&gt;关键字后sql的索引会失效。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，我们在想使用&lt;code&gt;or&lt;/code&gt;的场景，又想让索引有效，该怎么办呢？&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain&lt;/span&gt; (&lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;span&gt;where&lt;/span&gt;   code = &lt;span&gt;&#x27;001&#x27;&lt;/span&gt;) &lt;br/&gt;&lt;span&gt;union&lt;/span&gt; (&lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;span&gt;where&lt;/span&gt;  height = &lt;span&gt;8&lt;/span&gt;);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;没错，使用&lt;code&gt;union&lt;/code&gt;关键字，但是跟&lt;code&gt;or&lt;/code&gt;关键字的语法稍微有点区别，不过查询的数据结果是一样的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面sql执行结果如下：&lt;img data-ratio=&quot;0.09148936170212765&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFEuuIeQayMY2w9MMtX6e85qJPdy4su8B2tRm8pqJAqzDrWLNj0l36XA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1880&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们看到走了&lt;code&gt;ref&lt;/code&gt;类型索引。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;or关键字会让索引失效，可以用union代替&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;二. 索引失效的常见误区&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;1.使用not in会导致索引失效&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用法如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  height &lt;span&gt;not &lt;/span&gt; &lt;span&gt;in&lt;/span&gt; (&lt;span&gt;7&lt;/span&gt;,&lt;span&gt;8&lt;/span&gt;);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05046343975283213&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFRzibiaTrKs1iaVWHKWfqGffxYU8cZFUvJharROpBO2Ib1UMW3cgCibibseA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1942&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出是走了&lt;code&gt;range&lt;/code&gt;类型索引的，并没失效。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;需要特别说明的是mysql5.7和5.8不同的版本效果不一样，5.7中这种情况sql执行结果是全表扫描，而5.8中使用了&lt;code&gt;range&lt;/code&gt;类型索引。&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;2.使用不等于号会导致索引失效&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用法如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;explain &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt; height!=&lt;span&gt;8&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05056759545923633&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpF5lfwK17f6wzF4CiapYSl11yAo6uAMvNwkHHoelqevLrV7eLCWGUgicSA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1938&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从图中看出走了&lt;code&gt;range&lt;/code&gt;类型的索引。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;★&lt;/span&gt;&lt;p&gt;需要特别说明的是mysql5.7和5.8不同的版本效果不一样，5.7中这种情况sql执行结果是全表扫描，而5.8中使用了&lt;code&gt;range&lt;/code&gt;类型索引。5.7中如果想使用索引该怎么办呢？答案：使用大于和小于代替不等于。&lt;/p&gt;&lt;span&gt;”&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在这里温馨的提醒一声，不等于号不只是 &lt;code&gt;!=&lt;/code&gt; ，还包括 &lt;code&gt;&amp;lt;&amp;gt;&lt;/code&gt;。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;3.order by索引字段顺序不当导致索引失效&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;sql中除了&lt;code&gt;where&lt;/code&gt;后面的字段能走索引之外，&lt;code&gt;order by&lt;/code&gt;后面的字段也能走索引。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;order &lt;/span&gt; &lt;span&gt;by&lt;/span&gt; age,&lt;span&gt;name&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05592841163310962&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFTFRef6xfibCTyamyGjkINVSdsmsykuHMyFCNegSLzmSowM7IrKepzQw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出走了&lt;code&gt;ref&lt;/code&gt;类型的索引，索引长度是&lt;code&gt;92&lt;/code&gt;，并且没有额外信息。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但是如果把&lt;code&gt;order by&lt;/code&gt; 后面的条件改成如下两种排序：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;   &lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;order &lt;/span&gt; &lt;span&gt;by &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;   &lt;span&gt;EXPLAIN &lt;/span&gt; &lt;span&gt;select&lt;/span&gt; * &lt;span&gt;from&lt;/span&gt; test1 &lt;br/&gt;&lt;span&gt;where&lt;/span&gt;  code=&lt;span&gt;&#x27;001&#x27;&lt;/span&gt; &lt;span&gt;order &lt;/span&gt; &lt;span&gt;by &lt;/span&gt; &lt;span&gt;name&lt;/span&gt;,age;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;结果：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.05353319057815846&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDHyMP6qpFbEYns2vFYiazOpFGgom7PzvibJwXnQp3t5mOdPMZ2MYHhgpP2ldr3wDYDynyCHtGhkqWbw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1868&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上图中看出还是走了&lt;code&gt;ref&lt;/code&gt;类型的索引，索引长度是&lt;code&gt;92&lt;/code&gt;，但是额外信息中提示：&lt;code&gt;Using filesort&lt;/code&gt;，即按文件重排序。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面两个例子能够看出有没有使用索引跟&lt;code&gt;where&lt;/code&gt;后面的条件有关，而跟&lt;code&gt;order by&lt;/code&gt; 后面的字段没关系。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;而需不需要按文件重排序，则跟&lt;code&gt;order by&lt;/code&gt; 后面的字段有直接关系。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;问题来了，额外信息中提示：&lt;code&gt;Using filesort&lt;/code&gt;这种该如何优化？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答：这种情况一般是联合索引中索引字段的顺序，跟&lt;code&gt;sql&lt;/code&gt;中&lt;code&gt;where&lt;/code&gt;条件及&lt;code&gt;order by&lt;/code&gt; 不一致导致的，只要顺序调整一致就不会出现这个问题。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;三. 索引设计的几个建议：&lt;/span&gt;&lt;/h2&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;优先使用唯一索引，能够快速定位&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;为常用查询字段建索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;为排序、分组和联合查询字段建索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;一张表的索引数量不超过5个&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;表数据量少，可以不用建索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;尽量使用占用空间小的字段建索引&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;用idx_或unx_等前缀命名索引，方面查找&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;删除没用的索引，因为它会占一定空间&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;四. 彩蛋：&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;特别说明：索引失效除了上述的常见问题之外，&lt;code&gt;mysql&lt;/code&gt;通过索引扫描的行记录数超过全表的&lt;code&gt;10%~30%&lt;/code&gt;左右,优化器也可能不会走索引，自动变成全表扫描。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;送给大家一个避坑口诀：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;全职匹配我最爱，最左前缀要遵守&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;带头大哥不能死，中间兄弟不能断&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;索引列上少计算，范围列后全失效&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;like百分写最右，覆盖索引不写*&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;不等空值还有or&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;索引影响要注意；&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;字符字段引号不能丢，sql优化有诀窍。&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;span&gt;最后说一句(求关注，别白嫖我)&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果这篇文章对您有所帮助，或者有所启发的话，帮忙扫描下发二维码关注一下，您的支持是我坚持写作最大的动力。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;求一键三连：点赞、转发、在看。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在公众号中回复：面试、代码神器、开发手册、时间管理有超赞的粉丝福利，另外回复：加群，可以跟很多BAT大厂的前辈交流和学习。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/uL371281oDEltuPhDALy7ELR10AicRg8YjGAPyBaQGnG4Ff2bTSsHFMHWTeyEiabErQsbBwV0dXaibfHe6LIZcPWw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-ratio=&quot;0.3648148148148148&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>2a99da5fdb6967fb082578f3ee888d80</guid>
<title>二进制文件是什么样的？</title>
<link>https://toutiao.io/k/0ztmcru</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;在讲述进程之前，先来了解一下二进制可执行文件和目标文件。我们知道程序运行起来后就有了进程，所以了解程序的结构对于认识操作系统大有好处。先抛三个问题：&lt;strong&gt;编译器编译代码后生成的文件是目标文件，目标文件里面是什么？可执行文件里面又是什么？可执行文件与目标文件的区别在哪呢？&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;这篇文件会使用如下一个简单的 C 文件进行贯穿讲解：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;#&lt;span class=&quot;code-snippet__meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;code-snippet__meta-string&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;hello&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;1.编译过程&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;代码要想成为可执行文件就需要经过编译。编译过程分为&lt;span&gt;&lt;strong&gt;预处理、编译、汇编、链接&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.5386904761904762&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/pMAe7v8MuciciaeCFtQ5jia9tfeic36QKeRsLVGnD2qM97V3pVdsHscAjlTmCXsdWAY6Miciasfu7J278baUVib9KjR9A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;672&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;预处理&lt;/strong&gt;&lt;/span&gt;：主要处理源码中的预处理指令，在 C/C++ 中主要指的是“#include”、“#define” 等，它的处理方法是将这些指令所在的位置进行内容替换，比如 “#include” 就会把整个头文件给引进来。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;编译&lt;/strong&gt;&lt;/span&gt;：把上一步预处理过的文件进行词法分析、语法分析、语义分析&amp;amp;优化一系列步骤后生成汇编代码。这是整个编译过程中最难最复杂的 部分。在现在版本的 GCC 中，预处理和编译这两个过程已经合并为一步。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;汇编&lt;/strong&gt;&lt;/span&gt;：把汇编代码转变为机器可以执行的指令，这是一个翻译的过程，有个汇编指令与机器指令的对照表进行一一对应。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;链接&lt;/strong&gt;&lt;/span&gt;：把每个独立编译的模块进行组装，这些模块之间会有相互引用，链接就是让这些独立模块能够相互正确引用，形成一个完整的可执行文件。链接分为动态链接和静态链接，这两个会在下篇文章进行讲解。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;使用以上那个 C 文件进行整个编译过程如下：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;预处理：gcc -E hello.c -o hello.i&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;编译：gcc -S hello.i -o hello.s&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;汇编：gcc -c hello.s -o hello.o&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;链接：ld -&lt;span class=&quot;code-snippet__keyword&quot;&gt;static&lt;/span&gt; /usr/lib64/crt1.o /usr/lib64/crti.o /usr/lib/gcc/x86_64-redhat-linux/&lt;span class=&quot;code-snippet__number&quot;&gt;4.8&lt;/span&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;.5&lt;/span&gt;/crtbeginT.o  -L /usr/lib/gcc/x86_64-redhat-linux/&lt;span class=&quot;code-snippet__number&quot;&gt;4.8&lt;/span&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;.5&lt;/span&gt; -L /usr/lib -L hello.o --start-&lt;span class=&quot;code-snippet__keyword&quot;&gt;group&lt;/span&gt; -lgcc -lgcc_eh -lc --end-&lt;span class=&quot;code-snippet__keyword&quot;&gt;group&lt;/span&gt; /usr/lib/gcc/x86_64-redhat-linux/&lt;span class=&quot;code-snippet__number&quot;&gt;4.8&lt;/span&gt;&lt;span class=&quot;code-snippet__number&quot;&gt;.5&lt;/span&gt;/crtend.o /usr/lib64/crtn.o&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;不想这么麻烦的话，直接一行代码搞定：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;gcc&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.c&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;2.什么是可执行文件&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;可执行文件指的是可以由操作系统进行加载执行的文件&lt;/strong&gt;&lt;/span&gt;。在不同的系统中，可执行文件是不同的。比如在 windows 中可执行文件是以 exe 后缀的文件，而在 linux 中可执行文件可以是任何后缀的文件，只是需要给文件添加“可执行”权限。&lt;span&gt;&lt;strong&gt;注意，在同一种操作系统中如果 CPU 的架构不同的话，可执行文件是不能通用的&lt;/strong&gt;&lt;/span&gt;，比如：在 linux 中，ARM 架构上的可执行文件就不能直接在 X86 架构执行，因为可执行文件内通常含有二进制编码的 CPU 指令，而每种 CPU 的指令集都是不一样的。这种情况下&lt;span&gt;&lt;strong&gt;通常需要进行交叉编译&lt;/strong&gt;&lt;/span&gt;：在一个平台上生成另一个平台的可执行文件，比如在 X86 平台上生成 ARM 的可执行文件。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;3.可执行文件类型&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在 windows 系统中可执行文件类型为 PE(Portable Executable)，在 Linux 系统中可执行文件类型为 ELF(Executable Linkable Format)。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在 linux 下可以使用 file 命令查看文件的文件格式。&lt;/p&gt;&lt;p&gt;普通的源码文件显示是：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-attr&quot;&gt;[root@centos7-dev hello]&lt;/span&gt;# &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.c&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.c&lt;/span&gt;: &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;source&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ASCII&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;text&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;目标文件是：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-attr&quot;&gt;[root@centos7-dev hello]&lt;/span&gt;# &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.o&lt;/span&gt;: &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ELF&lt;/span&gt; 64&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;-bit&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LSB&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;relocatable&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;x86-64&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;version&lt;/span&gt; 1 (&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SYSV&lt;/span&gt;), &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;stripped&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;可执行文件是：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;[&lt;span class=&quot;code-snippet__meta&quot;&gt;root@centos7-dev hello&lt;/span&gt;]&lt;span class=&quot;code-snippet__meta&quot;&gt;# file hello&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;hello: ELF &lt;span class=&quot;code-snippet__number&quot;&gt;64&lt;/span&gt;-bit LSB executable, x86&lt;span class=&quot;code-snippet__number&quot;&gt;-64&lt;/span&gt;, version &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt; (SYSV), &lt;span class=&quot;code-snippet__function&quot;&gt;dynamically &lt;span class=&quot;code-snippet__title&quot;&gt;linked&lt;/span&gt; (&lt;span class=&quot;code-snippet__params&quot;&gt;uses shared libs&lt;/span&gt;), &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; GNU/Linux 2.6.32, BuildID[sha1]&lt;/span&gt;=&lt;span class=&quot;code-snippet__number&quot;&gt;6115b&lt;/span&gt;831b9be5d023a87ce84ecd72d44cbfa1548, not stripped&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;不是只有可执行文件可以按照上述这两种类型进行存储，目标文件(.obj/.o)可以，链接库（.dll/.so）也可以，甚至在 linux 下的 coredump 也是可执行文件格式。目标文件既然和可执行文件的存储结构一致，那两者有什么差异呢？一句话：&lt;span&gt;&lt;strong&gt;目标文件是尚未进行链接操作的可执行文件&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;4.关于链接&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;为什么会有链接这个动作呢？&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;先把时间拉回到打孔条带的时代，在计算机刚出来的时候，程序都是写在条带上。最开始的程序是一条纸带，很简单很完整。然后随着时间的推移，程序越来越多了，条带也是越来越多。在某个时刻有个程序员想偷懒，他正在写的 A 程序想使用之前写好的 B 程序的一个功能，所以他把 B 条带上的那段代码给剪出来然后拼接上了 A 程序。这是最早的链接，应该也是最早的静态链接。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在现代的软件开发过程中，程序文件的数量是非常庞大的，往往一个工程就有上千个模块和文件。这些模块和文件是相互独立和依赖的，相互调用的情况是很常见的。你想想，这样一个庞大的项目要编译出一个可执行文件应该怎么做？先对每个代码文件进行单独编译得到目标文件，然后把这些目标文件给捏到一块去，形成一个可执行文件。而这个捏到一块去的过程就是链接。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;如果没有这个链接过程，上千模块的目标文件根本没法正常工作，因为它们无法执行。那有人说了：整个项目工程可以只写一个文件呀，只对这个文件进行编译就可以不用链接了。没错，但那就没法比较好的进行多人协作开发了。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;5.ELF 结构&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;由于对 windows 系统的可执行文件结构不熟，所以这里拿 linux 系统下的可执行文件结构 ELF 进行分析一下。&lt;span&gt;&lt;strong&gt;ELF 里面包含了编译后的机器指令和数据、符号表、调试信息、字符串等，这些不同类型的信息都会单独分开存放在某个模块内，一般称呼这些模块为&quot;段&quot;&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;首先我们得先了解 ELF 都有哪些段，请看如下资料：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.bss&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;构成程序的内存映像的未初始化数据。根据定义，系统在程序开始运行时会将数据初始化为零。如节类型 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHT_NOBITS&lt;/span&gt; 所指明的那样，此节不会占用任何文件空间。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.comment&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;注释信息，通常由编译系统的组件提供。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.data&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.data1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;构成程序的内存映像的已初始化数据。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynamic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;动态链接信息。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynstr&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;进行动态链接所需的字符串，通常是表示与符号表各项关联的名称的字符串。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynsym&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;动态链接符号表。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.eh_frame_hdr&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.eh_frame&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;用于展开栈的调用帧信息。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.fini&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;可执行指令，用于构成包含此节的可执行文件或共享目标文件的单个终止函数。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.fini_array&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;函数指针数组，用于构成包含此节的可执行文件或共享目标文件的单个终止数组。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.got&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;全局偏移表。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.hash&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;符号散列表。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.init&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;可执行指令，用于构成包含此节的可执行文件或共享目标文件的单个初始化函数。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.init_array&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;函数指针数组，用于构成包含此节的可执行文件或共享目标文件的单个初始化数组。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.interp&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;程序的解释程序的路径名。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.lbss&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;特定于 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;x64&lt;/span&gt; 的未初始化的数据。此数据与 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.bss&lt;/span&gt; 类似，但用于大小超过 2 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;GB&lt;/span&gt; 的节。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.ldata&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.ldata1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;特定于 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;x64&lt;/span&gt; 的已初始化数据。此数据与 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.data&lt;/span&gt; 类似，但用于大小超过 2 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;GB&lt;/span&gt; 的节。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.lrodata&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.lrodata1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;特定于 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;x64&lt;/span&gt; 的只读数据。此数据与 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rodata&lt;/span&gt; 类似，但用于大小超过 2 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;GB&lt;/span&gt; 的节。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.note&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;注释节中说明了该格式的信息。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.plt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;过程链接表。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.preinit_array&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;函数指针数组，用于构成包含此节的可执行文件或共享目标文件的单个预初始化数组。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rela&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;不适用于特定节的重定位。此节的用途之一是用于寄存器重定位。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.relname&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.relaname&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;重定位信息，如重定位节中所述。如果文件具有包括重定位的可装入段，则此节的属性将包括 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHF_ALLOC&lt;/span&gt; 位。否则，该位会处于禁用状态。通常，&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;name&lt;/span&gt; 由应用重定位的节提供。因此，&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt; 的重定位节的名称通常为 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rel&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt; 或 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rela&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt;。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rodata&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rodata1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;通常构成进程映像中的非可写段的只读数据。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.shstrtab&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;节名称。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.strtab&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;字符串，通常是表示与符号表各项关联的名称的字符串。如果文件具有包括符号字符串表的可装入段，则此节的属性将包括 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHF_ALLOC&lt;/span&gt; 位。否则，该位会处于禁用状态。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.symtab&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;符号表，如符号表节中所述。如果文件具有包括符号表的可装入段，则此节的属性将包括 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHF_ALLOC&lt;/span&gt; 位。否则，该位会处于禁用状态。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.symtab_shndx&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;此节包含特殊符号表的节索引数组，如 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.symtab&lt;/span&gt; 所述。如果关联的符号表节包括 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHF_ALLOC&lt;/span&gt; 位，则此节的属性也将包括该位。否则，该位会处于禁用状态。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.tbss&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;此节包含构成程序的内存映像的未初始化线程局部数据。根据定义，为每个新执行流实例化数据时，系统都会将数据初始化为零。如节类型 &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;SHT_NOBITS&lt;/span&gt; 所指明的那样，此节不会占用任何文件空间。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.tdata&lt;/span&gt;、&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.tdata1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;这些节包含已初始化的线程局部数据，这些数据构成程序的内存映像。对于每个新执行流，系统会对其内容的副本进行实例化。&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;程序的文本或可执行指令。&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;有了以上资料，我们可以使用 objdump 命令查看 hello 可执行文件中都有哪些模块：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-attr&quot;&gt;[root@centos7-dev hello]&lt;/span&gt;# &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;objdump&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;-h&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;:     &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;elf64-x86-64&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Sections&lt;/span&gt;:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Idx&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Name&lt;/span&gt;          &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Size&lt;/span&gt;      &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;VMA&lt;/span&gt;               &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LMA&lt;/span&gt;               &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;off&lt;/span&gt;  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Algn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  0 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.interp&lt;/span&gt;       0000001&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;c&lt;/span&gt;  0000000000400238  0000000000400238  00000238  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  1 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.note&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.ABI-tag&lt;/span&gt; 00000020  0000000000400254  0000000000400254  00000254  2**2&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  2 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.note&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.gnu&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.build-id&lt;/span&gt; 00000024  0000000000400274  0000000000400274  00000274  2**2&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  3 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.gnu&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.hash&lt;/span&gt;     0000001&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;c&lt;/span&gt;  0000000000400298  0000000000400298  00000298  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  4 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynsym&lt;/span&gt;       00000060  00000000004002&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;b8&lt;/span&gt;  00000000004002&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;b8&lt;/span&gt;  000002&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;b8&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  5 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynstr&lt;/span&gt;       0000003&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;f&lt;/span&gt;  0000000000400318  0000000000400318  00000318  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  6 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.gnu&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.version&lt;/span&gt;  00000008  0000000000400358  0000000000400358  00000358  2**1&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  7 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.gnu&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.version_r&lt;/span&gt; 00000020  0000000000400360  0000000000400360  00000360  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  8 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rela&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dyn&lt;/span&gt;     00000018  0000000000400380  0000000000400380  00000380  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  9 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rela&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.plt&lt;/span&gt;     00000048  0000000000400398  0000000000400398  00000398  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 10 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.init&lt;/span&gt;         0000001&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  00000000004003&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e0&lt;/span&gt;  00000000004003&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e0&lt;/span&gt;  000003&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e0&lt;/span&gt;  2**2&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 11 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.plt&lt;/span&gt;          00000040  0000000000400400  0000000000400400  00000400  2**4&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 12 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt;         00000182  0000000000400440  0000000000400440  00000440  2**4&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 13 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.fini&lt;/span&gt;         00000009  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;c4&lt;/span&gt;  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;c4&lt;/span&gt;  000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;c4&lt;/span&gt;  2**2&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 14 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rodata&lt;/span&gt;       00000016  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;d0&lt;/span&gt;  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;d0&lt;/span&gt;  000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;d0&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 15 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.eh_frame_hdr&lt;/span&gt; 00000034  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e8&lt;/span&gt;  00000000004005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e8&lt;/span&gt;  000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e8&lt;/span&gt;  2**2&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 16 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.eh_frame&lt;/span&gt;     000000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;f4&lt;/span&gt;  0000000000400620  0000000000400620  00000620  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 17 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.init_array&lt;/span&gt;   00000008  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e10&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e10&lt;/span&gt;  00000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e10&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 18 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.fini_array&lt;/span&gt;   00000008  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e18&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e18&lt;/span&gt;  00000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e18&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 19 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.jcr&lt;/span&gt;          00000008  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e20&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e20&lt;/span&gt;  00000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e20&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 20 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.dynamic&lt;/span&gt;      000001&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;d0&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e28&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e28&lt;/span&gt;  00000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e28&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 21 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.got&lt;/span&gt;          00000008  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ff8&lt;/span&gt;  0000000000600&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ff8&lt;/span&gt;  00000&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ff8&lt;/span&gt;  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 22 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.got&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.plt&lt;/span&gt;      00000030  0000000000601000  0000000000601000  00001000  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 23 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.data&lt;/span&gt;         00000004  0000000000601030  0000000000601030  00001030  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 24 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.bss&lt;/span&gt;          00000004  0000000000601034  0000000000601034  00001034  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; 25 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.comment&lt;/span&gt;      0000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  0000000000000000  0000000000000000  00001034  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;然后再用同样的命令来查看目标文件：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-attr&quot;&gt;[root@centos7-dev hello]&lt;/span&gt;# &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;objdump&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;-h&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.o&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.o&lt;/span&gt;:     &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;elf64-x86-64&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Sections&lt;/span&gt;:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Idx&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Name&lt;/span&gt;          &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Size&lt;/span&gt;      &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;VMA&lt;/span&gt;               &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LMA&lt;/span&gt;               &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;off&lt;/span&gt;  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;Algn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  0 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.text&lt;/span&gt;         0000001&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  0000000000000000  0000000000000000  00000040  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;RELOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CODE&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  1 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.data&lt;/span&gt;         00000000  0000000000000000  0000000000000000  0000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  2 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.bss&lt;/span&gt;          00000000  0000000000000000  0000000000000000  0000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  3 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.rodata&lt;/span&gt;       00000006  0000000000000000  0000000000000000  0000005&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;a&lt;/span&gt;  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  4 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.comment&lt;/span&gt;      0000002&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e&lt;/span&gt;  0000000000000000  0000000000000000  00000060  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  5 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.note&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.GNU-stack&lt;/span&gt; 00000000  0000000000000000  0000000000000000  0000008&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;e&lt;/span&gt;  2**0&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  6 &lt;span class=&quot;code-snippet__selector-class&quot;&gt;.eh_frame&lt;/span&gt;     00000038  0000000000000000  0000000000000000  00000090  2**3&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                  &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;CONTENTS&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ALLOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;LOAD&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;RELOC&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;READONLY&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;DATA&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;可以发现目标文件内部的模块信息比可执行文件少很多，这是因为在目标文件经过链接过程变成可执行文件的过程中进行很多处理，比如：&lt;span&gt;&lt;strong&gt;地址和空间分配、重定位、符号决议&lt;/strong&gt;&lt;/span&gt;等。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;我们还可以用 objdump 来查看每个模块的代码信息：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;nginx&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attribute&quot;&gt;objdump&lt;/span&gt; -s -d hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;查看符号表：&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;nginx&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__attribute&quot;&gt;objdump&lt;/span&gt; -x hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;更多关于 objdump 命令的使用可以 man objdump 查看。&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>31b7c2bad8f06a8e09fa82bbd603183f</guid>
<title>程序员为什么转型管理？</title>
<link>https://toutiao.io/k/cxuwyue</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;post-body&quot; itemprop=&quot;articleBody&quot;&gt;
&lt;p&gt;一个享受编程的程序员为什么会有转管理的念头？更何况技术精进的好，不愁找工作，不愁加薪，还受领导重用，同事尊重，名利双收。我想通过亲身经历，说说转型管理的心路历程。&lt;/p&gt;
&lt;p&gt;转型管理，这个念头来自一次失败的创业经历。从那以后，意识到了，再好的技术，如果解决不了用户的痛点，投入再多的心血，也都是无用功。这是走向管理最重要的契机。除此之外，还有好奇心的驱动，做了七年多的开发，技术仍可以进步，但吸了水海绵，越吸越难，在管理这个新领域，很多知识都是新的，一碰就能吸进去。第三个原因，是想体验帮助人的快乐，程序员死磕代码，带来的是自我的成就感，做管理，能让光和热，温暖到更多的人。&lt;/p&gt;
&lt;p&gt;转管理更能创造价值。相对于程序员来讲，经理有更多的牌可以打，让程序员敲出的代码，能解决真正的问题，好钢用在刀刃上。这里所说的牌，是对项目更大的把控。首先，作为技术经理可以和产品经理及其他业务人员，围绕产品进行更深远的规划，因为技术经理可以从日常的事物中抽出身来，把花在机器上的编码调试时间省出来，抬头远眺，评估和管理产品可能遇到的风险。其次，可以利用所掌控的资源，为项目的进展保驾护航，特别是当项目遇到困难的时候，有权利调配研发力量，对产品进行迭代。最后，随着经历不断丰富，对产品，项目管理，技术实现等各个方面洞察力会不断增强，能从产品研发的全方位确保价值的产生。&lt;/p&gt;
&lt;p&gt;转管理更能博闻强识。程序员满足自身的求知欲，断然不是问题，这得益于技术更新换代的高速度。然而，程序员要做的优秀，最保险的是在技术领域深耕细作，这也往往限制了程序员对其他领域的探索和发现，失去了达到新高度的机会。做技术经理，除了对技术积累的要求外，有机会也有必要触及更多的领域。培养情商，有利于沟通；知晓心理学，有利于增强领导力；储备金融知识，有利于判断企业的发展潜力；学习决策组织管理，有利于在不同的机构不同的环境中游刃有余。自从转了管理以后，我发现了另外一片知识的海洋，享受着学习的快乐。&lt;/p&gt;
&lt;p&gt;转管理更能发现意义。写代码也好，做产品也好，达到职业巅峰也好。日出日落之后，是什么让你觉得你做的事情有意义。人作为一个社会动物，我觉得通过人与人之间的相处更容易找到意义。转了管理，考虑的不仅仅是自己，开始懂得照顾他人，关心团队的业绩，队员的成长。在对团队坚持不懈的支持下，团队取得的卓越绩效，队员的稳步成长，比独自撸代码战胜难题，更能带来满足感。&lt;/p&gt;
&lt;p&gt;上面说了我从程序员转型管理最重要的动机。然而我并不想盲目鼓励所有的程序员都去着急的转管理。这里有两个很重要的原因，首先，程序员和技术经理，不是黑与白的对立。管理特别是在技术领域下，需要程序员时期技术的沉淀，这样一来能更加深入的理解程序员这个群体的需求，二来帮助你得到程序员们新的信任，三是有助于敏锐的发现项目中暗藏的技术风险。&lt;/p&gt;
&lt;p&gt;除了需要技术积累，选择管理并不是对所有的人都适合。如果你喜欢专注起来做一件事，喜欢钻研事物的本质而成为某个领域的专家，比如某个数据库，或者某个编程语言。做程序员最大的幸事，就是你既可以做自己喜欢的，也可以衣食无忧。&lt;/p&gt;
&lt;p&gt;为什么要转型？如果你还没有答案，也不要过于纠结，大不了试一试，喜欢了就接着做，不喜欢可以继续做回工程师。这其实不但可行，反而会有意外的收获，因为管理，可以使你成为更好的工程师。因为从事管理，可以锻炼你更加全面长远的看待问题。也可以让你接触到更多的问题及解决办法，进而增加处理问题的经验。凡是没有绝对的黑和白，不同的岗位有不同的优缺点，如何找到合适你的，这是一个值得整个职业生涯都去考虑的事。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>ce686d3c409c1e523362cce0676746d3</guid>
<title>防卒指南：996 + 健身≈猝死</title>
<link>https://toutiao.io/k/jbhqgi4</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p&gt;刚刚看了条新闻，像聊家常似的说两句。希望程序员的心脏能永远“&lt;strong&gt;跳动&lt;/strong&gt;”，指尖的“&lt;strong&gt;字节&lt;/strong&gt;”能永远流淌。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;聊聊猝死。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;我试着在中文语境下找一些资料来佐证我标题的观点，“运动能锻炼身体的原理”。可惜只能搜到各种健身指南、健身技巧。显然，健身市场很红火， 这些关键字都被买断了。我只能做一些不那么严谨的论证。&lt;/p&gt;&lt;p&gt;在我看来，&lt;strong&gt;锻炼是对身体的适当惩罚以达到身体机能补偿的过程。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;人类在自然界中生存，物竞天择，我们的身体已经做出了选择。当你总是在奔跑，就奖励你腿部发达的肌肉。当你总是在举重，就奖励你手臂发达的肌肉。但这里有一个借和还的过程。你消耗一定的身体机能再通过自身的调节收获更强大的机能的过程。有借有还，连本带利。&lt;/p&gt;&lt;p&gt;这很公平。但如果你借不出了呢？我是说，你的身体无法承受一次&lt;strong&gt;惩罚&lt;/strong&gt;来获得更大的收益。你的机能无法再&lt;strong&gt;透支&lt;/strong&gt;以获得更多肌肉增长。&lt;/p&gt;&lt;p&gt;我想，这就是猝死的根本。&lt;/p&gt;&lt;p&gt;有人是这样证明世界上没有最大的数的。假设一个最大的数为M，那么，M+1一定大于M。前后矛盾，所以不存在最大的数。这是数学上的真理，但是，有一个词叫”枯竭“，有一个词叫”耗尽“，有一个词叫”绝迹“。它们的意思是，一点点都没有，一点点都不剩。我们总是以为我们有无数个明天，总以为自己再熬一熬，挺一挺什么都会过去。&lt;/p&gt;&lt;p&gt;可是，总有人没有明天。总有人再多一分的钱都拿不出来。总有人再多一分力气都使不出来。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;这时就耗尽了！就榨干了！&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;一丝不剩的那种。&lt;/p&gt;&lt;p&gt;我刚看了三篇文章，《为什么睡眠是让身体更好的第一要务》、《劳累时应该运动吗？》、《精疲力竭时应该运动吗？》，分别对应下面三个链接。&lt;/p&gt;&lt;p&gt;Why Sleep Is the No. 1 Most Important Thing for a Better Body&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://www.shape.com/lifestyle/mind-and-body/why-sleep-no-1-most-important-thing-better-body&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Should You Exercise When You&#x27;re Tired?&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://www.sparkpeople.com/resource/fitness_articles.asp?id=2298&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Should I Exercise When I&#x27;m Exhausted?&lt;/p&gt;&lt;p&gt;&lt;span&gt;https://www.livestrong.com/article/466754-should-i-exercise-when-im-exhausted/&lt;/span&gt;&lt;/p&gt;&lt;p&gt;其中提到，&lt;strong&gt;精疲力尽时锻炼是很危险的，因为身体机能的下降，你会因反应慢而受伤并且会损伤免疫系统。&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;所以，当我们疲惫时就必须休息。这是现代人类文明早就约定了的。就算别人忘了，自己也不能忘。&lt;/p&gt;&lt;blockquote&gt;&lt;h4&gt;&lt;span&gt;当你疲倦时，你要休息，不要锻炼！健身要在睡眠充足，休息充分时进行。&lt;/span&gt;&lt;/h4&gt;&lt;/blockquote&gt;&lt;p&gt;大家加班就加班，加完班就回家睡觉。这时候睡觉是对你身体最好的选择。既然选择了996就别在加完班后挑战身体的极限了。当你成功挑战了自己身体的极限，你也就看不见第二天的太阳了。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;有时候没时间就是没时间，挤也挤不出来！&lt;/strong&gt; 你挤出来的时间也是靠透支身体的休息换来的，你还要继续透支你的身体来”&lt;strong&gt;锻炼&lt;/strong&gt;“，就有点对自己太狠了。年纪轻时也许没事，但哪有人能一直年轻呢？&lt;/p&gt;&lt;p&gt;不要总跟自己的身体较劲，人的精力终究是有限的。假设你一生的精力总值是M，你永远无法透支M+1。这个世界不是冷冰冰的数学驱动的，再NB的数学也是为我们这些朴素的屁民服务的。爱自己，爱生活。&lt;strong&gt;在你的家人眼里，你不是一颗小草，不是一朵浪花，你是永不倒下的山峰！&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;当996和健身不可兼得，就不要强求了。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.31875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/RFqA2R4MfQRVicgeeiaPnwTO2BxNVrtfSueYudafJcIZvDIAia0uSXHibIQMuicYdsU8PoulfQgYhdiaxv2ngv2FRhEA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;---------&lt;/p&gt;&lt;p&gt;&lt;span&gt;后台回复【摸鱼】，参与红包抽奖。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;希望你健康快乐，让朋友也看到。&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;img data-ratio=&quot;0.5691057&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5I3AbD7wibGibydQThJXZh4SruL8YmNbvUX6H3lNWjTgQLwm0Coe7lWib5IvfbGjSNxxicJyeVWCPB9Y8PxvedCVAA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;123&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>